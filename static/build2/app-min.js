"use strict";function CannonActClass(a){var p={fontSize:30,targetHit:{x:637,y:303,w:182,h:53,r:10,xText:660,yText:350},jaws_text:"",jaws_text1:"",jaws_text2:"",jaws_text3:"",k:0,_color:[{color:"#122001",name:"Deep Fir Green color"},{color:"#360180",name:"purple color"},{color:"#621324",name:" red-brown color"},{color:"#353503",name:"olive green color"},{color:"#023621",name:"Cardin Green color"},{color:"#0A330B",name:"Deep Forest Green color"},{color:"#52143F",name:"Burgundy color"},{color:"#511D15",name:"Brown Derby color"},{color:"#2A2F0F",name:"Dark Yellow color"},{color:"#143421",name:"Celtic green color"},{color:"#162F46",name:"Blue color"},{color:"#352922",name:"dark brown color"},{color:"#290941",name:"Violet color"},{color:"#3C253C",name:"Dark Pastel Crimson color"},{color:"#22301C",name:"Green Kelp color"},{color:"#850085",name:"Fresh Eggplant color"}]},o={},n=this,f={viewTranslation:{x:0,y:-170},graph:{x:126,y:636,maxY:636},h1:250,h2:0,d:1050,Rangle:-Math.PI/4,cannon:{org:{x:122,y:624,w:58,h:26},cal:{x:122,y:620,xW:126,yH:636}},cannonStand:{org:{x:112,y:630,w:28,h:23},cal:{x:112,y:630}},cannonBase:{org:{x:104,y:653,w:43,h:10},cal:{x:104,y:653,w:43,h:10}},flag:{org:{x:95,y:597,w:59,h:40},cal:{x:96,y:594,w:59,h:40}},flagBase:{org:{x:107,y:630,w:35,h:0},cal:{x:102.5,y:637,w:35,h:0}},cannonBall:{w:20,h:20},cannonBlast:{w:144,h:108},erruption:{w:81,h:29,y:635},gtpX:1.74,gtpY:1.74};Object.keys(a).forEach(function(t){p[t]=a[t]}),p.imageList=["canon.png","canonball.png","canonbase.png","canonstand.png","flag.png","graph.png","TargrtHit.png"],p.LabComClass.requestLocalImage(p.imageList,function(t){o=t,onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:p.id}})});var r={};this.addEventListener=function(t,e){r[t]=e};var s=document.createElement("div"),l=document.createElement("span"),c=document.createElement("div"),h=document.createElement("span"),u=document.createElement("div");function d(t){var e={};if(e.id=p.id,e.r=[],e.r.push({id:0,eventListener:m.bind(this)}),p.paths&&p.drawPath)for(var i=0;i<p.paths.length;i++)for(var n=0;n<p.paths[i].length-1;n++)p.paths[i][n].c&&e.r.push({id:"line_"+i+"_"+n,arc:{x:p.paths[i][n+1].x,y:p.paths[i][n+1].y+f.viewTranslation.y,r:10},eventListener:m.bind(this)});onViewUpdateCls.trigger("onGlobalUpdate",{type:"removeMouseEvent",data:{id:e.id}}),t&&onViewUpdateCls.trigger("onGlobalUpdate",{type:"addMouseEvent",data:e})}function m(t){switch(t.type){case"mousedown":case"mousemove":break;case"mouseup":!function(t){if(0<=t.subId.indexOf("line_")){var e=t.subId.split("_");p.selectedColor=Number(e[1]);var i=p.lineData[p.selectedColor];i&&(p.initVelo=i.initVelo,p.gravity=i.gravity,p.height1=i.height1,p.height2=i.height2,p.angle=i.angle,p.distance=i.distance),n.updateRender(p),r.change&&r.change({type:"updateModel",data:p})}}(t)}}function t(){if(Math.round(p.currentTime)<100){p.currentTime+=.1;var t=p.currentPath[Math.round(10*p.currentTime)-1];p.paths[p.paths.length-1].push(t),p.drawBall=!0,p.blastBall=NaN;var e=("00"+parseInt(1<60*p.currentTime%60?60*p.currentTime%60:0,0)).slice(-2),i=("00"+parseInt(1<p.currentTime%60?p.currentTime%60:0,0)).slice(-2),n=("00"+parseInt(1<p.currentTime/60?p.currentTime/60:0,0)).slice(-2);p.timerText=p.LabComClass.globalLangText.time+(n+".")+i+"."+e,u.style.display="block",u.textContent=onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"}),(t.blastBool||t.groundBool)&&(p.anim.stop("ballAnim"),p.drawBall=!1,u.textContent=p.LabComClass.globalLangText[p.jaws_text3],p.currentPath=[],r.enable&&r.enable(!0),d(!0),p.playResetState="play"),t.flagHit&&(u.textContent=p.LabComClass.globalLangText[p.jaws_text2],p.currentTime=200)}else 0<=p.showTimeout&&200===p.currentTime?(p.showTimeout++,10<p.showTimeout&&(p.anim.stop("ballAnim"),p.drawBall=!1,p.showTimeout=void 0,p.currentPath=[],r.enable&&r.enable(!0),d(!0),p.playResetState="play")):200===p.currentTime?p.showTimeout=0:(p.anim.stop("ballAnim"),p.drawBall=!1,p.showTimeout=void 0,p.currentPath=[],r.enable&&r.enable(!0),d(!0),p.playResetState="play",n="01",i="40",e="00",p.timerText=p.LabComClass.globalLangText.time+(n+".")+i+"."+e,void 0!==r.change&&r.change({type:"showAlert"}));void 0!==r.change&&r.change({type:"updateModel",data:p})}this.draw=function(){var t=p.context;if(t.save(),t.translate(0,f.viewTranslation.y),void 0!==o[p.imageList[0]]){if(p.drawGraph&&t.drawImage(o[p.imageList[5]],54,125,o[p.imageList[5]].width/2,o[p.imageList[5]].height/2),p.drawPath){t.save();for(var e=0;e<p.paths.length&&(t.beginPath(),t.strokeStyle=p.colorList[e].value,t.lineWidth=4,isNaN(p.selectedColor)||(e===Number(p.selectedColor)?t.globalAlpha=1:t.globalAlpha=.5),void 0!==p.paths[e][0]);e++){t.moveTo(p.paths[e][0].x,p.paths[e][0].y);for(var i=1;i<p.paths[e].length;i++)t.quadraticCurveTo(p.paths[e][i-1].x,p.paths[e][i-1].y,p.paths[e][i].x,p.paths[e][i].y);t.stroke(),t.closePath();for(var n=1;n<p.paths[e].length;n++)p.paths[e][n-1].c&&(t.beginPath(),t.fillStyle=p.colorList[e].value,t.lineWidth=0,t.arc(p.paths[e][n].x,p.paths[e][n].y,10,0,2*Math.PI),t.fill(),t.closePath())}t.restore()}0<p.paths.length&&0<p.paths[p.paths.length-1].length&&p.drawBall&&(e=p.paths.length,i=p.paths[e-1].length,t.drawImage(o[p.imageList[1]],p.paths[e-1][i-1].x-f.cannonBall.w/2,p.paths[e-1][i-1].y-f.cannonBall.h/2,f.cannonBall.w,f.cannonBall.h)),t.save(),t.translate(f.cannon.cal.xW,f.cannon.cal.yH),t.rotate(f.Rangle),t.translate(-f.cannon.cal.xW,-f.cannon.cal.yH),t.drawImage(o[p.imageList[0]],f.cannon.cal.x,f.cannon.cal.y,f.cannon.org.w,f.cannon.org.h),t.restore(),t.drawImage(o[p.imageList[3]],f.cannonStand.cal.x,f.cannonStand.cal.y,f.cannonStand.org.w,f.cannonStand.org.h),t.drawImage(o[p.imageList[4]],f.flag.cal.x,f.flag.cal.y,f.flag.org.w,f.flag.org.h),s.style.width=f.cannonBase.cal.w+"px",s.style.height=f.cannonBase.cal.h+"px",s.style.position="absolute",s.style.left=f.cannonBase.cal.x+"px",s.style.top=f.cannonBase.cal.y-171+"px",s.style.backgroundColor="transparent",l.style.width=f.cannonBase.cal.w+"px",l.style.height=f.cannonBase.cal.h+"px",l.style.position="absolute",l.style.left="0px",l.style.top="0px",l.style.backgroundColor="transparent",l.style.opacity=0,l.innerHTML=p.LabComClass.globalLangText[p.jaws_text],s.appendChild(l),a.domLayer.appendChild(s),c.style.width=f.flagBase.cal.w+"px",c.style.height=f.flagBase.cal.h+"px",c.style.position="absolute",c.style.left=f.flagBase.cal.x+"px",c.style.top=f.flagBase.cal.y-171+"px",c.style.backgroundColor="transparent",h.style.width=f.flagBase.cal.w+"px",h.style.height=f.flagBase.cal.h+"px",h.style.position="absolute",h.style.left="0px",h.style.top="0px",h.style.backgroundColor="transparent",h.style.opacity=0,h.innerHTML=p.LabComClass.globalLangText[p.jaws_text1],c.appendChild(h),a.domLayer.appendChild(c),t.beginPath();var r=t.createPattern(o[p.imageList[2]],"repeat");t.fillStyle=r,t.translate(f.cannonBase.cal.x,f.cannonBase.cal.y),t.fillRect(0,0,f.cannonBase.cal.w,f.cannonBase.cal.h),t.translate(-f.cannonBase.cal.x,-f.cannonBase.cal.y),t.closePath(),t.beginPath(),r=t.createPattern(o[p.imageList[2]],"repeat"),t.fillStyle=r,t.translate(f.flagBase.cal.x,f.flagBase.cal.y),t.fillRect(-0,-0,f.flagBase.cal.w,f.flagBase.cal.h),t.translate(-f.flagBase.cal.x,-f.flagBase.cal.y),t.closePath(),isNaN(p.blastImg)||(e=p.paths.length,i=p.paths[e-1].length,t.drawImage(o["exp_"+p.blastImg+".png"],p.paths[e-1][i-1].x-f.cannonBlast.w/2,p.paths[e-1][i-1].y-f.cannonBlast.h/2,f.cannonBlast.w,f.cannonBlast.h))}0<=p.showTimeout&&(t.save(),t.beginPath(),t.fillStyle="rgba(255, 102, 0, 1)",function(t,e,i,n,r,a,o,s){void 0===s&&(s=!0);void 0===a&&(a=5);if("number"==typeof a)a={tl:a,tr:a,br:a,bl:a};else{var l={tl:0,tr:0,br:0,bl:0};Object.keys(l).forEach(function(t){a[t]=a[t]||l[t]})}t.beginPath(),t.moveTo(e+a.tl,i),t.lineTo(e+n-a.tr,i),t.quadraticCurveTo(e+n,i,e+n,i+a.tr),t.lineTo(e+n,i+r-a.br),t.quadraticCurveTo(e+n,i+r,e+n-a.br,i+r),t.lineTo(e+a.bl,i+r),t.quadraticCurveTo(e,i+r,e,i+r-a.bl),t.lineTo(e,i+a.tl),t.quadraticCurveTo(e,i,e+a.tl,i),t.closePath(),o&&t.fill();s&&t.stroke()}(t,p.targetHit.x,p.targetHit.y,p.targetHit.w,p.targetHit.h,p.targetHit.r,"true",!1),t.fill(),t.closePath(),t.beginPath(),t.fillStyle="rgba(255, 255, 255, 1)",t.textBaseline="bottom",t.drawStyledText(p.LabComClass.globalLangText.targetHit,p.targetHit.xText,p.targetHit.yText,p.LabComClass.klettFontRegular,p.fontSize),t.closePath(),t.restore()),t.restore()},this.init=function(t){p.anim=new p.LabComClass.GlobalAnimClass,d(!0),r.delConfirm&&r.delConfirm(!1),setTimeout(function(){u&&(u.id="status message",u.style.width=p.targetHit.w+"px",u.style.height=p.targetHit.h+"px",u.style.position="absolute",u.style.left=p.targetHit.x+"px",u.style.top="140px",u.style.backgroundColor="transparent",u.style.color="transparent",u.ariaAtomic=!0,u.ariaLive="polite",t.domLayer.appendChild(u))},500)},this.updateRender=function(e){Object.keys(e).forEach(function(t){p[t]=e[t]}),f.Rangle=-p.angle*Math.PI/180,f.h1=f.gtpY*p.height1,f.h2=f.gtpY*p.height2,f.d=f.gtpX*p.distance,f.cannon.cal.y=f.cannon.org.y-f.h1,f.cannon.cal.yH=f.cannon.cal.y+f.cannon.org.h/2,f.cannonStand.cal.y=f.cannonStand.org.y-f.h1,f.cannonBase.cal.y=f.cannonStand.cal.y+f.cannonStand.org.h,f.cannonBase.cal.h=f.cannonBase.org.h+f.h1,f.flag.cal.x=f.flag.org.x+f.d,f.flag.cal.y=f.flag.org.y-f.h2,f.flagBase.cal.x=f.flagBase.org.x+f.d,f.flagBase.cal.y=f.flag.cal.y+f.flag.org.h,f.flagBase.cal.h=f.flagBase.org.h+f.h2,p.protractor.y=f.cannon.cal.y-p.protractor.base-2+f.viewTranslation.y,p.playStarted&&(p.selectedColor=NaN,"play"===p.playStarted.value?(u.style.display="block",p.currentTime=0,p.currentPath=function(){15===p.k&&(p._color=function(){for(var t=p._color,e=t.length-1;0<e;e--){var i=Math.floor(Math.random()*(e+1)),n=[t[i],t[e]];t[e]=n[0],t[i]=n[1]}return t}(),p.k=0);var t=p._color[p.k++],e=t.color;p.colorList.push({name:t.name,value:e}),p.lineData.push({id:p.lineData.length,color:e,initVelo:p.initVelo,angle:p.angle,gravity:p.gravity,distance:p.distance,height1:p.height1,height2:p.height2});var i,n,r=[{x:f.graph.x+0*f.gtpX,y:f.graph.y-f.gtpY*p.height1,t:0,c:!0}],a=0,o=!1,s=(p.initVelo,p.gravity,0),l={x:r[0].x,y:r[0].y};for(;a<=1e3&&(a+=1,s+=.1,s=Number(s.toFixed(1)),!(1e3<a));){var c={};if(c.x=f.graph.x+f.gtpX*(1*p.initVelo)*Math.cos(-f.Rangle)*s,c.y=f.graph.y-f.gtpY*(p.height1+1*p.initVelo*Math.sin(-f.Rangle)*s-p.gravity*s*s*.5),c.y>f.graph.maxY){var h=(r[r.length-2].x-r[r.length-1].x)/(r[r.length-2].y-r[r.length-1].y),u=(f.graph.maxY-r[r.length-2].y)*h+r[r.length-2].x;r.push({x:u,y:f.graph.maxY}),r[r.length-1].blastBool=!0,r[r.length-1].groundBool=!0;break}var d={left:c.x-f.cannonBall.w/2,top:c.y+f.cannonBall.h/2,leftMax:c.x+f.cannonBall.w/2,leftF:f.flagBase.cal.x-f.flagBase.cal.w/2,leftFMax:f.flagBase.cal.x+f.flagBase.cal.w,topF:f.flagBase.cal.y,ballCX:c.x,ballCY:c.y,flagLeft:f.flagBase.cal.x,flagTop:f.flagBase.cal.y,canLeft:f.cannonBase.cal.x+f.cannonBase.cal.w,canTop:f.cannon.cal.y};if(n=50<p.LabComClass.Maths.getDistance(c,l)&&(l.x=c.x,l.y=c.y,!0),r.push({x:c.x,y:c.y,t:Number(s.toFixed(2)),c:n}),Object.keys(d).forEach(function(t){d[t]=Number(d[t].toFixed(2))}),d.ballCX,i=d.ballCY,d.left>=d.leftF&&d.left<=d.leftFMax&&Math.ceil(d.top)>=Math.ceil(d.topF)){d.topF>i?r[r.length-1].flagHit=!0:r[r.length-1].blastBool=!0;break}if(d.leftMax<=d.canLeft&&d.top>=d.canTop&&o){r[r.length-1].blastBool=!0;break}d.top<d.canTop&&(o=!0)}return r}(),p.paths.push([]),void 0!==r.change&&r.change({type:"updateModel",data:p}),r.enable&&r.enable(!1),d(!1),p.anim.start({id:"ballAnim",fps:12,frame:t})):(p.anim.stop("ballAnim"),p.drawBall=!1,p.currentPath=[],void 0!==r.change&&r.change({type:"updateModel",data:p}),r.enable&&r.enable(!0)),p.playStarted=void 0),p.deleteSelected&&(isNaN(p.selectedColor)?(u.style.display="none",p.colorList=[],p.lineData=[],p.paths=[]):(p.paths.splice(p.selectedColor,1),p.lineData.splice(p.selectedColor,1),p.colorList.splice(p.selectedColor,1)),p.selectedColor=NaN,(p.deleteSelected=void 0)!==r.change&&r.change({type:"updateModel",data:p}),r.enable&&r.enable(!0)),d(!0),void 0!==r.change&&r.change({type:"updateModel",data:p})}}function PanelCompClass(e){var n={x:0,y:0,width:100,height:100,visible:!0,bgColor:"#d3d3d3",headX:0,headY:0,headWidth:100,seperators:[],seperatorsColor:"#FFFFFF",seperatorsShadowColor:"rgba(3, 3, 3, 0.1)",seperatorsLength:[],hiddenSeperators:[],seperatorPadding:10,orientation:"h",headHeight:40,headColor:"#999999",headText:"Header",headTextX:30,isHeadItalic:!1,isHeadBold:!1,headTextY:12,headFontSize:18,headFontColor:"#ffffff",copyRight:!1,defaultX:20,radius:3.5,alignContent:"",jaws_coprright:""},i={},r=document.createElement("div"),t=document.createElement("span"),a=document.createElement("button");a.id=e.id;var o,s=document.createElement("span"),l=document.createElement("span"),c=document.createElement("span");Object.keys(e).forEach(function(t){n[t]=e[t]}),o=n,r.style.width=o.headWidth+"px",r.style.height=o.headHeight+"px",r.style.position="absolute",r.style.display="flex",r.style.alignItems="center",r.style.justifyContent=o.alignContent,r.style.left=o.x+o.headX+"px",r.style.top=o.y+o.headY+"px",t.innerHTML=o.LabComClass.globalLangText[o.headText],t.style.fontSize=o.headFontSize+"px",t.style.fontStyle=o.isHeadItalic?"italic ":"",t.style.fontWeight=o.isHeadBold?"bold ":"",t.style.fontFamily=o.LabComClass.klettFontRegular,t.style.verticalAlign="bottom",t.style.color="white","left"===o.alignContent&&(t.style.marginLeft="30px"),a.style.display="flex",a.style.flexDirection="column",a.style.alignItems="center",a.style.width="20px",a.style.height=o.headHeight+"px",a.style.position="absolute",a.style.right="10px",a.style.backgroundColor="transparent",a.style.cursor="pointer",a.style.borderWidth="0px",s.style.pointerEvents="none",s.style.width="7px",s.style.height="7px",s.style.backgroundColor="white",s.style.borderRadius="50%",s.style.display="block",s.style.margin="5px auto 1px auto",l.style.pointerEvents="none",l.style.width="7px",l.style.height="7px",l.style.backgroundColor="white",l.style.borderRadius="50%",l.style.display="block",l.style.margin="1.5px auto",c.style.pointerEvents="none",c.style.width="7px",c.style.height="7px",c.style.backgroundColor="white",c.style.borderRadius="50%",c.style.display="block",c.style.margin="1.5px auto",a.appendChild(s),a.appendChild(l),a.appendChild(c),r.appendChild(t),a.setAttribute("aria-label",e.LabComClass.globalLangText[o.jaws_coprright]),o.copyRight&&r.appendChild(a),e.domLayer.appendChild(r);n.context.textWrapperClass({xNum:0,yNum:0,maxWidthNum:n.width,textStr:n.LabComClass.globalLangText[n.headText],fontFamilyStr:n.LabComClass.klettFontRegular,fontSizeNum:n.headFontSize,fontColor:n.headFontColor});function h(){n.copyRight&&!0===n.visible&&a&&(a.removeEventListener("mousedown",u),a.removeEventListener("click",u),a.addEventListener("mousedown",u),a.addEventListener("click",u))}function u(t){switch(t.type){case"mousedown":case"mousemove":break;case"click":t.target.id===e.id&&void 0!==i.openPopUp&&i.openPopUp({id:n.id,type:"openPopUp"})}}h(),onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:n.id}}),this.show=function(){n.visible=!0,h()},this.hide=function(){n.visible=!1,h()},this.addEventListener=function(t,e){i[t]=e},this.showSeperator=function(t){var e,i;if("number"==typeof t)0<=(i=n.hiddenSeperators.indexOf(t))&&n.hiddenSeperators.splice(i,1);else for(e=0;e<t.length;e++)0<=(i=n.hiddenSeperators.indexOf(t[e]))&&n.hiddenSeperators.splice(i,1)},this.hideSeperator=function(e){"number"==typeof e?n.hiddenSeperators.push(e):Object.keys(e).forEach(function(t){-1===n.hiddenSeperators.indexOf(e[t])&&n.hiddenSeperators.push(e[t])})},this.draw=function(){if(document.getElementsByClassName("checkbox")[7].value===String(!0)?r.style.backgroundColor="#454540":r.style.backgroundColor="#999999",n.visible){var t=n.context;t.beginPath(),t.fillStyle=n.bgColor,t.fillRect(n.x,n.y,n.width,n.height),t.closePath(),t.beginPath();n.x,n.headTextX,n.y,n.headTextY;for(var e=0;e<n.seperators.length;e++){var i="h"===n.orientation?n.height:n.width;n.seperatorsLength&&n.seperatorsLength[e]&&(i=n.seperatorsLength[e]),-1===n.hiddenSeperators.indexOf(n.seperators[e])&&(t.save(),t.beginPath(),t.strokeStyle=n.seperatorsColor,t.lineWidth=1,"h"===n.orientation?(t.moveTo(n.x+n.seperators[e],n.y+n.headHeight+n.seperatorPadding),t.lineTo(n.x+n.seperators[e],n.y+i-n.seperatorPadding)):"v"===n.orientation&&(t.moveTo(n.x+n.seperatorPadding,n.y+n.seperators[e]),t.lineTo(n.x+i-n.seperatorPadding,n.y+n.seperators[e])),t.stroke(),t.closePath(),t.beginPath(),t.strokeStyle=n.seperatorsShadowColor,"h"===n.orientation?(t.moveTo(n.x+n.seperators[e]+1,n.y+n.headHeight+n.seperatorPadding),t.lineTo(n.x+n.seperators[e]+1,n.y+i-n.seperatorPadding)):"v"===n.orientation&&(t.moveTo(n.x+n.seperatorPadding,n.y+n.seperators[e]+1),t.lineTo(n.x+i-n.seperatorPadding,n.y+n.seperators[e]+1)),t.stroke(),t.closePath(),t.restore())}}}}function SliderCompClass(e){var i={},n=!1,a={x:0,y:0,width:180,height:26,min:0,max:100,decimal:2,selected:!1,visible:!0,enabled:!0,value:0,direction:"horizontal",baseSlideObj:{x:11,y:11,r:4,color:"#999999"},knobObj:{x:13,y:13,r:26,eventRadius:13,eventRadiusForDevieces:20,color:"#ff6600",downColor:"#ff0000",disableColor:"#afafaf"},jaws_text:""};Object.keys(e).forEach(function(t){a[t]=e[t]}),a.value=a.min,a.LabComClass.BrowserDetect.isDevice()&&(a.knobObj.eventRadius=a.knobObj.eventRadiusForDevieces),"horizontal"===a.direction?(a.baseSlideObj.x=a.knobObj.x,a.baseSlideObj.width=a.width-2*a.baseSlideObj.x,a.baseSlideObj.height=a.baseSlideObj.r):(a.baseSlideObj.y=a.knobObj.y,a.baseSlideObj.width=a.baseSlideObj.r,a.baseSlideObj.height=a.height-2*a.baseSlideObj.y),c(),onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:a.id}});var r,o=document.createElement("input"),t=function(t){a.value=+t.target.value,o.setAttribute("aria-valuenow",r),void 0!==i.change&&i.change({id:a.id,value:a.value})},s=function(t){var e=Math.pow(10,-a.decimal);switch(100===a.min&&(e=1),240===a.max&&(e=1),r=a.value,t.key){case"ArrowLeft":case"ArrowDown":r-=e;break;case"ArrowRight":case"ArrowUp":r+=e;break;default:return}r<a.min?r=a.min:r>a.max&&(r=a.max),a.value=r,o.value=r,o.setAttribute("aria-valuenow",r),o.removeAttribute("aria-valuenow"),void 0!==i.change&&i.change({id:a.id,value:a.value}),t.preventDefault()};function l(){if("vertical"===a.direction){var t=1-(a.knobObj.y-a.knobObj.r)/(a.height-2*a.knobObj.r),e=a.max-a.min;a.value=Number((e*t+a.min).toFixed(a.decimal))}else if("horizontal"===a.direction){var i=(a.knobObj.x-a.knobObj.r)/(a.width-2*a.knobObj.r),n=a.max-a.min;a.value=Number((n*i+a.min).toFixed(a.decimal))}}function c(){var t=a.max-a.min,e=a.value-a.min;if("vertical"===a.direction){var i=a.height-2*a.knobObj.r,n=i-e/t*i;a.knobObj.y=n+a.knobObj.r}else if("horizontal"===a.direction){var r=e/t*(a.width-2*a.knobObj.r);a.knobObj.x=r+a.knobObj.r}}o.setAttribute("type","range"),o.id="".concat(a.id),o.className="slider",o.min=a.min,o.max=a.max,o.style.position="absolute",o.style.width=a.width+"px",o.style.height=a.height+"px",o.style.cursor="pointer",o.style.left="".concat(a.x,"px"),o.style.top="".concat(a.y,"px"),o.step=Math.pow(10,-a.decimal),o.style.backgroundColor="#999999",100===a.min&&(o.step=1),240===a.max&&(o.step=1),"vertical"===a.direction?(o.value=0,o.style.webkitAppearance="none",o.style.transform="rotate(270deg)"):(o.style.webkitAppearance="none",o.style.width=a.width+"px",o.style.height=a.height+"px"),o.setAttribute("aria-label",a.LabComClass.globalLangText[a.jaws_text]),o.setAttribute("aria-valuenow",a.value),a.domLayer.appendChild(o),o.removeEventListener("input",t),o.addEventListener("input",t),o.addEventListener("keydown",s),this.addEventListener=function(t,e){i[t]=e},this.setValue=function(t){a.value=t,document.getElementById(a.id).value=a.value,c()},this.getValue=function(){return a.value},this.setMaxMin=function(t){a.max=void 0!==t.max?t.max:a.max,a.min=void 0!==t.min?t.min:a.min,c(),l()},this.getMaxMin=function(){return{max:a.max,min:a.min}},this.enable=function(){document.getElementById(a.id).removeAttribute("disabled"),a.enabled=!0},this.disable=function(){document.getElementById(a.id).setAttribute("disabled",!0),a.enabled=!1,n=!1},this.show=function(){a.visible=!0,document.getElementById(a.id).style.display=""},this.hide=function(){a.visible=!1,document.getElementById(a.id).style.display="none"},this.setAccess=function(t){t?(o.style.backgroundColor="#454540",o.classList.add("acc")):(o.style.backgroundColor="#999999",o.classList.remove("acc"))},this.draw=function(){},this.draw_old=function(){if(a.visible){var t=a.context;t.save(),t.beginPath(),t.fillStyle=a.baseSlideObj.color,t.fillRect(a.x+a.baseSlideObj.x,a.y+a.baseSlideObj.y,a.baseSlideObj.width,a.baseSlideObj.height),t.closePath(),t.beginPath(),a.enabled&&n?t.fillStyle=a.knobObj.downColor:a.enabled?t.fillStyle=a.knobObj.color:t.fillStyle=a.knobObj.disableColor,t.arc(a.x+a.knobObj.x,a.y+a.knobObj.y,a.knobObj.r,0,2*Math.PI),t.fill(),t.closePath(),t.restore()}}}function LabelCompClass(e){var n={x:0,y:0,width:2e3,visible:!0,text:"",maxWidth:0,fontSize:16,fontColor:"rgba(0,0,0,1)",align:"left",isItalic:!1,isBold:!1,rotation:0,lineHeight:"1.2em",bgColor:"#000000",jaws_text:""};Object.keys(e).forEach(function(t){n[t]=e[t]});var r=n.LabComClass.globalLangText[n.text],a=document.createElement("div");function i(){var t=n.text;a.innerHTML=t}a.id=n.id,this.init=function(t){a.setAttribute("aria-label",t.LabComClass.globalLangText[t.jaws_text]),t.domLayer.appendChild(a)},this.init(n),""!==n.text&&(n.text=n.LabComClass.globalLangText[n.text]),i(),onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:n.id}}),this.setValue=function(t){n.text=t,i()},this.getValue=function(){return n.text},this.setBGColor=function(t){n.bgColor=t},this.getVisble=function(){return n.visible},this.setVisible=function(t){n.visible=t},this.getBGColor=function(){return n.bgColor},this.setTextColor=function(t){n.fontColor=t},this.getTextColor=function(){return n.fontColor},this.show=function(){n.visible=!0},this.hide=function(){n.visible=!1},this.setPos=function(t,e){n.x=t,n.y=e},this.getPos=function(){return{x:n.x,y:n.y}},this.setStyle=function(e){Object.keys(e).forEach(function(t){n[t]=e[t]}),i()},this.draw=function(){if(n.visible){var t="",e=n.x,i=n.y;a.style.position="absolute",a.style.color=n.fontColor,t+=n.isItalic?"italic ":"",t+=n.isBold?"bold ":"",a.style.fontStyle="".concat(t),a.style.fontSize="".concat(n.fontSize," px"),a.style.fontFamily=n.LabComClass.klettFontRegular,a.style.textAlign=n.align,a.style.verticalAlign=void 0,a.style.fontWeight="".concat(t),n.text&&0===n.maxWidth&&(n.isBold&&n.isItalic?r=n.LabComClass.italicbold+r+n.LabComClass.end:(n.isItalic&&(r=n.LabComClass.italic+r+n.LabComClass.end),n.isBold&&(r=n.LabComClass.bold+r+n.LabComClass.end))),a.style.left=e+"px",a.style.top=i+"px"}}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function InputBoxClass(t){var e,i,n=this,r=t.id,a=(t.parentId,t.context,U(t.x,0)),o=U(t.y,0),s=U(t.width,56),l=U(t.height,30),c=(U(t.radius,0),U(t.strokeStyle,"transparent"),U(t.fillStyle,"rgba(255,255,255,1)"),U(t.borderWidth,2),U(t.shadowVisible,!1),U(t.shadowColor,"rgba(0,0,0,0.5)"),U(t.shadowOffsetX,2),U(t.shadowOffsetY,2),U(t.shadowBlur,10),U(t.paddingArr,[0,0,0,0]),U(t.fontSize,18)),h=U(t.fontFamily,t.LabComClass.klettFontRegular),u=U(t.fontColor,"rgba(0,0,0,1)"),d=U(t.disableFillStyle,"rgba(0,0,0,0.5)"),p=U(t.value,""),f=U(t.filterType,1),m=U(t.maxLength,4),g=U(t.maxLengthFilter,1),v=(U(t.textAlign,"center"),U(t.textPadding,5),U(t.cursorColor,"rgba(0, 0, 0, 1)"),U(t.allowFirstDecimal,!0),U(t.showComponent,!0)),y=(U(t.LabComClass.globalLangText[t.preTxt],""),U(t.LabComClass.globalLangText[t.postTxt],""),t.leftMinDecimalCountInt),_=t.rightMaxDecimalCountInt,b=!1,x=!1,w=!1,T={},M=["focusIn","focusOut","click","keyup","mouseenter","mouseout","Enter"],S=null,E=t.LabComClass.BrowserDetect,C=document.createElement("input");C.setAttribute("type","text"),this.init=function(t){C.id=t.id,C.style.position="absolute",C.style.left=a+"px",C.style.top=o+"px",C.style.width=s+"px",C.style.height=l+"px",C.style.padding="unset",C.style.border="none",C.style.borderRadius=0,C.autocapitalize="none",t.domLayer.appendChild(C)},this.init(t);var L=t.LabComClass.globalLangText[t.jaws_text]+C.value+t.LabComClass.globalLangText[t.jaws_text1];function A(t){if(-1!==M.indexOf(t))return!0;throw new Error("Invalid event ".concat(t," provided, following events ").concat(T," are allowed"))}function P(t){return T[t]&&0<T[t].length}function R(e){P(e)&&T[e].forEach(function(t){t({type:e,id:r,value:p})})}function O(){x&&(onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"}),requestAnimationFrame(O))}function I(t){t?(C.addEventListener("change",H),C.addEventListener("mouseup",F),C.addEventListener("mouseenter",F),C.addEventListener("mouseout",F),C.addEventListener("keydown",B)):(C.removeEventListener("mouseup",F),C.removeEventListener("mouseenter",F),C.removeEventListener("mouseout",F),C.removeEventListener("change",H),C.removeEventListener("keydown",B)),t}function D(t){t?onViewUpdateCls.trigger("onGlobalUpdate",{type:"addKeyEvent",data:{id:r,callback:H}}):onViewUpdateCls.trigger("onGlobalUpdate",{type:"removeKeyEvent",data:{id:r,callback:H}})}function j(e,t){var i=!1,n=function(){var t={48:0,49:1,50:2,51:3,52:4,53:5,54:6,55:7,56:8,57:9,96:0,97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9,8:"back",46:"clear"};switch(f){case 8:t[188]="comma",t[189]="diff",t[109]="diff",t[173]="diff",t[191]="slash",t[111]="slash",t[190]="dot",t[110]="dot";break;case 7:t[190]="dot",t[110]="dot";break;case 6:t[188]="comma";break;case 5:t[191]="slash",t[111]="slash";break;case 4:break;case 3:t[189]="diff",t[109]="diff",t[173]="diff";break;case 2:t[189]="diff",t[109]="diff",t[173]="diff",t[190]="dot",t[110]="dot";break;case 1:default:t[189]="diff",t[109]="diff",t[173]="diff",t[190]="dot",t[110]="dot",t[188]="comma"}return t}();if(void 0!==t){if(!0===t.ctrlKey||!0===t.shiftKey)return t.preventDefault(),!1;void 0!==n[t.keyCode]&&(i=!0,e=n[t.keyCode].toString())}else e=e.toString(),Object.keys(n).forEach(function(t){e===n[t].toString()&&(i=!0)});if(!0===i){switch(e){case"diff":""===p&&(p+="-");break;case"dot":-1===p.indexOf(".")&&p.length<N()&&(void 0!==y?p.length>=y&&(p+="."):p+=".");break;case"back":p=p.substring(0,p.length-1);break;case"clear":p="";break;case"comma":p.length<N()&&""!==p&&"."!==p.charAt(p.length-1)&&","!==p.charAt(p.length-1)&&"/"!==p.charAt(p.length-1)&&(p+=",");break;case"slash":p.length<N()&&""!==p&&"."!==p.charAt(p.length-1)&&","!==p.charAt(p.length-1)&&"/"!==p.charAt(p.length-1)&&(p+="/");break;default:p.length<N()&&-1!==(p+=e).indexOf(".")&&void 0!==_&&p.split(".")[1].length>_&&(p=p.substring(0,p.length-1))}k()}return t&&8===t.keyCode?(t.preventDefault(),!1):1}function k(){onViewUpdateCls.trigger("onGlobalUpdate",{type:"updateView"})}function N(){var t=m;switch(g){case 2:break;case 1:default:"-"===p.charAt(0)&&(t+=1),-1!==p.indexOf(".")&&(t+=1),-1!==p.indexOf("/")&&(t+=1),-1!==p.indexOf(",")&&(t+=p.split(",").length-1)}return t}function F(t){switch(t.type){case"mouseup":n.hasFocus||n.focusIn(),R("click");break;case"mouseenter":R("mouseenter");break;case"mouseout":R("mouseout");break;case"stageevent":null!==S&&-1!==[S,r].indexOf(t.id)||n.focusOut();break;case"click":t.target.classList.contains("numberPad")||n.focusOut();break;case"touchstart":R("focusOut"),C.blur()}onViewUpdateCls.trigger("onGlobalUpdate",{type:"updateView"})}function B(t){switch(t.key){case"Enter":p=C.value,R("focusOut"),C.blur()}onViewUpdateCls.trigger("onGlobalUpdate",{type:"updateView"})}function H(t){var e=t.nativeEvent;if(t.compId===r)switch(e.type){case"keyup":switch(e.key){case"Enter":n.focusOut();break;default:j(e.key,e)}R("keyup")}}function U(t,e){return _typeof(t)===_typeof(e)?t:e}C.setAttribute("aria-label",L),Object.defineProperties(this,{compId:{get:function(){return r}},hasFocus:{get:function(){return x}},isVisible:{get:function(){return v}},numberPadCompId:{set:function(t){S=t}}}),this.focusIn=function(){!1===E.isDevice()&&document.getElementById("inputFieldDummyDiv").focus(),D(!0),x=!0,function t(){clearTimeout(i);!0===x?i=setTimeout(function(){w=!w,k(),t()},530):k()}(),O(),R("focusIn"),k(),setTimeout(function(){window.addEventListener("click",F),window.addEventListener("touchstart",F)},10)},this.focusOut=function(){!1===E.isDevice()&&C.blur(),D(!1),!0===x&&(x=!1,isNaN(Number(p))&&(p="0"),R("focusOut"),window.removeEventListener("click",F),window.removeEventListener("touchstart",F)),k()},this.enable=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];v&&I(!0),b=!1,C.style.cursor="pointer",t&&(e=!0)},this.disable=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];n.focusOut(),I(!1),b=!0,C.style.cursor="default",t&&(e=!1)},this.show=function(){v=!0,e&&this.enable(!1)},this.hide=function(){v=!1,this.disable(!1)},this.getVisble=function(){return v},this.setVisible=function(t){t?this.show():this.hide()},this.on=function(t,e){A(t)&&(T[t]||(T[t]=[]),T[t].push(e))},this.off=function(t,e){if(A(t)&&P(t)){var i=T[t].indexOf(e);T[t].splice(i,1),0===T[t].length&&delete T[t]}},this.getValue=function(){return p},this.setValue=function(t){p=t.toString(),k()},this.setNumberPadValue=function(t){j(t)},this.draw=function(){var t=function(){C.value=C.value.replace(/[^0-9.]/g,""),C.value.indexOf(".")!==C.value.lastIndexOf(".")&&(C.value=C.value.slice(0,-1))};C.value=p,C.style.fontSize=c+"px",C.style.fontFamily=h,C.style.color=b?d:u,C.style.textAlign="center",C.style.position="center",C.disabled=b,C.addEventListener("click",function(){C.focus(),C.setSelectionRange(C.value.length,C.value.length),C.removeEventListener("input",t),C.addEventListener("input",t)})},this.destroy=function(){n.disable()},onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:r}})}function CheckBoxCompClass(r){var i={},n={bgColor:"#ffffff",downColor:"#FF0000",checked:!1,height:25,txtMaxWidth:30,imgList:["cb.png"],width:25,visible:!0,enabled:!0,topMargin:0,x:105,y:313,text:"",padding:10,fontSize:18,isBold:!1,fontColor:"#000000",jaws_text:""};Object.keys(r).forEach(function(t){n[t]=r[t]});document.createElement("div");var a=document.createElement("input");function o(){!0===n.visible&&!0===n.enabled?(a.addEventListener("mousedown",t),a.addEventListener("mousemove",t),a.addEventListener("mouseup",t),a.addEventListener("mouseupout",t),a.addEventListener("keydown",e)):(a.removeEventListener("mousedown",t),a.removeEventListener("mousemove",t),a.removeEventListener("mouseup",t),a.removeEventListener("mouseupout",t),a.removeEventListener("keydown",e))}function t(t){switch(t.type){case"mousedown":!0,a.style.accentColor=n.downColor;break;case"mousemove":break;case"mouseup":!1,a.style.accentColor=n.bgColor,s(t);break;case"mouseupout":!1}}function e(t){switch(t.key){case"Enter":!1,a.checked=!n.checked,s(t)}32===t.keyCode&&(!1,s(t))}function s(t){n.checked=!n.checked,void 0!==i.change&&i.change({id:n.id,value:n.checked}),o()}this.init=function(t){var e=document.createElement("div");e.className="checkbox",e.style.width="119px",e.style.height="32px",e.style.position="absolute",e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.display="flex",e.style.alignItems="center",a.type="checkbox",a.name="name",a.className="checkbox",a.id="id",a.checked=t.checked,a.style.width="25px",a.style.height="25px",a.style.margin="0px 10px 0px 0px",a.style.accentColor=t.bgColor,a.style.cursor="pointer",r.deviceTypeBool&&"#ff6600";var i=document.createElement("div"),n=document.createTextNode(t.LabComClass.globalLangText[t.text]);i.style.bold="true",i.style.italic="true",i.appendChild(n),e.appendChild(a),e.appendChild(i),e.setAttribute("aria-label",t.LabComClass.globalLangText[t.jaws_text]),t.domLayer.appendChild(e)},this.init(n),""!==n.text&&n.context.textWrapperClass({xNum:0,yNum:0,fontFormat:"px ",maxWidthNum:n.txtMaxWidth,textStr:n.LabComClass.globalLangText[n.text],fontFamilyStr:n.LabComClass.klettFontRegular,fontSizeNum:n.fontSize,fontColor:n.fontColor,bold:n.isBold}),o(),n.LabComClass.requestGlobalImage(n.imgList,function(t){t,onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:n.id}})},function(t){console.log("Images Loading Error...")}),this.addEventListener=function(t,e){i[t]=e},this.setValue=function(t){n.checked=t},this.getValue=function(){return n.checked},this.enable=function(){n.enabled=!0,o()},this.disable=function(){n.enabled=!1,o()},this.show=function(){n.visible=!0,o()},this.hide=function(){n.visible=!1,o()},this.setPos=function(t,e){n.x=t,n.y=e,o()},this.getPos=function(){return{x:n.x,y:n.y}},this.draw=function(){a.value=n.checked,n.LabComClass.BrowserDetect.platformIOS()?a.style.accentColor="#ff6600":a.style.accentColor=n.bgColor,n.visible?a.style.visibility="visible":a.style.visibility="hidden"}}function PlayPauseBtnCompClass(e){var i,n=this,r={},a={x:100,y:200,width:44,height:44,visible:!0,enable:!0,state:"play",bgColorState:{normal:"rgb(255, 102, 0)",hover:"",down:"rgb(255, 0, 0)",disable:"#afafaf"},images:["playUp.png","playDown.png","resetUp.png","resetDown.png"],imageObj:[],jaws_text:""},o=document.createElement("button");o.id=e.id;var s=new Image;function l(t){switch(t.type){case"mousedown":i="down";break;case"mousemove":break;case"mouseup":i="up",r.change&&r.change({id:a.id,value:a.state}),a.state="reset"===a.state?"play":"reset",c();break;case"mouseupout":i="up";break;case"click":i="up",r.change&&r.change({id:a.id,value:a.state}),a.state="reset"===a.state?"play":"reset",c()}onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"})}function c(t){!0===a.visible&&!0===a.enable?(o.addEventListener("mousedown",l),o.addEventListener("mouseupout",l),o.addEventListener("click",l)):(o.removeEventListener("mousedown",l),o.removeEventListener("mouseupout",l),o.removeEventListener("click",l))}this.init=function(t){o.style.width=e.width+"px",o.style.height=e.height+"px",o.style.position="absolute",o.style.left=e.x+"px",o.style.top=e.y+"px",o.style.borderWidth="0px",o.style.cursor="pointer",s.src="assets/images/".concat(t.images[0]),s.style.pointerEvents="none",s.onload=function(){s.style.width="".concat(t.width," px"),s.style.height="".concat(t.height,"px"),s.style.position="absolute",s.style.left="50%",s.style.top="50%",s.style.transform="translate(-50%, -50%)"},o.appendChild(s),o.setAttribute("aria-label",t.LabComClass.globalLangText[t.jaws_text]),t.domLayer.appendChild(o)},Object.keys(e).forEach(function(t){a[t]=e[t]}),this.init(a),a.LabComClass.requestGlobalImage(a.images,function(t){a.imageObj=t,i="up",n.enable(),onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:a.id}})}),this.enable=function(){i="up",a.enable=!0,c()},this.disable=function(){i="disabled",a.enable=!1,c()},this.addEventListener=function(t,e){r[t]=e},this.setValue=function(t){a.state=t},this.getValue=function(){return a.state},this.show=function(){a.visible=!0,c()},this.hide=function(){a.visible=!1,c()},this.setPos=function(t,e){a.x=t,a.y=e,this.enable()},this.getPos=function(){return{x:a.x,y:a.y}},this.draw=function(){if(a.visible)switch(document.getElementsByClassName("checkbox")[7].value===String(!0)?!1===a.enable?o.style.backgroundColor="#454540":"up"===i?o.style.backgroundColor="#DB5800":"down"===i&&(o.style.backgroundColor=a.bgColorState.down):!1===a.enable?o.style.backgroundColor=a.bgColorState.disable:"up"===i?o.style.backgroundColor=a.bgColorState.normal:"down"===i&&(o.style.backgroundColor=a.bgColorState.down),a.state+i){case"resetup":case"resetdisable":s.src="assets/images/".concat(a.images[2]);break;case"resetdown":s.src="assets/images/".concat(a.images[3]);break;case"playdown":s.src="assets/images/".concat(a.images[1]);break;case"playup":case"playdisable":default:s.src="assets/images/".concat(a.images[0])}}}!function(){for(var a=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var i=(new Date).getTime(),n=Math.max(0,16-(i-a)),r=window.setTimeout(function(){t(i+n)},n);return a=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),String.prototype.includes||(String.prototype.includes=function(t,e){if(t instanceof RegExp)throw TypeError("first argument must not be a RegExp");return void 0===e&&(e=0),-1!==this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(e){return 0<this.filter(function(t){return t===e}).length}})}(),function(){function n(t,e,i){return t.call.apply(t.bind,arguments)}function r(e,i,t){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,n),e.apply(i,t)}}return function(){return e.apply(i,arguments)}}function f(t,e,i){return(f=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n:r).apply(null,arguments)}var s=Date.now||function(){return+new Date};function e(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var l=!!window.FontFace;function c(t,e,i,n){if(e=t.c.createElement(e),i)for(var r in i)i.hasOwnProperty(r)&&("style"==r?e.style.cssText=i[r]:e.setAttribute(r,i[r]));return n&&e.appendChild(t.c.createTextNode(n)),e}function h(t,e,i){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(i,t.lastChild)}function i(t){t.parentNode&&t.parentNode.removeChild(t)}function m(t,e,i){e=e||[],i=i||[];for(var n=t.className.split(/\s+/),r=0;r<e.length;r+=1){for(var a=!1,o=0;o<n.length;o+=1)if(e[r]===n[o]){a=!0;break}a||n.push(e[r])}for(e=[],r=0;r<n.length;r+=1){for(a=!1,o=0;o<i.length;o+=1)if(n[r]===i[o]){a=!0;break}a||e.push(n[r])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function a(t,e){for(var i=t.className.split(/\s+/),n=0,r=i.length;n<r;n++)if(i[n]==e)return!0;return!1}function u(t,e,i){function n(){o&&r&&(o(a),o=null)}e=c(t,"link",{rel:"stylesheet",href:e,media:"all"});var r=!1,a=null,o=i||null;l?(e.onload=function(){r=!0,n()},e.onerror=function(){r=!0,a=Error("Stylesheet failed to load"),n()}):setTimeout(function(){r=!0,n()},0),h(t,"head",e)}function d(t,e,i,n){var r=t.c.getElementsByTagName("head")[0];if(r){var a=c(t,"script",{src:e}),o=!1;return a.onload=a.onreadystatechange=function(){o||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(o=!0,i&&i(null),a.onload=a.onreadystatechange=null,"HEAD"==a.parentNode.tagName&&r.removeChild(a))},r.appendChild(a),setTimeout(function(){o||(o=!0,i&&i(Error("Script load timeout")))},n||5e3),a}return null}function p(){this.a=0,this.c=null}function g(t){return t.a++,function(){t.a--,o(t)}}function v(t,e){t.c=e,o(t)}function o(t){0==t.a&&t.c&&(t.c(),t.c=null)}function y(t){this.a=t||"-"}function _(t,e){this.c=t,this.f=4,this.a="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function b(t){var e=[];t=t.split(/,\s*/);for(var i=0;i<t.length;i++){var n=t[i].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?e.push("'"+n+"'"):e.push(n)}return e.join(",")}function x(t){return t.a+t.f}function w(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function T(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new y("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function M(t){if(t.g){var e=a(t.f,t.a.c("wf","active")),i=[],n=[t.a.c("wf","loading")];e||i.push(t.a.c("wf","inactive")),m(t.f,i,n)}S(t,"inactive")}function S(t,e,i){t.j&&t.h[e]&&(i?t.h[e](i.c,x(i)):t.h[e]())}function E(){this.c={}}function C(t,e){this.c=t,this.f=e,this.a=c(this.c,"span",{"aria-hidden":"true"},this.f)}function L(t){h(t.c,"body",t.a)}function A(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+b(t.c)+";font-style:"+w(t)+";font-weight:"+t.f+"00;"}function P(t,e,i,n,r,a){this.g=t,this.j=e,this.a=n,this.c=i,this.f=r||3e3,this.h=a||void 0}function R(t,e,i,n,r,a,o){this.v=t,this.B=e,this.c=i,this.a=n,this.s=o||"BESbswy",this.f={},this.w=r||3e3,this.u=a||null,this.m=this.j=this.h=this.g=null,this.g=new C(this.c,this.s),this.h=new C(this.c,this.s),this.j=new C(this.c,this.s),this.m=new C(this.c,this.s),t=A(t=new _(this.a.c+",serif",x(this.a))),this.g.a.style.cssText=t,t=A(t=new _(this.a.c+",sans-serif",x(this.a))),this.h.a.style.cssText=t,t=A(t=new _("serif",x(this.a))),this.j.a.style.cssText=t,t=A(t=new _("sans-serif",x(this.a))),this.m.a.style.cssText=t,L(this.g),L(this.h),L(this.j),L(this.m)}y.prototype.c=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},P.prototype.start=function(){var r=this.c.o.document,a=this,o=s(),t=new Promise(function(i,n){!function e(){var t;s()-o>=a.f?n():r.fonts.load((t=a.a,w(t)+" "+t.f+"00 300px "+b(t.c)),a.h).then(function(t){1<=t.length?i():setTimeout(e,25)},function(){n()})}()}),i=null,e=new Promise(function(t,e){i=setTimeout(e,a.f)});Promise.race([e,t]).then(function(){i&&(clearTimeout(i),i=null),a.g(a.a)},function(){a.j(a.a)})};var O={D:"serif",C:"sans-serif"},I=null;function D(){if(null===I){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);I=!!t&&(parseInt(t[1],10)<536||536===parseInt(t[1],10)&&parseInt(t[2],10)<=11)}return I}function j(t,e,i){for(var n in O)if(O.hasOwnProperty(n)&&e===t.f[O[n]]&&i===t.f[O[n]])return!0;return!1}function k(t){var e,i=t.g.a.offsetWidth,n=t.h.a.offsetWidth;(e=i===t.f.serif&&n===t.f["sans-serif"])||(e=D()&&j(t,i,n)),e?s()-t.A>=t.w?D()&&j(t,i,n)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?N(t,t.v):N(t,t.B):setTimeout(f(function(){k(this)},t),50):N(t,t.v)}function N(t,e){setTimeout(f(function(){i(this.g.a),i(this.h.a),i(this.j.a),i(this.m.a),e(this.a)},t),0)}function F(t,e,i){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=i}R.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=s(),k(this)};var B=null;function H(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&m(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),S(t,"active")):M(t.a))}function t(t){this.j=t,this.a=new E,this.h=0,this.f=this.g=!0}function U(t,e){this.c=t,this.a=e}function z(t,e){this.c=t,this.a=e}function V(t,e){this.c=t||"https://fonts.googleapis.com/css",this.a=[],this.f=[],this.g=e||""}F.prototype.g=function(t){var e=this.a;e.g&&m(e.f,[e.a.c("wf",t.c,x(t).toString(),"active")],[e.a.c("wf",t.c,x(t).toString(),"loading"),e.a.c("wf",t.c,x(t).toString(),"inactive")]),S(e,"fontactive",t),this.m=!0,H(this)},F.prototype.h=function(t){var e=this.a;if(e.g){var i=a(e.f,e.a.c("wf",t.c,x(t).toString(),"active")),n=[],r=[e.a.c("wf",t.c,x(t).toString(),"loading")];i||n.push(e.a.c("wf",t.c,x(t).toString(),"inactive")),m(e.f,n,r)}S(e,"fontinactive",t),H(this)},t.prototype.load=function(t){this.c=new e(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(r,t,e){var i=[],n=e.timeout;a=t,a.g&&m(a.f,[a.a.c("wf","loading")]),S(a,"loading");var a;var i=function(t,e,i){var n,r=[];for(n in e)if(e.hasOwnProperty(n)){var a=t.c[n];a&&r.push(a(e[n],i))}return r}(r.a,e,r.c),o=new F(r.c,t,n);for(r.h=i.length,t=0,e=i.length;t<e;t++)i[t].load(function(t,e,i){var n,c,h,u,d,p;c=o,h=t,u=e,d=i,p=0==--(n=r).h,(n.f||n.g)&&setTimeout(function(){var t=d||null,e=u||{};if(0===h.length&&p)M(c.a);else{c.f+=h.length,p&&(c.j=p);var i,n=[];for(i=0;i<h.length;i++){var r=h[i],a=e[r.c],o=c.a,s=r;if(o.g&&m(o.f,[o.a.c("wf",s.c,x(s).toString(),"loading")]),S(o,"fontloading",s),(o=null)===B)if(window.FontFace){var s=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),l=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);B=s?42<parseInt(s[1],10):!l}else B=!1;o=B?new P(f(c.g,c),f(c.h,c),c.c,r,c.s,a):new R(f(c.g,c),f(c.h,c),c.c,r,c.s,t,a),n.push(o)}for(i=0;i<n.length;i++)n[i].start()}},0)})}(this,new T(this.c,t),t)},U.prototype.load=function(o){var e=this,s=e.a.projectId,t=e.a.version;if(s){var l=e.c.o;d(this.c,(e.a.api||"https://fast.fonts.net/jsapi")+"/"+s+".js"+(t?"?v="+t:""),function(t){t?o([]):(l["__MonotypeConfiguration__"+s]=function(){return e.a},function t(){if(l["__mti_fntLst"+s]){var e,i=l["__mti_fntLst"+s](),n=[];if(i)for(var r=0;r<i.length;r++){var a=i[r].fontfamily;null!=i[r].fontStyle&&null!=i[r].fontWeight?(e=i[r].fontStyle+i[r].fontWeight,n.push(new _(a,e))):n.push(new _(a))}o(n)}else setTimeout(function(){t()},50)}())}).id="__MonotypeAPIScript__"+s}else o([])},z.prototype.load=function(t){var e,i,n=this.a.urls||[],r=this.a.families||[],a=this.a.testStrings||{},o=new p;for(e=0,i=n.length;e<i;e++)u(this.c,n[e],g(o));var s=[];for(e=0,i=r.length;e<i;e++)if((n=r[e].split(":"))[1])for(var l=n[1].split(","),c=0;c<l.length;c+=1)s.push(new _(n[0],l[c]));else s.push(new _(n[0]));v(o,function(){t(s,a)})};function G(t){this.f=t,this.a=[],this.c={}}var W={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},Y={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},X={i:"i",italic:"i",n:"n",normal:"n"},q=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function J(t,e){this.c=t,this.a=e}var Z={Arimo:!0,Cousine:!0,Tinos:!0};function Q(t,e){this.c=t,this.a=e}function K(t,e){this.c=t,this.f=e,this.a=[]}J.prototype.load=function(t){var e=new p,i=this.c,n=new V(this.a.api,this.a.text),r=this.a.families;!function(t,e){for(var i=e.length,n=0;n<i;n++){var r=e[n].split(":");3==r.length&&t.f.push(r.pop());var a="";2==r.length&&""!=r[1]&&(a=":"),t.a.push(r.join(a))}}(n,r);var a=new G(r);!function(t){for(var e=t.f.length,i=0;i<e;i++){var n=t.f[i].split(":"),r=n[0].replace(/\+/g," "),a=["n4"];if(2<=n.length){var o;if(o=[],s=n[1])for(var s,l=(s=s.split(",")).length,c=0;c<l;c++){var h;if((h=s[c]).match(/^[\w-]+$/))if(null==(d=q.exec(h.toLowerCase())))h="";else{if(h=null==(h=d[2])||""==h?"n":X[h],null==(d=d[1])||""==d)d="4";else var u=Y[d],d=u||(isNaN(d)?"4":d.substr(0,1));h=[h,d].join("")}else h="";h&&o.push(h)}0<o.length&&(a=o),3==n.length&&(o=[],0<(n=(n=n[2])?n.split(","):o).length&&(n=W[n[0]])&&(t.c[r]=n))}for(t.c[r]||(n=W[r])&&(t.c[r]=n),n=0;n<a.length;n+=1)t.a.push(new _(r,a[n]))}}(a),u(i,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,i=[],n=0;n<e;n++)i.push(t.a[n].replace(/ /g,"+"));return e=t.c+"?family="+i.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(n),g(e)),v(e,function(){t(a.a,a.c,Z)})},Q.prototype.load=function(o){var t=this.a.id,s=this.c.o;t?d(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)o([]);else if(s.Typekit&&s.Typekit.config&&s.Typekit.config.fn){t=s.Typekit.config.fn;for(var e=[],i=0;i<t.length;i+=2)for(var n=t[i],r=t[i+1],a=0;a<r.length;a++)e.push(new _(n,r[a]));try{s.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}o(e)}},2e3):o([])},K.prototype.load=function(c){var t,e=this.f.id,i=this.c.o,h=this;e?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[e]=function(t,e){for(var i=0,n=e.fonts.length;i<n;++i){var r=e.fonts[i];h.a.push(new _(r.name,(a="font-weight:"+r.weight+";font-style:"+r.style,l=s=o=void 0,o=4,s="n",l=null,a&&((l=a.match(/(normal|oblique|italic)/i))&&l[1]&&(s=l[1].substr(0,1).toLowerCase()),(l=a.match(/([1-9]00|normal|bold)/i))&&l[1]&&(/bold/i.test(l[1])?o=7:/[1-9]00/.test(l[1])&&(o=parseInt(l[1].substr(0,1),10)))),s+o)))}var a,o,s,l;c(h.a)},d(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+((t=this.c).o.location.hostname||t.a.location.hostname)+"/"+e+".js",function(t){t&&c([])})):c([])};var $=new t(window);$.a.c.custom=function(t,e){return new z(e,t)},$.a.c.fontdeck=function(t,e){return new K(e,t)},$.a.c.monotype=function(t,e){return new U(e,t)},$.a.c.typekit=function(t,e){return new Q(e,t)},$.a.c.google=function(t,e){return new J(e,t)};var tt={load:f($.load,$)};"function"==typeof define&&define.amd?define(function(){return tt}):"undefined"!=typeof module&&module.exports?module.exports=tt:(window.WebFont=tt,window.WebFontConfig&&$.load(window.WebFontConfig))}(),function(){var t=function(){this.init()};t.prototype={init:function(){var t=this||y;return t._counter=1e3,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.mobileAutoEnable=!0,t._setup(),t},volume:function(t){var e=this||y;if(t=parseFloat(t),e.ctx||u(),void 0!==t&&0<=t&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&(e.masterGain.gain.value=t);for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var n=e._howls[i]._getSoundIds(),r=0;r<n.length;r++){var a=e._howls[i]._soundById(n[r]);a&&a._node&&(a._node.volume=a._volume*t)}return e}return e._volume},mute:function(t){var e=this||y;e.ctx||u(),e._muted=t,e.usingWebAudio&&(e.masterGain.gain.value=t?0:e._volume);for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var n=e._howls[i]._getSoundIds(),r=0;r<n.length;r++){var a=e._howls[i]._soundById(n[r]);a&&a._node&&(a._node.muted=!!t||a._muted)}return e},unload:function(){for(var t=this||y,e=t._howls.length-1;0<=e;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,u()),t},codecs:function(t){return(this||y)._codecs[t.replace(/^x-/,"")]},_setup:function(){var e=this||y;if(e.state=e.ctx&&e.ctx.state||"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||y,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),r=n&&parseInt(n[0].split("/")[1],10)<33;return e._codecs={mp3:!(r||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||y,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),i=!!("ontouchend"in window||e._navigator&&0<e._navigator.maxTouchPoints||e._navigator&&0<e._navigator.msMaxTouchPoints);if(!e._mobileEnabled&&e.ctx&&(t||i)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var n=function(){y._autoResume();var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),void 0===t.start?t.noteOn(0):t.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchend",n,!0)}};return document.addEventListener("touchend",n,!0),e}},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&y.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var i=0;i<t._howls[e]._sounds.length;i++)if(!t._howls[e]._sounds[i]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then(function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())}))},3e4),t}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&y.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var y=new t,e=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};e.prototype={init:function(t){var e=this;return y.ctx||u(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onresume=[],e._webAudio=y.usingWebAudio&&!e._html5,void 0!==y.ctx&&y.ctx&&y.mobileAutoEnable&&y._enableMobileAudio(),y._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&e.load(),e},load:function(){var t=this,e=null;if(!y.noAudio){"string"==typeof t._src&&(t._src=[t._src]);for(var i=0;i<t._src.length;i++){var n,r;if(t._format&&t._format[i])n=t._format[i];else{if("string"!=typeof(r=t._src[i])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(r))||(n=/\.([^.]+)$/.exec(r.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&y.codecs(n)){e=t._src[i];break}}return e?(t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new a(t),t._webAudio&&s(t),t):void t._emit("loaderror",null,"No codec support for selected audio sources.")}t._emit("loaderror",null,"No audio support.")},play:function(t,e){var i=this,n=null;if("number"==typeof t)n=t,t=null;else{if("string"==typeof t&&"loaded"===i._state&&!i._sprite[t])return null;if(void 0===t){t="__default";for(var r=0,a=0;a<i._sounds.length;a++)i._sounds[a]._paused&&!i._sounds[a]._ended&&(r++,n=i._sounds[a]._id);1===r?t=null:n=null}}var o=n?i._soundById(n):i._inactiveSound();if(!o)return null;if(n&&!t&&(t=o._sprite||"__default"),"loaded"!==i._state){o._sprite=t,o._ended=!1;var s=o._id;return i._queue.push({event:"play",action:function(){i.play(s)}}),s}if(n&&!o._paused)return e||setTimeout(function(){i._emit("play",o._id)},0),o._id;i._webAudio&&y._autoResume();var l=Math.max(0,0<o._seek?o._seek:i._sprite[t][0]/1e3),c=Math.max(0,(i._sprite[t][0]+i._sprite[t][1])/1e3-l),h=1e3*c/Math.abs(o._rate);o._paused=!1,o._ended=!1,o._sprite=t,o._seek=l,o._start=i._sprite[t][0]/1e3,o._stop=(i._sprite[t][0]+i._sprite[t][1])/1e3,o._loop=!(!o._loop&&!i._sprite[t][2]);var u=o._node;if(i._webAudio){var d=function(){i._refreshBuffer(o);var t=o._muted||i._muted?0:o._volume;u.gain.setValueAtTime(t,y.ctx.currentTime),o._playStart=y.ctx.currentTime,void 0===u.bufferSource.start?o._loop?u.bufferSource.noteGrainOn(0,l,86400):u.bufferSource.noteGrainOn(0,l,c):o._loop?u.bufferSource.start(0,l,86400):u.bufferSource.start(0,l,c),h!==1/0&&(i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),h)),e||setTimeout(function(){i._emit("play",o._id)},0)},p="running"===y.state;if("loaded"===i._state&&p)d();else{var f=p||"loaded"!==i._state?"load":"resume";i.once(f,d,p?o._id:null),i._clearTimer(o._id)}}else{var m=function(){u.currentTime=l,u.muted=o._muted||i._muted||y._muted||u.muted,u.volume=o._volume*y.volume(),u.playbackRate=o._rate,u.play(),h!==1/0&&(i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),h)),e||i._emit("play",o._id)},g="loaded"===i._state&&(window&&window.ejecta||!u.readyState&&y._navigator.isCocoonJS);if(4===u.readyState||g)m();else{var v=function(){m(),u.removeEventListener(y._canPlayEvent,v,!1)};u.addEventListener(y._canPlayEvent,v,!1),i._clearTimer(o._id)}}return o._id},pause:function(t){var e=this;if("loaded"!==e._state)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var i=e._getSoundIds(t),n=0;n<i.length;n++){e._clearTimer(i[n]);var r=e._soundById(i[n]);if(r&&!r._paused&&(r._seek=e.seek(i[n]),r._rateSeek=0,r._paused=!0,e._stopFade(i[n]),r._node))if(e._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),e._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||e._emit("pause",r?r._id:null)}return e},stop:function(t,e){var i=this;if("loaded"!==i._state)return i._queue.push({event:"stop",action:function(){i.stop(t)}}),i;for(var n=i._getSoundIds(t),r=0;r<n.length;r++){i._clearTimer(n[r]);var a=i._soundById(n[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,i._stopFade(n[r]),a._node&&(i._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),i._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause())),e||i._emit("stop",a._id))}return i},mute:function(t,e){var i=this;if("loaded"!==i._state)return i._queue.push({event:"mute",action:function(){i.mute(t,e)}}),i;if(void 0===e){if("boolean"!=typeof t)return i._muted;i._muted=t}for(var n=i._getSoundIds(e),r=0;r<n.length;r++){var a=i._soundById(n[r]);a&&(a._muted=t,i._webAudio&&a._node?a._node.gain.setValueAtTime(t?0:a._volume,y.ctx.currentTime):a._node&&(a._node.muted=!!y._muted||t),i._emit("mute",a._id))}return i},volume:function(){var t,e,i,n=this,r=arguments;if(0===r.length)return n._volume;if(1===r.length||2===r.length&&void 0===r[1]?0<=n._getSoundIds().indexOf(r[0])?e=parseInt(r[0],10):t=parseFloat(r[0]):2<=r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10)),!(void 0!==t&&0<=t&&t<=1))return(i=e?n._soundById(e):n._sounds[0])?i._volume:0;if("loaded"!==n._state)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,r)}}),n;void 0===e&&(n._volume=t),e=n._getSoundIds(e);for(var a=0;a<e.length;a++)(i=n._soundById(e[a]))&&(i._volume=t,r[2]||n._stopFade(e[a]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(t,y.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=t*y.volume()),n._emit("volume",i._id));return n},fade:function(i,n,t,r){var a=this,e=Math.abs(i-n),o=n<i?"out":"in",s=e/.01,l=0<s?t/s:t;if(l<4&&(s=Math.ceil(s/(4/l)),l=4),"loaded"!==a._state)return a._queue.push({event:"fade",action:function(){a.fade(i,n,t,r)}}),a;a.volume(i,r);for(var c=a._getSoundIds(r),h=0;h<c.length;h++){var u=a._soundById(c[h]);if(u){if(r||a._stopFade(c[h]),a._webAudio&&!u._muted){var d=y.ctx.currentTime,p=d+t/1e3;u._volume=i,u._node.gain.setValueAtTime(i,d),u._node.gain.linearRampToValueAtTime(n,p)}var f=i;u._interval=setInterval(function(t,e){0<s&&(f+="in"===o?.01:-.01),f=Math.max(0,f),f=Math.min(1,f),f=Math.round(100*f)/100,a._webAudio?(void 0===r&&(a._volume=f),e._volume=f):a.volume(f,t,!0),(n<i&&f<=n||i<n&&n<=f)&&(clearInterval(e._interval),e._interval=null,a.volume(n,t),a._emit("fade",t))}.bind(a,c[h],u),l)}}return a},_stopFade:function(t){var e=this._soundById(t);return e&&e._interval&&(this._webAudio&&e._node.gain.cancelScheduledValues(y.ctx.currentTime),clearInterval(e._interval),e._interval=null,this._emit("fade",t)),this},loop:function(){var t,e,i,n=this,r=arguments;if(0===r.length)return n._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(i=n._soundById(parseInt(r[0],10)))&&i._loop;t=r[0],n._loop=t}else 2===r.length&&(t=r[0],e=parseInt(r[1],10));for(var a=n._getSoundIds(e),o=0;o<a.length;o++)(i=n._soundById(a[o]))&&(i._loop=t,n._webAudio&&i._node&&i._node.bufferSource&&((i._node.bufferSource.loop=t)&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return n},rate:function(){var t,e,i,n=this,r=arguments;if(0===r.length)e=n._sounds[0]._id;else if(1===r.length){0<=n._getSoundIds().indexOf(r[0])?e=parseInt(r[0],10):t=parseFloat(r[0])}else 2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if("number"!=typeof t)return(i=n._soundById(e))?i._rate:n._rate;if("loaded"!==n._state)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,r)}}),n;void 0===e&&(n._rate=t),e=n._getSoundIds(e);for(var a=0;a<e.length;a++)if(i=n._soundById(e[a])){i._rateSeek=n.seek(e[a]),i._playStart=n._webAudio?y.ctx.currentTime:i._playStart,i._rate=t,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.value=t:i._node&&(i._node.playbackRate=t);var o=n.seek(e[a]),s=1e3*((n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-o)/Math.abs(i._rate);!n._endTimers[e[a]]&&i._paused||(n._clearTimer(e[a]),n._endTimers[e[a]]=setTimeout(n._ended.bind(n,i),s)),n._emit("rate",i._id)}return n},seek:function(){var t,e,i=this,n=arguments;if(0===n.length)e=i._sounds[0]._id;else if(1===n.length){0<=i._getSoundIds().indexOf(n[0])?e=parseInt(n[0],10):(e=i._sounds[0]._id,t=parseFloat(n[0]))}else 2===n.length&&(t=parseFloat(n[0]),e=parseInt(n[1],10));if(void 0===e)return i;if("loaded"!==i._state)return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var r=i._soundById(e);if(r){if(!("number"==typeof t&&0<=t)){if(i._webAudio){var a=i.playing(e)?y.ctx.currentTime-r._playStart:0,o=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(o+a*Math.abs(r._rate))}return r._node.currentTime}var s=i.playing(e);s&&i.pause(e,!0),r._seek=t,r._ended=!1,i._clearTimer(e),s&&i.play(e,!0),!i._webAudio&&r._node&&(r._node.currentTime=t),i._emit("seek",e)}return i},playing:function(t){if("number"==typeof t){var e=this._soundById(t);return!!e&&!e._paused}for(var i=0;i<this._sounds.length;i++)if(!this._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this._duration,i=this._soundById(t);return i&&(e=this._sprite[i._sprite][1]/1e3),e},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,i=0;i<e.length;i++){e[i]._paused||t.stop(e[i]._id),t._webAudio||(/MSIE |Trident\//.test(y._navigator&&y._navigator.userAgent)||(e[i]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),e[i]._node.removeEventListener("error",e[i]._errorFn,!1),e[i]._node.removeEventListener(y._canPlayEvent,e[i]._loadFn,!1)),delete e[i]._node,t._clearTimer(e[i]._id);var n=y._howls.indexOf(t);0<=n&&y._howls.splice(n,1)}var r=!0;for(i=0;i<y._howls.length;i++)if(y._howls[i]._src===t._src){r=!1;break}return o&&r&&delete o[t._src],y.noAudio=!1,t._state="unloaded",t._sounds=[],t=null},on:function(t,e,i,n){var r=this["_on"+t];return"function"==typeof e&&r.push(n?{id:i,fn:e,once:n}:{id:i,fn:e}),this},off:function(t,e,i){var n=this,r=n["_on"+t],a=0;if("number"==typeof e&&(i=e,e=null),e||i)for(a=0;a<r.length;a++){var o=i===r[a].id;if(e===r[a].fn&&o||!e&&o){r.splice(a,1);break}}else if(t)n["_on"+t]=[];else{var s=Object.keys(n);for(a=0;a<s.length;a++)0===s[a].indexOf("_on")&&Array.isArray(n[s[a]])&&(n[s[a]]=[])}return n},once:function(t,e,i){return this.on(t,e,i,1),this},_emit:function(t,e,i){for(var n=this["_on"+t],r=n.length-1;0<=r;r--)n[r].id&&n[r].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,i)}.bind(this,n[r].fn),0),n[r].once&&this.off(t,n[r].fn,n[r].id));return this},_loadQueue:function(){var t=this;if(0<t._queue.length){var e=t._queue[0];t.once(e.event,function(){t._queue.shift(),t._loadQueue()}),e.action()}return t},_ended:function(t){var e=this,i=t._sprite;if(!e._webAudio&&e._node&&!e._node.ended)return setTimeout(e._ended.bind(e,t),100),e;var n=!(!t._loop&&!e._sprite[i][2]);if(e._emit("end",t._id),!e._webAudio&&n&&e.stop(t._id,!0).play(t._id),e._webAudio&&n){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=y.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),r)}return e._webAudio&&!n&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),y._autoSuspend()),e._webAudio||n||e.stop(t._id),e},_clearTimer:function(t){return this._endTimers[t]&&(clearTimeout(this._endTimers[t]),delete this._endTimers[t]),this},_soundById:function(t){for(var e=0;e<this._sounds.length;e++)if(t===this._sounds[e]._id)return this._sounds[e];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new a(t)},_drain:function(){var t=this,e=t._pool,i=0,n=0;if(!(t._sounds.length<e)){for(n=0;n<t._sounds.length;n++)t._sounds[n]._ended&&i++;for(n=t._sounds.length-1;0<=n;n--){if(i<=e)return;t._sounds[n]._ended&&(t._webAudio&&t._sounds[n]._node&&t._sounds[n]._node.disconnect(0),t._sounds.splice(n,1),i--)}}},_getSoundIds:function(t){if(void 0!==t)return[t];for(var e=[],i=0;i<this._sounds.length;i++)e.push(this._sounds[i]._id);return e},_refreshBuffer:function(t){return t._node.bufferSource=y.ctx.createBufferSource(),t._node.bufferSource.buffer=o[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop),t._node.bufferSource.playbackRate.value=t._rate,this},_cleanBuffer:function(t){if(this._scratchBuffer){t.bufferSource.onended=null,t.bufferSource.disconnect(0);try{t.bufferSource.buffer=this._scratchBuffer}catch(t){}}return t.bufferSource=null,this}};var a=function(t){this._parent=t,this.init()};a.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++y._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,i=y._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=void 0===y.ctx.createGain?y.ctx.createGainNode():y.ctx.createGain(),t._node.gain.setValueAtTime(i,y.ctx.currentTime),t._node.paused=!0,t._node.connect(y.masterGain)):(t._node=new Audio,t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(y._canPlayEvent,t._loadFn,!1),t._node.src=e._src,t._node.preload="auto",t._node.volume=i*y.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++y._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this._parent;t._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),this._node.removeEventListener(y._canPlayEvent,this._loadFn,!1)}};var o={},s=function(e){var t=e._src;if(o[t])return e._duration=o[t].duration,void h(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),n=new Uint8Array(i.length),r=0;r<i.length;++r)n[r]=i.charCodeAt(r);c(n.buffer,e)}else{var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){var t=(a.status+"")[0];"0"===t||"2"===t||"3"===t?c(a.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+a.status+".")},a.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete o[t],e.load())},l(a)}},l=function(e){try{e.send()}catch(t){e.onerror()}},c=function(t,e){y.ctx.decodeAudioData(t,function(t){t&&0<e._sounds.length&&(o[e._src]=t,h(e,t))},function(){e._emit("loaderror",null,"Decoding audio data failed.")})},h=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},u=function(){try{"undefined"!=typeof AudioContext?y.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?y.ctx=new webkitAudioContext:y.usingWebAudio=!1}catch(t){y.usingWebAudio=!1}var t=/iP(hone|od|ad)/.test(y._navigator&&y._navigator.platform),e=y._navigator&&y._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=e?parseInt(e[1],10):null;if(t&&i&&i<9){var n=/safari/.test(y._navigator&&y._navigator.userAgent.toLowerCase());(y._navigator&&y._navigator.standalone&&!n||y._navigator&&!y._navigator.standalone&&!n)&&(y.usingWebAudio=!1)}y.usingWebAudio&&(y.masterGain=void 0===y.ctx.createGain?y.ctx.createGainNode():y.ctx.createGain(),y.masterGain.gain.value=y._muted?0:1,y.masterGain.connect(y.ctx.destination)),y._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:y,Howl:e}}),"undefined"!=typeof exports&&(exports.Howler=y,exports.Howl=e),"undefined"!=typeof window?(window.HowlerGlobal=t,window.Howler=y,window.Howl=e,window.Sound=a):"undefined"!=typeof global&&(global.HowlerGlobal=t,global.Howler=y,global.Howl=e,global.Sound=a)}(),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.moment=e()}(this,function(){var t,r;function y(){return t.apply(null,arguments)}function s(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function l(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function c(t){return void 0===t}function h(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function u(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function d(t,e){var i,n=[];for(i=0;i<t.length;++i)n.push(e(t[i],i));return n}function _(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t,e){for(var i in e)_(e,i)&&(t[i]=e[i]);return _(e,"toString")&&(t.toString=e.toString),_(e,"valueOf")&&(t.valueOf=e.valueOf),t}function f(t,e,i,n){return Se(t,e,i,n,!0).utc()}function b(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function m(t){if(null==t._isValid){var e=b(t),i=r.call(e.parsedDateParts,function(t){return null!=t}),n=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&i);if(t._strict&&(n=n&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return n;t._isValid=n}return t._isValid}function g(t){var e=f(NaN);return null!=t?p(b(e),t):b(e).userInvalidated=!0,e}r=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),i=e.length>>>0,n=0;n<i;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};var a=y.momentProperties=[];function v(t,e){var i,n,r;if(c(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),c(e._i)||(t._i=e._i),c(e._f)||(t._f=e._f),c(e._l)||(t._l=e._l),c(e._strict)||(t._strict=e._strict),c(e._tzm)||(t._tzm=e._tzm),c(e._isUTC)||(t._isUTC=e._isUTC),c(e._offset)||(t._offset=e._offset),c(e._pf)||(t._pf=b(e)),c(e._locale)||(t._locale=e._locale),0<a.length)for(i=0;i<a.length;i++)c(r=e[n=a[i]])||(t[n]=r);return t}var e=!1;function x(t){v(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===e&&(e=!0,y.updateOffset(this),e=!1)}function w(t){return t instanceof x||null!=t&&null!=t._isAMomentObject}function T(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function M(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=T(e)),i}function o(t,e,i){var n,r=Math.min(t.length,e.length),a=Math.abs(t.length-e.length),o=0;for(n=0;n<r;n++)(i&&t[n]!==e[n]||!i&&M(t[n])!==M(e[n]))&&o++;return o+a}function S(t){!1===y.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function i(r,a){var o=!0;return p(function(){if(null!=y.deprecationHandler&&y.deprecationHandler(null,r),o){for(var t,e=[],i=0;i<arguments.length;i++){if(t="","object"==typeof arguments[i]){for(var n in t+="\n["+i+"] ",arguments[0])t+=n+": "+arguments[0][n]+", ";t=t.slice(0,-2)}else t=arguments[i];e.push(t)}S(r+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack),o=!1}return a.apply(this,arguments)},a)}var n,E={};function C(t,e){null!=y.deprecationHandler&&y.deprecationHandler(t,e),E[t]||(S(e),E[t]=!0)}function L(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function A(t,e){var i,n=p({},t);for(i in e)_(e,i)&&(l(t[i])&&l(e[i])?(n[i]={},p(n[i],t[i]),p(n[i],e[i])):null!=e[i]?n[i]=e[i]:delete n[i]);for(i in t)_(t,i)&&!_(e,i)&&l(t[i])&&(n[i]=p({},n[i]));return n}function P(t){null!=t&&this.set(t)}y.suppressDeprecationWarnings=!1,y.deprecationHandler=null,n=Object.keys?Object.keys:function(t){var e,i=[];for(e in t)_(t,e)&&i.push(e);return i};var R={};function O(t,e){var i=t.toLowerCase();R[i]=R[i+"s"]=R[e]=t}function I(t){return"string"==typeof t?R[t]||R[t.toLowerCase()]:void 0}function D(t){var e,i,n={};for(i in t)_(t,i)&&(e=I(i))&&(n[e]=t[i]);return n}var j={};function k(t,e){j[t]=e}function N(t,e,i){var n=""+Math.abs(t),r=e-n.length;return(0<=t?i?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+n}var F=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,B=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},U={};function z(t,e,i,n){var r=n;"string"==typeof n&&(r=function(){return this[n]()}),t&&(U[t]=r),e&&(U[e[0]]=function(){return N(r.apply(this,arguments),e[1],e[2])}),i&&(U[i]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function V(t,e){return t.isValid()?(e=G(e,t.localeData()),H[e]=H[e]||function(n){var t,r,e,a=n.match(F);for(t=0,r=a.length;t<r;t++)U[a[t]]?a[t]=U[a[t]]:a[t]=(e=a[t]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(t){var e,i="";for(e=0;e<r;e++)i+=L(a[e])?a[e].call(t,n):a[e];return i}}(e),H[e](t)):t.localeData().invalidDate()}function G(t,e){var i=5;function n(t){return e.longDateFormat(t)||t}for(B.lastIndex=0;0<=i&&B.test(t);)t=t.replace(B,n),B.lastIndex=0,i-=1;return t}var W=/\d/,Y=/\d\d/,X=/\d{3}/,q=/\d{4}/,J=/[+-]?\d{6}/,Z=/\d\d?/,Q=/\d\d\d\d?/,K=/\d\d\d\d\d\d?/,$=/\d{1,3}/,tt=/\d{1,4}/,et=/[+-]?\d{1,6}/,it=/\d+/,nt=/[+-]?\d+/,rt=/Z|[+-]\d\d:?\d\d/gi,at=/Z|[+-]\d\d(?::?\d\d)?/gi,ot=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,st={};function lt(t,i,n){st[t]=L(i)?i:function(t,e){return t&&n?n:i}}function ct(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ht={};function ut(t,i){var e,n=i;for("string"==typeof t&&(t=[t]),h(i)&&(n=function(t,e){e[i]=M(t)}),e=0;e<t.length;e++)ht[t[e]]=n}function dt(t,r){ut(t,function(t,e,i,n){i._w=i._w||{},r(t,i._w,i,n)})}var pt=0,ft=1,mt=2,gt=3,vt=4,yt=5,_t=6,bt=7,xt=8;function wt(t){return Tt(t)?366:365}function Tt(t){return t%4==0&&t%100!=0||t%400==0}z("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),z(0,["YY",2],0,function(){return this.year()%100}),z(0,["YYYY",4],0,"year"),z(0,["YYYYY",5],0,"year"),z(0,["YYYYYY",6,!0],0,"year"),O("year","y"),k("year",1),lt("Y",nt),lt("YY",Z,Y),lt("YYYY",tt,q),lt("YYYYY",et,J),lt("YYYYYY",et,J),ut(["YYYYY","YYYYYY"],pt),ut("YYYY",function(t,e){e[pt]=2===t.length?y.parseTwoDigitYear(t):M(t)}),ut("YY",function(t,e){e[pt]=y.parseTwoDigitYear(t)}),ut("Y",function(t,e){e[pt]=parseInt(t,10)}),y.parseTwoDigitYear=function(t){return M(t)+(68<M(t)?1900:2e3)};var Mt,St=Et("FullYear",!0);function Et(e,i){return function(t){return null!=t?(Lt(this,e,t),y.updateOffset(this,i),this):Ct(this,e)}}function Ct(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function Lt(t,e,i){t.isValid()&&!isNaN(i)&&("FullYear"===e&&Tt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](i,t.month(),At(i,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](i))}function At(t,e){if(isNaN(t)||isNaN(e))return NaN;var i=(e%12+12)%12;return t+=(e-i)/12,1===i?Tt(t)?29:28:31-i%7%2}Mt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},z("M",["MM",2],"Mo",function(){return this.month()+1}),z("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),z("MMMM",0,0,function(t){return this.localeData().months(this,t)}),O("month","M"),k("month",8),lt("M",Z),lt("MM",Z,Y),lt("MMM",function(t,e){return e.monthsShortRegex(t)}),lt("MMMM",function(t,e){return e.monthsRegex(t)}),ut(["M","MM"],function(t,e){e[ft]=M(t)-1}),ut(["MMM","MMMM"],function(t,e,i,n){var r=i._locale.monthsParse(t,n,i._strict);null!=r?e[ft]=r:b(i).invalidMonth=t});var Pt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Rt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ot="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function It(t,e){var i;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=M(e);else if(!h(e=t.localeData().monthsParse(e)))return t;return i=Math.min(t.date(),At(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t}function Dt(t){return null!=t?(It(this,t),y.updateOffset(this,!0),this):Ct(this,"Month")}var jt=ot,kt=ot;function Nt(){function t(t,e){return e.length-t.length}var e,i,n=[],r=[],a=[];for(e=0;e<12;e++)i=f([2e3,e]),n.push(this.monthsShort(i,"")),r.push(this.months(i,"")),a.push(this.months(i,"")),a.push(this.monthsShort(i,""));for(n.sort(t),r.sort(t),a.sort(t),e=0;e<12;e++)n[e]=ct(n[e]),r[e]=ct(r[e]);for(e=0;e<24;e++)a[e]=ct(a[e]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function Ft(t){var e;if(t<100&&0<=t){var i=Array.prototype.slice.call(arguments);i[0]=t+400,e=new Date(Date.UTC.apply(null,i)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)}else e=new Date(Date.UTC.apply(null,arguments));return e}function Bt(t,e,i){var n=7+e-i;return-(7+Ft(t,0,n).getUTCDay()-e)%7+n-1}function Ht(t,e,i,n,r){var a,o,s=1+7*(e-1)+(7+i-n)%7+Bt(t,n,r);return o=s<=0?wt(a=t-1)+s:s>wt(t)?(a=t+1,s-wt(t)):(a=t,s),{year:a,dayOfYear:o}}function Ut(t,e,i){var n,r,a=Bt(t.year(),e,i),o=Math.floor((t.dayOfYear()-a-1)/7)+1;return o<1?n=o+zt(r=t.year()-1,e,i):o>zt(t.year(),e,i)?(n=o-zt(t.year(),e,i),r=t.year()+1):(r=t.year(),n=o),{week:n,year:r}}function zt(t,e,i){var n=Bt(t,e,i),r=Bt(t+1,e,i);return(wt(t)-n+r)/7}function Vt(t,e){return t.slice(e,7).concat(t.slice(0,e))}z("w",["ww",2],"wo","week"),z("W",["WW",2],"Wo","isoWeek"),O("week","w"),O("isoWeek","W"),k("week",5),k("isoWeek",5),lt("w",Z),lt("ww",Z,Y),lt("W",Z),lt("WW",Z,Y),dt(["w","ww","W","WW"],function(t,e,i,n){e[n.substr(0,1)]=M(t)}),z("d",0,"do","day"),z("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),z("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),z("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),z("e",0,0,"weekday"),z("E",0,0,"isoWeekday"),O("day","d"),O("weekday","e"),O("isoWeekday","E"),k("day",11),k("weekday",11),k("isoWeekday",11),lt("d",Z),lt("e",Z),lt("E",Z),lt("dd",function(t,e){return e.weekdaysMinRegex(t)}),lt("ddd",function(t,e){return e.weekdaysShortRegex(t)}),lt("dddd",function(t,e){return e.weekdaysRegex(t)}),dt(["dd","ddd","dddd"],function(t,e,i,n){var r=i._locale.weekdaysParse(t,n,i._strict);null!=r?e.d=r:b(i).invalidWeekday=t}),dt(["d","e","E"],function(t,e,i,n){e[n]=M(t)});var Gt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Wt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Yt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Xt=ot,qt=ot,Jt=ot;function Zt(){function t(t,e){return e.length-t.length}var e,i,n,r,a,o=[],s=[],l=[],c=[];for(e=0;e<7;e++)i=f([2e3,1]).day(e),n=this.weekdaysMin(i,""),r=this.weekdaysShort(i,""),a=this.weekdays(i,""),o.push(n),s.push(r),l.push(a),c.push(n),c.push(r),c.push(a);for(o.sort(t),s.sort(t),l.sort(t),c.sort(t),e=0;e<7;e++)s[e]=ct(s[e]),l[e]=ct(l[e]),c[e]=ct(c[e]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function Qt(){return this.hours()%12||12}function Kt(t,e){z(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function $t(t,e){return e._meridiemParse}z("H",["HH",2],0,"hour"),z("h",["hh",2],0,Qt),z("k",["kk",2],0,function(){return this.hours()||24}),z("hmm",0,0,function(){return""+Qt.apply(this)+N(this.minutes(),2)}),z("hmmss",0,0,function(){return""+Qt.apply(this)+N(this.minutes(),2)+N(this.seconds(),2)}),z("Hmm",0,0,function(){return""+this.hours()+N(this.minutes(),2)}),z("Hmmss",0,0,function(){return""+this.hours()+N(this.minutes(),2)+N(this.seconds(),2)}),Kt("a",!0),Kt("A",!1),O("hour","h"),k("hour",13),lt("a",$t),lt("A",$t),lt("H",Z),lt("h",Z),lt("k",Z),lt("HH",Z,Y),lt("hh",Z,Y),lt("kk",Z,Y),lt("hmm",Q),lt("hmmss",K),lt("Hmm",Q),lt("Hmmss",K),ut(["H","HH"],gt),ut(["k","kk"],function(t,e,i){var n=M(t);e[gt]=24===n?0:n}),ut(["a","A"],function(t,e,i){i._isPm=i._locale.isPM(t),i._meridiem=t}),ut(["h","hh"],function(t,e,i){e[gt]=M(t),b(i).bigHour=!0}),ut("hmm",function(t,e,i){var n=t.length-2;e[gt]=M(t.substr(0,n)),e[vt]=M(t.substr(n)),b(i).bigHour=!0}),ut("hmmss",function(t,e,i){var n=t.length-4,r=t.length-2;e[gt]=M(t.substr(0,n)),e[vt]=M(t.substr(n,2)),e[yt]=M(t.substr(r)),b(i).bigHour=!0}),ut("Hmm",function(t,e,i){var n=t.length-2;e[gt]=M(t.substr(0,n)),e[vt]=M(t.substr(n))}),ut("Hmmss",function(t,e,i){var n=t.length-4,r=t.length-2;e[gt]=M(t.substr(0,n)),e[vt]=M(t.substr(n,2)),e[yt]=M(t.substr(r))});var te,ee=Et("Hours",!0),ie={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Rt,monthsShort:Ot,week:{dow:0,doy:6},weekdays:Gt,weekdaysMin:Yt,weekdaysShort:Wt,meridiemParse:/[ap]\.?m?\.?/i},ne={},re={};function ae(t){return t?t.toLowerCase().replace("_","-"):t}function oe(t){var e=null;if(!ne[t]&&"undefined"!=typeof module&&module&&module.exports)try{e=te._abbr,require("./locale/"+t),se(e)}catch(t){}return ne[t]}function se(t,e){var i;return t&&((i=c(e)?ce(t):le(t,e))?te=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),te._abbr}function le(t,e){if(null===e)return delete ne[t],null;var i,n=ie;if(e.abbr=t,null!=ne[t])C("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ne[t]._config;else if(null!=e.parentLocale)if(null!=ne[e.parentLocale])n=ne[e.parentLocale]._config;else{if(null==(i=oe(e.parentLocale)))return re[e.parentLocale]||(re[e.parentLocale]=[]),re[e.parentLocale].push({name:t,config:e}),null;n=i._config}return ne[t]=new P(A(n,e)),re[t]&&re[t].forEach(function(t){le(t.name,t.config)}),se(t),ne[t]}function ce(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return te;if(!s(t)){if(e=oe(t))return e;t=[t]}return function(t){for(var e,i,n,r,a=0;a<t.length;){for(e=(r=ae(t[a]).split("-")).length,i=(i=ae(t[a+1]))?i.split("-"):null;0<e;){if(n=oe(r.slice(0,e).join("-")))return n;if(i&&i.length>=e&&o(r,i,!0)>=e-1)break;e--}a++}return te}(t)}function he(t){var e,i=t._a;return i&&-2===b(t).overflow&&(e=i[ft]<0||11<i[ft]?ft:i[mt]<1||i[mt]>At(i[pt],i[ft])?mt:i[gt]<0||24<i[gt]||24===i[gt]&&(0!==i[vt]||0!==i[yt]||0!==i[_t])?gt:i[vt]<0||59<i[vt]?vt:i[yt]<0||59<i[yt]?yt:i[_t]<0||999<i[_t]?_t:-1,b(t)._overflowDayOfYear&&(e<pt||mt<e)&&(e=mt),b(t)._overflowWeeks&&-1===e&&(e=bt),b(t)._overflowWeekday&&-1===e&&(e=xt),b(t).overflow=e),t}function ue(t,e,i){return null!=t?t:null!=e?e:i}function de(t){var e,i,n,r,a,o=[];if(!t._d){var s,l;for(s=t,l=new Date(y.now()),n=s._useUTC?[l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()]:[l.getFullYear(),l.getMonth(),l.getDate()],t._w&&null==t._a[mt]&&null==t._a[ft]&&function(t){var e,i,n,r,a,o,s,l;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)a=1,o=4,i=ue(e.GG,t._a[pt],Ut(Ee(),1,4).year),n=ue(e.W,1),((r=ue(e.E,1))<1||7<r)&&(l=!0);else{a=t._locale._week.dow,o=t._locale._week.doy;var c=Ut(Ee(),a,o);i=ue(e.gg,t._a[pt],c.year),n=ue(e.w,c.week),null!=e.d?((r=e.d)<0||6<r)&&(l=!0):null!=e.e?(r=e.e+a,(e.e<0||6<e.e)&&(l=!0)):r=a}n<1||n>zt(i,a,o)?b(t)._overflowWeeks=!0:null!=l?b(t)._overflowWeekday=!0:(s=Ht(i,n,r,a,o),t._a[pt]=s.year,t._dayOfYear=s.dayOfYear)}(t),null!=t._dayOfYear&&(a=ue(t._a[pt],n[pt]),(t._dayOfYear>wt(a)||0===t._dayOfYear)&&(b(t)._overflowDayOfYear=!0),i=Ft(a,0,t._dayOfYear),t._a[ft]=i.getUTCMonth(),t._a[mt]=i.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=o[e]=n[e];for(;e<7;e++)t._a[e]=o[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[gt]&&0===t._a[vt]&&0===t._a[yt]&&0===t._a[_t]&&(t._nextDay=!0,t._a[gt]=0),t._d=(t._useUTC?Ft:function(t,e,i,n,r,a,o){var s;return t<100&&0<=t?(s=new Date(t+400,e,i,n,r,a,o),isFinite(s.getFullYear())&&s.setFullYear(t)):s=new Date(t,e,i,n,r,a,o),s}).apply(null,o),r=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[gt]=24),t._w&&void 0!==t._w.d&&t._w.d!==r&&(b(t).weekdayMismatch=!0)}}var pe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,me=/Z|[+-]\d\d(?::?\d\d)?/,ge=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],ve=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ye=/^\/?Date\((\-?\d+)/i;function _e(t){var e,i,n,r,a,o,s=t._i,l=pe.exec(s)||fe.exec(s);if(l){for(b(t).iso=!0,e=0,i=ge.length;e<i;e++)if(ge[e][1].exec(l[1])){r=ge[e][0],n=!1!==ge[e][2];break}if(null==r)return void(t._isValid=!1);if(l[3]){for(e=0,i=ve.length;e<i;e++)if(ve[e][1].exec(l[3])){a=(l[2]||" ")+ve[e][0];break}if(null==a)return void(t._isValid=!1)}if(!n&&null!=a)return void(t._isValid=!1);if(l[4]){if(!me.exec(l[4]))return void(t._isValid=!1);o="Z"}t._f=r+(a||"")+(o||""),Te(t)}else t._isValid=!1}var be=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;var xe={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function we(t){var e,i,n,r,a,o,s,l,c,h,u,d=be.exec(t._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(d){var p=(r=d[4],a=d[3],o=d[2],s=d[5],l=d[6],c=d[7],u=[(h=parseInt(r,10),h<=49?2e3+h:h<=999?1900+h:h),Ot.indexOf(a),parseInt(o,10),parseInt(s,10),parseInt(l,10)],c&&u.push(parseInt(c,10)),u);if(i=p,n=t,(e=d[1])&&Wt.indexOf(e)!==new Date(i[0],i[1],i[2]).getDay()&&(b(n).weekdayMismatch=!0,!(n._isValid=!1)))return;t._a=p,t._tzm=function(t,e,i){if(t)return xe[t];if(e)return 0;var n=parseInt(i,10),r=n%100;return(n-r)/100*60+r}(d[8],d[9],d[10]),t._d=Ft.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),b(t).rfc2822=!0}else t._isValid=!1}function Te(t){if(t._f!==y.ISO_8601)if(t._f!==y.RFC_2822){t._a=[],b(t).empty=!0;var e,i,n,r,a,o,s,l,c=""+t._i,h=c.length,u=0;for(n=G(t._f,t._locale).match(F)||[],e=0;e<n.length;e++)r=n[e],(i=(c.match((g=r,v=t,_(st,g)?st[g](v._strict,v._locale):new RegExp(ct(g.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,n,r){return e||i||n||r})))))||[])[0])&&(0<(a=c.substr(0,c.indexOf(i))).length&&b(t).unusedInput.push(a),c=c.slice(c.indexOf(i)+i.length),u+=i.length),U[r]?(i?b(t).empty=!1:b(t).unusedTokens.push(r),o=r,l=t,null!=(s=i)&&_(ht,o)&&ht[o](s,l._a,l,o)):t._strict&&!i&&b(t).unusedTokens.push(r);b(t).charsLeftOver=h-u,0<c.length&&b(t).unusedInput.push(c),t._a[gt]<=12&&!0===b(t).bigHour&&0<t._a[gt]&&(b(t).bigHour=void 0),b(t).parsedDateParts=t._a.slice(0),b(t).meridiem=t._meridiem,t._a[gt]=(d=t._locale,p=t._a[gt],null==(f=t._meridiem)?p:null!=d.meridiemHour?d.meridiemHour(p,f):(null!=d.isPM&&((m=d.isPM(f))&&p<12&&(p+=12),m||12!==p||(p=0)),p)),de(t),he(t)}else we(t);else _e(t);var d,p,f,m,g,v}function Me(t){var e,i,n,r,a=t._i,o=t._f;return t._locale=t._locale||ce(t._l),null===a||void 0===o&&""===a?g({nullInput:!0}):("string"==typeof a&&(t._i=a=t._locale.preparse(a)),w(a)?new x(he(a)):(u(a)?t._d=a:s(o)?function(t){var e,i,n,r,a;if(0===t._f.length)return b(t).invalidFormat=!0,t._d=new Date(NaN);for(r=0;r<t._f.length;r++)a=0,e=v({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[r],Te(e),m(e)&&(a+=b(e).charsLeftOver,a+=10*b(e).unusedTokens.length,b(e).score=a,(null==n||a<n)&&(n=a,i=e));p(t,i||e)}(t):o?Te(t):c(i=(e=t)._i)?e._d=new Date(y.now()):u(i)?e._d=new Date(i.valueOf()):"string"==typeof i?(n=e,null===(r=ye.exec(n._i))?(_e(n),!1===n._isValid&&(delete n._isValid,we(n),!1===n._isValid&&(delete n._isValid,y.createFromInputFallback(n)))):n._d=new Date(+r[1])):s(i)?(e._a=d(i.slice(0),function(t){return parseInt(t,10)}),de(e)):l(i)?function(t){if(!t._d){var e=D(t._i);t._a=d([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),de(t)}}(e):h(i)?e._d=new Date(i):y.createFromInputFallback(e),m(t)||(t._d=null),t))}function Se(t,e,i,n,r){var a,o={};return!0!==i&&!1!==i||(n=i,i=void 0),(l(t)&&function(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}(t)||s(t)&&0===t.length)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=i,o._i=t,o._f=e,o._strict=n,(a=new x(he(Me(o))))._nextDay&&(a.add(1,"d"),a._nextDay=void 0),a}function Ee(t,e,i,n){return Se(t,e,i,n,!1)}y.createFromInputFallback=i("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),y.ISO_8601=function(){},y.RFC_2822=function(){};var Ce=i("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ee.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:g()}),Le=i("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ee.apply(null,arguments);return this.isValid()&&t.isValid()?this<t?this:t:g()});function Ae(t,e){var i,n;if(1===e.length&&s(e[0])&&(e=e[0]),!e.length)return Ee();for(i=e[0],n=1;n<e.length;++n)e[n].isValid()&&!e[n][t](i)||(i=e[n]);return i}var Pe=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Re(t){var e=D(t),i=e.year||0,n=e.quarter||0,r=e.month||0,a=e.week||e.isoWeek||0,o=e.day||0,s=e.hour||0,l=e.minute||0,c=e.second||0,h=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===Mt.call(Pe,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var i=!1,n=0;n<Pe.length;++n)if(t[Pe[n]]){if(i)return!1;parseFloat(t[Pe[n]])!==M(t[Pe[n]])&&(i=!0)}return!0}(e),this._milliseconds=+h+1e3*c+6e4*l+1e3*s*60*60,this._days=+o+7*a,this._months=+r+3*n+12*i,this._data={},this._locale=ce(),this._bubble()}function Oe(t){return t instanceof Re}function Ie(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function De(t,i){z(t,0,0,function(){var t=this.utcOffset(),e="+";return t<0&&(t=-t,e="-"),e+N(~~(t/60),2)+i+N(~~t%60,2)})}De("Z",":"),De("ZZ",""),lt("Z",at),lt("ZZ",at),ut(["Z","ZZ"],function(t,e,i){i._useUTC=!0,i._tzm=ke(at,t)});var je=/([\+\-]|\d\d)/gi;function ke(t,e){var i=(e||"").match(t);if(null===i)return null;var n=((i[i.length-1]||[])+"").match(je)||["-",0,0],r=60*n[1]+M(n[2]);return 0===r?0:"+"===n[0]?r:-r}function Ne(t,e){var i,n;return e._isUTC?(i=e.clone(),n=(w(t)||u(t)?t.valueOf():Ee(t).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+n),y.updateOffset(i,!1),i):Ee(t).local()}function Fe(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Be(){return!!this.isValid()&&this._isUTC&&0===this._offset}y.updateOffset=function(){};var He=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ue=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ze(t,e){var i,n,r,a,o,s,l=t,c=null;return Oe(t)?l={ms:t._milliseconds,d:t._days,M:t._months}:h(t)?(l={},e?l[e]=t:l.milliseconds=t):(c=He.exec(t))?(i="-"===c[1]?-1:1,l={y:0,d:M(c[mt])*i,h:M(c[gt])*i,m:M(c[vt])*i,s:M(c[yt])*i,ms:M(Ie(1e3*c[_t]))*i}):(c=Ue.exec(t))?(i="-"===c[1]?-1:1,l={y:Ve(c[2],i),M:Ve(c[3],i),w:Ve(c[4],i),d:Ve(c[5],i),h:Ve(c[6],i),m:Ve(c[7],i),s:Ve(c[8],i)}):null==l?l={}:"object"==typeof l&&("from"in l||"to"in l)&&(a=Ee(l.from),o=Ee(l.to),r=a.isValid()&&o.isValid()?(o=Ne(o,a),a.isBefore(o)?s=Ge(a,o):((s=Ge(o,a)).milliseconds=-s.milliseconds,s.months=-s.months),s):{milliseconds:0,months:0},(l={}).ms=r.milliseconds,l.M=r.months),n=new Re(l),Oe(t)&&_(t,"_locale")&&(n._locale=t._locale),n}function Ve(t,e){var i=t&&parseFloat(t.replace(",","."));return(isNaN(i)?0:i)*e}function Ge(t,e){var i={};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function We(n,r){return function(t,e){var i;return null===e||isNaN(+e)||(C(r,"moment()."+r+"(period, number) is deprecated. Please use moment()."+r+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=t,t=e,e=i),Ye(this,ze(t="string"==typeof t?+t:t,e),n),this}}function Ye(t,e,i,n){var r=e._milliseconds,a=Ie(e._days),o=Ie(e._months);t.isValid()&&(n=null==n||n,o&&It(t,Ct(t,"Month")+o*i),a&&Lt(t,"Date",Ct(t,"Date")+a*i),r&&t._d.setTime(t._d.valueOf()+r*i),n&&y.updateOffset(t,a||o))}ze.fn=Re.prototype,ze.invalid=function(){return ze(NaN)};var Xe=We(1,"add"),qe=We(-1,"subtract");function Je(t,e){var i=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(i,"months");return-(i+(e-n<0?(e-n)/(n-t.clone().add(i-1,"months")):(e-n)/(t.clone().add(i+1,"months")-n)))||0}function Ze(t){var e;return void 0===t?this._locale._abbr:(null!=(e=ce(t))&&(this._locale=e),this)}y.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",y.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Qe=i("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});function Ke(){return this._locale}var $e=126227808e5;function ti(t,e){return(t%e+e)%e}function ei(t,e,i){return t<100&&0<=t?new Date(t+400,e,i)-$e:new Date(t,e,i).valueOf()}function ii(t,e,i){return t<100&&0<=t?Date.UTC(t+400,e,i)-$e:Date.UTC(t,e,i)}function ni(t,e){z(0,[t,t.length],0,e)}function ri(t,e,i,n,r){var a;return null==t?Ut(this,n,r).year:((a=zt(t,n,r))<e&&(e=a),function(t,e,i,n,r){var a=Ht(t,e,i,n,r),o=Ft(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}.call(this,t,e,i,n,r))}z(0,["gg",2],0,function(){return this.weekYear()%100}),z(0,["GG",2],0,function(){return this.isoWeekYear()%100}),ni("gggg","weekYear"),ni("ggggg","weekYear"),ni("GGGG","isoWeekYear"),ni("GGGGG","isoWeekYear"),O("weekYear","gg"),O("isoWeekYear","GG"),k("weekYear",1),k("isoWeekYear",1),lt("G",nt),lt("g",nt),lt("GG",Z,Y),lt("gg",Z,Y),lt("GGGG",tt,q),lt("gggg",tt,q),lt("GGGGG",et,J),lt("ggggg",et,J),dt(["gggg","ggggg","GGGG","GGGGG"],function(t,e,i,n){e[n.substr(0,2)]=M(t)}),dt(["gg","GG"],function(t,e,i,n){e[n]=y.parseTwoDigitYear(t)}),z("Q",0,"Qo","quarter"),O("quarter","Q"),k("quarter",7),lt("Q",W),ut("Q",function(t,e){e[ft]=3*(M(t)-1)}),z("D",["DD",2],"Do","date"),O("date","D"),k("date",9),lt("D",Z),lt("DD",Z,Y),lt("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),ut(["D","DD"],mt),ut("Do",function(t,e){e[mt]=M(t.match(Z)[0])});var ai=Et("Date",!0);z("DDD",["DDDD",3],"DDDo","dayOfYear"),O("dayOfYear","DDD"),k("dayOfYear",4),lt("DDD",$),lt("DDDD",X),ut(["DDD","DDDD"],function(t,e,i){i._dayOfYear=M(t)}),z("m",["mm",2],0,"minute"),O("minute","m"),k("minute",14),lt("m",Z),lt("mm",Z,Y),ut(["m","mm"],vt);var oi=Et("Minutes",!1);z("s",["ss",2],0,"second"),O("second","s"),k("second",15),lt("s",Z),lt("ss",Z,Y),ut(["s","ss"],yt);var si,li=Et("Seconds",!1);for(z("S",0,0,function(){return~~(this.millisecond()/100)}),z(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),z(0,["SSS",3],0,"millisecond"),z(0,["SSSS",4],0,function(){return 10*this.millisecond()}),z(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),z(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),z(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),z(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),z(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),O("millisecond","ms"),k("millisecond",16),lt("S",$,W),lt("SS",$,Y),lt("SSS",$,X),si="SSSS";si.length<=9;si+="S")lt(si,it);function ci(t,e){e[_t]=M(1e3*("0."+t))}for(si="S";si.length<=9;si+="S")ut(si,ci);var hi=Et("Milliseconds",!1);z("z",0,0,"zoneAbbr"),z("zz",0,0,"zoneName");var ui=x.prototype;function di(t){return t}ui.add=Xe,ui.calendar=function(t,e){var i=t||Ee(),n=Ne(i,this).startOf("day"),r=y.calendarFormat(this,n)||"sameElse",a=e&&(L(e[r])?e[r].call(this,i):e[r]);return this.format(a||this.localeData().calendar(r,this,Ee(i)))},ui.clone=function(){return new x(this)},ui.diff=function(t,e,i){var n,r,a;if(!this.isValid())return NaN;if(!(n=Ne(t,this)).isValid())return NaN;switch(r=6e4*(n.utcOffset()-this.utcOffset()),e=I(e)){case"year":a=Je(this,n)/12;break;case"month":a=Je(this,n);break;case"quarter":a=Je(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-r)/864e5;break;case"week":a=(this-n-r)/6048e5;break;default:a=this-n}return i?a:T(a)},ui.endOf=function(t){var e;if(void 0===(t=I(t))||"millisecond"===t||!this.isValid())return this;var i=this._isUTC?ii:ei;switch(t){case"year":e=i(this.year()+1,0,1)-1;break;case"quarter":e=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=i(this.year(),this.month()+1,1)-1;break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=36e5-ti(e+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":e=this._d.valueOf(),e+=6e4-ti(e,6e4)-1;break;case"second":e=this._d.valueOf(),e+=1e3-ti(e,1e3)-1}return this._d.setTime(e),y.updateOffset(this,!0),this},ui.format=function(t){t||(t=this.isUtc()?y.defaultFormatUtc:y.defaultFormat);var e=V(this,t);return this.localeData().postformat(e)},ui.from=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||Ee(t).isValid())?ze({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ui.fromNow=function(t){return this.from(Ee(),t)},ui.to=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||Ee(t).isValid())?ze({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ui.toNow=function(t){return this.to(Ee(),t)},ui.get=function(t){return L(this[t=I(t)])?this[t]():this},ui.invalidAt=function(){return b(this).overflow},ui.isAfter=function(t,e){var i=w(t)?t:Ee(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=I(e)||"millisecond")?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(e).valueOf())},ui.isBefore=function(t,e){var i=w(t)?t:Ee(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=I(e)||"millisecond")?this.valueOf()<i.valueOf():this.clone().endOf(e).valueOf()<i.valueOf())},ui.isBetween=function(t,e,i,n){var r=w(t)?t:Ee(t),a=w(e)?e:Ee(e);return!!(this.isValid()&&r.isValid()&&a.isValid())&&("("===(n=n||"()")[0]?this.isAfter(r,i):!this.isBefore(r,i))&&(")"===n[1]?this.isBefore(a,i):!this.isAfter(a,i))},ui.isSame=function(t,e){var i,n=w(t)?t:Ee(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=I(e)||"millisecond")?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf()))},ui.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},ui.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},ui.isValid=function(){return m(this)},ui.lang=Qe,ui.locale=Ze,ui.localeData=Ke,ui.max=Le,ui.min=Ce,ui.parsingFlags=function(){return p({},b(this))},ui.set=function(t,e){if("object"==typeof t)for(var i=function(t){var e=[];for(var i in t)e.push({unit:i,priority:j[i]});return e.sort(function(t,e){return t.priority-e.priority}),e}(t=D(t)),n=0;n<i.length;n++)this[i[n].unit](t[i[n].unit]);else if(L(this[t=I(t)]))return this[t](e);return this},ui.startOf=function(t){var e;if(void 0===(t=I(t))||"millisecond"===t||!this.isValid())return this;var i=this._isUTC?ii:ei;switch(t){case"year":e=i(this.year(),0,1);break;case"quarter":e=i(this.year(),this.month()-this.month()%3,1);break;case"month":e=i(this.year(),this.month(),1);break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=i(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=ti(e+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":e=this._d.valueOf(),e-=ti(e,6e4);break;case"second":e=this._d.valueOf(),e-=ti(e,1e3)}return this._d.setTime(e),y.updateOffset(this,!0),this},ui.subtract=qe,ui.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},ui.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},ui.toDate=function(){return new Date(this.valueOf())},ui.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,i=e?this.clone().utc():this;return i.year()<0||9999<i.year()?V(i,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):L(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",V(i,"Z")):V(i,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ui.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var i="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r=e+'[")]';return this.format(i+n+"-MM-DD[T]HH:mm:ss.SSS"+r)},ui.toJSON=function(){return this.isValid()?this.toISOString():null},ui.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ui.unix=function(){return Math.floor(this.valueOf()/1e3)},ui.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ui.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ui.year=St,ui.isLeapYear=function(){return Tt(this.year())},ui.weekYear=function(t){return ri.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ui.isoWeekYear=function(t){return ri.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},ui.quarter=ui.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},ui.month=Dt,ui.daysInMonth=function(){return At(this.year(),this.month())},ui.week=ui.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},ui.isoWeek=ui.isoWeeks=function(t){var e=Ut(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},ui.weeksInYear=function(){var t=this.localeData()._week;return zt(this.year(),t.dow,t.doy)},ui.isoWeeksInYear=function(){return zt(this.year(),1,4)},ui.date=ai,ui.day=ui.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e,i,n=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(e=t,i=this.localeData(),t="string"!=typeof e?e:isNaN(e)?"number"==typeof(e=i.weekdaysParse(e))?e:null:parseInt(e,10),this.add(t-n,"d")):n},ui.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},ui.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null==t)return this.day()||7;var e,i,n=(e=t,i=this.localeData(),"string"==typeof e?i.weekdaysParse(e)%7||7:isNaN(e)?null:e);return this.day(this.day()%7?n:n-7)},ui.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},ui.hour=ui.hours=ee,ui.minute=ui.minutes=oi,ui.second=ui.seconds=li,ui.millisecond=ui.milliseconds=hi,ui.utcOffset=function(t,e,i){var n,r=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null==t)return this._isUTC?r:Fe(this);if("string"==typeof t){if(null===(t=ke(at,t)))return this}else Math.abs(t)<16&&!i&&(t*=60);return!this._isUTC&&e&&(n=Fe(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),r!==t&&(!e||this._changeInProgress?Ye(this,ze(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,y.updateOffset(this,!0),this._changeInProgress=null)),this},ui.utc=function(t){return this.utcOffset(0,t)},ui.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Fe(this),"m")),this},ui.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=ke(rt,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},ui.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?Ee(t).utcOffset():0,(this.utcOffset()-t)%60==0)},ui.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ui.isLocal=function(){return!!this.isValid()&&!this._isUTC},ui.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ui.isUtc=Be,ui.isUTC=Be,ui.zoneAbbr=function(){return this._isUTC?"UTC":""},ui.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ui.dates=i("dates accessor is deprecated. Use date instead.",ai),ui.months=i("months accessor is deprecated. Use month instead",Dt),ui.years=i("years accessor is deprecated. Use year instead",St),ui.zone=i("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),ui.isDSTShifted=i("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!c(this._isDSTShifted))return this._isDSTShifted;var t={};if(v(t,this),(t=Me(t))._a){var e=t._isUTC?f(t._a):Ee(t._a);this._isDSTShifted=this.isValid()&&0<o(t._a,e.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var pi=P.prototype;function fi(t,e,i,n){var r=ce(),a=f().set(n,e);return r[i](a,t)}function mi(t,e,i){if(h(t)&&(e=t,t=void 0),t=t||"",null!=e)return fi(t,e,i,"month");var n,r=[];for(n=0;n<12;n++)r[n]=fi(t,n,i,"month");return r}function gi(t,e,i,n){"boolean"==typeof t?h(e)&&(i=e,e=void 0):(e=t,t=!1,h(i=e)&&(i=e,e=void 0)),e=e||"";var r,a=ce(),o=t?a._week.dow:0;if(null!=i)return fi(e,(i+o)%7,n,"day");var s=[];for(r=0;r<7;r++)s[r]=fi(e,(r+o)%7,n,"day");return s}pi.calendar=function(t,e,i){var n=this._calendar[t]||this._calendar.sameElse;return L(n)?n.call(e,i):n},pi.longDateFormat=function(t){var e=this._longDateFormat[t],i=this._longDateFormat[t.toUpperCase()];return e||!i?e:(this._longDateFormat[t]=i.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])},pi.invalidDate=function(){return this._invalidDate},pi.ordinal=function(t){return this._ordinal.replace("%d",t)},pi.preparse=di,pi.postformat=di,pi.relativeTime=function(t,e,i,n){var r=this._relativeTime[i];return L(r)?r(t,e,i,n):r.replace(/%d/i,t)},pi.pastFuture=function(t,e){var i=this._relativeTime[0<t?"future":"past"];return L(i)?i(e):i.replace(/%s/i,e)},pi.set=function(t){var e,i;for(i in t)L(e=t[i])?this[i]=e:this["_"+i]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},pi.months=function(t,e){return t?s(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Pt).test(e)?"format":"standalone"][t.month()]:s(this._months)?this._months:this._months.standalone},pi.monthsShort=function(t,e){return t?s(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Pt.test(e)?"format":"standalone"][t.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},pi.monthsParse=function(t,e,i){var n,r,a;if(this._monthsParseExact)return function(t,e,i){var n,r,a,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=f([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return i?"MMM"===e?-1!==(r=Mt.call(this._shortMonthsParse,o))?r:null:-1!==(r=Mt.call(this._longMonthsParse,o))?r:null:"MMM"===e?-1!==(r=Mt.call(this._shortMonthsParse,o))?r:-1!==(r=Mt.call(this._longMonthsParse,o))?r:null:-1!==(r=Mt.call(this._longMonthsParse,o))?r:-1!==(r=Mt.call(this._shortMonthsParse,o))?r:null}.call(this,t,e,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(r=f([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(a="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[n].test(t))return n;if(i&&"MMM"===e&&this._shortMonthsParse[n].test(t))return n;if(!i&&this._monthsParse[n].test(t))return n}},pi.monthsRegex=function(t){return this._monthsParseExact?(_(this,"_monthsRegex")||Nt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(_(this,"_monthsRegex")||(this._monthsRegex=kt),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},pi.monthsShortRegex=function(t){return this._monthsParseExact?(_(this,"_monthsRegex")||Nt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(_(this,"_monthsShortRegex")||(this._monthsShortRegex=jt),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},pi.week=function(t){return Ut(t,this._week.dow,this._week.doy).week},pi.firstDayOfYear=function(){return this._week.doy},pi.firstDayOfWeek=function(){return this._week.dow},pi.weekdays=function(t,e){var i=s(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?Vt(i,this._week.dow):t?i[t.day()]:i},pi.weekdaysMin=function(t){return!0===t?Vt(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},pi.weekdaysShort=function(t){return!0===t?Vt(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},pi.weekdaysParse=function(t,e,i){var n,r,a;if(this._weekdaysParseExact)return function(t,e,i){var n,r,a,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=f([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return i?"dddd"===e?-1!==(r=Mt.call(this._weekdaysParse,o))?r:null:"ddd"===e?-1!==(r=Mt.call(this._shortWeekdaysParse,o))?r:null:-1!==(r=Mt.call(this._minWeekdaysParse,o))?r:null:"dddd"===e?-1!==(r=Mt.call(this._weekdaysParse,o))?r:-1!==(r=Mt.call(this._shortWeekdaysParse,o))?r:-1!==(r=Mt.call(this._minWeekdaysParse,o))?r:null:"ddd"===e?-1!==(r=Mt.call(this._shortWeekdaysParse,o))?r:-1!==(r=Mt.call(this._weekdaysParse,o))?r:-1!==(r=Mt.call(this._minWeekdaysParse,o))?r:null:-1!==(r=Mt.call(this._minWeekdaysParse,o))?r:-1!==(r=Mt.call(this._weekdaysParse,o))?r:-1!==(r=Mt.call(this._shortWeekdaysParse,o))?r:null}.call(this,t,e,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(r=f([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),i&&"dddd"===e&&this._fullWeekdaysParse[n].test(t))return n;if(i&&"ddd"===e&&this._shortWeekdaysParse[n].test(t))return n;if(i&&"dd"===e&&this._minWeekdaysParse[n].test(t))return n;if(!i&&this._weekdaysParse[n].test(t))return n}},pi.weekdaysRegex=function(t){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||Zt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(_(this,"_weekdaysRegex")||(this._weekdaysRegex=Xt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},pi.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||Zt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(_(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qt),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},pi.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(_(this,"_weekdaysRegex")||Zt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(_(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Jt),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},pi.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},pi.meridiem=function(t,e,i){return 11<t?i?"pm":"PM":i?"am":"AM"},se("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===M(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),y.lang=i("moment.lang is deprecated. Use moment.locale instead.",se),y.langData=i("moment.langData is deprecated. Use moment.localeData instead.",ce);var vi=Math.abs;function yi(t,e,i,n){var r=ze(e,i);return t._milliseconds+=n*r._milliseconds,t._days+=n*r._days,t._months+=n*r._months,t._bubble()}function _i(t){return t<0?Math.floor(t):Math.ceil(t)}function bi(t){return 4800*t/146097}function xi(t){return 146097*t/4800}function wi(t){return function(){return this.as(t)}}var Ti=wi("ms"),Mi=wi("s"),Si=wi("m"),Ei=wi("h"),Ci=wi("d"),Li=wi("w"),Ai=wi("M"),Pi=wi("Q"),Ri=wi("y");function Oi(t){return function(){return this.isValid()?this._data[t]:NaN}}var Ii=Oi("milliseconds"),Di=Oi("seconds"),ji=Oi("minutes"),ki=Oi("hours"),Ni=Oi("days"),Fi=Oi("months"),Bi=Oi("years"),Hi=Math.round,Ui={ss:44,s:45,m:45,h:22,d:26,M:11},zi=Math.abs;function Vi(t){return(0<t)-(t<0)||+t}function Gi(){if(!this.isValid())return this.localeData().invalidDate();var t,e,i=zi(this._milliseconds)/1e3,n=zi(this._days),r=zi(this._months);e=T((t=T(i/60))/60),i%=60,t%=60;var a=T(r/12),o=r%=12,s=n,l=e,c=t,h=i?i.toFixed(3).replace(/\.?0+$/,""):"",u=this.asSeconds();if(!u)return"P0D";var d=u<0?"-":"",p=Vi(this._months)!==Vi(u)?"-":"",f=Vi(this._days)!==Vi(u)?"-":"",m=Vi(this._milliseconds)!==Vi(u)?"-":"";return d+"P"+(a?p+a+"Y":"")+(o?p+o+"M":"")+(s?f+s+"D":"")+(l||c||h?"T":"")+(l?m+l+"H":"")+(c?m+c+"M":"")+(h?m+h+"S":"")}var Wi=Re.prototype;return Wi.isValid=function(){return this._isValid},Wi.abs=function(){var t=this._data;return this._milliseconds=vi(this._milliseconds),this._days=vi(this._days),this._months=vi(this._months),t.milliseconds=vi(t.milliseconds),t.seconds=vi(t.seconds),t.minutes=vi(t.minutes),t.hours=vi(t.hours),t.months=vi(t.months),t.years=vi(t.years),this},Wi.add=function(t,e){return yi(this,t,e,1)},Wi.subtract=function(t,e){return yi(this,t,e,-1)},Wi.as=function(t){if(!this.isValid())return NaN;var e,i,n=this._milliseconds;if("month"===(t=I(t))||"quarter"===t||"year"===t)switch(e=this._days+n/864e5,i=this._months+bi(e),t){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(e=this._days+Math.round(xi(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return 24*e+n/36e5;case"minute":return 1440*e+n/6e4;case"second":return 86400*e+n/1e3;case"millisecond":return Math.floor(864e5*e)+n;default:throw new Error("Unknown unit "+t)}},Wi.asMilliseconds=Ti,Wi.asSeconds=Mi,Wi.asMinutes=Si,Wi.asHours=Ei,Wi.asDays=Ci,Wi.asWeeks=Li,Wi.asMonths=Ai,Wi.asQuarters=Pi,Wi.asYears=Ri,Wi.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*M(this._months/12):NaN},Wi._bubble=function(){var t,e,i,n,r,a=this._milliseconds,o=this._days,s=this._months,l=this._data;return 0<=a&&0<=o&&0<=s||a<=0&&o<=0&&s<=0||(a+=864e5*_i(xi(s)+o),s=o=0),l.milliseconds=a%1e3,t=T(a/1e3),l.seconds=t%60,e=T(t/60),l.minutes=e%60,i=T(e/60),l.hours=i%24,s+=r=T(bi(o+=T(i/24))),o-=_i(xi(r)),n=T(s/12),s%=12,l.days=o,l.months=s,l.years=n,this},Wi.clone=function(){return ze(this)},Wi.get=function(t){return t=I(t),this.isValid()?this[t+"s"]():NaN},Wi.milliseconds=Ii,Wi.seconds=Di,Wi.minutes=ji,Wi.hours=ki,Wi.days=Ni,Wi.weeks=function(){return T(this.days()/7)},Wi.months=Fi,Wi.years=Bi,Wi.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e,i,n,r,a,o,s,l,c,h,u=this.localeData(),d=(e=!t,i=u,n=ze(this).abs(),r=Hi(n.as("s")),a=Hi(n.as("m")),o=Hi(n.as("h")),s=Hi(n.as("d")),l=Hi(n.as("M")),c=Hi(n.as("y")),(h=r<=Ui.ss&&["s",r]||r<Ui.s&&["ss",r]||a<=1&&["m"]||a<Ui.m&&["mm",a]||o<=1&&["h"]||o<Ui.h&&["hh",o]||s<=1&&["d"]||s<Ui.d&&["dd",s]||l<=1&&["M"]||l<Ui.M&&["MM",l]||c<=1&&["y"]||["yy",c])[2]=e,h[3]=0<+this,h[4]=i,function(t,e,i,n,r){return r.relativeTime(e||1,!!i,t,n)}.apply(null,h));return t&&(d=u.pastFuture(+this,d)),u.postformat(d)},Wi.toISOString=Gi,Wi.toString=Gi,Wi.toJSON=Gi,Wi.locale=Ze,Wi.localeData=Ke,Wi.toIsoString=i("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gi),Wi.lang=Qe,z("X",0,0,"unix"),z("x",0,0,"valueOf"),lt("x",nt),lt("X",/[+-]?\d+(\.\d{1,3})?/),ut("X",function(t,e,i){i._d=new Date(1e3*parseFloat(t,10))}),ut("x",function(t,e,i){i._d=new Date(M(t))}),y.version="2.24.0",t=Ee,y.fn=ui,y.min=function(){return Ae("isBefore",[].slice.call(arguments,0))},y.max=function(){return Ae("isAfter",[].slice.call(arguments,0))},y.now=function(){return Date.now?Date.now():+new Date},y.utc=f,y.unix=function(t){return Ee(1e3*t)},y.months=function(t,e){return mi(t,e,"months")},y.isDate=u,y.locale=se,y.invalid=g,y.duration=ze,y.isMoment=w,y.weekdays=function(t,e,i){return gi(t,e,i,"weekdays")},y.parseZone=function(){return Ee.apply(null,arguments).parseZone()},y.localeData=ce,y.isDuration=Oe,y.monthsShort=function(t,e){return mi(t,e,"monthsShort")},y.weekdaysMin=function(t,e,i){return gi(t,e,i,"weekdaysMin")},y.defineLocale=le,y.updateLocale=function(t,e){if(null!=e){var i,n,r=ie;null!=(n=oe(t))&&(r=n._config),(i=new P(e=A(r,e))).parentLocale=ne[t],ne[t]=i,se(t)}else null!=ne[t]&&(null!=ne[t].parentLocale?ne[t]=ne[t].parentLocale:null!=ne[t]&&delete ne[t]);return ne[t]},y.locales=function(){return n(ne)},y.weekdaysShort=function(t,e,i){return gi(t,e,i,"weekdaysShort")},y.normalizeUnits=I,y.relativeTimeRounding=function(t){return void 0===t?Hi:"function"==typeof t&&(Hi=t,!0)},y.relativeTimeThreshold=function(t,e){return void 0!==Ui[t]&&(void 0===e?Ui[t]:(Ui[t]=e,"s"===t&&(Ui.ss=e-1),!0))},y.calendarFormat=function(t,e){var i=t.diff(e,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"},y.prototype=ui,y.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},y}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(function(){try{return require("moment")}catch(t){}}()):"function"==typeof define&&define.amd?define(["require"],function(t){return e(function(){try{return t("moment")}catch(t){}}())}):t.Chart=e(t.moment)}(this,function(n){n=n&&n.hasOwnProperty("default")?n.default:n;var a={rgb2hsl:o,rgb2hsv:e,rgb2hwb:i,rgb2cmyk:s,rgb2keyword:l,rgb2xyz:c,rgb2lab:h,rgb2lch:function(t){return _(h(t))},hsl2rgb:u,hsl2hsv:function(t){var e=t[0],i=t[1]/100,n=t[2]/100;return 0===n?[0,0,0]:[e,2*(i*=(n*=2)<=1?n:2-n)/(n+i)*100,(n+i)/2*100]},hsl2hwb:function(t){return i(u(t))},hsl2cmyk:function(t){return s(u(t))},hsl2keyword:function(t){return l(u(t))},hsv2rgb:d,hsv2hsl:function(t){var e,i,n=t[0],r=t[1]/100,a=t[2]/100;return e=r*a,[n,100*(e=(e/=(i=(2-r)*a)<=1?i:2-i)||0),100*(i/=2)]},hsv2hwb:function(t){return i(d(t))},hsv2cmyk:function(t){return s(d(t))},hsv2keyword:function(t){return l(d(t))},hwb2rgb:p,hwb2hsl:function(t){return o(p(t))},hwb2hsv:function(t){return e(p(t))},hwb2cmyk:function(t){return s(p(t))},hwb2keyword:function(t){return l(p(t))},cmyk2rgb:f,cmyk2hsl:function(t){return o(f(t))},cmyk2hsv:function(t){return e(f(t))},cmyk2hwb:function(t){return i(f(t))},cmyk2keyword:function(t){return l(f(t))},keyword2rgb:T,keyword2hsl:function(t){return o(T(t))},keyword2hsv:function(t){return e(T(t))},keyword2hwb:function(t){return i(T(t))},keyword2cmyk:function(t){return s(T(t))},keyword2lab:function(t){return h(T(t))},keyword2xyz:function(t){return c(T(t))},xyz2rgb:m,xyz2lab:v,xyz2lch:function(t){return _(v(t))},lab2xyz:y,lab2rgb:x,lab2lch:_,lch2lab:w,lch2xyz:function(t){return y(w(t))},lch2rgb:function(t){return x(w(t))}};function o(t){var e,i,n=t[0]/255,r=t[1]/255,a=t[2]/255,o=Math.min(n,r,a),s=Math.max(n,r,a),l=s-o;return s==o?e=0:n==s?e=(r-a)/l:r==s?e=2+(a-n)/l:a==s&&(e=4+(n-r)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+s)/2,[e,100*(s==o?0:i<=.5?l/(s+o):l/(2-s-o)),100*i]}function e(t){var e,i,n=t[0],r=t[1],a=t[2],o=Math.min(n,r,a),s=Math.max(n,r,a),l=s-o;return i=0==s?0:l/s*1e3/10,s==o?e=0:n==s?e=(r-a)/l:r==s?e=2+(a-n)/l:a==s&&(e=4+(n-r)/l),(e=Math.min(60*e,360))<0&&(e+=360),[e,i,s/255*1e3/10]}function i(t){var e=t[0],i=t[1],n=t[2];return[o(t)[0],1/255*Math.min(e,Math.min(i,n))*100,100*(n=1-1/255*Math.max(e,Math.max(i,n)))]}function s(t){var e,i=t[0]/255,n=t[1]/255,r=t[2]/255;return[100*((1-i-(e=Math.min(1-i,1-n,1-r)))/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-r-e)/(1-e)||0),100*e]}function l(t){return S[JSON.stringify(t)]}function c(t){var e=t[0]/255,i=t[1]/255,n=t[2]/255;return[100*(.4124*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(i=.04045<i?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(n=.04045<n?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*e+.7152*i+.0722*n),100*(.0193*e+.1192*i+.9505*n)]}function h(t){var e=c(t),i=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,i=.008856<(i/=95.047)?Math.pow(i,1/3):7.787*i+16/116,[116*(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116)-16,500*(i-n),200*(n-(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116))]}function u(t){var e,i,n,r,a,o=t[0]/360,s=t[1]/100,l=t[2]/100;if(0==s)return[a=255*l,a,a];e=2*l-(i=l<.5?l*(1+s):l+s-l*s),r=[0,0,0];for(var c=0;c<3;c++)(n=o+1/3*-(c-1))<0&&n++,1<n&&n--,a=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,r[c]=255*a;return r}function d(t){var e=t[0]/60,i=t[1]/100,n=t[2]/100,r=Math.floor(e)%6,a=e-Math.floor(e),o=255*n*(1-i),s=255*n*(1-i*a),l=255*n*(1-i*(1-a));switch(n*=255,r){case 0:return[n,l,o];case 1:return[s,n,o];case 2:return[o,n,l];case 3:return[o,s,n];case 4:return[l,o,n];case 5:return[n,o,s]}}function p(t){var e,i,n,a,o=t[0]/360,s=t[1]/100,l=t[2]/100,c=s+l;switch(1<c&&(s/=c,l/=c),n=6*o-(e=Math.floor(6*o)),0!=(1&e)&&(n=1-n),a=s+n*((i=1-l)-s),e){default:case 6:case 0:r=i,g=a,b=s;break;case 1:r=a,g=i,b=s;break;case 2:r=s,g=i,b=a;break;case 3:r=s,g=a,b=i;break;case 4:r=a,g=s,b=i;break;case 5:r=i,g=s,b=a}return[255*r,255*g,255*b]}function f(t){var e=t[0]/100,i=t[1]/100,n=t[2]/100,r=t[3]/100;return[255*(1-Math.min(1,e*(1-r)+r)),255*(1-Math.min(1,i*(1-r)+r)),255*(1-Math.min(1,n*(1-r)+r))]}function m(t){var e,i,n,r=t[0]/100,a=t[1]/100,o=t[2]/100;return i=-.9689*r+1.8758*a+.0415*o,n=.0557*r+-.204*a+1.057*o,e=.0031308<(e=3.2406*r+-1.5372*a+-.4986*o)?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=.0031308<n?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1))]}function v(t){var e=t[0],i=t[1],n=t[2];return i/=100,n/=108.883,e=.008856<(e/=95.047)?Math.pow(e,1/3):7.787*e+16/116,[116*(i=.008856<i?Math.pow(i,1/3):7.787*i+16/116)-16,500*(e-i),200*(i-(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116))]}function y(t){var e,i,n,r,a=t[0],o=t[1],s=t[2];return r=a<=8?(i=100*a/903.3)/100*7.787+16/116:(i=100*Math.pow((a+16)/116,3),Math.pow(i/100,1/3)),[e=e/95.047<=.008856?e=95.047*(o/500+r-16/116)/7.787:95.047*Math.pow(o/500+r,3),i,n=n/108.883<=.008859?n=108.883*(r-s/200-16/116)/7.787:108.883*Math.pow(r-s/200,3)]}function _(t){var e,i=t[0],n=t[1],r=t[2];return(e=360*Math.atan2(r,n)/2/Math.PI)<0&&(e+=360),[i,Math.sqrt(n*n+r*r),e]}function x(t){return m(y(t))}function w(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]}function T(t){return M[t]}var M={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},S={};for(var t in M)S[JSON.stringify(M[t])]=t;var E=function(){return new R};for(var C in a){E[C+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),a[e](t)}}(C);var L=/(\w+)2(\w+)/.exec(C),A=L[1],P=L[2];(E[A]=E[A]||{})[P]=E[C]=function(n){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var e=a[n](t);if("string"==typeof e||void 0===e)return e;for(var i=0;i<e.length;i++)e[i]=Math.round(e[i]);return e}}(C)}var R=function(){this.convs={}};R.prototype.routeSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i))},R.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},R.prototype.getValues=function(t){var e=this.convs[t];if(!e){var i=this.space,n=this.convs[i];e=E[i][t](n),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(e){R.prototype[e]=function(t){return this.routeSpace(e,arguments)}});var O=E,I={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},D={getRgba:j,getHsla:k,getRgb:function(t){var e=j(t);return e&&e.slice(0,3)},getHsl:function(t){var e=k(t);return e&&e.slice(0,3)},getHwb:N,getAlpha:function(t){var e=j(t);return e?e[3]:(e=k(t))?e[3]:(e=N(t))?e[3]:void 0},hexString:function(t,e){e=void 0!==e&&3===t.length?e:t[3];return"#"+z(t[0])+z(t[1])+z(t[2])+(0<=e&&e<1?z(Math.round(255*e)):"")},rgbString:function(t,e){return e<1||t[3]&&t[3]<1?F(t,e):"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},rgbaString:F,percentString:function(t,e){return e<1||t[3]&&t[3]<1?B(t,e):"rgb("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%)"},percentaString:B,hslString:function(t,e){return e<1||t[3]&&t[3]<1?H(t,e):"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"},hslaString:H,hwbString:function(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"},keyword:function(t){return V[t.slice(0,3)]}};function j(t){if(t){var e=[0,0,0],i=1,n=t.match(/^#([a-fA-F0-9]{3,4})$/i),r="";if(n){r=(n=n[1])[3];for(var a=0;a<e.length;a++)e[a]=parseInt(n[a]+n[a],16);r&&(i=Math.round(parseInt(r+r,16)/255*100)/100)}else if(n=t.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){for(r=n[2],n=n[1],a=0;a<e.length;a++)e[a]=parseInt(n.slice(2*a,2*a+2),16);r&&(i=Math.round(parseInt(r,16)/255*100)/100)}else if(n=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(a=0;a<e.length;a++)e[a]=parseInt(n[a+1]);i=parseFloat(n[4])}else if(n=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(a=0;a<e.length;a++)e[a]=Math.round(2.55*parseFloat(n[a+1]));i=parseFloat(n[4])}else if(n=t.match(/(\w+)/)){if("transparent"==n[1])return[0,0,0,0];if(!(e=I[n[1]]))return}for(a=0;a<e.length;a++)e[a]=U(e[a],0,255);return i=i||0==i?U(i,0,1):1,e[3]=i,e}}function k(t){if(t){var e=t.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[U(parseInt(e[1]),0,360),U(parseFloat(e[2]),0,100),U(parseFloat(e[3]),0,100),U(isNaN(i)?1:i,0,1)]}}}function N(t){if(t){var e=t.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[U(parseInt(e[1]),0,360),U(parseFloat(e[2]),0,100),U(parseFloat(e[3]),0,100),U(isNaN(i)?1:i,0,1)]}}}function F(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function B(t,e){return"rgba("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%, "+(e||t[3]||1)+")"}function H(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function U(t,e,i){return Math.min(Math.max(e,t),i)}function z(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var V={};for(var G in I)V[I[G]]=G;var W=function(t){return t instanceof W?t:this instanceof W?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof t?(e=D.getRgba(t))?this.setValues("rgb",e):(e=D.getHsla(t))?this.setValues("hsl",e):(e=D.getHwb(t))&&this.setValues("hwb",e):"object"==typeof t&&(void 0!==(e=t).r||void 0!==e.red?this.setValues("rgb",e):void 0!==e.l||void 0!==e.lightness?this.setValues("hsl",e):void 0!==e.v||void 0!==e.value?this.setValues("hsv",e):void 0!==e.w||void 0!==e.whiteness?this.setValues("hwb",e):void 0===e.c&&void 0===e.cyan||this.setValues("cmyk",e)))):new W(t);var e};W.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t=(t%=360)<0?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return D.hexString(this.values.rgb)},rgbString:function(){return D.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return D.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return D.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return D.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return D.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return D.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return D.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],i=0;i<t.length;i++){var n=t[i]/255;e[i]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),i=t.luminosity();return i<e?(e+.05)/(i+.05):(i+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return 7.1<=e?"AAA":4.5<=e?"AA":""},dark:function(){var t=this.values.rgb;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;e<3;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,i=(e[0]+t)%360;return e[0]=i<0?360+i:i,this.setValues("hsl",e),this},mix:function(t,e){var i=t,n=void 0===e?.5:e,r=2*n-1,a=this.alpha()-i.alpha(),o=((r*a==-1?r:(r+a)/(1+r*a))+1)/2,s=1-o;return this.rgb(o*this.red()+s*i.red(),o*this.green()+s*i.green(),o*this.blue()+s*i.blue()).alpha(this.alpha()*n+i.alpha()*(1-n))},toJSON:function(){return this.rgb()},clone:function(){var t,e,i=new W,n=this.values,r=i.values;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],"[object Array]"===(e={}.toString.call(t))?r[a]=t.slice(0):"[object Number]"===e?r[a]=t:console.error("unexpected color value:",t));return i}},W.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},W.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},W.prototype.getValues=function(t){for(var e=this.values,i={},n=0;n<t.length;n++)i[t.charAt(n)]=e[t][n];return 1!==e.alpha&&(i.a=e.alpha),i},W.prototype.setValues=function(t,e){var i,n,r=this.values,a=this.spaces,o=this.maxes,s=1;if(this.valid=!0,"alpha"===t)s=e;else if(e.length)r[t]=e.slice(0,t.length),s=e[t.length];else if(void 0!==e[t.charAt(0)]){for(i=0;i<t.length;i++)r[t][i]=e[t.charAt(i)];s=e.a}else if(void 0!==e[a[t][0]]){var l=a[t];for(i=0;i<t.length;i++)r[t][i]=e[l[i]];s=e.alpha}if(r.alpha=Math.max(0,Math.min(1,void 0===s?r.alpha:s)),"alpha"===t)return!1;for(i=0;i<t.length;i++)n=Math.max(0,Math.min(o[t][i],r[t][i])),r[t][i]=Math.round(n);for(var c in a)c!==t&&(r[c]=O[t][c](r[t]));return!0},W.prototype.setSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i),this)},W.prototype.setChannel=function(t,e,i){var n=this.values[t];return void 0===i?n[e]:(i===n[e]||(n[e]=i,this.setValues(t,n)),this)},"undefined"!=typeof window&&(window.Color=W);var Y,X=W,q={noop:function(){},uid:(Y=0,function(){return Y++}),isNullOrUndef:function(t){return null==t},isArray:function(t){if(Array.isArray&&Array.isArray(t))return!0;var e=Object.prototype.toString.call(t);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)},isObject:function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},isFinite:function(t){return("number"==typeof t||t instanceof Number)&&isFinite(t)},valueOrDefault:function(t,e){return void 0===t?e:t},valueAtIndexOrDefault:function(t,e,i){return q.valueOrDefault(q.isArray(t)?t[e]:t,i)},callback:function(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)},each:function(t,e,i,n){var r,a,o;if(q.isArray(t))if(a=t.length,n)for(r=a-1;0<=r;r--)e.call(i,t[r],r);else for(r=0;r<a;r++)e.call(i,t[r],r);else if(q.isObject(t))for(a=(o=Object.keys(t)).length,r=0;r<a;r++)e.call(i,t[o[r]],o[r])},arrayEquals:function(t,e){var i,n,r,a;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(r=t[i],a=e[i],r instanceof Array&&a instanceof Array){if(!q.arrayEquals(r,a))return!1}else if(r!==a)return!1;return!0},clone:function(t){if(q.isArray(t))return t.map(q.clone);if(q.isObject(t)){for(var e={},i=Object.keys(t),n=i.length,r=0;r<n;++r)e[i[r]]=q.clone(t[i[r]]);return e}return t},_merger:function(t,e,i,n){var r=e[t],a=i[t];q.isObject(r)&&q.isObject(a)?q.merge(r,a,n):e[t]=q.clone(a)},_mergerIf:function(t,e,i){var n=e[t],r=i[t];q.isObject(n)&&q.isObject(r)?q.mergeIf(n,r):e.hasOwnProperty(t)||(e[t]=q.clone(r))},merge:function(t,e,i){var n,r,a,o,s,l=q.isArray(e)?e:[e],c=l.length;if(!q.isObject(t))return t;for(n=(i=i||{}).merger||q._merger,r=0;r<c;++r)if(e=l[r],q.isObject(e))for(s=0,o=(a=Object.keys(e)).length;s<o;++s)n(a[s],t,e,i);return t},mergeIf:function(t,e){return q.merge(t,e,{merger:q._mergerIf})},extend:function(i){for(var t=function(t,e){i[e]=t},e=1,n=arguments.length;e<n;++e)q.each(arguments[e],t);return i},inherits:function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=q.inherits,t&&q.extend(i.prototype,t),i.__super__=e.prototype,i}},J=q;q.callCallback=q.callback,q.indexOf=function(t,e,i){return Array.prototype.indexOf.call(t,e,i)},q.getValueOrDefault=q.valueOrDefault,q.getValueAtIndexOrDefault=q.valueAtIndexOrDefault;var Z={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return 1<=t?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=n<1?(n=1,i/4):i/(2*Math.PI)*Math.asin(1/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i))},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=n<1?(n=1,i/4):i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.45),e=n<1?(n=1,i/4):i/(2*Math.PI)*Math.asin(1/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1)},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-Z.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*Z.easeInBounce(2*t):.5*Z.easeOutBounce(2*t-1)+.5}},Q={effects:Z};J.easingEffects=Z;var K=Math.PI,$=K/180,tt=2*K,et=K/2,it=K/4,nt=2*K/3,rt={clear:function(t){t.ctx.clearRect(0,0,t.width,t.height)},roundedRect:function(t,e,i,n,r,a){if(a){var o=Math.min(a,r/2,n/2),s=e+o,l=i+o,c=e+n-o,h=i+r-o;t.moveTo(e,l),s<c&&l<h?(t.arc(s,l,o,-K,-et),t.arc(c,l,o,-et,0),t.arc(c,h,o,0,et),t.arc(s,h,o,et,K)):s<c?(t.moveTo(s,i),t.arc(c,l,o,-et,et),t.arc(s,l,o,et,K+et)):l<h?(t.arc(s,l,o,-K,0),t.arc(s,h,o,0,K)):t.arc(s,l,o,-K,K),t.closePath(),t.moveTo(e,i)}else t.rect(e,i,n,r)},drawPoint:function(t,e,i,n,r,a){var o,s,l,c,h,u=(a||0)*$;if(!e||"object"!=typeof e||"[object HTMLImageElement]"!==(o=e.toString())&&"[object HTMLCanvasElement]"!==o){if(!(isNaN(i)||i<=0)){switch(t.beginPath(),e){default:t.arc(n,r,i,0,tt),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(u)*i,r-Math.cos(u)*i),u+=nt,t.lineTo(n+Math.sin(u)*i,r-Math.cos(u)*i),u+=nt,t.lineTo(n+Math.sin(u)*i,r-Math.cos(u)*i),t.closePath();break;case"rectRounded":c=i-(h=.516*i),s=Math.cos(u+it)*c,l=Math.sin(u+it)*c,t.arc(n-s,r-l,h,u-K,u-et),t.arc(n+l,r-s,h,u-et,u),t.arc(n+s,r+l,h,u,u+et),t.arc(n-l,r+s,h,u+et,u+K),t.closePath();break;case"rect":if(!a){c=Math.SQRT1_2*i,t.rect(n-c,r-c,2*c,2*c);break}u+=it;case"rectRot":s=Math.cos(u)*i,l=Math.sin(u)*i,t.moveTo(n-s,r-l),t.lineTo(n+l,r-s),t.lineTo(n+s,r+l),t.lineTo(n-l,r+s),t.closePath();break;case"crossRot":u+=it;case"cross":s=Math.cos(u)*i,l=Math.sin(u)*i,t.moveTo(n-s,r-l),t.lineTo(n+s,r+l),t.moveTo(n+l,r-s),t.lineTo(n-l,r+s);break;case"star":s=Math.cos(u)*i,l=Math.sin(u)*i,t.moveTo(n-s,r-l),t.lineTo(n+s,r+l),t.moveTo(n+l,r-s),t.lineTo(n-l,r+s),u+=it,s=Math.cos(u)*i,l=Math.sin(u)*i,t.moveTo(n-s,r-l),t.lineTo(n+s,r+l),t.moveTo(n+l,r-s),t.lineTo(n-l,r+s);break;case"line":s=Math.cos(u)*i,l=Math.sin(u)*i,t.moveTo(n-s,r-l),t.lineTo(n+s,r+l);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(u)*i,r+Math.sin(u)*i)}t.fill(),t.stroke()}}else t.drawImage(e,n-e.width/2,r-e.height/2,e.width,e.height)},_isPointInArea:function(t,e){return t.x>e.left-1e-6&&t.x<e.right+1e-6&&t.y>e.top-1e-6&&t.y<e.bottom+1e-6},clipArea:function(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()},unclipArea:function(t){t.restore()},lineTo:function(t,e,i,n){var r=i.steppedLine;if(r){if("middle"===r){var a=(e.x+i.x)/2;t.lineTo(a,n?i.y:e.y),t.lineTo(a,n?e.y:i.y)}else"after"===r&&!n||"after"!==r&&n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}else i.tension?t.bezierCurveTo(n?e.controlPointPreviousX:e.controlPointNextX,n?e.controlPointPreviousY:e.controlPointNextY,n?i.controlPointNextX:i.controlPointPreviousX,n?i.controlPointNextY:i.controlPointPreviousY,i.x,i.y):t.lineTo(i.x,i.y)}},at=rt;J.clear=rt.clear,J.drawRoundedRectangle=function(t){t.beginPath(),rt.roundedRect.apply(rt,arguments)};var ot={_set:function(t,e){return J.merge(this[t]||(this[t]={}),e)}};ot._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#000",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var st=ot,lt=J.valueOrDefault,ct={toLineHeight:function(t,e){var i=(""+t).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t},toPadding:function(t){var e,i,n,r;return J.isObject(t)?(e=+t.top||0,i=+t.right||0,n=+t.bottom||0,r=+t.left||0):e=i=n=r=+t||0,{top:e,right:i,bottom:n,left:r,height:e+n,width:r+i}},_parseFont:function(t){var e,i=st.global,n=lt(t.fontSize,i.defaultFontSize),r={family:lt(t.fontFamily,i.defaultFontFamily),lineHeight:J.options.toLineHeight(lt(t.lineHeight,i.defaultLineHeight),n),size:n,style:lt(t.fontStyle,i.defaultFontStyle),weight:null,string:""};return r.string=!(e=r)||J.isNullOrUndef(e.size)||J.isNullOrUndef(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family,r},resolve:function(t,e,i){var n,r,a;for(n=0,r=t.length;n<r;++n)if(void 0!==(a=t[n])&&(void 0!==e&&"function"==typeof a&&(a=a(e)),void 0!==i&&J.isArray(a)&&(a=a[i]),void 0!==a))return a}},ht=J,ut=Q,dt=at,pt=ct;ht.easing=ut,ht.canvas=dt,ht.options=pt;var ft=function(t){ht.extend(this,t),this.initialize.apply(this,arguments)};ht.extend(ft.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=ht.clone(t._model)),t._start={},t},transition:function(t){var e=this,i=e._model,n=e._start,r=e._view;return i&&1!==t?(r||(r=e._view={}),n||(n=e._start={}),function(t,e,i,n){var r,a,o,s,l,c,h,u,d,p=Object.keys(i);for(r=0,a=p.length;r<a;++r)if(c=i[o=p[r]],e.hasOwnProperty(o)||(e[o]=c),(s=e[o])!==c&&"_"!==o[0]){if(t.hasOwnProperty(o)||(t[o]=s),(h=typeof c)==typeof(l=t[o]))if("string"===h){if((u=X(l)).valid&&(d=X(c)).valid){e[o]=d.mix(u,n).rgbString();continue}}else if(ht.isFinite(l)&&ht.isFinite(c)){e[o]=l+(c-l)*n;continue}e[o]=c}}(n,r,i,t)):(e._view=i,e._start=null),e},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return ht.isNumber(this._model.x)&&ht.isNumber(this._model.y)}}),ft.extend=ht.inherits;var mt=ft,gt=mt.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),vt=gt;Object.defineProperty(gt.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(gt.prototype,"chartInstance",{get:function(){return this.chart},set:function(t){this.chart=t}}),st._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:ht.noop,onComplete:ht.noop}});var yt={animations:[],request:null,addAnimation:function(t,e,i,n){var r,a,o=this.animations;for(e.chart=t,e.startTime=Date.now(),e.duration=i,n||(t.animating=!0),r=0,a=o.length;r<a;++r)if(o[r].chart===t)return void(o[r]=e);o.push(e),1===o.length&&this.requestAnimationFrame()},cancelAnimation:function(e){var t=ht.findIndex(this.animations,function(t){return t.chart===e});-1!==t&&(this.animations.splice(t,1),e.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=ht.requestAnimFrame.call(window,function(){t.request=null,t.startDigest()}))},startDigest:function(){this.advance(),0<this.animations.length&&this.requestAnimationFrame()},advance:function(){for(var t,e,i,n,r=this.animations,a=0;a<r.length;)e=(t=r[a]).chart,i=t.numSteps,n=Math.floor((Date.now()-t.startTime)/t.duration*i)+1,t.currentStep=Math.min(n,i),ht.callback(t.render,[e,t],e),ht.callback(t.onAnimationProgress,[t],e),t.currentStep>=i?(ht.callback(t.onAnimationComplete,[t],e),e.animating=!1,r.splice(a,1)):++a}},_t=ht.options.resolve,bt=["push","pop","shift","splice","unshift"];function xt(e,t){var i=e._chartjs;if(i){var n=i.listeners,r=n.indexOf(t);-1!==r&&n.splice(r,1),0<n.length||(bt.forEach(function(t){delete e[t]}),delete e._chartjs)}}var wt=function(t,e){this.initialize(t,e)};ht.extend(wt.prototype,{datasetElementType:null,dataElementType:null,initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){var t=this,e=t.getMeta(),i=t.getDataset();null!==e.xAxisID&&e.xAxisID in t.chart.scales||(e.xAxisID=i.xAxisID||t.chart.options.scales.xAxes[0].id),null!==e.yAxisID&&e.yAxisID in t.chart.scales||(e.yAxisID=i.yAxisID||t.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this.update(!0)},destroy:function(){this._data&&xt(this._data,this)},createMetaDataset:function(){var t=this.datasetElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(t){var e=this.dataElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index,_index:t})},addElements:function(){var t,e,i=this.getMeta(),n=this.getDataset().data||[],r=i.data;for(t=0,e=n.length;t<e;++t)r[t]=r[t]||this.createMetaData(t);i.dataset=i.dataset||this.createMetaDataset()},addElementAndReset:function(t){var e=this.createMetaData(t);this.getMeta().data.splice(t,0,e),this.updateElement(e,t,!0)},buildOrUpdateElements:function(){var r,t,e=this,i=e.getDataset(),n=i.data||(i.data=[]);e._data!==n&&(e._data&&xt(e._data,e),n&&Object.isExtensible(n)&&(t=e,(r=n)._chartjs?r._chartjs.listeners.push(t):(Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),bt.forEach(function(t){var i="onData"+t.charAt(0).toUpperCase()+t.slice(1),n=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value:function(){var e=Array.prototype.slice.call(arguments),t=n.apply(this,e);return ht.each(r._chartjs.listeners,function(t){"function"==typeof t[i]&&t[i].apply(t,e)}),t}})}))),e._data=n),e.resyncElements()},update:ht.noop,transition:function(t){for(var e=this.getMeta(),i=e.data||[],n=i.length,r=0;r<n;++r)i[r].transition(t);e.dataset&&e.dataset.transition(t)},draw:function(){var t=this.getMeta(),e=t.data||[],i=e.length,n=0;for(t.dataset&&t.dataset.draw();n<i;++n)e[n].draw()},removeHoverStyle:function(t){ht.merge(t._model,t.$previousStyle||{}),delete t.$previousStyle},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},r=t._model,a=ht.getHoverColor;t.$previousStyle={backgroundColor:r.backgroundColor,borderColor:r.borderColor,borderWidth:r.borderWidth},r.backgroundColor=_t([n.hoverBackgroundColor,e.hoverBackgroundColor,a(r.backgroundColor)],void 0,i),r.borderColor=_t([n.hoverBorderColor,e.hoverBorderColor,a(r.borderColor)],void 0,i),r.borderWidth=_t([n.hoverBorderWidth,e.hoverBorderWidth,r.borderWidth],void 0,i)},resyncElements:function(){var t=this.getMeta(),e=this.getDataset().data,i=t.data.length,n=e.length;n<i?t.data.splice(n,i-n):i<n&&this.insertElements(i,n-i)},insertElements:function(t,e){for(var i=0;i<e;++i)this.addElementAndReset(t+i)},onDataPush:function(){var t=arguments.length;this.insertElements(this.getDataset().data.length-t,t)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(t,e){this.getMeta().data.splice(t,e),this.insertElements(t,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),wt.extend=ht.inherits;var Tt=wt;st._set("global",{elements:{arc:{backgroundColor:st.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var Mt=mt.extend({inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2)},inRange:function(t,e){var i=this._view;if(i){for(var n=ht.getAngleFromPoint(i,{x:t,y:e}),r=n.angle,a=n.distance,o=i.startAngle,s=i.endAngle;s<o;)s+=2*Math.PI;for(;s<r;)r-=2*Math.PI;for(;r<o;)r+=2*Math.PI;var l=o<=r&&r<=s,c=a>=i.innerRadius&&a<=i.outerRadius;return l&&c}return!1},getCenterPoint:function(){var t=this._view,e=(t.startAngle+t.endAngle)/2,i=(t.innerRadius+t.outerRadius)/2;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},getArea:function(){var t=this._view;return Math.PI*((t.endAngle-t.startAngle)/(2*Math.PI))*(Math.pow(t.outerRadius,2)-Math.pow(t.innerRadius,2))},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,i=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},draw:function(){var t,e=this._chart.ctx,i=this._view,n=i.startAngle,r=i.endAngle,a="inner"===i.borderAlign?.33:0;e.save(),e.beginPath(),e.arc(i.x,i.y,Math.max(i.outerRadius-a,0),n,r),e.arc(i.x,i.y,i.innerRadius,r,n,!0),e.closePath(),e.fillStyle=i.backgroundColor,e.fill(),i.borderWidth&&("inner"===i.borderAlign?(e.beginPath(),t=a/i.outerRadius,e.arc(i.x,i.y,i.outerRadius,n-t,r+t),i.innerRadius>a?(t=a/i.innerRadius,e.arc(i.x,i.y,i.innerRadius-a,r+t,n-t,!0)):e.arc(i.x,i.y,a,r+Math.PI/2,n-Math.PI/2),e.closePath(),e.clip(),e.beginPath(),e.arc(i.x,i.y,i.outerRadius,n,r),e.arc(i.x,i.y,i.innerRadius,r,n,!0),e.closePath(),e.lineWidth=2*i.borderWidth,e.lineJoin="round"):(e.lineWidth=i.borderWidth,e.lineJoin="bevel"),e.strokeStyle=i.borderColor,e.stroke()),e.restore()}}),St=ht.valueOrDefault,Et=st.global.defaultColor;st._set("global",{elements:{line:{tension:.4,backgroundColor:Et,borderWidth:3,borderColor:Et,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var Ct=mt.extend({draw:function(){var t,e,i,n,r=this._view,a=this._chart.ctx,o=r.spanGaps,s=this._children.slice(),l=st.global,c=l.elements.line,h=-1;for(this._loop&&s.length&&s.push(s[0]),a.save(),a.lineCap=r.borderCapStyle||c.borderCapStyle,a.setLineDash&&a.setLineDash(r.borderDash||c.borderDash),a.lineDashOffset=St(r.borderDashOffset,c.borderDashOffset),a.lineJoin=r.borderJoinStyle||c.borderJoinStyle,a.lineWidth=St(r.borderWidth,c.borderWidth),a.strokeStyle=r.borderColor||l.defaultColor,a.beginPath(),h=-1,t=0;t<s.length;++t)e=s[t],i=ht.previousItem(s,t),n=e._view,0===t?n.skip||(a.moveTo(n.x,n.y),h=t):(i=-1===h?i:s[h],n.skip||(h!==t-1&&!o||-1===h?a.moveTo(n.x,n.y):ht.canvas.lineTo(a,i._view,e._view),h=t));a.stroke(),a.restore()}}),Lt=ht.valueOrDefault,At=st.global.defaultColor;function Pt(t){var e=this._view;return!!e&&Math.abs(t-e.x)<e.radius+e.hitRadius}st._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:At,borderColor:At,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var Rt=mt.extend({inRange:function(t,e){var i=this._view;return!!i&&Math.pow(t-i.x,2)+Math.pow(e-i.y,2)<Math.pow(i.hitRadius+i.radius,2)},inLabelRange:Pt,inXRange:Pt,inYRange:function(t){var e=this._view;return!!e&&Math.abs(t-e.y)<e.radius+e.hitRadius},getCenterPoint:function(){var t=this._view;return{x:t.x,y:t.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(t){var e=this._view,i=this._chart.ctx,n=e.pointStyle,r=e.rotation,a=e.radius,o=e.x,s=e.y,l=st.global,c=l.defaultColor;e.skip||(void 0===t||ht.canvas._isPointInArea(e,t))&&(i.strokeStyle=e.borderColor||c,i.lineWidth=Lt(e.borderWidth,l.elements.point.borderWidth),i.fillStyle=e.backgroundColor||c,ht.canvas.drawPoint(i,n,a,o,s,r))}}),Ot=st.global.defaultColor;function It(t){return t&&void 0!==t.width}function Dt(t){var e,i,n,r,a;return r=It(t)?(a=t.width/2,e=t.x-a,i=t.x+a,n=Math.min(t.y,t.base),Math.max(t.y,t.base)):(a=t.height/2,e=Math.min(t.x,t.base),i=Math.max(t.x,t.base),n=t.y-a,t.y+a),{left:e,top:n,right:i,bottom:r}}function jt(t,e,i){return t===e?i:t===i?e:t}function kt(t,e,i){var n=null===e,r=null===i,a=!(!t||n&&r)&&Dt(t);return a&&(n||e>=a.left&&e<=a.right)&&(r||i>=a.top&&i<=a.bottom)}st._set("global",{elements:{rectangle:{backgroundColor:Ot,borderColor:Ot,borderSkipped:"bottom",borderWidth:0}}});var Nt=mt.extend({draw:function(){var t,e,i,n,r,a,o,s,l,c,h,u,d,p,f,m,g,v=this._chart.ctx,y=this._view,_=(p=Dt(t=y),f=p.right-p.left,m=p.bottom-p.top,i=f/2,n=m/2,u=(e=t).borderWidth,c=(l=e).borderSkipped,h={},c&&(l.horizontal?l.base>l.x&&(c=jt(c,"left","right")):l.base<l.y&&(c=jt(c,"bottom","top")),h[c]=!0),d=h,ht.isObject(u)?(r=+u.top||0,a=+u.right||0,o=+u.bottom||0,s=+u.left||0):r=a=o=s=+u||0,g={t:d.top||r<0?0:n<r?n:r,r:d.right||a<0?0:i<a?i:a,b:d.bottom||o<0?0:n<o?n:o,l:d.left||s<0?0:i<s?i:s},{outer:{x:p.left,y:p.top,w:f,h:m},inner:{x:p.left+g.l,y:p.top+g.t,w:f-g.l-g.r,h:m-g.t-g.b}}),b=_.outer,x=_.inner;v.fillStyle=y.backgroundColor,v.fillRect(b.x,b.y,b.w,b.h),b.w===x.w&&b.h===x.h||(v.save(),v.beginPath(),v.rect(b.x,b.y,b.w,b.h),v.clip(),v.fillStyle=y.borderColor,v.rect(x.x,x.y,x.w,x.h),v.fill("evenodd"),v.restore())},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){return kt(this._view,t,e)},inLabelRange:function(t,e){var i=this._view;return It(i)?kt(i,t,null):kt(i,null,e)},inXRange:function(t){return kt(this._view,t,null)},inYRange:function(t){return kt(this._view,null,t)},getCenterPoint:function(){var t,e,i=this._view;return e=It(i)?(t=i.x,(i.y+i.base)/2):(t=(i.x+i.base)/2,i.y),{x:t,y:e}},getArea:function(){var t=this._view;return It(t)?t.width*Math.abs(t.y-t.base):t.height*Math.abs(t.x-t.base)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}}),Ft={},Bt=Mt,Ht=Ct,Ut=Rt,zt=Nt;Ft.Arc=Bt,Ft.Line=Ht,Ft.Point=Ut,Ft.Rectangle=zt;var Vt=ht.options.resolve;st._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}});var Gt=Tt.extend({dataElementType:Ft.Rectangle,initialize:function(){var t;Tt.prototype.initialize.apply(this,arguments),(t=this.getMeta()).stack=this.getDataset().stack,t.bar=!0},update:function(t){var e,i,n=this.getMeta().data;for(this._ruler=this.getRuler(),e=0,i=n.length;e<i;++e)this.updateElement(n[e],e,t)},updateElement:function(t,e,i){var n=this,r=n.getMeta(),a=n.getDataset(),o=n._resolveElementOptions(t,e);t._xScale=n.getScaleForId(r.xAxisID),t._yScale=n.getScaleForId(r.yAxisID),t._datasetIndex=n.index,t._index=e,t._model={backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth,datasetLabel:a.label,label:n.chart.data.labels[e]},n._updateElementGeometry(t,e,i),t.pivot()},_updateElementGeometry:function(t,e,i){var n=this,r=t._model,a=n._getValueScale(),o=a.getBasePixel(),s=a.isHorizontal(),l=n._ruler||n.getRuler(),c=n.calculateBarValuePixels(n.index,e),h=n.calculateBarIndexPixels(n.index,e,l);r.horizontal=s,r.base=i?o:c.base,r.x=s?i?o:c.head:h.center,r.y=s?h.center:i?o:c.head,r.height=s?h.size:void 0,r.width=s?void 0:h.size},_getStacks:function(t){var e,i,n=this.chart,r=this._getIndexScale().options.stacked,a=void 0===t?n.data.datasets.length:t+1,o=[];for(e=0;e<a;++e)(i=n.getDatasetMeta(e)).bar&&n.isDatasetVisible(e)&&(!1===r||!0===r&&-1===o.indexOf(i.stack)||void 0===r&&(void 0===i.stack||-1===o.indexOf(i.stack)))&&o.push(i.stack);return o},getStackCount:function(){return this._getStacks().length},getStackIndex:function(t,e){var i=this._getStacks(t),n=void 0!==e?i.indexOf(e):-1;return-1===n?i.length-1:n},getRuler:function(){var t,e,i=this._getIndexScale(),n=this.getStackCount(),r=this.index,a=i.isHorizontal(),o=a?i.left:i.top,s=o+(a?i.width:i.height),l=[];for(t=0,e=this.getMeta().data.length;t<e;++t)l.push(i.getPixelForValue(null,t,r));return{min:ht.isNullOrUndef(i.options.barThickness)?function(t,e){var i,n,r,a,o=t.isHorizontal()?t.width:t.height,s=t.getTicks();for(r=1,a=e.length;r<a;++r)o=Math.min(o,Math.abs(e[r]-e[r-1]));for(r=0,a=s.length;r<a;++r)n=t.getPixelForTick(r),o=0<r?Math.min(o,n-i):o,i=n;return o}(i,l):-1,pixels:l,start:o,end:s,stackCount:n,scale:i}},calculateBarValuePixels:function(t,e){var i,n,r,a,o,s,l=this.chart,c=this.getMeta(),h=this._getValueScale(),u=h.isHorizontal(),d=l.data.datasets,p=+h.getRightValue(d[t].data[e]),f=h.options.minBarLength,m=h.options.stacked,g=c.stack,v=0;if(m||void 0===m&&void 0!==g)for(i=0;i<t;++i)(n=l.getDatasetMeta(i)).bar&&n.stack===g&&n.controller._getValueScaleId()===h.id&&l.isDatasetVisible(i)&&(r=+h.getRightValue(d[i].data[e]),(p<0&&r<0||0<=p&&0<r)&&(v+=r));return a=h.getPixelForValue(v),s=(o=h.getPixelForValue(v+p))-a,void 0!==f&&Math.abs(s)<f&&(s=f,o=0<=p&&!u||p<0&&u?a-f:a+f),{size:s,base:a,head:o,center:o+s/2}},calculateBarIndexPixels:function(t,e,i){var n,r,a,o,s,l,c,h,u,d,p,f,m,g,v,y,_,b=i.scale.options,x="flex"===b.barThickness?(u=e,p=b,m=(d=i).pixels,g=m[u],v=0<u?m[u-1]:null,y=u<m.length-1?m[u+1]:null,_=p.categoryPercentage,null===v&&(v=g-(null===y?d.end-d.start:y-g)),null===y&&(y=g+g-v),f=g-(g-Math.min(v,y))/2*_,{chunk:Math.abs(y-v)/2*_/d.stackCount,ratio:p.barPercentage,start:f}):(n=e,r=i,l=(a=b).barThickness,c=r.stackCount,h=r.pixels[n],s=ht.isNullOrUndef(l)?(o=r.min*a.categoryPercentage,a.barPercentage):(o=l*c,1),{chunk:o/c,ratio:s,start:h-o/2}),w=this.getStackIndex(t,this.getMeta().stack),T=x.start+x.chunk*w+x.chunk/2,M=Math.min(ht.valueOrDefault(b.maxBarThickness,1/0),x.chunk*x.ratio);return{base:T-M/2,head:T+M/2,center:T,size:M}},draw:function(){var t=this.chart,e=this._getValueScale(),i=this.getMeta().data,n=this.getDataset(),r=i.length,a=0;for(ht.canvas.clipArea(t.ctx,t.chartArea);a<r;++a)isNaN(e.getRightValue(n.data[a]))||i[a].draw();ht.canvas.unclipArea(t.ctx)},_resolveElementOptions:function(t,e){var i,n,r,a=this.chart,o=a.data.datasets[this.index],s=t.custom||{},l=a.options.elements.rectangle,c={},h={chart:a,dataIndex:e,dataset:o,datasetIndex:this.index},u=["backgroundColor","borderColor","borderSkipped","borderWidth"];for(i=0,n=u.length;i<n;++i)c[r=u[i]]=Vt([s[r],o[r],l[r]],h,e);return c}}),Wt=ht.valueOrDefault,Yt=ht.options.resolve;st._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.datasets[t.datasetIndex].label||"",n=e.datasets[t.datasetIndex].data[t.index];return i+": ("+t.xLabel+", "+t.yLabel+", "+n.r+")"}}}});var Xt=Tt.extend({dataElementType:Ft.Point,update:function(i){var n=this,t=n.getMeta().data;ht.each(t,function(t,e){n.updateElement(t,e,i)})},updateElement:function(t,e,i){var n=this,r=n.getMeta(),a=t.custom||{},o=n.getScaleForId(r.xAxisID),s=n.getScaleForId(r.yAxisID),l=n._resolveElementOptions(t,e),c=n.getDataset().data[e],h=n.index,u=i?o.getPixelForDecimal(.5):o.getPixelForValue("object"==typeof c?c:NaN,e,h),d=i?s.getBasePixel():s.getPixelForValue(c,e,h);t._xScale=o,t._yScale=s,t._options=l,t._datasetIndex=h,t._index=e,t._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:i?0:l.radius,skip:a.skip||isNaN(u)||isNaN(d),x:u,y:d},t.pivot()},setHoverStyle:function(t){var e=t._model,i=t._options,n=ht.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Wt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Wt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Wt(i.hoverBorderWidth,i.borderWidth),e.radius=i.radius+i.hoverRadius},_resolveElementOptions:function(t,e){var i,n,r,a=this.chart,o=a.data.datasets[this.index],s=t.custom||{},l=a.options.elements.point,c=o.data[e],h={},u={chart:a,dataIndex:e,dataset:o,datasetIndex:this.index},d=["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"];for(i=0,n=d.length;i<n;++i)h[r=d[i]]=Yt([s[r],o[r],l[r]],u,e);return h.radius=Yt([s.radius,c?c.r:void 0,o.radius,l.radius],u,e),h}}),qt=ht.options.resolve,Jt=ht.valueOrDefault;st._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,r=i.labels;if(n.length)for(var a=0;a<n[0].data.length;++a)e.push('<li><span style="background-color:'+n[0].backgroundColor[a]+'"></span>'),r[a]&&e.push(r[a]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(s){var l=s.data;return l.labels.length&&l.datasets.length?l.labels.map(function(t,e){var i=s.getDatasetMeta(0),n=l.datasets[0],r=i.data[e],a=r&&r.custom||{},o=s.options.elements.arc;return{text:t,fillStyle:qt([a.backgroundColor,n.backgroundColor,o.backgroundColor],void 0,e),strokeStyle:qt([a.borderColor,n.borderColor,o.borderColor],void 0,e),lineWidth:qt([a.borderWidth,n.borderWidth,o.borderWidth],void 0,e),hidden:isNaN(n.data[e])||i.data[e].hidden,index:e}}):[]}},onClick:function(t,e){var i,n,r,a=e.index,o=this.chart;for(i=0,n=(o.data.datasets||[]).length;i<n;++i)(r=o.getDatasetMeta(i)).data[a]&&(r.data[a].hidden=!r.data[a].hidden);o.update()}},cutoutPercentage:50,rotation:-.5*Math.PI,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.labels[t.index],n=": "+e.datasets[t.datasetIndex].data[t.index];return ht.isArray(i)?(i=i.slice())[0]+=n:i+=n,i}}}});var Zt=Tt.extend({dataElementType:Ft.Arc,linkScales:ht.noop,getRingIndex:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&++e;return e},update:function(t){var e,i,n=this,r=n.chart,a=r.chartArea,o=r.options,s=a.right-a.left,l=a.bottom-a.top,c=Math.min(s,l),h={x:0,y:0},u=n.getMeta(),d=u.data,p=o.cutoutPercentage,f=o.circumference,m=n._getRingWeight(n.index);if(f<2*Math.PI){var g=o.rotation%(2*Math.PI),v=(g+=2*Math.PI*(g>=Math.PI?-1:g<-Math.PI?1:0))+f,y=Math.cos(g),_=Math.sin(g),b=Math.cos(v),x=Math.sin(v),w=g<=0&&0<=v||g<=2*Math.PI&&2*Math.PI<=v,T=g<=.5*Math.PI&&.5*Math.PI<=v||g<=2.5*Math.PI&&2.5*Math.PI<=v,M=g<=-Math.PI&&-Math.PI<=v||g<=Math.PI&&Math.PI<=v,S=g<=.5*-Math.PI&&.5*-Math.PI<=v||g<=1.5*Math.PI&&1.5*Math.PI<=v,E=p/100,C=M?-1:Math.min(y*(y<0?1:E),b*(b<0?1:E)),L=S?-1:Math.min(_*(_<0?1:E),x*(x<0?1:E)),A=w?1:Math.max(y*(0<y?1:E),b*(0<b?1:E)),P=T?1:Math.max(_*(0<_?1:E),x*(0<x?1:E)),R=.5*(A-C),O=.5*(P-L);c=Math.min(s/R,l/O),h={x:-.5*(A+C),y:-.5*(P+L)}}for(e=0,i=d.length;e<i;++e)d[e]._options=n._resolveElementOptions(d[e],e);for(r.borderWidth=n.getMaxBorderWidth(),r.outerRadius=Math.max((c-r.borderWidth)/2,0),r.innerRadius=Math.max(p?r.outerRadius/100*p:0,0),r.radiusLength=(r.outerRadius-r.innerRadius)/(n._getVisibleDatasetWeightTotal()||1),r.offsetX=h.x*r.outerRadius,r.offsetY=h.y*r.outerRadius,u.total=n.calculateTotal(),n.outerRadius=r.outerRadius-r.radiusLength*n._getRingWeightOffset(n.index),n.innerRadius=Math.max(n.outerRadius-r.radiusLength*m,0),e=0,i=d.length;e<i;++e)n.updateElement(d[e],e,t)},updateElement:function(t,e,i){var n=this,r=n.chart,a=r.chartArea,o=r.options,s=o.animation,l=(a.left+a.right)/2,c=(a.top+a.bottom)/2,h=o.rotation,u=o.rotation,d=n.getDataset(),p=i&&s.animateRotate?0:t.hidden?0:n.calculateCircumference(d.data[e])*(o.circumference/(2*Math.PI)),f=i&&s.animateScale?0:n.innerRadius,m=i&&s.animateScale?0:n.outerRadius,g=t._options||{};ht.extend(t,{_datasetIndex:n.index,_index:e,_model:{backgroundColor:g.backgroundColor,borderColor:g.borderColor,borderWidth:g.borderWidth,borderAlign:g.borderAlign,x:l+r.offsetX,y:c+r.offsetY,startAngle:h,endAngle:u,circumference:p,outerRadius:m,innerRadius:f,label:ht.valueAtIndexOrDefault(d.label,e,r.data.labels[e])}});var v=t._model;i&&s.animateRotate||(v.startAngle=0===e?o.rotation:n.getMeta().data[e-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},calculateTotal:function(){var i,n=this.getDataset(),t=this.getMeta(),r=0;return ht.each(t.data,function(t,e){i=n.data[e],isNaN(i)||t.hidden||(r+=Math.abs(i))}),r},calculateCircumference:function(t){var e=this.getMeta().total;return 0<e&&!isNaN(t)?2*Math.PI*(Math.abs(t)/e):0},getMaxBorderWidth:function(t){var e,i,n,r,a,o,s,l,c=0,h=this.chart;if(!t)for(e=0,i=h.data.datasets.length;e<i;++e)if(h.isDatasetVisible(e)){t=(n=h.getDatasetMeta(e)).data,e!==this.index&&(a=n.controller);break}if(!t)return 0;for(e=0,i=t.length;e<i;++e)r=t[e],"inner"!==(o=a?a._resolveElementOptions(r,e):r._options).borderAlign&&(s=o.borderWidth,c=(l=o.hoverBorderWidth)>(c=c<s?s:c)?l:c);return c},setHoverStyle:function(t){var e=t._model,i=t._options,n=ht.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=Jt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Jt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Jt(i.hoverBorderWidth,i.borderWidth)},_resolveElementOptions:function(t,e){var i,n,r,a=this.chart,o=this.getDataset(),s=t.custom||{},l=a.options.elements.arc,c={},h={chart:a,dataIndex:e,dataset:o,datasetIndex:this.index},u=["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"];for(i=0,n=u.length;i<n;++i)c[r=u[i]]=qt([s[r],o[r],l[r]],h,e);return c},_getRingWeightOffset:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e},_getRingWeight:function(t){return Math.max(Jt(this.chart.data.datasets[t].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});st._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}});var Qt=Gt.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),Kt=ht.valueOrDefault,$t=ht.options.resolve,te=ht.canvas._isPointInArea;function ee(t,e){return Kt(t.showLine,e.showLines)}st._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var ie=Tt.extend({datasetElementType:Ft.Line,dataElementType:Ft.Point,update:function(t){var e,i,n=this,r=n.getMeta(),a=r.dataset,o=r.data||[],s=n.getScaleForId(r.yAxisID),l=n.getDataset(),c=ee(l,n.chart.options);for(c&&(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),a._scale=s,a._datasetIndex=n.index,a._children=o,a._model=n._resolveLineOptions(a),a.pivot()),e=0,i=o.length;e<i;++e)n.updateElement(o[e],e,t);for(c&&0!==a._model.tension&&n.updateBezierControlPoints(),e=0,i=o.length;e<i;++e)o[e].pivot()},updateElement:function(t,e,i){var n,r,a=this,o=a.getMeta(),s=t.custom||{},l=a.getDataset(),c=a.index,h=l.data[e],u=a.getScaleForId(o.yAxisID),d=a.getScaleForId(o.xAxisID),p=o.dataset._model,f=a._resolvePointOptions(t,e);n=d.getPixelForValue("object"==typeof h?h:NaN,e,c),r=i?u.getBasePixel():a.calculatePointY(h,e,c),t._xScale=d,t._yScale=u,t._options=f,t._datasetIndex=c,t._index=e,t._model={x:n,y:r,skip:s.skip||isNaN(n)||isNaN(r),radius:f.radius,pointStyle:f.pointStyle,rotation:f.rotation,backgroundColor:f.backgroundColor,borderColor:f.borderColor,borderWidth:f.borderWidth,tension:Kt(s.tension,p?p.tension:0),steppedLine:!!p&&p.steppedLine,hitRadius:f.hitRadius}},_resolvePointOptions:function(t,e){var i,n,r,a=this.chart,o=a.data.datasets[this.index],s=t.custom||{},l=a.options.elements.point,c={},h={chart:a,dataIndex:e,dataset:o,datasetIndex:this.index},u={backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},d=Object.keys(u);for(i=0,n=d.length;i<n;++i)c[r=d[i]]=$t([s[r],o[u[r]],o[r],l[r]],h,e);return c},_resolveLineOptions:function(t){var e,i,n,r=this.chart,a=r.data.datasets[this.index],o=t.custom||{},s=r.options,l=s.elements.line,c={},h=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill","cubicInterpolationMode"];for(e=0,i=h.length;e<i;++e)c[n=h[e]]=$t([o[n],a[n],l[n]]);return c.spanGaps=Kt(a.spanGaps,s.spanGaps),c.tension=Kt(a.lineTension,l.tension),c.steppedLine=$t([o.steppedLine,a.steppedLine,l.stepped]),c},calculatePointY:function(t,e,i){var n,r,a,o=this.chart,s=this.getMeta(),l=this.getScaleForId(s.yAxisID),c=0,h=0;if(l.options.stacked){for(n=0;n<i;n++)if(r=o.data.datasets[n],"line"===(a=o.getDatasetMeta(n)).type&&a.yAxisID===l.id&&o.isDatasetVisible(n)){var u=Number(l.getRightValue(r.data[e]));u<0?h+=u||0:c+=u||0}var d=Number(l.getRightValue(t));return d<0?l.getPixelForValue(h+d):l.getPixelForValue(c+d)}return l.getPixelForValue(t)},updateBezierControlPoints:function(){var t,e,i,n,r=this.chart,a=this.getMeta(),o=a.dataset._model,s=r.chartArea,l=a.data||[];function c(t,e,i){return Math.max(Math.min(t,i),e)}if(o.spanGaps&&(l=l.filter(function(t){return!t._model.skip})),"monotone"===o.cubicInterpolationMode)ht.splineCurveMonotone(l);else for(t=0,e=l.length;t<e;++t)i=l[t]._model,n=ht.splineCurve(ht.previousItem(l,t)._model,i,ht.nextItem(l,t)._model,o.tension),i.controlPointPreviousX=n.previous.x,i.controlPointPreviousY=n.previous.y,i.controlPointNextX=n.next.x,i.controlPointNextY=n.next.y;if(r.options.elements.line.capBezierPoints)for(t=0,e=l.length;t<e;++t)i=l[t]._model,te(i,s)&&(0<t&&te(l[t-1]._model,s)&&(i.controlPointPreviousX=c(i.controlPointPreviousX,s.left,s.right),i.controlPointPreviousY=c(i.controlPointPreviousY,s.top,s.bottom)),t<l.length-1&&te(l[t+1]._model,s)&&(i.controlPointNextX=c(i.controlPointNextX,s.left,s.right),i.controlPointNextY=c(i.controlPointNextY,s.top,s.bottom)))},draw:function(){var t,e=this.chart,i=this.getMeta(),n=i.data||[],r=e.chartArea,a=n.length,o=0;for(ee(this.getDataset(),e.options)&&(t=(i.dataset._model.borderWidth||0)/2,ht.canvas.clipArea(e.ctx,{left:r.left,right:r.right,top:r.top-t,bottom:r.bottom+t}),i.dataset.draw(),ht.canvas.unclipArea(e.ctx));o<a;++o)n[o].draw(r)},setHoverStyle:function(t){var e=t._model,i=t._options,n=ht.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Kt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Kt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Kt(i.hoverBorderWidth,i.borderWidth),e.radius=Kt(i.hoverRadius,i.radius)}}),ne=ht.options.resolve;st._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,r=i.labels;if(n.length)for(var a=0;a<n[0].data.length;++a)e.push('<li><span style="background-color:'+n[0].backgroundColor[a]+'"></span>'),r[a]&&e.push(r[a]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(o){var s=o.data;return s.labels.length&&s.datasets.length?s.labels.map(function(t,e){var i=o.getDatasetMeta(0),n=s.datasets[0],r=i.data[e].custom||{},a=o.options.elements.arc;return{text:t,fillStyle:ne([r.backgroundColor,n.backgroundColor,a.backgroundColor],void 0,e),strokeStyle:ne([r.borderColor,n.borderColor,a.borderColor],void 0,e),lineWidth:ne([r.borderWidth,n.borderWidth,a.borderWidth],void 0,e),hidden:isNaN(n.data[e])||i.data[e].hidden,index:e}}):[]}},onClick:function(t,e){var i,n,r,a=e.index,o=this.chart;for(i=0,n=(o.data.datasets||[]).length;i<n;++i)(r=o.getDatasetMeta(i)).data[a].hidden=!r.data[a].hidden;o.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}});var re=Tt.extend({dataElementType:Ft.Arc,linkScales:ht.noop,update:function(t){var e,i,n,r=this,a=r.getDataset(),o=r.getMeta(),s=r.chart.options.startAngle||0,l=r._starts=[],c=r._angles=[],h=o.data;for(r._updateRadius(),o.count=r.countVisibleElements(),e=0,i=a.data.length;e<i;e++)l[e]=s,n=r._computeAngle(e),s+=c[e]=n;for(e=0,i=h.length;e<i;++e)h[e]._options=r._resolveElementOptions(h[e],e),r.updateElement(h[e],e,t)},_updateRadius:function(){var t=this,e=t.chart,i=e.chartArea,n=e.options,r=Math.min(i.right-i.left,i.bottom-i.top);e.outerRadius=Math.max(r/2,0),e.innerRadius=Math.max(n.cutoutPercentage?e.outerRadius/100*n.cutoutPercentage:1,0),e.radiusLength=(e.outerRadius-e.innerRadius)/e.getVisibleDatasetCount(),t.outerRadius=e.outerRadius-e.radiusLength*t.index,t.innerRadius=t.outerRadius-e.radiusLength},updateElement:function(t,e,i){var n=this,r=n.chart,a=n.getDataset(),o=r.options,s=o.animation,l=r.scale,c=r.data.labels,h=l.xCenter,u=l.yCenter,d=o.startAngle,p=t.hidden?0:l.getDistanceFromCenterForValue(a.data[e]),f=n._starts[e],m=f+(t.hidden?0:n._angles[e]),g=s.animateScale?0:l.getDistanceFromCenterForValue(a.data[e]),v=t._options||{};ht.extend(t,{_datasetIndex:n.index,_index:e,_scale:l,_model:{backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,borderAlign:v.borderAlign,x:h,y:u,innerRadius:0,outerRadius:i?g:p,startAngle:i&&s.animateRotate?d:f,endAngle:i&&s.animateRotate?d:m,label:ht.valueAtIndexOrDefault(c,e,c[e])}}),t.pivot()},countVisibleElements:function(){var i=this.getDataset(),t=this.getMeta(),n=0;return ht.each(t.data,function(t,e){isNaN(i.data[e])||t.hidden||n++}),n},setHoverStyle:function(t){var e=t._model,i=t._options,n=ht.getHoverColor,r=ht.valueOrDefault;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=r(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=r(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=r(i.hoverBorderWidth,i.borderWidth)},_resolveElementOptions:function(t,e){var i,n,r,a=this.chart,o=this.getDataset(),s=t.custom||{},l=a.options.elements.arc,c={},h={chart:a,dataIndex:e,dataset:o,datasetIndex:this.index},u=["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"];for(i=0,n=u.length;i<n;++i)c[r=u[i]]=ne([s[r],o[r],l[r]],h,e);return c},_computeAngle:function(t){var e=this,i=this.getMeta().count,n=e.getDataset(),r=e.getMeta();if(isNaN(n.data[t])||r.data[t].hidden)return 0;var a={chart:e.chart,dataIndex:t,dataset:n,datasetIndex:e.index};return ne([e.chart.options.elements.arc.angle,2*Math.PI/i],a,t)}});st._set("pie",ht.clone(st.doughnut)),st._set("pie",{cutoutPercentage:0});var ae=Zt,oe=ht.valueOrDefault,se=ht.options.resolve;st._set("radar",{scale:{type:"radialLinear"},elements:{line:{tension:0}}});var le=Tt.extend({datasetElementType:Ft.Line,dataElementType:Ft.Point,linkScales:ht.noop,update:function(t){var e,i,n=this,r=n.getMeta(),a=r.dataset,o=r.data||[],s=n.chart.scale,l=n.getDataset();for(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),a._scale=s,a._datasetIndex=n.index,a._children=o,a._loop=!0,a._model=n._resolveLineOptions(a),a.pivot(),e=0,i=o.length;e<i;++e)n.updateElement(o[e],e,t);for(n.updateBezierControlPoints(),e=0,i=o.length;e<i;++e)o[e].pivot()},updateElement:function(t,e,i){var n=this,r=t.custom||{},a=n.getDataset(),o=n.chart.scale,s=o.getPointPositionForValue(e,a.data[e]),l=n._resolvePointOptions(t,e),c=n.getMeta().dataset._model,h=i?o.xCenter:s.x,u=i?o.yCenter:s.y;t._scale=o,t._options=l,t._datasetIndex=n.index,t._index=e,t._model={x:h,y:u,skip:r.skip||isNaN(h)||isNaN(u),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:oe(r.tension,c?c.tension:0),hitRadius:l.hitRadius}},_resolvePointOptions:function(t,e){var i,n,r,a=this.chart,o=a.data.datasets[this.index],s=t.custom||{},l=a.options.elements.point,c={},h={chart:a,dataIndex:e,dataset:o,datasetIndex:this.index},u={backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},d=Object.keys(u);for(i=0,n=d.length;i<n;++i)c[r=d[i]]=se([s[r],o[u[r]],o[r],l[r]],h,e);return c},_resolveLineOptions:function(t){var e,i,n,r=this.chart,a=r.data.datasets[this.index],o=t.custom||{},s=r.options.elements.line,l={},c=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"];for(e=0,i=c.length;e<i;++e)l[n=c[e]]=se([o[n],a[n],s[n]]);return l.tension=oe(a.lineTension,s.tension),l},updateBezierControlPoints:function(){var t,e,i,n,r=this.getMeta(),a=this.chart.chartArea,o=r.data||[];function s(t,e,i){return Math.max(Math.min(t,i),e)}for(t=0,e=o.length;t<e;++t)i=o[t]._model,n=ht.splineCurve(ht.previousItem(o,t,!0)._model,i,ht.nextItem(o,t,!0)._model,i.tension),i.controlPointPreviousX=s(n.previous.x,a.left,a.right),i.controlPointPreviousY=s(n.previous.y,a.top,a.bottom),i.controlPointNextX=s(n.next.x,a.left,a.right),i.controlPointNextY=s(n.next.y,a.top,a.bottom)},setHoverStyle:function(t){var e=t._model,i=t._options,n=ht.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=oe(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=oe(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=oe(i.hoverBorderWidth,i.borderWidth),e.radius=oe(i.hoverRadius,i.radius)}});st._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},showLines:!1,tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}});var ce={bar:Gt,bubble:Xt,doughnut:Zt,horizontalBar:Qt,line:ie,polarArea:re,pie:ae,radar:le,scatter:ie};function he(t,e){return t.native?{x:t.x,y:t.y}:ht.getRelativePosition(t,e)}function ue(t,e){var i,n,r,a,o;for(n=0,a=t.data.datasets.length;n<a;++n)if(t.isDatasetVisible(n))for(r=0,o=(i=t.getDatasetMeta(n)).data.length;r<o;++r){var s=i.data[r];s._view.skip||e(s)}}function de(t,e){var i=[];return ue(t,function(t){t.inRange(e.x,e.y)&&i.push(t)}),i}function pe(t,n,r,a){var o=Number.POSITIVE_INFINITY,s=[];return ue(t,function(t){if(!r||t.inRange(n.x,n.y)){var e=t.getCenterPoint(),i=a(n,e);i<o?(s=[t],o=i):i===o&&s.push(t)}}),s}function fe(t){var r=-1!==t.indexOf("x"),a=-1!==t.indexOf("y");return function(t,e){var i=r?Math.abs(t.x-e.x):0,n=a?Math.abs(t.y-e.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(n,2))}}function me(n,t,e){var i=he(t,n);e.axis=e.axis||"x";var r=fe(e.axis),a=e.intersect?de(n,i):pe(n,i,!1,r),o=[];return a.length?(n.data.datasets.forEach(function(t,e){if(n.isDatasetVisible(e)){var i=n.getDatasetMeta(e).data[a[0]._index];i&&!i._view.skip&&o.push(i)}}),o):[]}var ge={modes:{single:function(t,e){var i=he(e,t),n=[];return ue(t,function(t){if(t.inRange(i.x,i.y))return n.push(t),n}),n.slice(0,1)},label:me,index:me,dataset:function(t,e,i){var n=he(e,t);i.axis=i.axis||"xy";var r=fe(i.axis),a=i.intersect?de(t,n):pe(t,n,!1,r);return 0<a.length&&(a=t.getDatasetMeta(a[0]._datasetIndex).data),a},"x-axis":function(t,e){return me(t,e,{intersect:!1})},point:function(t,e){return de(t,he(e,t))},nearest:function(t,e,i){var n=he(e,t);i.axis=i.axis||"xy";var r=fe(i.axis);return pe(t,n,i.intersect,r)},x:function(t,e,i){var n=he(e,t),r=[],a=!1;return ue(t,function(t){t.inXRange(n.x)&&r.push(t),t.inRange(n.x,n.y)&&(a=!0)}),i.intersect&&!a&&(r=[]),r},y:function(t,e,i){var n=he(e,t),r=[],a=!1;return ue(t,function(t){t.inYRange(n.y)&&r.push(t),t.inRange(n.x,n.y)&&(a=!0)}),i.intersect&&!a&&(r=[]),r}}};function ve(t,e){return ht.where(t,function(t){return t.position===e})}function ye(t,r){t.forEach(function(t,e){return t._tmpIndex_=e,t}),t.sort(function(t,e){var i=r?e:t,n=r?t:e;return i.weight===n.weight?i._tmpIndex_-n._tmpIndex_:i.weight-n.weight}),t.forEach(function(t){delete t._tmpIndex_})}function _e(t,e){ht.each(t,function(t){e[t.position]+=t.isHorizontal()?t.height:t.width})}st._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var be,xe={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),e.fullWidth=e.fullWidth||!1,e.position=e.position||"top",e.weight=e.weight||0,t.boxes.push(e)},removeBox:function(t,e){var i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure:function(t,e,i){for(var n,r=["fullWidth","position","weight"],a=r.length,o=0;o<a;++o)n=r[o],i.hasOwnProperty(n)&&(e[n]=i[n])},update:function(e,i,t){if(e){var n=e.options.layout||{},r=ht.options.toPadding(n.padding),a=r.left,o=r.right,s=r.top,l=r.bottom,c=ve(e.boxes,"left"),h=ve(e.boxes,"right"),u=ve(e.boxes,"top"),d=ve(e.boxes,"bottom"),p=ve(e.boxes,"chartArea");ye(c,!0),ye(h,!1),ye(u,!0),ye(d,!1);var f,m=c.concat(h),g=u.concat(d),v=m.concat(g),y=i-a-o,_=t-s-l,b=(i-y/2)/m.length,x=y,w=_,T={top:s,left:a,bottom:l,right:o},M=[];ht.each(v,function(t){var e,i=t.isHorizontal();i?(e=t.update(t.fullWidth?y:x,_/2),w-=e.height):(e=t.update(b,w),x-=e.width),M.push({horizontal:i,width:e.width,box:t})}),R=v,j=D=I=O=0,ht.each(R,function(t){if(t.getPadding){var e=t.getPadding();O=Math.max(O,e.top),I=Math.max(I,e.left),D=Math.max(D,e.bottom),j=Math.max(j,e.right)}}),f={top:O,left:I,bottom:D,right:j},ht.each(m,k),_e(m,T),ht.each(g,k),_e(g,T),ht.each(m,function(e){var t=ht.findNextWhere(M,function(t){return t.box===e}),i={left:0,right:0,top:T.top,bottom:T.bottom};t&&e.update(t.width,w,i)}),_e(v,T={top:s,left:a,bottom:l,right:o});var S=Math.max(f.left-T.left,0);T.left+=S,T.right+=Math.max(f.right-T.right,0);var E=Math.max(f.top-T.top,0);T.top+=E,T.bottom+=Math.max(f.bottom-T.bottom,0);var C=t-T.top-T.bottom,L=i-T.left-T.right;L===x&&C===w||(ht.each(m,function(t){t.height=C}),ht.each(g,function(t){t.fullWidth||(t.width=L)}),w=C,x=L);var A=a+S,P=s+E;ht.each(c.concat(u),N),A+=x,P+=w,ht.each(h,N),ht.each(d,N),e.chartArea={left:T.left,top:T.top,right:T.left+x,bottom:T.top+w},ht.each(p,function(t){t.left=e.chartArea.left,t.top=e.chartArea.top,t.right=e.chartArea.right,t.bottom=e.chartArea.bottom,t.update(x,w)})}var R,O,I,D,j;function k(e){var t=ht.findNextWhere(M,function(t){return t.box===e});if(t)if(t.horizontal){var i={left:Math.max(T.left,f.left),right:Math.max(T.right,f.right),top:0,bottom:0};e.update(e.fullWidth?y:x,_/2,i)}else e.update(t.width,w)}function N(t){t.isHorizontal()?(t.left=t.fullWidth?a:T.left,t.right=t.fullWidth?i-o:T.left+x,t.top=P,t.bottom=P+t.height,P=t.bottom):(t.left=A,t.right=A+t.width,t.top=T.top,t.bottom=T.top+w,A=t.right)}}},we=(be=Object.freeze({default:"@keyframes chartjs-render-animation{from{opacity:.99}to{opacity:1}}.chartjs-render-monitor{animation:chartjs-render-animation 1ms}.chartjs-size-monitor,.chartjs-size-monitor-expand,.chartjs-size-monitor-shrink{position:absolute;direction:ltr;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1}.chartjs-size-monitor-expand>div{position:absolute;width:1000000px;height:1000000px;left:0;top:0}.chartjs-size-monitor-shrink>div{position:absolute;width:200%;height:200%;left:0;top:0}"}))&&be.default||be,Te="$chartjs",Me="chartjs-size-monitor",Se="chartjs-render-monitor",Ee=["animationstart","webkitAnimationStart"],Ce={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function Le(t,e){var i=ht.getStyle(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?Number(n[1]):void 0}var Ae=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("e",null,e)}catch(t){}return t}()&&{passive:!0};function Pe(t,e,i){t.addEventListener(e,i,Ae)}function Re(t,e,i){t.removeEventListener(e,i,Ae)}function Oe(t,e,i,n,r){return{type:t,chart:e,native:r||null,x:void 0!==i?i:null,y:void 0!==n?n:null}}function Ie(t){var e=document.createElement("div");return e.className=t||"",e}function De(i,n,r){var t,e,a,o,s,l,c,h=i[Te]||(i[Te]={}),u=h.resizer=function(t){var e=Ie(Me),i=Ie(Me+"-expand"),n=Ie(Me+"-shrink");i.appendChild(Ie()),n.appendChild(Ie()),e.appendChild(i),e.appendChild(n),e._reset=function(){i.scrollLeft=1e6,i.scrollTop=1e6,n.scrollLeft=1e6,n.scrollTop=1e6};var r=function(){e._reset(),t()};return Pe(i,"scroll",r.bind(i,"expand")),Pe(n,"scroll",r.bind(n,"shrink")),e}((a=!(t=function(){if(h.resizer){var t=r.options.maintainAspectRatio&&i.parentNode,e=t?t.clientWidth:0;n(Oe("resize",r)),t&&t.clientWidth<e&&r.canvas&&n(Oe("resize",r))}}),o=[],function(){o=Array.prototype.slice.call(arguments),e=e||this,a||(a=!0,ht.requestAnimFrame.call(window,function(){a=!1,t.apply(e,o)}))}));l=(s=i)[Te]||(s[Te]={}),c=l.renderProxy=function(t){"chartjs-render-animation"===t.animationName&&function(){if(h.resizer){var t=i.parentNode;t&&t!==u.parentNode&&t.insertBefore(u,t.firstChild),u._reset()}}()},ht.each(Ee,function(t){Pe(s,t,c)}),l.reflow=!!s.offsetParent,s.classList.add(Se)}var je={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(){var t,e;this._loaded||(this._loaded=!0,this.disableCSSInjection||(t=we,e=this._style||document.createElement("style"),this._style||(t="/* Chart.js */\n"+t,(this._style=e).setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(e)),e.appendChild(document.createTextNode(t))))},acquireContext:function(t,e){"string"==typeof t?t=document.getElementById(t):t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas);var i=t&&t.getContext&&t.getContext("2d");return this._ensureLoaded(),i&&i.canvas===t?(function(t,e){var i=t.style,n=t.getAttribute("height"),r=t.getAttribute("width");if(t[Te]={initial:{height:n,width:r,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",null===r||""===r){var a=Le(t,"width");void 0!==a&&(t.width=a)}if(null===n||""===n)if(""===t.style.height)t.height=t.width/(e.options.aspectRatio||2);else{var o=Le(t,"height");void 0!==a&&(t.height=o)}}(t,e),i):null},releaseContext:function(t){var i=t.canvas;if(i[Te]){var n=i[Te].initial;["height","width"].forEach(function(t){var e=n[t];ht.isNullOrUndef(e)?i.removeAttribute(t):i.setAttribute(t,e)}),ht.each(n.style||{},function(t,e){i.style[e]=t}),i.width=i.width,delete i[Te]}},addEventListener:function(a,t,o){var e=a.canvas;if("resize"!==t){var i=o[Te]||(o[Te]={});Pe(e,t,(i.proxies||(i.proxies={}))[a.id+"_"+t]=function(t){var e,i,n,r;o((i=a,n=Ce[(e=t).type]||e.type,r=ht.getRelativePosition(e,i),Oe(n,i,r.x,r.y,e)))})}else De(e,o,a)},removeEventListener:function(t,e,i){var n,r,a,o,s,l,c=t.canvas;if("resize"!==e){var h=((i[Te]||{}).proxies||{})[t.id+"_"+e];h&&Re(c,e,h)}else s=(n=c)[Te]||{},l=s.resizer,delete s.resizer,a=(r=n)[Te]||{},(o=a.renderProxy)&&(ht.each(Ee,function(t){Re(r,t,o)}),delete a.renderProxy),r.classList.remove(Se),l&&l.parentNode&&l.parentNode.removeChild(l)}};ht.addEvent=Pe,ht.removeEvent=Re;var ke=je._enabled?je:{acquireContext:function(t){return t&&t.canvas&&(t=t.canvas),t&&t.getContext("2d")||null}},Ne=ht.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},ke);st._set("global",{plugins:{}});var Fe={_plugins:[],_cacheId:0,register:function(t){var e=this._plugins;[].concat(t).forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),this._cacheId++},unregister:function(t){var i=this._plugins;[].concat(t).forEach(function(t){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e,i){var n,r,a,o,s,l=this.descriptors(t),c=l.length;for(n=0;n<c;++n)if("function"==typeof(s=(a=(r=l[n]).plugin)[e])&&((o=[t].concat(i||[])).push(r.options),!1===s.apply(a,o)))return!1;return!0},descriptors:function(t){var e=t.$plugins||(t.$plugins={});if(e.id===this._cacheId)return e.descriptors;var n=[],r=[],i=t&&t.config||{},a=i.options&&i.options.plugins||{};return this._plugins.concat(i.plugins||[]).forEach(function(t){if(-1===n.indexOf(t)){var e=t.id,i=a[e];!1!==i&&(!0===i&&(i=ht.clone(st.global.plugins[e])),n.push(t),r.push({plugin:t,options:i||{}}))}}),e.descriptors=r,e.id=this._cacheId,r},_invalidate:function(t){delete t.$plugins}},Be={constructors:{},defaults:{},registerScaleType:function(t,e,i){this.constructors[t]=e,this.defaults[t]=ht.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(t){return this.defaults.hasOwnProperty(t)?ht.merge({},[st.scale,this.defaults[t]]):{}},updateScaleDefaults:function(t,e){this.defaults.hasOwnProperty(t)&&(this.defaults[t]=ht.extend(this.defaults[t],e))},addScalesToLayout:function(e){ht.each(e.scales,function(t){t.fullWidth=t.options.fullWidth,t.position=t.options.position,t.weight=t.options.weight,xe.addBox(e,t)})}},He=ht.valueOrDefault;st._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:ht.noop,title:function(t,e){var i="",n=e.labels,r=n?n.length:0;if(0<t.length){var a=t[0];a.label?i=a.label:a.xLabel?i=a.xLabel:0<r&&a.index<r&&(i=n[a.index])}return i},afterTitle:ht.noop,beforeBody:ht.noop,beforeLabel:ht.noop,label:function(t,e){var i=e.datasets[t.datasetIndex].label||"";return i&&(i+=": "),ht.isNullOrUndef(t.value)?i+=t.yLabel:i+=t.value,i},labelColor:function(t,e){var i=e.getDatasetMeta(t.datasetIndex).data[t.index]._view;return{borderColor:i.borderColor,backgroundColor:i.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:ht.noop,afterBody:ht.noop,beforeFooter:ht.noop,footer:ht.noop,afterFooter:ht.noop}}});var Ue={average:function(t){if(!t.length)return!1;var e,i,n=0,r=0,a=0;for(e=0,i=t.length;e<i;++e){var o=t[e];if(o&&o.hasValue()){var s=o.tooltipPosition();n+=s.x,r+=s.y,++a}}return{x:n/a,y:r/a}},nearest:function(t,e){var i,n,r,a=e.x,o=e.y,s=Number.POSITIVE_INFINITY;for(i=0,n=t.length;i<n;++i){var l=t[i];if(l&&l.hasValue()){var c=l.getCenterPoint(),h=ht.distanceBetweenPoints(e,c);h<s&&(s=h,r=l)}}if(r){var u=r.tooltipPosition();a=u.x,o=u.y}return{x:a,y:o}}};function ze(t,e){return e&&(ht.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ve(t){return("string"==typeof t||t instanceof String)&&-1<t.indexOf("\n")?t.split("\n"):t}function Ge(t){var e=st.global;return{xPadding:t.xPadding,yPadding:t.yPadding,xAlign:t.xAlign,yAlign:t.yAlign,bodyFontColor:t.bodyFontColor,_bodyFontFamily:He(t.bodyFontFamily,e.defaultFontFamily),_bodyFontStyle:He(t.bodyFontStyle,e.defaultFontStyle),_bodyAlign:t.bodyAlign,bodyFontSize:He(t.bodyFontSize,e.defaultFontSize),bodySpacing:t.bodySpacing,titleFontColor:t.titleFontColor,_titleFontFamily:He(t.titleFontFamily,e.defaultFontFamily),_titleFontStyle:He(t.titleFontStyle,e.defaultFontStyle),titleFontSize:He(t.titleFontSize,e.defaultFontSize),_titleAlign:t.titleAlign,titleSpacing:t.titleSpacing,titleMarginBottom:t.titleMarginBottom,footerFontColor:t.footerFontColor,_footerFontFamily:He(t.footerFontFamily,e.defaultFontFamily),_footerFontStyle:He(t.footerFontStyle,e.defaultFontStyle),footerFontSize:He(t.footerFontSize,e.defaultFontSize),_footerAlign:t.footerAlign,footerSpacing:t.footerSpacing,footerMarginTop:t.footerMarginTop,caretSize:t.caretSize,cornerRadius:t.cornerRadius,backgroundColor:t.backgroundColor,opacity:0,legendColorBackground:t.multiKeyBackground,displayColors:t.displayColors,borderColor:t.borderColor,borderWidth:t.borderWidth}}function We(t,e){return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-t.xPadding:t.x+t.xPadding}function Ye(t){return ze([],Ve(t))}var Xe=mt.extend({initialize:function(){this._model=Ge(this._options),this._lastActive=[]},getTitle:function(){var t=this._options.callbacks,e=t.beforeTitle.apply(this,arguments),i=t.title.apply(this,arguments),n=t.afterTitle.apply(this,arguments),r=[];return ze(r=ze(r=ze(r,Ve(e)),Ve(i)),Ve(n))},getBeforeBody:function(){return Ye(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(t,i){var n=this,r=n._options.callbacks,a=[];return ht.each(t,function(t){var e={before:[],lines:[],after:[]};ze(e.before,Ve(r.beforeLabel.call(n,t,i))),ze(e.lines,r.label.call(n,t,i)),ze(e.after,Ve(r.afterLabel.call(n,t,i))),a.push(e)}),a},getAfterBody:function(){return Ye(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var t=this._options.callbacks,e=t.beforeFooter.apply(this,arguments),i=t.footer.apply(this,arguments),n=t.afterFooter.apply(this,arguments),r=[];return ze(r=ze(r=ze(r,Ve(e)),Ve(i)),Ve(n))},update:function(t){var e,i,n,r,a,o,s,l,c,h,u,d,p,f,m,g,v,y,_,b,x,w,T,M=this,S=M._options,E=M._model,C=M._model=Ge(S),L=M._active,A=M._data,P={xAlign:E.xAlign,yAlign:E.yAlign},R={x:E.x,y:E.y},O={width:E.width,height:E.height},I={x:E.caretX,y:E.caretY};if(L.length){C.opacity=1;var D=[],j=[];I=Ue[S.position].call(M,L,M._eventPosition);var k=[];for(e=0,i=L.length;e<i;++e)k.push((h=c=l=a=r=void 0,r=(n=L[e])._xScale,a=n._yScale||n._scale,o=n._index,s=n._datasetIndex,c=(l=n._chart.getDatasetMeta(s).controller)._getIndexScale(),h=l._getValueScale(),{xLabel:r?r.getLabelForIndex(o,s):"",yLabel:a?a.getLabelForIndex(o,s):"",label:c?""+c.getLabelForIndex(o,s):"",value:h?""+h.getLabelForIndex(o,s):"",index:o,datasetIndex:s,x:n._model.x,y:n._model.y}));S.filter&&(k=k.filter(function(t){return S.filter(t,A)})),S.itemSort&&(k=k.sort(function(t,e){return S.itemSort(t,e,A)})),ht.each(k,function(t){D.push(S.callbacks.labelColor.call(M,t,M._chart)),j.push(S.callbacks.labelTextColor.call(M,t,M._chart))}),C.title=M.getTitle(k,A),C.beforeBody=M.getBeforeBody(k,A),C.body=M.getBody(k,A),C.afterBody=M.getAfterBody(k,A),C.footer=M.getFooter(k,A),C.x=I.x,C.y=I.y,C.caretPadding=S.caretPadding,C.labelColors=D,C.labelTextColors=j,C.dataPoints=k,O=function(t,e){var i=t._chart.ctx,n=2*e.yPadding,r=0,a=e.body,o=a.reduce(function(t,e){return t+e.before.length+e.lines.length+e.after.length},0);o+=e.beforeBody.length+e.afterBody.length;var s=e.title.length,l=e.footer.length,c=e.titleFontSize,h=e.bodyFontSize,u=e.footerFontSize;n+=s*c,n+=s?(s-1)*e.titleSpacing:0,n+=s?e.titleMarginBottom:0,n+=o*h,n+=o?(o-1)*e.bodySpacing:0,n+=l?e.footerMarginTop:0,n+=l*u,n+=l?(l-1)*e.footerSpacing:0;var d=0,p=function(t){r=Math.max(r,i.measureText(t).width+d)};return i.font=ht.fontString(c,e._titleFontStyle,e._titleFontFamily),ht.each(e.title,p),i.font=ht.fontString(h,e._bodyFontStyle,e._bodyFontFamily),ht.each(e.beforeBody.concat(e.afterBody),p),d=e.displayColors?h+2:0,ht.each(a,function(t){ht.each(t.before,p),ht.each(t.lines,p),ht.each(t.after,p)}),d=0,i.font=ht.fontString(u,e._footerFontStyle,e._footerFontFamily),ht.each(e.footer,p),{width:r+=2*e.xPadding,height:n}}(this,C),u=C,p=P=function(t,e){var i,n,r,a,o,s=t._model,l=t._chart,c=t._chart.chartArea,h="center",u="center";s.y<e.height?u="top":s.y>l.height-e.height&&(u="bottom");var d=(c.left+c.right)/2,p=(c.top+c.bottom)/2;n="center"===u?(i=function(t){return t<=d},function(t){return d<t}):(i=function(t){return t<=e.width/2},function(t){return t>=l.width-e.width/2}),r=function(t){return t+e.width+s.caretSize+s.caretPadding>l.width},a=function(t){return t-e.width-s.caretSize-s.caretPadding<0},o=function(t){return t<=p?"top":"bottom"},i(s.x)?(h="left",r(s.x)&&(h="center",u=o(s.y))):n(s.x)&&(h="right",a(s.x)&&(h="center",u=o(s.y)));var f=t._options;return{xAlign:f.xAlign?f.xAlign:h,yAlign:f.yAlign?f.yAlign:u}}(this,d=O),f=M._chart,m=u.x,g=u.y,v=u.caretSize,y=u.caretPadding,_=u.cornerRadius,b=p.xAlign,x=p.yAlign,w=v+y,T=_+y,"right"===b?m-=d.width:"center"===b&&((m-=d.width/2)+d.width>f.width&&(m=f.width-d.width),m<0&&(m=0)),"top"===x?g+=w:g-="bottom"===x?d.height+w:d.height/2,"center"===x?"left"===b?m+=w:"right"===b&&(m-=w):"left"===b?m-=T:"right"===b&&(m+=T),R={x:m,y:g}}else C.opacity=0;return C.xAlign=P.xAlign,C.yAlign=P.yAlign,C.x=R.x,C.y=R.y,C.width=O.width,C.height=O.height,C.caretX=I.x,C.caretY=I.y,M._model=C,t&&S.custom&&S.custom.call(M,C),M},drawCaret:function(t,e){var i=this._chart.ctx,n=this._view,r=this.getCaretPosition(t,e,n);i.lineTo(r.x1,r.y1),i.lineTo(r.x2,r.y2),i.lineTo(r.x3,r.y3)},getCaretPosition:function(t,e,i){var n,r,a,o,s,l,c=i.caretSize,h=i.cornerRadius,u=i.xAlign,d=i.yAlign,p=t.x,f=t.y,m=e.width,g=e.height;if("center"===d)s=f+g/2,l="left"===u?(r=(n=p)-c,a=n,o=s+c,s-c):(r=(n=p+m)+c,a=n,o=s-c,s+c);else if(a=(n="left"===u?(r=p+h+c)-c:"right"===u?(r=p+m-h-c)-c:(r=i.caretX)-c,r+c),"top"===d)s=(o=f)-c,l=o;else{s=(o=f+g)+c,l=o;var v=a;a=n,n=v}return{x1:n,x2:r,x3:a,y1:o,y2:s,y3:l}},drawTitle:function(t,e,i){var n=e.title;if(n.length){t.x=We(e,e._titleAlign),i.textAlign=e._titleAlign,i.textBaseline="top";var r,a,o=e.titleFontSize,s=e.titleSpacing;for(i.fillStyle=e.titleFontColor,i.font=ht.fontString(o,e._titleFontStyle,e._titleFontFamily),r=0,a=n.length;r<a;++r)i.fillText(n[r],t.x,t.y),t.y+=o+s,r+1===n.length&&(t.y+=e.titleMarginBottom-s)}},drawBody:function(i,n,r){var a,o=n.bodyFontSize,e=n.bodySpacing,t=n._bodyAlign,s=n.body,l=n.displayColors,c=n.labelColors,h=0,u=l?We(n,"left"):0;r.textAlign=t,r.textBaseline="top",r.font=ht.fontString(o,n._bodyFontStyle,n._bodyFontFamily),i.x=We(n,t);var d=function(t){r.fillText(t,i.x+h,i.y),i.y+=o+e};r.fillStyle=n.bodyFontColor,ht.each(n.beforeBody,d),h=l&&"right"!==t?"center"===t?o/2+1:o+2:0,ht.each(s,function(t,e){a=n.labelTextColors[e],r.fillStyle=a,ht.each(t.before,d),ht.each(t.lines,function(t){l&&(r.fillStyle=n.legendColorBackground,r.fillRect(u,i.y,o,o),r.lineWidth=1,r.strokeStyle=c[e].borderColor,r.strokeRect(u,i.y,o,o),r.fillStyle=c[e].backgroundColor,r.fillRect(u+1,i.y+1,o-2,o-2),r.fillStyle=a),d(t)}),ht.each(t.after,d)}),h=0,ht.each(n.afterBody,d),i.y-=e},drawFooter:function(e,i,n){var t=i.footer;t.length&&(e.x=We(i,i._footerAlign),e.y+=i.footerMarginTop,n.textAlign=i._footerAlign,n.textBaseline="top",n.fillStyle=i.footerFontColor,n.font=ht.fontString(i.footerFontSize,i._footerFontStyle,i._footerFontFamily),ht.each(t,function(t){n.fillText(t,e.x,e.y),e.y+=i.footerFontSize+i.footerSpacing}))},drawBackground:function(t,e,i,n){i.fillStyle=e.backgroundColor,i.strokeStyle=e.borderColor,i.lineWidth=e.borderWidth;var r=e.xAlign,a=e.yAlign,o=t.x,s=t.y,l=n.width,c=n.height,h=e.cornerRadius;i.beginPath(),i.moveTo(o+h,s),"top"===a&&this.drawCaret(t,n),i.lineTo(o+l-h,s),i.quadraticCurveTo(o+l,s,o+l,s+h),"center"===a&&"right"===r&&this.drawCaret(t,n),i.lineTo(o+l,s+c-h),i.quadraticCurveTo(o+l,s+c,o+l-h,s+c),"bottom"===a&&this.drawCaret(t,n),i.lineTo(o+h,s+c),i.quadraticCurveTo(o,s+c,o,s+c-h),"center"===a&&"left"===r&&this.drawCaret(t,n),i.lineTo(o,s+h),i.quadraticCurveTo(o,s,o+h,s),i.closePath(),i.fill(),0<e.borderWidth&&i.stroke()},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var i={width:e.width,height:e.height},n={x:e.x,y:e.y},r=Math.abs(e.opacity<.001)?0:e.opacity,a=e.title.length||e.beforeBody.length||e.body.length||e.afterBody.length||e.footer.length;this._options.enabled&&a&&(t.save(),t.globalAlpha=r,this.drawBackground(n,e,t,i),n.y+=e.yPadding,this.drawTitle(n,e,t),this.drawBody(n,e,t),this.drawFooter(n,e,t),t.restore())}},handleEvent:function(t){var e,i=this,n=i._options;return i._lastActive=i._lastActive||[],"mouseout"===t.type?i._active=[]:i._active=i._chart.getElementsAtEventForMode(t,n.mode,n),(e=!ht.arrayEquals(i._active,i._lastActive))&&(i._lastActive=i._active,(n.enabled||n.custom)&&(i._eventPosition={x:t.x,y:t.y},i.update(!0),i.pivot())),e}}),qe=Ue,Je=Xe;Je.positioners=qe;var Ze=ht.valueOrDefault;function Qe(){return ht.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){if("xAxes"===t||"yAxes"===t){var r,a,o,s=i[t].length;for(e[t]||(e[t]=[]),r=0;r<s;++r)o=i[t][r],a=Ze(o.type,"xAxes"===t?"category":"linear"),r>=e[t].length&&e[t].push({}),!e[t][r].type||o.type&&o.type!==e[t][r].type?ht.merge(e[t][r],[Be.getScaleDefaults(a),o]):ht.merge(e[t][r],o)}else ht._merger(t,e,i,n)}})}function Ke(){return ht.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){var r=e[t]||{},a=i[t];"scales"===t?e[t]=Qe(r,a):"scale"===t?e[t]=ht.merge(r,[Be.getScaleDefaults(a.type),a]):ht._merger(t,e,i,n)}})}function $e(t){return"top"===t||"bottom"===t}st._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var ti=function(t,e){return this.construct(t,e),this};ht.extend(ti.prototype,{construct:function(t,e){var i,n,r=this;(n=(i=(i=e)||{}).data=i.data||{}).datasets=n.datasets||[],n.labels=n.labels||[],i.options=Ke(st.global,st[i.type],i.options||{}),e=i;var a=Ne.acquireContext(t,e),o=a&&a.canvas,s=o&&o.height,l=o&&o.width;r.id=ht.uid(),r.ctx=a,r.canvas=o,r.config=e,r.width=l,r.height=s,r.aspectRatio=s?l/s:null,r.options=e.options,r._bufferedRender=!1,(r.chart=r).controller=r,ti.instances[r.id]=r,Object.defineProperty(r,"data",{get:function(){return r.config.data},set:function(t){r.config.data=t}}),a&&o?(r.initialize(),r.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var t=this;return Fe.notify(t,"beforeInit"),ht.retinaScale(t,t.options.devicePixelRatio),t.bindEvents(),t.options.responsive&&t.resize(!0),t.ensureScalesHaveIDs(),t.buildOrUpdateScales(),t.initToolTip(),Fe.notify(t,"afterInit"),t},clear:function(){return ht.canvas.clear(this),this},stop:function(){return yt.cancelAnimation(this),this},resize:function(t){var e=this,i=e.options,n=e.canvas,r=i.maintainAspectRatio&&e.aspectRatio||null,a=Math.max(0,Math.floor(ht.getMaximumWidth(n))),o=Math.max(0,Math.floor(r?a/r:ht.getMaximumHeight(n)));if((e.width!==a||e.height!==o)&&(n.width=e.width=a,n.height=e.height=o,n.style.width=a+"px",n.style.height=o+"px",ht.retinaScale(e,i.devicePixelRatio),!t)){var s={width:a,height:o};Fe.notify(e,"resize",[s]),i.onResize&&i.onResize(e,s),e.stop(),e.update({duration:i.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var t=this.options,e=t.scales||{},i=t.scale;ht.each(e.xAxes,function(t,e){t.id=t.id||"x-axis-"+e}),ht.each(e.yAxes,function(t,e){t.id=t.id||"y-axis-"+e}),i&&(i.id=i.id||"scale")},buildOrUpdateScales:function(){var o=this,t=o.options,s=o.scales||{},e=[],l=Object.keys(s).reduce(function(t,e){return t[e]=!1,t},{});t.scales&&(e=e.concat((t.scales.xAxes||[]).map(function(t){return{options:t,dtype:"category",dposition:"bottom"}}),(t.scales.yAxes||[]).map(function(t){return{options:t,dtype:"linear",dposition:"left"}}))),t.scale&&e.push({options:t.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),ht.each(e,function(t){var e=t.options,i=e.id,n=Ze(e.type,t.dtype);$e(e.position)!==$e(t.dposition)&&(e.position=t.dposition),l[i]=!0;var r=null;if(i in s&&s[i].type===n)(r=s[i]).options=e,r.ctx=o.ctx,r.chart=o;else{var a=Be.getScaleConstructor(n);if(!a)return;r=new a({id:i,type:n,options:e,ctx:o.ctx,chart:o}),s[r.id]=r}r.mergeTicksOptions(),t.isDefault&&(o.scale=r)}),ht.each(l,function(t,e){t||delete s[e]}),o.scales=s,Be.addScalesToLayout(this)},buildOrUpdateControllers:function(){var a=this,o=[];return ht.each(a.data.datasets,function(t,e){var i=a.getDatasetMeta(e),n=t.type||a.config.type;if(i.type&&i.type!==n&&(a.destroyDatasetMeta(e),i=a.getDatasetMeta(e)),i.type=n,i.controller)i.controller.updateIndex(e),i.controller.linkScales();else{var r=ce[i.type];if(void 0===r)throw new Error('"'+i.type+'" is not a chart type.');i.controller=new r(a,e),o.push(i.controller)}},a),o},resetElements:function(){var i=this;ht.each(i.data.datasets,function(t,e){i.getDatasetMeta(e).controller.reset()},i)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(t){var e,i,n=this;if(t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]}),i=(e=n).options,ht.each(e.scales,function(t){xe.removeBox(e,t)}),i=Ke(st.global,st[e.config.type],i),e.options=e.config.options=i,e.ensureScalesHaveIDs(),e.buildOrUpdateScales(),e.tooltip._options=i.tooltips,e.tooltip.initialize(),Fe._invalidate(n),!1!==Fe.notify(n,"beforeUpdate")){n.tooltip._data=n.data;var r=n.buildOrUpdateControllers();ht.each(n.data.datasets,function(t,e){n.getDatasetMeta(e).controller.buildOrUpdateElements()},n),n.updateLayout(),n.options.animation&&n.options.animation.duration&&ht.each(r,function(t){t.reset()}),n.updateDatasets(),n.tooltip.initialize(),n.lastActive=[],Fe.notify(n,"afterUpdate"),n._bufferedRender?n._bufferedRequest={duration:t.duration,easing:t.easing,lazy:t.lazy}:n.render(t)}},updateLayout:function(){!1!==Fe.notify(this,"beforeLayout")&&(xe.update(this,this.width,this.height),Fe.notify(this,"afterScaleUpdate"),Fe.notify(this,"afterLayout"))},updateDatasets:function(){if(!1!==Fe.notify(this,"beforeDatasetsUpdate")){for(var t=0,e=this.data.datasets.length;t<e;++t)this.updateDataset(t);Fe.notify(this,"afterDatasetsUpdate")}},updateDataset:function(t){var e=this.getDatasetMeta(t),i={meta:e,index:t};!1!==Fe.notify(this,"beforeDatasetUpdate",[i])&&(e.controller.update(),Fe.notify(this,"afterDatasetUpdate",[i]))},render:function(t){var e=this;t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]});var i=e.options.animation,n=Ze(t.duration,i&&i.duration),r=t.lazy;if(!1!==Fe.notify(e,"beforeRender")){var a=function(t){Fe.notify(e,"afterRender"),ht.callback(i&&i.onComplete,[t],e)};if(i&&n){var o=new vt({numSteps:n/16.66,easing:t.easing||i.easing,render:function(t,e){var i=ht.easing.effects[e.easing],n=e.currentStep,r=n/e.numSteps;t.draw(i(r),r,n)},onAnimationProgress:i.onProgress,onAnimationComplete:a});yt.addAnimation(e,o,n,r)}else e.draw(),a(new vt({numSteps:0,chart:e}));return e}},draw:function(t){var e=this;e.clear(),ht.isNullOrUndef(t)&&(t=1),e.transition(t),e.width<=0||e.height<=0||!1!==Fe.notify(e,"beforeDraw",[t])&&(ht.each(e.boxes,function(t){t.draw(e.chartArea)},e),e.drawDatasets(t),e._drawTooltip(t),Fe.notify(e,"afterDraw",[t]))},transition:function(t){for(var e=0,i=(this.data.datasets||[]).length;e<i;++e)this.isDatasetVisible(e)&&this.getDatasetMeta(e).controller.transition(t);this.tooltip.transition(t)},drawDatasets:function(t){if(!1!==Fe.notify(this,"beforeDatasetsDraw",[t])){for(var e=(this.data.datasets||[]).length-1;0<=e;--e)this.isDatasetVisible(e)&&this.drawDataset(e,t);Fe.notify(this,"afterDatasetsDraw",[t])}},drawDataset:function(t,e){var i=this.getDatasetMeta(t),n={meta:i,index:t,easingValue:e};!1!==Fe.notify(this,"beforeDatasetDraw",[n])&&(i.controller.draw(e),Fe.notify(this,"afterDatasetDraw",[n]))},_drawTooltip:function(t){var e=this.tooltip,i={tooltip:e,easingValue:t};!1!==Fe.notify(this,"beforeTooltipDraw",[i])&&(e.draw(),Fe.notify(this,"afterTooltipDraw",[i]))},getElementAtEvent:function(t){return ge.modes.single(this,t)},getElementsAtEvent:function(t){return ge.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function(t){return ge.modes["x-axis"](this,t,{intersect:!0})},getElementsAtEventForMode:function(t,e,i){var n=ge.modes[e];return"function"==typeof n?n(this,t,i):[]},getDatasetAtEvent:function(t){return ge.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function(t){var e=this.data.datasets[t];e._meta||(e._meta={});var i=e._meta[this.id];return i||(i=e._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,i=this.data.datasets.length;e<i;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(t){var e=this.id,i=this.data.datasets[t],n=i._meta&&i._meta[e];n&&(n.controller.destroy(),delete i._meta[e])},destroy:function(){var t,e,i=this,n=i.canvas;for(i.stop(),t=0,e=i.data.datasets.length;t<e;++t)i.destroyDatasetMeta(t);n&&(i.unbindEvents(),ht.canvas.clear(i),Ne.releaseContext(i.ctx),i.canvas=null,i.ctx=null),Fe.notify(i,"destroy"),delete ti.instances[i.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){this.tooltip=new Je({_chart:this,_chartInstance:this,_data:this.data,_options:this.options.tooltips},this)},bindEvents:function(){var e=this,i=e._listeners={},n=function(){e.eventHandler.apply(e,arguments)};ht.each(e.options.events,function(t){Ne.addEventListener(e,t,n),i[t]=n}),e.options.responsive&&(n=function(){e.resize()},Ne.addEventListener(e,"resize",n),i.resize=n)},unbindEvents:function(){var i=this,t=i._listeners;t&&(delete i._listeners,ht.each(t,function(t,e){Ne.removeEventListener(i,e,t)}))},updateHoverStyle:function(t,e,i){var n,r,a,o=i?"setHoverStyle":"removeHoverStyle";for(r=0,a=t.length;r<a;++r)(n=t[r])&&this.getDatasetMeta(n._datasetIndex).controller[o](n)},eventHandler:function(t){var e=this,i=e.tooltip;if(!1!==Fe.notify(e,"beforeEvent",[t])){e._bufferedRender=!0,e._bufferedRequest=null;var n=e.handleEvent(t);i&&(n=i._start?i.handleEvent(t):n|i.handleEvent(t)),Fe.notify(e,"afterEvent",[t]);var r=e._bufferedRequest;return r?e.render(r):n&&!e.animating&&(e.stop(),e.render({duration:e.options.hover.animationDuration,lazy:!0})),e._bufferedRender=!1,e._bufferedRequest=null,e}},handleEvent:function(t){var e,i=this,n=i.options||{},r=n.hover;return i.lastActive=i.lastActive||[],"mouseout"===t.type?i.active=[]:i.active=i.getElementsAtEventForMode(t,r.mode,r),ht.callback(n.onHover||n.hover.onHover,[t.native,i.active],i),"mouseup"!==t.type&&"click"!==t.type||n.onClick&&n.onClick.call(i,t.native,i.active),i.lastActive.length&&i.updateHoverStyle(i.lastActive,r.mode,!1),i.active.length&&r.mode&&i.updateHoverStyle(i.active,r.mode,!0),e=!ht.arrayEquals(i.active,i.lastActive),i.lastActive=i.active,e}}),ti.instances={};var ei=ti;function ii(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function ni(t){this.options=t||{}}(ti.Controller=ti).types={},ht.configMerge=Ke,ht.scaleMerge=Qe,ht.extend(ni.prototype,{formats:ii,parse:ii,format:ii,add:ii,diff:ii,startOf:ii,endOf:ii,_create:function(t){return t}}),ni.override=function(t){ht.extend(ni.prototype,t)};var ri={_date:ni},ai={formatters:{values:function(t){return ht.isArray(t)?t:""+t},linear:function(t,e,i){var n=3<i.length?i[2]-i[1]:i[1]-i[0];1<Math.abs(n)&&t!==Math.floor(t)&&(n=t-Math.floor(t));var r=ht.log10(Math.abs(n)),a="";if(0!==t)if(Math.max(Math.abs(i[0]),Math.abs(i[i.length-1]))<1e-4){var o=ht.log10(Math.abs(t));a=t.toExponential(Math.floor(o)-Math.floor(r))}else{var s=-1*Math.floor(r);s=Math.max(Math.min(s,20),0),a=t.toFixed(s)}else a="0";return a},logarithmic:function(t,e,i){var n=t/Math.pow(10,Math.floor(ht.log10(t)));return 0===t?"0":1===n||2===n||5===n||0===e||e===i.length-1?t.toExponential():""}}},oi=ht.valueOrDefault,si=ht.valueAtIndexOrDefault;function li(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(t[e].label);return n}function ci(t,e,i){return ht.isArray(e)?ht.longestText(t,i,e):t.measureText(e).width}st._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:ai.formatters.values,minor:{},major:{}}});var hi=mt.extend({getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var t=this.options.ticks;for(var e in!1===t.minor&&(t.minor={display:!1}),!1===t.major&&(t.major={display:!1}),t)"major"!==e&&"minor"!==e&&(void 0===t.minor[e]&&(t.minor[e]=t[e]),void 0===t.major[e]&&(t.major[e]=t[e]))},beforeUpdate:function(){ht.callback(this.options.beforeUpdate,[this])},update:function(t,e,i){var n,r,a,o,s,l,c=this;for(c.beforeUpdate(),c.maxWidth=t,c.maxHeight=e,c.margins=ht.extend({left:0,right:0,top:0,bottom:0},i),c._maxLabelLines=0,c.longestLabelWidth=0,c.longestTextCache=c.longestTextCache||{},c.beforeSetDimensions(),c.setDimensions(),c.afterSetDimensions(),c.beforeDataLimits(),c.determineDataLimits(),c.afterDataLimits(),c.beforeBuildTicks(),s=c.buildTicks()||[],s=c.afterBuildTicks(s)||s,c.beforeTickToLabelConversion(),a=c.convertTicksToLabels(s)||c.ticks,c.afterTickToLabelConversion(),n=0,r=(c.ticks=a).length;n<r;++n)o=a[n],(l=s[n])?l.label=o:s.push(l={label:o,major:!1});return c._ticks=s,c.beforeCalculateTickRotation(),c.calculateTickRotation(),c.afterCalculateTickRotation(),c.beforeFit(),c.fit(),c.afterFit(),c.afterUpdate(),c.minSize},afterUpdate:function(){ht.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){ht.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){ht.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){ht.callback(this.options.beforeDataLimits,[this])},determineDataLimits:ht.noop,afterDataLimits:function(){ht.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){ht.callback(this.options.beforeBuildTicks,[this])},buildTicks:ht.noop,afterBuildTicks:function(t){return ht.isArray(t)&&t.length?ht.callback(this.options.afterBuildTicks,[this,t]):(this.ticks=ht.callback(this.options.afterBuildTicks,[this,this.ticks])||this.ticks,t)},beforeTickToLabelConversion:function(){ht.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this.options.ticks;this.ticks=this.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){ht.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){ht.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var t=this,e=t.ctx,i=t.options.ticks,n=li(t._ticks),r=ht.options._parseFont(i);e.font=r.string;var a=i.minRotation||0;if(n.length&&t.options.display&&t.isHorizontal())for(var o,s=ht.longestText(e,r.string,n,t.longestTextCache),l=s,c=t.getPixelForTick(1)-t.getPixelForTick(0)-6;c<l&&a<i.maxRotation;){var h=ht.toRadians(a);if(o=Math.cos(h),Math.sin(h)*s>t.maxHeight){a--;break}a++,l=o*s}t.labelRotation=a},afterCalculateTickRotation:function(){ht.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){ht.callback(this.options.beforeFit,[this])},fit:function(){var t=this,e=t.minSize={width:0,height:0},i=li(t._ticks),n=t.options,r=n.ticks,a=n.scaleLabel,o=n.gridLines,s=t._isVisible(),l=n.position,c=t.isHorizontal(),h=ht.options._parseFont,u=h(r),d=n.gridLines.tickMarkLength;if(e.width=c?t.isFullWidth()?t.maxWidth-t.margins.left-t.margins.right:t.maxWidth:s&&o.drawTicks?d:0,e.height=c?s&&o.drawTicks?d:0:t.maxHeight,a.display&&s){var p=h(a),f=ht.options.toPadding(a.padding),m=p.lineHeight+f.height;c?e.height+=m:e.width+=m}if(r.display&&s){var g=ht.longestText(t.ctx,u.string,i,t.longestTextCache),v=ht.numberOfLabelLines(i),y=.5*u.size,_=t.options.ticks.padding;if(t._maxLabelLines=v,t.longestLabelWidth=g,c){var b=ht.toRadians(t.labelRotation),x=Math.cos(b),w=Math.sin(b)*g+u.lineHeight*v+y;e.height=Math.min(t.maxHeight,e.height+w+_),t.ctx.font=u.string;var T,M,S=ci(t.ctx,i[0],u.string),E=ci(t.ctx,i[i.length-1],u.string),C=t.getPixelForTick(0)-t.left,L=t.right-t.getPixelForTick(i.length-1);M=0!==t.labelRotation?(T="bottom"===l?x*S:x*y,"bottom"===l?x*y:x*E):(T=S/2,E/2),t.paddingLeft=Math.max(T-C,0)+3,t.paddingRight=Math.max(M-L,0)+3}else r.mirror?g=0:g+=_+y,e.width=Math.min(t.maxWidth,e.width+g),t.paddingTop=u.size/2,t.paddingBottom=u.size/2}t.handleMargins(),t.width=e.width,t.height=e.height},handleMargins:function(){var t=this;t.margins&&(t.paddingLeft=Math.max(t.paddingLeft-t.margins.left,0),t.paddingTop=Math.max(t.paddingTop-t.margins.top,0),t.paddingRight=Math.max(t.paddingRight-t.margins.right,0),t.paddingBottom=Math.max(t.paddingBottom-t.margins.bottom,0))},afterFit:function(){ht.callback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){if(ht.isNullOrUndef(t))return NaN;if(("number"==typeof t||t instanceof Number)&&!isFinite(t))return NaN;if(t)if(this.isHorizontal()){if(void 0!==t.x)return this.getRightValue(t.x)}else if(void 0!==t.y)return this.getRightValue(t.y);return t},getLabelForIndex:ht.noop,getPixelForValue:ht.noop,getValueForPixel:ht.noop,getPixelForTick:function(t){var e=this,i=e.options.offset;if(e.isHorizontal()){var n=(e.width-(e.paddingLeft+e.paddingRight))/Math.max(e._ticks.length-(i?0:1),1),r=n*t+e.paddingLeft;return i&&(r+=n/2),e.left+r+(e.isFullWidth()?e.margins.left:0)}var a=e.height-(e.paddingTop+e.paddingBottom);return e.top+t*(a/(e._ticks.length-1))},getPixelForDecimal:function(t){var e=this;if(e.isHorizontal()){var i=(e.width-(e.paddingLeft+e.paddingRight))*t+e.paddingLeft;return e.left+i+(e.isFullWidth()?e.margins.left:0)}return e.top+t*e.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var t=this.min,e=this.max;return this.beginAtZero?0:t<0&&e<0?e:0<t&&0<e?t:0},_autoSkip:function(t){var e,i,n=this.isHorizontal(),r=this.options.ticks.minor,a=t.length,o=!1,s=r.maxTicksLimit,l=this._tickSize()*(a-1),c=n?this.width-(this.paddingLeft+this.paddingRight):this.height-(this.paddingTop+this.PaddingBottom),h=[];for(c<l&&(o=1+Math.floor(l/c)),s<a&&(o=Math.max(o,1+Math.floor(a/s))),e=0;e<a;e++)i=t[e],1<o&&0<e%o&&delete i.label,h.push(i);return h},_tickSize:function(){var t=this.isHorizontal(),e=this.options.ticks.minor,i=ht.toRadians(this.labelRotation),n=Math.abs(Math.cos(i)),r=Math.abs(Math.sin(i)),a=e.autoSkipPadding||0,o=this.longestLabelWidth+a||0,s=ht.options._parseFont(e),l=this._maxLabelLines*s.lineHeight+a||0;return t?o*r<l*n?o/n:l/r:l*r<o*n?l/n:o/r},_isVisible:function(){var t,e,i,n=this.chart,r=this.options.display;if("auto"!==r)return!!r;for(t=0,e=n.data.datasets.length;t<e;++t)if(n.isDatasetVisible(t)&&((i=n.getDatasetMeta(t)).xAxisID===this.id||i.yAxisID===this.id))return!0;return!1},draw:function(C){var L=this,A=L.options;if(L._isVisible()){var t,P,R,O=L.chart,o=L.ctx,e=st.global.defaultFontColor,s=A.ticks.minor,i=A.ticks.major||s,I=A.gridLines,n=A.scaleLabel,D=A.position,j=0!==L.labelRotation,k=s.mirror,N=L.isHorizontal(),r=ht.options._parseFont,a=s.display&&s.autoSkip?L._autoSkip(L.getTicks()):L.getTicks(),l=oi(s.fontColor,e),c=r(s),F=c.lineHeight,h=oi(i.fontColor,e),u=r(i),B=s.padding,H=s.labelOffset,U=I.drawTicks?I.tickMarkLength:0,d=oi(n.fontColor,e),p=r(n),f=ht.options.toPadding(n.padding),z=ht.toRadians(L.labelRotation),V=[],G=I.drawBorder?si(I.lineWidth,0,0):0,W=ht._alignPixel;if(R="top"===D?(t=W(O,L.bottom,G),P=L.bottom-U,t-G/2):"bottom"===D?(t=W(O,L.top,G),P=t+G/2,L.top+U):"left"===D?(t=W(O,L.right,G),P=L.right-U,t-G/2):(t=W(O,L.left,G),P=t+G/2,L.left+U),ht.each(a,function(t,e){if(!ht.isNullOrUndef(t.label)){var i,n,r,a,o,s,l,c,h,u,d,p,f,m,g,v,y=t.label;a=e===L.zeroLineIndex&&A.offset===I.offsetGridLines?(i=I.zeroLineWidth,n=I.zeroLineColor,r=I.zeroLineBorderDash||[],I.zeroLineBorderDashOffset||0):(i=si(I.lineWidth,e),n=si(I.color,e),r=I.borderDash||[],I.borderDashOffset||0);var _=ht.isArray(y)?y.length:1,b=(T=L,M=e,S=I.offsetGridLines,E=T.getPixelForTick(M),S&&(1===T.getTicks().length?E-=T.isHorizontal()?Math.max(E-T.left,T.right-E):Math.max(E-T.top,T.bottom-E):E-=0===M?(T.getPixelForTick(1)-E)/2:(E-T.getPixelForTick(M-1))/2),E);if(N){var x=U+B;b<L.left-1e-7&&(n="rgba(0,0,0,0)"),o=l=h=d=W(O,b,i),s=P,c=R,f=L.getPixelForTick(e)+H,m="top"===D?(u=W(O,C.top,G)+G/2,p=C.bottom,g=((j?1:.5)-_)*F,v=j?"left":"center",L.bottom-x):(u=C.top,p=W(O,C.bottom,G)-G/2,g=(j?0:.5)*F,v=j?"right":"center",L.top+x)}else{var w=(k?0:U)+B;b<L.top-1e-7&&(n="rgba(0,0,0,0)"),o=P,l=R,s=c=u=p=W(O,b,i),m=L.getPixelForTick(e)+H,g=(1-_)*F/2,f="left"===D?(h=W(O,C.left,G)+G/2,d=C.right,v=k?"left":"right",L.right-w):(h=C.left,d=W(O,C.right,G)-G/2,v=k?"right":"left",L.left+w)}V.push({tx1:o,ty1:s,tx2:l,ty2:c,x1:h,y1:u,x2:d,y2:p,labelX:f,labelY:m,glWidth:i,glColor:n,glBorderDash:r,glBorderDashOffset:a,rotation:-1*z,label:y,major:t.major,textOffset:g,textAlign:v})}var T,M,S,E}),ht.each(V,function(t){var e=t.glWidth,i=t.glColor;if(I.display&&e&&i&&(o.save(),o.lineWidth=e,o.strokeStyle=i,o.setLineDash&&(o.setLineDash(t.glBorderDash),o.lineDashOffset=t.glBorderDashOffset),o.beginPath(),I.drawTicks&&(o.moveTo(t.tx1,t.ty1),o.lineTo(t.tx2,t.ty2)),I.drawOnChartArea&&(o.moveTo(t.x1,t.y1),o.lineTo(t.x2,t.y2)),o.stroke(),o.restore()),s.display){o.save(),o.translate(t.labelX,t.labelY),o.rotate(t.rotation),o.font=t.major?u.string:c.string,o.fillStyle=t.major?h:l,o.textBaseline="middle",o.textAlign=t.textAlign;var n=t.label,r=t.textOffset;if(ht.isArray(n))for(var a=0;a<n.length;++a)o.fillText(""+n[a],0,r),r+=F;else o.fillText(n,0,r);o.restore()}}),n.display){var m,g,v=0,y=p.lineHeight/2;if(N)m=L.left+(L.right-L.left)/2,g="bottom"===D?L.bottom-y-f.bottom:L.top+y+f.top;else{var _="left"===D;m=_?L.left+y+f.top:L.right-y-f.top,g=L.top+(L.bottom-L.top)/2,v=_?-.5*Math.PI:.5*Math.PI}o.save(),o.translate(m,g),o.rotate(v),o.textAlign="center",o.textBaseline="middle",o.fillStyle=d,o.font=p.string,o.fillText(n.labelString,0,0),o.restore()}if(G){var b,x,w,T,M=G,S=si(I.lineWidth,a.length-1,0);N?(b=W(O,L.left,M)-M/2,x=W(O,L.right,S)+S/2,w=T=t):(w=W(O,L.top,M)-M/2,T=W(O,L.bottom,S)+S/2,b=x=t),o.lineWidth=G,o.strokeStyle=si(I.color,0),o.beginPath(),o.moveTo(b,w),o.lineTo(x,T),o.stroke()}}}}),ui=hi.extend({getLabels:function(){var t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels},determineDataLimits:function(){var t,e=this,i=e.getLabels();e.minIndex=0,e.maxIndex=i.length-1,void 0!==e.options.ticks.min&&(t=i.indexOf(e.options.ticks.min),e.minIndex=-1!==t?t:e.minIndex),void 0!==e.options.ticks.max&&(t=i.indexOf(e.options.ticks.max),e.maxIndex=-1!==t?t:e.maxIndex),e.min=i[e.minIndex],e.max=i[e.maxIndex]},buildTicks:function(){var t=this.getLabels();this.ticks=0===this.minIndex&&this.maxIndex===t.length-1?t:t.slice(this.minIndex,this.maxIndex+1)},getLabelForIndex:function(t,e){var i=this.chart;return i.getDatasetMeta(e).controller._getValueScaleId()===this.id?this.getRightValue(i.data.datasets[e].data[t]):this.ticks[t-this.minIndex]},getPixelForValue:function(t,e){var i,n=this,r=n.options.offset,a=Math.max(n.maxIndex+1-n.minIndex-(r?0:1),1);if(null!=t&&(i=n.isHorizontal()?t.x:t.y),void 0!==i||void 0!==t&&isNaN(e)){t=i||t;var o=n.getLabels().indexOf(t);e=-1!==o?o:e}if(n.isHorizontal()){var s=n.width/a,l=s*(e-n.minIndex);return r&&(l+=s/2),n.left+l}var c=n.height/a,h=c*(e-n.minIndex);return r&&(h+=c/2),n.top+h},getPixelForTick:function(t){return this.getPixelForValue(this.ticks[t],t+this.minIndex,null)},getValueForPixel:function(t){var e=this.options.offset,i=Math.max(this._ticks.length-(e?0:1),1),n=this.isHorizontal(),r=(n?this.width:this.height)/i;return t-=n?this.left:this.top,e&&(t-=r/2),(t<=0?0:Math.round(t/r))+this.minIndex},getBasePixel:function(){return this.bottom}});ui._defaults={position:"bottom"};var di=ht.noop,pi=ht.isNullOrUndef,fi=hi.extend({getRightValue:function(t){return"string"==typeof t?+t:hi.prototype.getRightValue.call(this,t)},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;if(e.beginAtZero){var i=ht.sign(t.min),n=ht.sign(t.max);i<0&&n<0?t.max=0:0<i&&0<n&&(t.min=0)}var r=void 0!==e.min||void 0!==e.suggestedMin,a=void 0!==e.max||void 0!==e.suggestedMax;void 0!==e.min?t.min=e.min:void 0!==e.suggestedMin&&(null===t.min?t.min=e.suggestedMin:t.min=Math.min(t.min,e.suggestedMin)),void 0!==e.max?t.max=e.max:void 0!==e.suggestedMax&&(null===t.max?t.max=e.suggestedMax:t.max=Math.max(t.max,e.suggestedMax)),r!==a&&t.min>=t.max&&(r?t.max=t.min+1:t.min=t.max-1),t.min===t.max&&(t.max++,e.beginAtZero||t.min--)},getTickLimit:function(){var t,e=this.options.ticks,i=e.stepSize,n=e.maxTicksLimit;return i?t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1:(t=this._computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:di,buildTicks:function(){var t=this,e=t.options.ticks,i=t.getTickLimit(),v={maxTicks:i=Math.max(2,i),min:e.min,max:e.max,precision:e.precision,stepSize:ht.valueOrDefault(e.fixedStepSize,e.stepSize)},n=t.ticks=function(t,e){var i,n,r,a,o=[],s=v.stepSize,l=s||1,c=v.maxTicks-1,h=v.min,u=v.max,d=v.precision,p=e.min,f=e.max,m=ht.niceNum((f-p)/c/l)*l;if(m<1e-14&&pi(h)&&pi(u))return[p,f];(a=Math.ceil(f/m)-Math.floor(p/m))>c&&(m=ht.niceNum(a*m/c/l)*l),s||pi(d)?i=Math.pow(10,ht._decimalPlaces(m)):(i=Math.pow(10,d),m=Math.ceil(m*i)/i),n=Math.floor(p/m)*m,r=Math.ceil(f/m)*m,s&&(!pi(h)&&ht.almostWhole(h/m,m/1e3)&&(n=h),!pi(u)&&ht.almostWhole(u/m,m/1e3)&&(r=u)),a=(r-n)/m,a=ht.almostEquals(a,Math.round(a),m/1e3)?Math.round(a):Math.ceil(a),n=Math.round(n*i)/i,r=Math.round(r*i)/i,o.push(pi(h)?n:h);for(var g=1;g<a;++g)o.push(Math.round((n+g*m)*i)/i);return o.push(pi(u)?r:u),o}(0,t);t.handleDirectionalChanges(),t.max=ht.max(n),t.min=ht.min(n),e.reverse?(n.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){this.ticksAsNumbers=this.ticks.slice(),this.zeroLineIndex=this.ticks.indexOf(0),hi.prototype.convertTicksToLabels.call(this)}}),mi={position:"left",ticks:{callback:ai.formatters.linear}},gi=fi.extend({determineDataLimits:function(){var o=this,s=o.options,l=o.chart,t=l.data.datasets,e=o.isHorizontal();function c(t){return e?t.xAxisID===o.id:t.yAxisID===o.id}o.min=null,o.max=null;var n=s.stacked;if(void 0===n&&ht.each(t,function(t,e){if(!n){var i=l.getDatasetMeta(e);l.isDatasetVisible(e)&&c(i)&&void 0!==i.stack&&(n=!0)}}),s.stacked||n){var h={};ht.each(t,function(t,e){var n=l.getDatasetMeta(e),i=[n.type,void 0===s.stacked&&void 0===n.stack?e:"",n.stack].join(".");void 0===h[i]&&(h[i]={positiveValues:[],negativeValues:[]});var r=h[i].positiveValues,a=h[i].negativeValues;l.isDatasetVisible(e)&&c(n)&&ht.each(t.data,function(t,e){var i=+o.getRightValue(t);isNaN(i)||n.data[e].hidden||(r[e]=r[e]||0,a[e]=a[e]||0,s.relativePoints?r[e]=100:i<0?a[e]+=i:r[e]+=i)})}),ht.each(h,function(t){var e=t.positiveValues.concat(t.negativeValues),i=ht.min(e),n=ht.max(e);o.min=null===o.min?i:Math.min(o.min,i),o.max=null===o.max?n:Math.max(o.max,n)})}else ht.each(t,function(t,e){var n=l.getDatasetMeta(e);l.isDatasetVisible(e)&&c(n)&&ht.each(t.data,function(t,e){var i=+o.getRightValue(t);isNaN(i)||n.data[e].hidden||(null===o.min?o.min=i:i<o.min&&(o.min=i),null===o.max?o.max=i:i>o.max&&(o.max=i))})});o.min=isFinite(o.min)&&!isNaN(o.min)?o.min:0,o.max=isFinite(o.max)&&!isNaN(o.max)?o.max:1,this.handleTickRangeOptions()},_computeTickLimit:function(){var t;return this.isHorizontal()?Math.ceil(this.width/40):(t=ht.options._parseFont(this.options.ticks),Math.ceil(this.height/t.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){var e=this.start,i=+this.getRightValue(t),n=this.end-e;return this.isHorizontal()?this.left+this.width/n*(i-e):this.bottom-this.height/n*(i-e)},getValueForPixel:function(t){var e=this.isHorizontal(),i=e?this.width:this.height,n=(e?t-this.left:this.bottom-t)/i;return this.start+(this.end-this.start)*n},getPixelForTick:function(t){return this.getPixelForValue(this.ticksAsNumbers[t])}}),vi=mi;gi._defaults=vi;var yi=ht.valueOrDefault,_i={position:"left",ticks:{callback:ai.formatters.logarithmic}};function bi(t,e){return ht.isFinite(t)&&0<=t?t:e}var xi=hi.extend({determineDataLimits:function(){var o=this,i=o.options,s=o.chart,t=s.data.datasets,e=o.isHorizontal();function l(t){return e?t.xAxisID===o.id:t.yAxisID===o.id}o.min=null,o.max=null,o.minNotZero=null;var n=i.stacked;if(void 0===n&&ht.each(t,function(t,e){if(!n){var i=s.getDatasetMeta(e);s.isDatasetVisible(e)&&l(i)&&void 0!==i.stack&&(n=!0)}}),i.stacked||n){var c={};ht.each(t,function(t,e){var r=s.getDatasetMeta(e),a=[r.type,void 0===i.stacked&&void 0===r.stack?e:"",r.stack].join(".");s.isDatasetVisible(e)&&l(r)&&(void 0===c[a]&&(c[a]=[]),ht.each(t.data,function(t,e){var i=c[a],n=+o.getRightValue(t);isNaN(n)||r.data[e].hidden||n<0||(i[e]=i[e]||0,i[e]+=n)}))}),ht.each(c,function(t){if(0<t.length){var e=ht.min(t),i=ht.max(t);o.min=null===o.min?e:Math.min(o.min,e),o.max=null===o.max?i:Math.max(o.max,i)}})}else ht.each(t,function(t,e){var n=s.getDatasetMeta(e);s.isDatasetVisible(e)&&l(n)&&ht.each(t.data,function(t,e){var i=+o.getRightValue(t);isNaN(i)||n.data[e].hidden||i<0||(null===o.min?o.min=i:i<o.min&&(o.min=i),null===o.max?o.max=i:i>o.max&&(o.max=i),0!==i&&(null===o.minNotZero||i<o.minNotZero)&&(o.minNotZero=i))})});this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;t.min=bi(e.min,t.min),t.max=bi(e.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(ht.log10(t.min))-1),t.max=Math.pow(10,Math.floor(ht.log10(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(ht.log10(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(ht.log10(t.min))+1):10),null===t.minNotZero&&(0<t.min?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(ht.log10(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,e=t.options.ticks,i=!t.isHorizontal(),n={min:bi(e.min),max:bi(e.max)},r=t.ticks=function(t,e){var i,n,r=[],a=yi(t.min,Math.pow(10,Math.floor(ht.log10(e.min)))),o=Math.floor(ht.log10(e.max)),s=Math.ceil(e.max/Math.pow(10,o));0===a?(i=Math.floor(ht.log10(e.minNotZero)),n=Math.floor(e.minNotZero/Math.pow(10,i)),r.push(a),a=n*Math.pow(10,i)):(i=Math.floor(ht.log10(a)),n=Math.floor(a/Math.pow(10,i)));for(var l=i<0?Math.pow(10,Math.abs(i)):1;r.push(a),10==++n&&(n=1,l=0<=++i?1:l),a=Math.round(n*Math.pow(10,i)*l)/l,i<o||i===o&&n<s;);var c=yi(t.max,a);return r.push(c),r}(n,t);t.max=ht.max(r),t.min=ht.min(r),e.reverse?(i=!i,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i&&r.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),hi.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},_getFirstTickValue:function(t){var e=Math.floor(ht.log10(t));return Math.floor(t/Math.pow(10,e))*Math.pow(10,e)},getPixelForValue:function(t){var e,i,n,r,a,o=this,s=o.options.ticks,l=s.reverse,c=ht.log10,h=o._getFirstTickValue(o.minNotZero),u=0;return t=+o.getRightValue(t),a=l?(n=o.end,r=o.start,-1):(n=o.start,r=o.end,1),i=o.isHorizontal()?(e=o.width,l?o.right:o.left):(e=o.height,a*=-1,l?o.top:o.bottom),t!==n&&(0===n&&(e-=u=yi(s.fontSize,st.global.defaultFontSize),n=h),0!==t&&(u+=e/(c(r)-c(n))*(c(t)-c(n))),i+=a*u),i},getValueForPixel:function(t){var e,i,n,r,a=this,o=a.options.ticks,s=o.reverse,l=ht.log10,c=a._getFirstTickValue(a.minNotZero);if(n=s?(i=a.end,a.start):(i=a.start,a.end),(r=a.isHorizontal()?(e=a.width,s?a.right-t:t-a.left):(e=a.height,s?t-a.top:a.bottom-t))!==i){if(0===i){var h=yi(o.fontSize,st.global.defaultFontSize);r-=h,e-=h,i=c}r*=l(n)-l(i),r/=e,r=Math.pow(10,l(i)+r)}return r}}),wi=_i;xi._defaults=wi;var Ti=ht.valueOrDefault,Mi=ht.valueAtIndexOrDefault,Si=ht.options.resolve,Ei={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:ai.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function Ci(t){var e=t.options;return e.angleLines.display||e.pointLabels.display?t.chart.data.labels.length:0}function Li(t){var e=t.ticks;return e.display&&t.display?Ti(e.fontSize,st.global.defaultFontSize)+2*e.backdropPaddingY:0}function Ai(t,e,i,n,r){return t===n||t===r?{start:e-i/2,end:e+i/2}:t<n||r<t?{start:e-i,end:e}:{start:e,end:e+i}}function Pi(t,e,i,n){var r,a,o=i.y+n/2;if(ht.isArray(e))for(r=0,a=e.length;r<a;++r)t.fillText(e[r],i.x,o),o+=n;else t.fillText(e,i.x,o)}function Ri(t){return ht.isNumber(t)?t:0}var Oi=fi.extend({setDimensions:function(){var t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=Li(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2},determineDataLimits:function(){var r=this,i=r.chart,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;ht.each(i.data.datasets,function(t,e){if(i.isDatasetVisible(e)){var n=i.getDatasetMeta(e);ht.each(t.data,function(t,e){var i=+r.getRightValue(t);isNaN(i)||n.data[e].hidden||(a=Math.min(i,a),o=Math.max(i,o))})}}),r.min=a===Number.POSITIVE_INFINITY?0:a,r.max=o===Number.NEGATIVE_INFINITY?0:o,r.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/Li(this.options))},convertTicksToLabels:function(){fi.prototype.convertTicksToLabels.call(this),this.pointLabels=this.chart.data.labels.map(this.options.pointLabels.callback,this)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t=this.options;t.display&&t.pointLabels.display?function(t){var e,i,n,r=ht.options._parseFont(t.options.pointLabels),a={l:0,r:t.width,t:0,b:t.height-t.paddingTop},o={};t.ctx.font=r.string,t._pointLabelSizes=[];var s,l,c,h=Ci(t);for(e=0;e<h;e++){n=t.getPointPosition(e,t.drawingArea+5),s=t.ctx,l=r.lineHeight,c=t.pointLabels[e]||"",i=ht.isArray(c)?{w:ht.longestText(s,s.font,c),h:c.length*l}:{w:s.measureText(c).width,h:l},t._pointLabelSizes[e]=i;var u=t.getIndexAngle(e),d=ht.toDegrees(u)%360,p=Ai(d,n.x,i.w,0,180),f=Ai(d,n.y,i.h,90,270);p.start<a.l&&(a.l=p.start,o.l=u),p.end>a.r&&(a.r=p.end,o.r=u),f.start<a.t&&(a.t=f.start,o.t=u),f.end>a.b&&(a.b=f.end,o.b=u)}t.setReductions(t.drawingArea,a,o)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(t,e,i){var n=e.l/Math.sin(i.l),r=Math.max(e.r-this.width,0)/Math.sin(i.r),a=-e.t/Math.cos(i.t),o=-Math.max(e.b-(this.height-this.paddingTop),0)/Math.cos(i.b);n=Ri(n),r=Ri(r),a=Ri(a),o=Ri(o),this.drawingArea=Math.min(Math.floor(t-(n+r)/2),Math.floor(t-(a+o)/2)),this.setCenterPoint(n,r,a,o)},setCenterPoint:function(t,e,i,n){var r=this,a=r.width-e-r.drawingArea,o=t+r.drawingArea,s=i+r.drawingArea,l=r.height-r.paddingTop-n-r.drawingArea;r.xCenter=Math.floor((o+a)/2+r.left),r.yCenter=Math.floor((s+l)/2+r.top+r.paddingTop)},getIndexAngle:function(t){return t*(2*Math.PI/Ci(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){if(null===t)return 0;var e=this.drawingArea/(this.max-this.min);return this.options.ticks.reverse?(this.max-t)*e:(t-this.min)*e},getPointPosition:function(t,e){var i=this.getIndexAngle(t)-Math.PI/2;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this.min,e=this.max;return this.getPointPositionForValue(0,this.beginAtZero?0:t<0&&e<0?e:0<t&&0<e?t:0)},draw:function(){var a=this,t=a.options,o=t.gridLines,s=t.ticks;if(t.display){var l=a.ctx,c=this.getIndexAngle(0),h=ht.options._parseFont(s);(t.angleLines.display||t.pointLabels.display)&&function(t){var e=t.ctx,i=t.options,n=i.angleLines,r=i.gridLines,a=i.pointLabels,o=Ti(n.lineWidth,r.lineWidth),s=Ti(n.color,r.color),l=Li(i);e.save(),e.lineWidth=o,e.strokeStyle=s,e.setLineDash&&(e.setLineDash(Si([n.borderDash,r.borderDash,[]])),e.lineDashOffset=Si([n.borderDashOffset,r.borderDashOffset,0]));var c,h,u,d,p=t.getDistanceFromCenterForValue(i.ticks.reverse?t.min:t.max),f=ht.options._parseFont(a);e.font=f.string,e.textBaseline="middle";for(var m=Ci(t)-1;0<=m;m--){if(n.display&&o&&s){var g=t.getPointPosition(m,p);e.beginPath(),e.moveTo(t.xCenter,t.yCenter),e.lineTo(g.x,g.y),e.stroke()}if(a.display){var v=0===m?l/2:0,y=t.getPointPosition(m,p+v+5),_=Mi(a.fontColor,m,st.global.defaultFontColor);e.fillStyle=_;var b=t.getIndexAngle(m),x=ht.toDegrees(b);e.textAlign=0===(d=x)||180===d?"center":d<180?"left":"right",c=x,h=t._pointLabelSizes[m],u=y,90===c||270===c?u.y-=h.h/2:(270<c||c<90)&&(u.y-=h.h),Pi(e,t.pointLabels[m]||"",y,f.lineHeight)}}e.restore()}(a),ht.each(a.ticks,function(t,e){if(0<e||s.reverse){var i=a.getDistanceFromCenterForValue(a.ticksAsNumbers[e]);if(o.display&&0!==e&&function(t,e,i,n){var r,a=t.ctx,o=e.circular,s=Ci(t),l=Mi(e.color,n-1),c=Mi(e.lineWidth,n-1);if((o||s)&&l&&c){if(a.save(),a.strokeStyle=l,a.lineWidth=c,a.setLineDash&&(a.setLineDash(e.borderDash||[]),a.lineDashOffset=e.borderDashOffset||0),a.beginPath(),o)a.arc(t.xCenter,t.yCenter,i,0,2*Math.PI);else{r=t.getPointPosition(0,i),a.moveTo(r.x,r.y);for(var h=1;h<s;h++)r=t.getPointPosition(h,i),a.lineTo(r.x,r.y)}a.closePath(),a.stroke(),a.restore()}}(a,o,i,e),s.display){var n=Ti(s.fontColor,st.global.defaultFontColor);if(l.font=h.string,l.save(),l.translate(a.xCenter,a.yCenter),l.rotate(c),s.showLabelBackdrop){var r=l.measureText(t).width;l.fillStyle=s.backdropColor,l.fillRect(-r/2-s.backdropPaddingX,-i-h.size/2-s.backdropPaddingY,r+2*s.backdropPaddingX,h.size+2*s.backdropPaddingY)}l.textAlign="center",l.textBaseline="middle",l.fillStyle=n,l.fillText(t,0,-i),l.restore()}}})}}}),Ii=Ei;Oi._defaults=Ii;var Di=ht.valueOrDefault,ji=Number.MIN_SAFE_INTEGER||-9007199254740991,ki=Number.MAX_SAFE_INTEGER||9007199254740991,Ni={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},Fi=Object.keys(Ni);function Bi(t,e){return t-e}function Hi(t){var e,i,n,r={},a=[];for(e=0,i=t.length;e<i;++e)r[n=t[e]]||(r[n]=!0,a.push(n));return a}function Ui(t,e,i,n){var r=function(t,e,i){for(var n,r,a,o=0,s=t.length-1;0<=o&&o<=s;){if(r=t[(n=o+s>>1)-1]||null,a=t[n],!r)return{lo:null,hi:a};if(a[e]<i)o=n+1;else{if(!(r[e]>i))return{lo:r,hi:a};s=n-1}}return{lo:a,hi:null}}(t,e,i),a=r.lo?r.hi?r.lo:t[t.length-2]:t[0],o=r.lo?r.hi?r.hi:t[t.length-1]:t[1],s=o[e]-a[e],l=s?(i-a[e])/s:0,c=(o[n]-a[n])*l;return a[n]+c}function zi(t,e){var i=t._adapter,n=t.options.time,r=n.parser,a=r||n.format,o=e;return"function"==typeof r&&(o=r(o)),ht.isFinite(o)||(o="string"==typeof a?i.parse(o,a):i.parse(o)),null!==o?+o:(r||"function"!=typeof a||(o=a(e),ht.isFinite(o)||(o=i.parse(o))),o)}function Vi(t,e){if(ht.isNullOrUndef(e))return null;var i=t.options.time,n=zi(t,t.getRightValue(e));return null===n||i.round&&(n=+t._adapter.startOf(n,i.round)),n}function Gi(t){for(var e=Fi.indexOf(t)+1,i=Fi.length;e<i;++e)if(Ni[Fi[e]].common)return Fi[e]}var Wi=hi.extend({initialize:function(){this.mergeTicksOptions(),hi.prototype.initialize.call(this)},update:function(){var t=this.options,e=t.time||(t.time={}),i=this._adapter=new ri._date(t.adapters.date);return e.format&&console.warn("options.time.format is deprecated and replaced by options.time.parser."),ht.mergeIf(e.displayFormats,i.formats()),hi.prototype.update.apply(this,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),hi.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var t,e,i,n,r,a,o=this,s=o.chart,l=o._adapter,c=o.options.time,h=c.unit||"day",u=ki,d=ji,p=[],f=[],m=[],g=s.data.labels||[];for(t=0,i=g.length;t<i;++t)m.push(Vi(o,g[t]));for(t=0,i=(s.data.datasets||[]).length;t<i;++t)if(s.isDatasetVisible(t))if(r=s.data.datasets[t].data,ht.isObject(r[0]))for(f[t]=[],e=0,n=r.length;e<n;++e)a=Vi(o,r[e]),p.push(a),f[t][e]=a;else{for(e=0,n=m.length;e<n;++e)p.push(m[e]);f[t]=m.slice(0)}else f[t]=[];m.length&&(m=Hi(m).sort(Bi),u=Math.min(u,m[0]),d=Math.max(d,m[m.length-1])),p.length&&(p=Hi(p).sort(Bi),u=Math.min(u,p[0]),d=Math.max(d,p[p.length-1])),u=Vi(o,c.min)||u,d=Vi(o,c.max)||d,u=u===ki?+l.startOf(Date.now(),h):u,d=d===ji?+l.endOf(Date.now(),h)+1:d,o.min=Math.min(u,d),o.max=Math.max(u+1,d),o._horizontal=o.isHorizontal(),o._table=[],o._timestamps={data:p,datasets:f,labels:m}},buildTicks:function(){var t,e,i,n,r,a,o,s,l,c,h=this,u=h.min,d=h.max,p=h.options,f=p.time,m=[],g=[];switch(p.ticks.source){case"data":m=h._timestamps.data;break;case"labels":m=h._timestamps.labels;break;case"auto":default:m=function(t,u,d,e){var i,n=t._adapter,r=t.options,a=r.time,p=a.unit||function(t,e,i,n){var r,a,o,s=Fi.length;for(r=Fi.indexOf(t);r<s-1;++r)if(o=(a=Ni[Fi[r]]).steps?a.steps[a.steps.length-1]:ki,a.common&&Math.ceil((i-e)/(o*a.size))<=n)return Fi[r];return Fi[s-1]}(a.minUnit,u,d,e),o=Gi(p),s=Di(a.stepSize,a.unitStepSize),l="week"===p&&a.isoWeekday,c=r.ticks.major.enabled,h=Ni[p],f=u,m=d,g=[];for(s||(s=function(t,e,i,n){var r,a,o,s=d-u,l=Ni[p],c=l.size,h=l.steps;if(!h)return Math.ceil(s/(n*c));for(r=0,a=h.length;r<a&&(o=h[r],!(Math.ceil(s/(c*o))<=n));++r);return o}(0,0,0,e)),l&&(f=+n.startOf(f,"isoWeek",l),m=+n.startOf(m,"isoWeek",l)),f=+n.startOf(f,l?"day":p),(m=+n.startOf(m,l?"day":p))<d&&(m=+n.add(m,1,p)),i=f,c&&o&&!l&&!a.round&&(i=+n.startOf(i,o),i=+n.add(i,~~((f-i)/(h.size*s))*s,p));i<m;i=+n.add(i,s,p))g.push(+i);return g.push(+i),g}(h,u,d,h.getLabelCapacity(u))}for("ticks"===p.bounds&&m.length&&(u=m[0],d=m[m.length-1]),u=Vi(h,f.min)||u,d=Vi(h,f.max)||d,t=0,e=m.length;t<e;++t)(i=m[t])>=u&&i<=d&&g.push(i);return h.min=u,h.max=d,h._unit=f.unit||function(t,e,i,n,r){var a,o;for(a=Fi.length-1;a>=Fi.indexOf(i);a--)if(o=Fi[a],Ni[o].common&&t._adapter.diff(r,n,o)>=e.length)return o;return Fi[i?Fi.indexOf(i):0]}(h,g,f.minUnit,h.min,h.max),h._majorUnit=Gi(h._unit),h._table=function(t,e,i,n){if("linear"===p.distribution||!t.length)return[{time:e,pos:0},{time:i,pos:1}];var r,a,o,s,l,c=[],h=[e];for(r=0,a=t.length;r<a;++r)(s=t[r])>e&&s<i&&h.push(s);for(h.push(i),r=0,a=h.length;r<a;++r)l=h[r+1],o=h[r-1],s=h[r],void 0!==o&&void 0!==l&&Math.round((l+o)/2)===s||c.push({time:s,pos:r/(a-1)});return c}(h._timestamps.data,u,d),h._offsets=(n=h._table,r=g,c=l=0,(a=p).offset&&r.length&&(a.time.min||(o=Ui(n,"time",r[0],"pos"),l=1===r.length?1-o:(Ui(n,"time",r[1],"pos")-o)/2),a.time.max||(s=Ui(n,"time",r[r.length-1],"pos"),c=1===r.length?s:(s-Ui(n,"time",r[r.length-2],"pos"))/2)),{start:l,end:c}),p.ticks.reverse&&g.reverse(),function(t,e,i){var n,r,a,o,s=[];for(n=0,r=e.length;n<r;++n)a=e[n],o=!!i&&a===+t._adapter.startOf(a,i),s.push({value:a,major:o});return s}(h,g,h._majorUnit)},getLabelForIndex:function(t,e){var i=this._adapter,n=this.chart.data,r=this.options.time,a=n.labels&&t<n.labels.length?n.labels[t]:"",o=n.datasets[e].data[t];return ht.isObject(o)&&(a=this.getRightValue(o)),r.tooltipFormat?i.format(zi(this,a),r.tooltipFormat):"string"==typeof a?a:i.format(zi(this,a),r.displayFormats.datetime)},tickFormatFunction:function(t,e,i,n){var r=this._adapter,a=this.options,o=a.time.displayFormats,s=o[this._unit],l=this._majorUnit,c=o[l],h=+r.startOf(t,l),u=a.ticks.major,d=u.enabled&&l&&c&&t===h,p=r.format(t,n||(d?c:s)),f=d?u:a.ticks.minor,m=Di(f.callback,f.userCallback);return m?m(p,e,i):p},convertTicksToLabels:function(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(this.tickFormatFunction(t[e].value,e,t));return n},getPixelForOffset:function(t){var e=this,i=e.options.ticks.reverse,n=e._horizontal?e.width:e.height,r=e._horizontal?i?e.right:e.left:i?e.bottom:e.top,a=Ui(e._table,"time",t,"pos"),o=n*(e._offsets.start+a)/(e._offsets.start+1+e._offsets.end);return i?r-o:r+o},getPixelForValue:function(t,e,i){var n=null;if(void 0!==e&&void 0!==i&&(n=this._timestamps.datasets[i][e]),null===n&&(n=Vi(this,t)),null!==n)return this.getPixelForOffset(n)},getPixelForTick:function(t){var e=this.getTicks();return 0<=t&&t<e.length?this.getPixelForOffset(e[t].value):null},getValueForPixel:function(t){var e=this,i=e._horizontal?e.width:e.height,n=e._horizontal?e.left:e.top,r=(i?(t-n)/i:0)*(e._offsets.start+1+e._offsets.start)-e._offsets.end,a=Ui(e._table,"pos",r,"time");return e._adapter._create(a)},getLabelWidth:function(t){var e=this.options.ticks,i=this.ctx.measureText(t).width,n=ht.toRadians(e.maxRotation),r=Math.cos(n),a=Math.sin(n);return i*r+Di(e.fontSize,st.global.defaultFontSize)*a},getLabelCapacity:function(t){var e=this.options.time.displayFormats.millisecond,i=this.tickFormatFunction(t,0,[],e),n=this.getLabelWidth(i),r=this.isHorizontal()?this.width:this.height,a=Math.floor(r/n);return 0<a?a:1}});Wi._defaults={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};var Yi={category:ui,linear:gi,logarithmic:xi,radialLinear:Oi,time:Wi},Xi={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};ri._date.override("function"==typeof n?{_id:"moment",formats:function(){return Xi},parse:function(t,e){return"string"==typeof t&&"string"==typeof e?t=n(t,e):t instanceof n||(t=n(t)),t.isValid()?t.valueOf():null},format:function(t,e){return n(t).format(e)},add:function(t,e,i){return n(t).add(e,i).valueOf()},diff:function(t,e,i){return n.duration(n(t).diff(n(e))).as(i)},startOf:function(t,e,i){return t=n(t),"isoWeek"===e?t.isoWeekday(i).valueOf():t.startOf(e).valueOf()},endOf:function(t,e){return n(t).endOf(e).valueOf()},_create:function(t){return n(t)}}:{}),st._set("global",{plugins:{filler:{propagate:!0}}});var qi={dataset:function(t){var e=t.fill,i=t.chart,n=i.getDatasetMeta(e),r=n&&i.isDatasetVisible(e)&&n.dataset._children||[],a=r.length||0;return a?function(t,e){return e<a&&r[e]._view||null}:null},boundary:function(t){var e=t.boundary,i=e?e.x:null,n=e?e.y:null;return function(t){return{x:null===i?t.x:i,y:null===n?t.y:n}}}};function Ji(t,e,i){var n,r=t._model||{},a=r.fill;if(void 0===a&&(a=!!r.backgroundColor),!1===a||null===a)return!1;if(!0===a)return"origin";if(n=parseFloat(a,10),isFinite(n)&&Math.floor(n)===n)return"-"!==a[0]&&"+"!==a[0]||(n=e+n),!(n===e||n<0||i<=n)&&n;switch(a){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return a;default:return!1}}function Zi(t){var e,i=t.el._model||{},n=t.el._scale||{},r=t.fill,a=null;if(isFinite(r))return null;if("start"===r?a=void 0===i.scaleBottom?n.bottom:i.scaleBottom:"end"===r?a=void 0===i.scaleTop?n.top:i.scaleTop:void 0!==i.scaleZero?a=i.scaleZero:n.getBasePosition?a=n.getBasePosition():n.getBasePixel&&(a=n.getBasePixel()),null!=a){if(void 0!==a.x&&void 0!==a.y)return a;if(ht.isFinite(a))return{x:(e=n.isHorizontal())?a:null,y:e?null:a}}return null}function Qi(t,e,i){var n,r=t[e].fill,a=[e];if(!i)return r;for(;!1!==r&&-1===a.indexOf(r);){if(!isFinite(r))return r;if(!(n=t[r]))return!1;if(n.visible)return r;a.push(r),r=n.fill}return!1}function Ki(t){return t&&!t.skip}function $i(t,e,i,n,r){var a;if(n&&r){for(t.moveTo(e[0].x,e[0].y),a=1;a<n;++a)ht.canvas.lineTo(t,e[a-1],e[a]);for(t.lineTo(i[r-1].x,i[r-1].y),a=r-1;0<a;--a)ht.canvas.lineTo(t,i[a],i[a-1],!0)}}var tn={id:"filler",afterDatasetsUpdate:function(t,e){var i,n,r,a,o,s,l,c=(t.data.datasets||[]).length,h=e.propagate,u=[];for(n=0;n<c;++n)a=null,(r=(i=t.getDatasetMeta(n)).dataset)&&r._model&&r instanceof Ft.Line&&(a={visible:t.isDatasetVisible(n),fill:Ji(r,n,c),chart:t,el:r}),i.$filler=a,u.push(a);for(n=0;n<c;++n)(a=u[n])&&(a.fill=Qi(u,n,h),a.boundary=Zi(a),a.mapper=(l=void 0,s=(o=a).fill,!(l="dataset")===s?null:(isFinite(s)||(l="boundary"),qi[l](o))))},beforeDatasetDraw:function(t,e){var i=e.meta.$filler;if(i){var n=t.ctx,r=i.el,a=r._view,o=r._children||[],s=i.mapper,l=a.backgroundColor||st.global.defaultColor;s&&l&&o.length&&(ht.canvas.clipArea(n,t.chartArea),function(t,e,i,n,r,a){var o,s,l,c,h,u,d,p=e.length,f=n.spanGaps,m=[],g=[],v=0,y=0;for(t.beginPath(),o=0,s=p+!!a;o<s;++o)h=i(c=e[l=o%p]._view,l,n),u=Ki(c),d=Ki(h),u&&d?(v=m.push(c),y=g.push(h)):v&&y&&(f?(u&&m.push(c),d&&g.push(h)):($i(t,m,g,v,y),v=y=0,m=[],g=[]));$i(t,m,g,v,y),t.closePath(),t.fillStyle=r,t.fill()}(n,o,s,a,l,r._loop),ht.canvas.unclipArea(n))}}},en=ht.noop,nn=ht.valueOrDefault;function rn(t,e){return t.usePointStyle&&t.boxWidth>e?e:t.boxWidth}st._set("global",{legend:{display:!0,position:"top",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(t,e){var i=e.datasetIndex,n=this.chart,r=n.getDatasetMeta(i);r.hidden=null===r.hidden?!n.data.datasets[i].hidden:null,n.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(i){var t=i.data;return ht.isArray(t.datasets)?t.datasets.map(function(t,e){return{text:t.label,fillStyle:ht.isArray(t.backgroundColor)?t.backgroundColor[0]:t.backgroundColor,hidden:!i.isDatasetVisible(e),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,pointStyle:t.pointStyle,datasetIndex:e}},this):[]}}},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');for(var i=0;i<t.data.datasets.length;i++)e.push('<li><span style="background-color:'+t.data.datasets[i].backgroundColor+'"></span>'),t.data.datasets[i].label&&e.push(t.data.datasets[i].label),e.push("</li>");return e.push("</ul>"),e.join("")}});var an=mt.extend({initialize:function(t){ht.extend(this,t),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:en,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:en,beforeSetDimensions:en,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:en,beforeBuildLabels:en,buildLabels:function(){var e=this,i=e.options.labels||{},t=ht.callback(i.generateLabels,[e.chart],e)||[];i.filter&&(t=t.filter(function(t){return i.filter(t,e.chart.data)})),e.options.reverse&&t.reverse(),e.legendItems=t},afterBuildLabels:en,beforeFit:en,fit:function(){var t=this,e=t.options,n=e.labels,i=e.display,r=t.ctx,a=ht.options._parseFont(n),o=a.size,s=t.legendHitBoxes=[],l=t.minSize,c=t.isHorizontal();if(l.height=c?(l.width=t.maxWidth,i?10:0):(l.width=i?10:0,t.maxHeight),i)if(r.font=a.string,c){var h=t.lineWidths=[0],u=0;r.textAlign="left",r.textBaseline="top",ht.each(t.legendItems,function(t,e){var i=rn(n,o)+o/2+r.measureText(t.text).width;(0===e||h[h.length-1]+i+n.padding>l.width)&&(u+=o+n.padding,h[h.length-(0<e?0:1)]=n.padding),s[e]={left:0,top:0,width:i,height:o},h[h.length-1]+=i+n.padding}),l.height+=u}else{var d=n.padding,p=t.columnWidths=[],f=n.padding,m=0,g=0,v=o+d;ht.each(t.legendItems,function(t,e){var i=rn(n,o)+o/2+r.measureText(t.text).width;0<e&&g+v>l.height-d&&(f+=m+n.padding,p.push(m),g=m=0),m=Math.max(m,i),g+=v,s[e]={left:0,top:0,width:i,height:o}}),f+=m,p.push(m),l.width+=f}t.width=l.width,t.height=l.height},afterFit:en,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var u=this,d=u.options,p=d.labels,t=st.global,f=t.defaultColor,m=t.elements.line,g=u.width,v=u.lineWidths;if(d.display){var y,_=u.ctx,e=nn(p.fontColor,t.defaultFontColor),i=ht.options._parseFont(p),b=i.size;_.textAlign="left",_.textBaseline="middle",_.lineWidth=.5,_.strokeStyle=e,_.fillStyle=e,_.font=i.string;var x=rn(p,b),w=u.legendHitBoxes,T=u.isHorizontal();y=T?{x:u.left+(g-v[0])/2+p.padding,y:u.top+p.padding,line:0}:{x:u.left+p.padding,y:u.top+p.padding,line:0};var M=b+p.padding;ht.each(u.legendItems,function(t,e){var i,n,r,a,o,s=_.measureText(t.text).width,l=x+b/2+s,c=y.x,h=y.y;T?0<e&&c+l+p.padding>u.left+u.minSize.width&&(h=y.y+=M,y.line++,c=y.x=u.left+(g-v[y.line])/2+p.padding):0<e&&h+M>u.top+u.minSize.height&&(c=y.x=c+u.columnWidths[y.line]+p.padding,h=y.y=u.top+p.padding,y.line++),function(t,e,i){if(!(isNaN(x)||x<=0)){_.save();var n=nn(i.lineWidth,m.borderWidth);if(_.fillStyle=nn(i.fillStyle,f),_.lineCap=nn(i.lineCap,m.borderCapStyle),_.lineDashOffset=nn(i.lineDashOffset,m.borderDashOffset),_.lineJoin=nn(i.lineJoin,m.borderJoinStyle),_.lineWidth=n,_.strokeStyle=nn(i.strokeStyle,f),_.setLineDash&&_.setLineDash(nn(i.lineDash,m.borderDash)),d.labels&&d.labels.usePointStyle){var r=x*Math.SQRT2/2,a=t+x/2,o=e+b/2;ht.canvas.drawPoint(_,i.pointStyle,r,a,o)}else 0!==n&&_.strokeRect(t,e,x,b),_.fillRect(t,e,x,b);_.restore()}}(c,h,t),w[e].left=c,w[e].top=h,i=t,n=s,a=x+(r=b/2)+c,o=h+r,_.fillText(i.text,a,o),i.hidden&&(_.beginPath(),_.lineWidth=2,_.moveTo(a,o),_.lineTo(a+n,o),_.stroke()),T?y.x+=l+p.padding:y.y+=M})}},_getLegendItemAt:function(t,e){var i,n,r;if(t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom)for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(t>=(n=r[i]).left&&t<=n.left+n.width&&e>=n.top&&e<=n.top+n.height)return this.legendItems[i];return null},handleEvent:function(t){var e,i=this.options,n="mouseup"===t.type?"click":t.type;if("mousemove"===n){if(!i.onHover&&!i.onLeave)return}else{if("click"!==n)return;if(!i.onClick)return}e=this._getLegendItemAt(t.x,t.y),"click"===n?e&&i.onClick&&i.onClick.call(this,t.native,e):(i.onLeave&&e!==this._hoveredItem&&(this._hoveredItem&&i.onLeave.call(this,t.native,this._hoveredItem),this._hoveredItem=e),i.onHover&&e&&i.onHover.call(this,t.native,e))}});function on(t,e){var i=new an({ctx:t.ctx,options:e,chart:t});xe.configure(t,i,e),xe.addBox(t,i),t.legend=i}var sn={id:"legend",_element:an,beforeInit:function(t){var e=t.options.legend;e&&on(t,e)},beforeUpdate:function(t){var e=t.options.legend,i=t.legend;e?(ht.mergeIf(e,st.global.legend),i?(xe.configure(t,i,e),i.options=e):on(t,e)):i&&(xe.removeBox(t,i),delete t.legend)},afterEvent:function(t,e){var i=t.legend;i&&i.handleEvent(e)}},ln=ht.noop;st._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var cn=mt.extend({initialize:function(t){ht.extend(this,t),this.legendHitBoxes=[]},beforeUpdate:ln,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:ln,beforeSetDimensions:ln,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:ln,beforeBuildLabels:ln,buildLabels:ln,afterBuildLabels:ln,beforeFit:ln,fit:function(){var t=this.options,e=t.display,i=this.minSize,n=ht.isArray(t.text)?t.text.length:1,r=ht.options._parseFont(t),a=e?n*r.lineHeight+2*t.padding:0;this.isHorizontal()?(i.width=this.maxWidth,i.height=a):(i.width=a,i.height=this.maxHeight),this.width=i.width,this.height=i.height},afterFit:ln,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var t=this.ctx,e=this.options;if(e.display){var i,n,r,a=ht.options._parseFont(e),o=a.lineHeight,s=o/2+e.padding,l=0,c=this.top,h=this.left,u=this.bottom,d=this.right;t.fillStyle=ht.valueOrDefault(e.fontColor,st.global.defaultFontColor),t.font=a.string,this.isHorizontal()?(n=h+(d-h)/2,r=c+s,i=d-h):(n="left"===e.position?h+s:d-s,r=c+(u-c)/2,i=u-c,l=Math.PI*("left"===e.position?-.5:.5)),t.save(),t.translate(n,r),t.rotate(l),t.textAlign="center",t.textBaseline="middle";var p=e.text;if(ht.isArray(p))for(var f=0,m=0;m<p.length;++m)t.fillText(p[m],0,f,i),f+=o;else t.fillText(p,0,0,i);t.restore()}}});function hn(t,e){var i=new cn({ctx:t.ctx,options:e,chart:t});xe.configure(t,i,e),xe.addBox(t,i),t.titleBlock=i}var un={},dn=tn,pn=sn,fn={id:"title",_element:cn,beforeInit:function(t){var e=t.options.title;e&&hn(t,e)},beforeUpdate:function(t){var e=t.options.title,i=t.titleBlock;e?(ht.mergeIf(e,st.global.title),i?(xe.configure(t,i,e),i.options=e):hn(t,e)):i&&(xe.removeBox(t,i),delete t.titleBlock)}};for(var mn in un.filler=dn,un.legend=pn,un.title=fn,ei.helpers=ht,function(){function h(t,e,i){var n;return"string"==typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}function u(t){return null!=t&&"none"!==t}function e(t,e,i){var n=document.defaultView,r=ht._getParentNode(t),a=n.getComputedStyle(t)[e],o=n.getComputedStyle(r)[e],s=u(a),l=u(o),c=Number.POSITIVE_INFINITY;return s||l?Math.min(s?h(a,t,i):c,l?h(o,r,i):c):"none"}ht.where=function(t,e){if(ht.isArray(t)&&Array.prototype.filter)return t.filter(e);var i=[];return ht.each(t,function(t){e(t)&&i.push(t)}),i},ht.findIndex=Array.prototype.findIndex?function(t,e,i){return t.findIndex(e,i)}:function(t,e,i){i=void 0===i?t:i;for(var n=0,r=t.length;n<r;++n)if(e.call(i,t[n],n,t))return n;return-1},ht.findNextWhere=function(t,e,i){ht.isNullOrUndef(i)&&(i=-1);for(var n=i+1;n<t.length;n++){var r=t[n];if(e(r))return r}},ht.findPreviousWhere=function(t,e,i){ht.isNullOrUndef(i)&&(i=t.length);for(var n=i-1;0<=n;n--){var r=t[n];if(e(r))return r}},ht.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},ht.almostEquals=function(t,e,i){return Math.abs(t-e)<i},ht.almostWhole=function(t,e){var i=Math.round(t);return i-e<t&&t<i+e},ht.max=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.max(t,e)},Number.NEGATIVE_INFINITY)},ht.min=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.min(t,e)},Number.POSITIVE_INFINITY)},ht.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return 0==(t=+t)||isNaN(t)?t:0<t?1:-1},ht.log10=Math.log10?function(t){return Math.log10(t)}:function(t){var e=Math.log(t)*Math.LOG10E,i=Math.round(e);return t===Math.pow(10,i)?i:e},ht.toRadians=function(t){return t*(Math.PI/180)},ht.toDegrees=function(t){return t*(180/Math.PI)},ht._decimalPlaces=function(t){if(ht.isFinite(t)){for(var e=1,i=0;Math.round(t*e)/e!==t;)e*=10,i++;return i}},ht.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=Math.sqrt(i*i+n*n),a=Math.atan2(n,i);return a<-.5*Math.PI&&(a+=2*Math.PI),{angle:a,distance:r}},ht.distanceBetweenPoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},ht.aliasPixel=function(t){return t%2==0?0:.5},ht._alignPixel=function(t,e,i){var n=t.currentDevicePixelRatio,r=i/2;return Math.round((e-r)*n)/n+r},ht.splineCurve=function(t,e,i,n){var r=t.skip?e:t,a=e,o=i.skip?e:i,s=Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2)),l=Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2)),c=s/(s+l),h=l/(s+l),u=n*(c=isNaN(c)?0:c),d=n*(h=isNaN(h)?0:h);return{previous:{x:a.x-u*(o.x-r.x),y:a.y-u*(o.y-r.y)},next:{x:a.x+d*(o.x-r.x),y:a.y+d*(o.y-r.y)}}},ht.EPSILON=Number.EPSILON||1e-14,ht.splineCurveMonotone=function(t){var e,i,n,r,a,o,s,l,c,h=(t||[]).map(function(t){return{model:t._model,deltaK:0,mK:0}}),u=h.length;for(e=0;e<u;++e)if(!(n=h[e]).model.skip){if(i=0<e?h[e-1]:null,(r=e<u-1?h[e+1]:null)&&!r.model.skip){var d=r.model.x-n.model.x;n.deltaK=0!==d?(r.model.y-n.model.y)/d:0}!i||i.model.skip?n.mK=n.deltaK:!r||r.model.skip?n.mK=i.deltaK:this.sign(i.deltaK)!==this.sign(n.deltaK)?n.mK=0:n.mK=(i.deltaK+n.deltaK)/2}for(e=0;e<u-1;++e)n=h[e],r=h[e+1],n.model.skip||r.model.skip||(ht.almostEquals(n.deltaK,0,this.EPSILON)?n.mK=r.mK=0:(a=n.mK/n.deltaK,o=r.mK/n.deltaK,(l=Math.pow(a,2)+Math.pow(o,2))<=9||(s=3/Math.sqrt(l),n.mK=a*s*n.deltaK,r.mK=o*s*n.deltaK)));for(e=0;e<u;++e)(n=h[e]).model.skip||(i=0<e?h[e-1]:null,r=e<u-1?h[e+1]:null,i&&!i.model.skip&&(c=(n.model.x-i.model.x)/3,n.model.controlPointPreviousX=n.model.x-c,n.model.controlPointPreviousY=n.model.y-c*n.mK),r&&!r.model.skip&&(c=(r.model.x-n.model.x)/3,n.model.controlPointNextX=n.model.x+c,n.model.controlPointNextY=n.model.y+c*n.mK))},ht.nextItem=function(t,e,i){return i?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},ht.previousItem=function(t,e,i){return i?e<=0?t[t.length-1]:t[e-1]:e<=0?t[0]:t[e-1]},ht.niceNum=function(t,e){var i=Math.floor(ht.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},ht.requestAnimFrame="undefined"==typeof window?function(t){t()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},ht.getRelativePosition=function(t,e){var i,n,r=t.originalEvent||t,a=t.target||t.srcElement,o=a.getBoundingClientRect(),s=r.touches;n=s&&0<s.length?(i=s[0].clientX,s[0].clientY):(i=r.clientX,r.clientY);var l=parseFloat(ht.getStyle(a,"padding-left")),c=parseFloat(ht.getStyle(a,"padding-top")),h=parseFloat(ht.getStyle(a,"padding-right")),u=parseFloat(ht.getStyle(a,"padding-bottom")),d=o.right-o.left-l-h,p=o.bottom-o.top-c-u;return{x:i=Math.round((i-o.left-l)/d*a.width/e.currentDevicePixelRatio),y:n=Math.round((n-o.top-c)/p*a.height/e.currentDevicePixelRatio)}},ht.getConstraintWidth=function(t){return e(t,"max-width","clientWidth")},ht.getConstraintHeight=function(t){return e(t,"max-height","clientHeight")},ht._calculatePadding=function(t,e,i){return-1<(e=ht.getStyle(t,e)).indexOf("%")?i*parseInt(e,10)/100:parseInt(e,10)},ht._getParentNode=function(t){var e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e},ht.getMaximumWidth=function(t){var e=ht._getParentNode(t);if(!e)return t.clientWidth;var i=e.clientWidth,n=i-ht._calculatePadding(e,"padding-left",i)-ht._calculatePadding(e,"padding-right",i),r=ht.getConstraintWidth(t);return isNaN(r)?n:Math.min(n,r)},ht.getMaximumHeight=function(t){var e=ht._getParentNode(t);if(!e)return t.clientHeight;var i=e.clientHeight,n=i-ht._calculatePadding(e,"padding-top",i)-ht._calculatePadding(e,"padding-bottom",i),r=ht.getConstraintHeight(t);return isNaN(r)?n:Math.min(n,r)},ht.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},ht.retinaScale=function(t,e){var i=t.currentDevicePixelRatio=e||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==i){var n=t.canvas,r=t.height,a=t.width;n.height=r*i,n.width=a*i,t.ctx.scale(i,i),n.style.height||n.style.width||(n.style.height=r+"px",n.style.width=a+"px")}},ht.fontString=function(t,e,i){return e+" "+t+"px "+i},ht.longestText=function(e,t,i,n){var r=(n=n||{}).data=n.data||{},a=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(r=n.data={},a=n.garbageCollect=[],n.font=t),e.font=t;var o=0;ht.each(i,function(t){null!=t&&!0!==ht.isArray(t)?o=ht.measureText(e,r,a,o,t):ht.isArray(t)&&ht.each(t,function(t){null==t||ht.isArray(t)||(o=ht.measureText(e,r,a,o,t))})});var s=a.length/2;if(s>i.length){for(var l=0;l<s;l++)delete r[a[l]];a.splice(0,s)}return o},ht.measureText=function(t,e,i,n,r){var a=e[r];return a||(a=e[r]=t.measureText(r).width,i.push(r)),n<a&&(n=a),n},ht.numberOfLabelLines=function(t){var e=1;return ht.each(t,function(t){ht.isArray(t)&&t.length>e&&(e=t.length)}),e},ht.color=X?function(t){return t instanceof CanvasGradient&&(t=st.global.defaultColor),X(t)}:function(t){return console.error("Color.js not found!"),t},ht.getHoverColor=function(t){return t instanceof CanvasPattern||t instanceof CanvasGradient?t:ht.color(t).saturate(.5).darken(.1).rgbString()}}(),ei._adapters=ri,ei.Animation=vt,ei.animationService=yt,ei.controllers=ce,ei.DatasetController=Tt,ei.defaults=st,ei.Element=mt,ei.elements=Ft,ei.Interaction=ge,ei.layouts=xe,ei.platform=Ne,ei.plugins=Fe,ei.Scale=hi,ei.scaleService=Be,ei.Ticks=ai,ei.Tooltip=Je,ei.helpers.each(Yi,function(t,e){ei.scaleService.registerScaleType(e,t,t._defaults)}),un)un.hasOwnProperty(mn)&&ei.plugins.register(un[mn]);ei.platform.initialize();var gn=ei;return"undefined"!=typeof window&&(window.Chart=ei),(ei.Chart=ei).Legend=un.legend._element,ei.Title=un.title._element,ei.pluginService=ei.plugins,ei.PluginBase=ei.Element.extend({}),ei.canvasHelpers=ei.helpers.canvas,ei.layoutService=ei.layouts,ei.LinearScaleBase=fi,ei.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],function(i){ei[i]=function(t,e){return new ei(t,ei.helpers.merge(e||{},{type:i.charAt(0).toLowerCase()+i.slice(1)}))}}),gn}),this.createjs=this.createjs||{},createjs.extend=function(t,e){function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var r in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(r)&&"function"==typeof n[r]&&(i[e+r]=n[r]);return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){for(var i=0,n=t.length;i<n;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){function t(){throw"UID cannot be instantiated"}t._nextID=0,t.get=function(){return t._nextID++},createjs.UID=t}(),this.createjs=this.createjs||{},createjs.deprecate=function(e,i){return function(){var t="Deprecated property or method '"+i+"'. See docs for info.";return console&&(console.warn?console.warn(t):console.log(t)),e&&e.apply(this,arguments)}},this.createjs=this.createjs||{},function(){function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n,r=(n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[t];return r&&this.removeEventListener(t,e,i),(r=n[t])?r.push(e):n[t]=[e],e},e.on=function(t,e,i,n,r,a){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,function(t){e.call(i,t,r),n&&t.remove()},a)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var r=n[t];if(r)for(var a=0,o=r.length;a<o;a++)if(r[a]==e){1==o?delete n[t]:r.splice(a,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!(e||n&&n[t]))return!0;t=new createjs.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(t){}if(t.bubbles&&this.parent){for(var r=this,a=[r];r.parent;)a.push(r=r.parent);var o,s=a.length;for(o=s-1;0<=o&&!t.propagationStopped;o--)a[o]._dispatchEvent(t,1+(0==o));for(o=1;o<s&&!t.propagationStopped;o++)a[o]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n,r=e<=2?this._captureListeners:this._listeners;if(t&&r&&(n=r[t.type])&&(i=n.length)){try{t.currentTarget=this}catch(t){}try{t.eventPhase=0|e}catch(t){}t.removed=!1,n=n.slice();for(var a=0;a<i&&!t.immediatePropagationStopped;a++){var o=n[a];o.handleEvent?o.handleEvent(t):o(t),t.removed&&(this.off(t.type,o,1==e),t.removed=!1)}}2===e&&this._dispatchEvent(t,2.1)},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){function a(){throw"Ticker cannot be instantiated."}a.RAF_SYNCHED="synched",a.RAF="raf",a.TIMEOUT="timeout",a.timingMode=null,a.maxDelta=0,a.paused=!1,a.removeEventListener=null,a.removeAllEventListeners=null,a.dispatchEvent=null,a.hasEventListener=null,a._listeners=null,createjs.EventDispatcher.initialize(a),a._addEventListener=a.addEventListener,a.addEventListener=function(){return!a._inited&&a.init(),a._addEventListener.apply(a,arguments)},a._inited=!1,a._startTime=0,a._pausedTime=0,a._ticks=0,a._pausedTicks=0,a._interval=50,a._lastTime=0,a._times=null,a._tickTimes=null,a._timerId=null,a._raf=!0,a._setInterval=function(t){a._interval=t,a._inited&&a._setupTick()},a.setInterval=createjs.deprecate(a._setInterval,"Ticker.setInterval"),a._getInterval=function(){return a._interval},a.getInterval=createjs.deprecate(a._getInterval,"Ticker.getInterval"),a._setFPS=function(t){a._setInterval(1e3/t)},a.setFPS=createjs.deprecate(a._setFPS,"Ticker.setFPS"),a._getFPS=function(){return 1e3/a._interval},a.getFPS=createjs.deprecate(a._getFPS,"Ticker.getFPS");try{Object.defineProperties(a,{interval:{get:a._getInterval,set:a._setInterval},framerate:{get:a._getFPS,set:a._setFPS}})}catch(t){console.log(t)}a.init=function(){a._inited||(a._inited=!0,a._times=[],a._tickTimes=[],a._startTime=a._getTime(),a._times.push(a._lastTime=0),a.interval=a._interval)},a.reset=function(){if(a._raf){var t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;t&&t(a._timerId)}else clearTimeout(a._timerId);a.removeAllEventListeners("tick"),a._timerId=a._times=a._tickTimes=null,a._startTime=a._lastTime=a._ticks=a._pausedTime=0,a._inited=!1},a.getMeasuredTickTime=function(t){var e=0,i=a._tickTimes;if(!i||i.length<1)return-1;t=Math.min(i.length,t||0|a._getFPS());for(var n=0;n<t;n++)e+=i[n];return e/t},a.getMeasuredFPS=function(t){var e=a._times;return!e||e.length<2?-1:(t=Math.min(e.length-1,t||0|a._getFPS()),1e3/((e[0]-e[t])/t))},a.getTime=function(t){return a._startTime?a._getTime()-(t?a._pausedTime:0):-1},a.getEventTime=function(t){return a._startTime?(a._lastTime||a._startTime)-(t?a._pausedTime:0):-1},a.getTicks=function(t){return a._ticks-(t?a._pausedTicks:0)},a._handleSynch=function(){a._timerId=null,a._setupTick(),a._getTime()-a._lastTime>=.97*(a._interval-1)&&a._tick()},a._handleRAF=function(){a._timerId=null,a._setupTick(),a._tick()},a._handleTimeout=function(){a._timerId=null,a._setupTick(),a._tick()},a._setupTick=function(){if(null==a._timerId){var t=a.timingMode;if(t==a.RAF_SYNCHED||t==a.RAF){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(e)return a._timerId=e(t==a.RAF?a._handleRAF:a._handleSynch),void(a._raf=!0)}a._raf=!1,a._timerId=setTimeout(a._handleTimeout,a._interval)}},a._tick=function(){var t=a.paused,e=a._getTime(),i=e-a._lastTime;if(a._lastTime=e,a._ticks++,t&&(a._pausedTicks++,a._pausedTime+=i),a.hasEventListener("tick")){var n=new createjs.Event("tick"),r=a.maxDelta;n.delta=r&&r<i?r:i,n.paused=t,n.time=e,n.runTime=e-a._pausedTime,a.dispatchEvent(n)}for(a._tickTimes.unshift(a._getTime()-e);100<a._tickTimes.length;)a._tickTimes.pop();for(a._times.unshift(e);100<a._times.length;)a._times.pop()};var t=window,e=t.performance.now||t.performance.mozNow||t.performance.msNow||t.performance.oNow||t.performance.webkitNow;a._getTime=function(){return(e&&e.call(t.performance)||(new Date).getTime())-a._startTime},createjs.Ticker=a}(),this.createjs=this.createjs||{},function(){function t(t){this.readyState=t.readyState,this._video=t,this._canvas=null,this._lastTime=-1,this.readyState<2&&t.addEventListener("canplaythrough",this._videoReady.bind(this))}var e=t.prototype;e.getImage=function(){if(!(this.readyState<2)){var t=this._canvas,e=this._video;if(t||((t=this._canvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")).width=e.videoWidth,t.height=e.videoHeight),2<=e.readyState&&e.currentTime!==this._lastTime){var i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i.drawImage(e,0,0,t.width,t.height),this._lastTime=e.currentTime}return t}},e._videoReady=function(){this.readyState=2},createjs.VideoBuffer=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,r,a,o,s,l,c,h){this.Event_constructor(t,e,i),this.stageX=n,this.stageY=r,this.rawX=null==l?n:l,this.rawY=null==c?r:c,this.nativeEvent=a,this.pointerID=o,this.primary=!!s,this.relatedTarget=h}var e=createjs.extend(t,createjs.Event);e._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x},e._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y},e._get_isTouch=function(){return-1!==this.pointerID};try{Object.defineProperties(e,{localX:{get:e._get_localX},localY:{get:e._get_localY},isTouch:{get:e._get_isTouch}})}catch(t){}e.clone=function(){return new t(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)},e.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"},createjs.MouseEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){function d(t,e,i,n,r,a){this.setValues(t,e,i,n,r,a)}var t=d.prototype;d.DEG_TO_RAD=Math.PI/180,d.identity=null,t.setValues=function(t,e,i,n,r,a){return this.a=null==t?1:t,this.b=e||0,this.c=i||0,this.d=null==n?1:n,this.tx=r||0,this.ty=a||0,this},t.append=function(t,e,i,n,r,a){var o=this.a,s=this.b,l=this.c,c=this.d;return(1!=t||0!=e||0!=i||1!=n)&&(this.a=o*t+l*e,this.b=s*t+c*e,this.c=o*i+l*n,this.d=s*i+c*n),this.tx=o*r+l*a+this.tx,this.ty=s*r+c*a+this.ty,this},t.prepend=function(t,e,i,n,r,a){var o=this.a,s=this.c,l=this.tx;return this.a=t*o+i*this.b,this.b=e*o+n*this.b,this.c=t*s+i*this.d,this.d=e*s+n*this.d,this.tx=t*l+i*this.ty+r,this.ty=e*l+n*this.ty+a,this},t.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.appendTransform=function(t,e,i,n,r,a,o,s,l){if(r%360)var c=r*d.DEG_TO_RAD,h=Math.cos(c),u=Math.sin(c);else h=1,u=0;return a||o?(a*=d.DEG_TO_RAD,o*=d.DEG_TO_RAD,this.append(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),t,e),this.append(h*i,u*i,-u*n,h*n,0,0)):this.append(h*i,u*i,-u*n,h*n,t,e),(s||l)&&(this.tx-=s*this.a+l*this.c,this.ty-=s*this.b+l*this.d),this},t.prependTransform=function(t,e,i,n,r,a,o,s,l){if(r%360)var c=r*d.DEG_TO_RAD,h=Math.cos(c),u=Math.sin(c);else h=1,u=0;return(s||l)&&(this.tx-=s,this.ty-=l),a||o?(a*=d.DEG_TO_RAD,o*=d.DEG_TO_RAD,this.prepend(h*i,u*i,-u*n,h*n,0,0),this.prepend(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),t,e)):this.prepend(h*i,u*i,-u*n,h*n,t,e),this},t.rotate=function(t){t*=d.DEG_TO_RAD;var e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.b;return this.a=n*e+this.c*i,this.b=r*e+this.d*i,this.c=-n*i+this.c*e,this.d=-r*i+this.d*e,this},t.skew=function(t,e){return t*=d.DEG_TO_RAD,e*=d.DEG_TO_RAD,this.append(Math.cos(e),Math.sin(e),-Math.sin(t),Math.cos(t),0,0),this},t.scale=function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this},t.translate=function(t,e){return this.tx+=this.a*t+this.c*e,this.ty+=this.b*t+this.d*e,this},t.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},t.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,a=t*n-e*i;return this.a=n/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*r)/a,this.ty=-(t*this.ty-e*r)/a,this},t.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d},t.equals=function(t){return this.tx===t.tx&&this.ty===t.ty&&this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d},t.transformPoint=function(t,e,i){return(i=i||{}).x=t*this.a+e*this.c+this.tx,i.y=t*this.b+e*this.d+this.ty,i},t.decompose=function(t){null==t&&(t={}),t.x=this.tx,t.y=this.ty,t.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),t.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var e=Math.atan2(-this.c,this.d),i=Math.atan2(this.b,this.a);return Math.abs(1-e/i)<1e-5?(t.rotation=i/d.DEG_TO_RAD,this.a<0&&0<=this.d&&(t.rotation+=t.rotation<=0?180:-180),t.skewX=t.skewY=0):(t.skewX=e/d.DEG_TO_RAD,t.skewY=i/d.DEG_TO_RAD),t},t.copy=function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.clone=function(){return new d(this.a,this.b,this.c,this.d,this.tx,this.ty)},t.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},d.identity=new d,createjs.Matrix2D=d}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,r){this.setValues(t,e,i,n,r)}var e=t.prototype;e.setValues=function(t,e,i,n,r){return this.visible=null==t||!!t,this.alpha=null==e?1:e,this.shadow=i,this.compositeOperation=n,this.matrix=r||this.matrix&&this.matrix.identity()||new createjs.Matrix2D,this},e.append=function(t,e,i,n,r){return this.alpha*=e,this.shadow=i||this.shadow,this.compositeOperation=n||this.compositeOperation,this.visible=this.visible&&t,r&&this.matrix.appendMatrix(r),this},e.prepend=function(t,e,i,n,r){return this.alpha*=e,this.shadow=this.shadow||i,this.compositeOperation=this.compositeOperation||n,this.visible=this.visible&&t,r&&this.matrix.prependMatrix(r),this},e.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this},e.clone=function(){return new t(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())},createjs.DisplayProps=t}(),this.createjs=this.createjs||{},function(){function t(t,e){this.setValues(t,e)}var e=t.prototype;e.setValues=function(t,e){return this.x=t||0,this.y=e||0,this},e.copy=function(t){return this.x=t.x,this.y=t.y,this},e.clone=function(){return new t(this.x,this.y)},e.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},createjs.Point=t}(),this.createjs=this.createjs||{},function(){function a(t,e,i,n){this.setValues(t,e,i,n)}var t=a.prototype;t.setValues=function(t,e,i,n){return this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this},t.extend=function(t,e,i,n){return n=n||0,t+(i=i||0)>this.x+this.width&&(this.width=t+i-this.x),e+n>this.y+this.height&&(this.height=e+n-this.y),t<this.x&&(this.width+=this.x-t,this.x=t),e<this.y&&(this.height+=this.y-e,this.y=e),this},t.pad=function(t,e,i,n){return this.x-=e,this.y-=t,this.width+=e+n,this.height+=t+i,this},t.copy=function(t){return this.setValues(t.x,t.y,t.width,t.height)},t.contains=function(t,e,i,n){return i=i||0,n=n||0,t>=this.x&&t+i<=this.x+this.width&&e>=this.y&&e+n<=this.y+this.height},t.union=function(t){return this.clone().extend(t.x,t.y,t.width,t.height)},t.intersection=function(t){var e=t.x,i=t.y,n=e+t.width,r=i+t.height;return this.x>e&&(e=this.x),this.y>i&&(i=this.y),this.x+this.width<n&&(n=this.x+this.width),this.y+this.height<r&&(r=this.y+this.height),n<=e||r<=i?null:new a(e,i,n-e,r-i)},t.intersects=function(t){return t.x<=this.x+this.width&&this.x<=t.x+t.width&&t.y<=this.y+this.height&&this.y<=t.y+t.height},t.isEmpty=function(){return this.width<=0||this.height<=0},t.clone=function(){return new a(this.x,this.y,this.width,this.height)},t.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},createjs.Rectangle=a}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,r,a,o){t.addEventListener&&(this.target=t,this.overLabel=null==i?"over":i,this.outLabel=null==e?"out":e,this.downLabel=null==n?"down":n,this.play=r,this._isPressed=!1,this._isOver=!1,this._enabled=!1,t.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),a&&(o&&(a.actionsEnabled=!1,a.gotoAndStop&&a.gotoAndStop(o)),t.hitArea=a))}var e=t.prototype;e._setEnabled=function(t){if(t!=this._enabled){var e=this.target;(this._enabled=t)?(e.cursor="pointer",e.addEventListener("rollover",this),e.addEventListener("rollout",this),e.addEventListener("mousedown",this),e.addEventListener("pressup",this),e._reset&&(e.__reset=e._reset,e._reset=this._reset)):(e.cursor=null,e.removeEventListener("rollover",this),e.removeEventListener("rollout",this),e.removeEventListener("mousedown",this),e.removeEventListener("pressup",this),e.__reset&&(e._reset=e.__reset,delete e.__reset))}},e.setEnabled=createjs.deprecate(e._setEnabled,"ButtonHelper.setEnabled"),e._getEnabled=function(){return this._enabled},e.getEnabled=createjs.deprecate(e._getEnabled,"ButtonHelper.getEnabled");try{Object.defineProperties(e,{enabled:{get:e._getEnabled,set:e._setEnabled}})}catch(t){}e.toString=function(){return"[ButtonHelper]"},e.handleEvent=function(t){var e,i=this.target,n=t.type;e="mousedown"==n?(this._isPressed=!0,this.downLabel):"pressup"==n?(this._isPressed=!1,this._isOver?this.overLabel:this.outLabel):"rollover"==n?(this._isOver=!0,this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,this._isPressed?this.overLabel:this.outLabel),this.play?i.gotoAndPlay&&i.gotoAndPlay(e):i.gotoAndStop&&i.gotoAndStop(e)},e._reset=function(){var t=this.paused;this.__reset(),this.paused=t},createjs.ButtonHelper=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.color=t||"black",this.offsetX=e||0,this.offsetY=i||0,this.blur=n||0}var e=t.prototype;t.identity=new t("transparent",0,0,0),e.toString=function(){return"[Shadow]"},e.clone=function(){return new t(this.color,this.offsetX,this.offsetY,this.blur)},createjs.Shadow=t}(),this.createjs=this.createjs||{},function(){function t(t){this.EventDispatcher_constructor(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(t)}var e=createjs.extend(t,createjs.EventDispatcher);e._getAnimations=function(){return this._animations.slice()},e.getAnimations=createjs.deprecate(e._getAnimations,"SpriteSheet.getAnimations");try{Object.defineProperties(e,{animations:{get:e._getAnimations}})}catch(t){}e.getNumFrames=function(t){if(null==t)return this._frames?this._frames.length:this._numFrames||0;var e=this._data[t];return null==e?0:e.frames.length},e.getAnimation=function(t){return this._data[t]},e.getFrame=function(t){var e;return this._frames&&(e=this._frames[t])?e:null},e.getFrameBounds=function(t,e){var i=this.getFrame(t);return i?(e||new createjs.Rectangle).setValues(-i.regX,-i.regY,i.rect.width,i.rect.height):null},e.toString=function(){return"[SpriteSheet]"},e.clone=function(){throw"SpriteSheet cannot be cloned."},e._parseData=function(t){var e,i,n,r;if(null!=t){if(this.framerate=t.framerate||0,t.images&&0<(i=t.images.length))for(r=this._images=[],e=0;e<i;e++){var a=t.images[e];if("string"==typeof a){var o=a;(a=document.createElement("img")).src=o}r.push(a),a.getContext||a.naturalWidth||(this._loadCount++,this.complete=!1,function(t,e){a.onload=function(){t._handleImageLoad(e)}}(this,o),function(t,e){a.onerror=function(){t._handleImageError(e)}}(this,o))}if(null==t.frames);else if(Array.isArray(t.frames))for(this._frames=[],e=0,i=(r=t.frames).length;e<i;e++){var s=r[e];this._frames.push({image:this._images[s[4]?s[4]:0],rect:new createjs.Rectangle(s[0],s[1],s[2],s[3]),regX:s[5]||0,regY:s[6]||0})}else n=t.frames,this._frameWidth=n.width,this._frameHeight=n.height,this._regX=n.regX||0,this._regY=n.regY||0,this._spacing=n.spacing||0,this._margin=n.margin||0,this._numFrames=n.count,0==this._loadCount&&this._calculateFrames();var l;if(this._animations=[],null!=(n=t.animations))for(l in this._data={},n){var c={name:l},h=n[l];if("number"==typeof h)r=c.frames=[h];else if(Array.isArray(h))if(1==h.length)c.frames=[h[0]];else for(c.speed=h[3],c.next=h[2],r=c.frames=[],e=h[0];e<=h[1];e++)r.push(e);else{c.speed=h.speed,c.next=h.next;var u=h.frames;r=c.frames="number"==typeof u?[u]:u.slice(0)}(!0===c.next||void 0===c.next)&&(c.next=l),(!1===c.next||r.length<2&&c.next==l)&&(c.next=null),c.speed||(c.speed=1),this._animations.push(l),this._data[l]=c}}},e._handleImageLoad=function(t){0==--this._loadCount&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))},e._handleImageError=function(t){var e=new createjs.Event("error");e.src=t,this.dispatchEvent(e),0==--this._loadCount&&this.dispatchEvent("complete")},e._calculateFrames=function(){if(!this._frames&&0!=this._frameWidth){this._frames=[];var t=this._numFrames||1e5,e=0,i=this._frameWidth,n=this._frameHeight,r=this._spacing,a=this._margin;t:for(var o=0,s=this._images;o<s.length;o++)for(var l=s[o],c=l.width||l.naturalWidth,h=l.height||l.naturalHeight,u=a;u<=h-a-n;){for(var d=a;d<=c-a-i;){if(t<=e)break t;e++,this._frames.push({image:l,rect:new createjs.Rectangle(d,u,i,n),regX:this._regX,regY:this._regY}),d+=i+r}u+=n+r}this._numFrames=e}},createjs.SpriteSheet=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function y(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._strokeIgnoreScale=!1,this._fill=null,this._instructions=[],this._commitIndex=0,this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.clear()}var t=y.prototype,l=y;y.getRGB=function(t,e,i,n){return null!=t&&null==i&&(n=e,i=255&t,e=t>>8&255,t=t>>16&255),null==n?"rgb("+t+","+e+","+i+")":"rgba("+t+","+e+","+i+","+n+")"},y.getHSL=function(t,e,i,n){return null==n?"hsl("+t%360+","+e+"%,"+i+"%)":"hsla("+t%360+","+e+"%,"+i+"%,"+n+")"},y.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},y.STROKE_CAPS_MAP=["butt","round","square"],y.STROKE_JOINTS_MAP=["miter","round","bevel"];var e=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");e.getContext&&(y._ctx=e.getContext("2d"),e.width=e.height=1),t._getInstructions=function(){return this._updateInstructions(),this._instructions},t.getInstructions=createjs.deprecate(t._getInstructions,"Graphics.getInstructions");try{Object.defineProperties(t,{instructions:{get:t._getInstructions}})}catch(t){}t.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)},t.draw=function(t,e){this._updateInstructions();for(var i=this._instructions,n=this._storeIndex,r=i.length;n<r;n++)i[n].exec(t,e)},t.drawAsPath=function(t){this._updateInstructions();for(var e,i=this._instructions,n=this._storeIndex,r=i.length;n<r;n++)!1!==(e=i[n]).path&&e.exec(t)},t.moveTo=function(t,e){return this.append(new l.MoveTo(t,e),!0)},t.lineTo=function(t,e){return this.append(new l.LineTo(t,e))},t.arcTo=function(t,e,i,n,r){return this.append(new l.ArcTo(t,e,i,n,r))},t.arc=function(t,e,i,n,r,a){return this.append(new l.Arc(t,e,i,n,r,a))},t.quadraticCurveTo=function(t,e,i,n){return this.append(new l.QuadraticCurveTo(t,e,i,n))},t.bezierCurveTo=function(t,e,i,n,r,a){return this.append(new l.BezierCurveTo(t,e,i,n,r,a))},t.rect=function(t,e,i,n){return this.append(new l.Rect(t,e,i,n))},t.closePath=function(){return this._activeInstructions.length?this.append(new l.ClosePath):this},t.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this},t.beginFill=function(t){return this._setFill(t?new l.Fill(t):null)},t.beginLinearGradientFill=function(t,e,i,n,r,a){return this._setFill((new l.Fill).linearGradient(t,e,i,n,r,a))},t.beginRadialGradientFill=function(t,e,i,n,r,a,o,s){return this._setFill((new l.Fill).radialGradient(t,e,i,n,r,a,o,s))},t.beginBitmapFill=function(t,e,i){return this._setFill(new l.Fill(null,i).bitmap(t,e))},t.endFill=function(){return this.beginFill()},t.setStrokeStyle=function(t,e,i,n,r){return this._updateInstructions(!0),this._strokeStyle=this.command=new l.StrokeStyle(t,e,i,n,r),this._stroke&&(this._stroke.ignoreScale=r),this._strokeIgnoreScale=r,this},t.setStrokeDash=function(t,e){return this._updateInstructions(!0),this._strokeDash=this.command=new l.StrokeDash(t,e),this},t.beginStroke=function(t){return this._setStroke(t?new l.Stroke(t):null)},t.beginLinearGradientStroke=function(t,e,i,n,r,a){return this._setStroke((new l.Stroke).linearGradient(t,e,i,n,r,a))},t.beginRadialGradientStroke=function(t,e,i,n,r,a,o,s){return this._setStroke((new l.Stroke).radialGradient(t,e,i,n,r,a,o,s))},t.beginBitmapStroke=function(t,e){return this._setStroke((new l.Stroke).bitmap(t,e))},t.endStroke=function(){return this.beginStroke()},t.curveTo=t.quadraticCurveTo,t.drawRect=t.rect,t.drawRoundRect=function(t,e,i,n,r){return this.drawRoundRectComplex(t,e,i,n,r,r,r,r)},t.drawRoundRectComplex=function(t,e,i,n,r,a,o,s){return this.append(new l.RoundRect(t,e,i,n,r,a,o,s))},t.drawCircle=function(t,e,i){return this.append(new l.Circle(t,e,i))},t.drawEllipse=function(t,e,i,n){return this.append(new l.Ellipse(t,e,i,n))},t.drawPolyStar=function(t,e,i,n,r,a){return this.append(new l.PolyStar(t,e,i,n,r,a))},t.append=function(t,e){return this._activeInstructions.push(t),this.command=t,e||(this._dirty=!0),this},t.decodePath=function(t){for(var e=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],i=[2,2,4,6,0],n=0,r=t.length,a=[],o=0,s=0,l=y.BASE_64;n<r;){var c=t.charAt(n),h=l[c],u=h>>3,d=e[u];if(!d||3&h)throw"bad path data (@"+n+"): "+c;var p=i[u];u||(o=s=0),n++;for(var f=2+(h>>2&1),m=a.length=0;m<p;m++){var g=l[t.charAt(n)],v=g>>5?-1:1;g=(31&g)<<6|l[t.charAt(n+1)],3==f&&(g=g<<6|l[t.charAt(n+2)]),g=v*g/10,m%2?o=g+=o:s=g+=s,a[m]=g,n+=f}d.apply(this,a)}return this},t.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this},t.unstore=function(){return this._storeIndex=0,this},t.clone=function(){var t=new y;return t.command=this.command,t._stroke=this._stroke,t._strokeStyle=this._strokeStyle,t._strokeDash=this._strokeDash,t._strokeIgnoreScale=this._strokeIgnoreScale,t._fill=this._fill,t._instructions=this._instructions.slice(),t._commitIndex=this._commitIndex,t._activeInstructions=this._activeInstructions.slice(),t._dirty=this._dirty,t._storeIndex=this._storeIndex,t},t.toString=function(){return"[Graphics]"},t.mt=t.moveTo,t.lt=t.lineTo,t.at=t.arcTo,t.bt=t.bezierCurveTo,t.qt=t.quadraticCurveTo,t.a=t.arc,t.r=t.rect,t.cp=t.closePath,t.c=t.clear,t.f=t.beginFill,t.lf=t.beginLinearGradientFill,t.rf=t.beginRadialGradientFill,t.bf=t.beginBitmapFill,t.ef=t.endFill,t.ss=t.setStrokeStyle,t.sd=t.setStrokeDash,t.s=t.beginStroke,t.ls=t.beginLinearGradientStroke,t.rs=t.beginRadialGradientStroke,t.bs=t.beginBitmapStroke,t.es=t.endStroke,t.dr=t.drawRect,t.rr=t.drawRoundRect,t.rc=t.drawRoundRectComplex,t.dc=t.drawCircle,t.de=t.drawEllipse,t.dp=t.drawPolyStar,t.p=t.decodePath,t._updateInstructions=function(t){var e=this._instructions,i=this._activeInstructions,n=this._commitIndex;if(this._dirty&&i.length){e.length=n,e.push(y.beginCmd);var r=i.length,a=e.length;e.length=a+r;for(var o=0;o<r;o++)e[o+a]=i[o];this._fill&&e.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&e.push(this._strokeDash),this._strokeStyle!==this._oldStrokeStyle&&e.push(this._strokeStyle),t&&(this._oldStrokeStyle=this._strokeStyle,this._oldStrokeDash=this._strokeDash),e.push(this._stroke)),this._dirty=!1}t&&(i.length=0,this._commitIndex=e.length)},t._setFill=function(t){return this._updateInstructions(!0),this.command=this._fill=t,this},t._setStroke=function(t){return this._updateInstructions(!0),(this.command=this._stroke=t)&&(t.ignoreScale=this._strokeIgnoreScale),this},(l.LineTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.lineTo(this.x,this.y)},(l.MoveTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.moveTo(this.x,this.y)},(l.ArcTo=function(t,e,i,n,r){this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.radius=r}).prototype.exec=function(t){t.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)},(l.Arc=function(t,e,i,n,r,a){this.x=t,this.y=e,this.radius=i,this.startAngle=n,this.endAngle=r,this.anticlockwise=!!a}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},(l.QuadraticCurveTo=function(t,e,i,n){this.cpx=t,this.cpy=e,this.x=i,this.y=n}).prototype.exec=function(t){t.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)},(l.BezierCurveTo=function(t,e,i,n,r,a){this.cp1x=t,this.cp1y=e,this.cp2x=i,this.cp2y=n,this.x=r,this.y=a}).prototype.exec=function(t){t.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)},(l.Rect=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){t.rect(this.x,this.y,this.w,this.h)},(l.ClosePath=function(){}).prototype.exec=function(t){t.closePath()},(l.BeginPath=function(){}).prototype.exec=function(t){t.beginPath()},(t=(l.Fill=function(t,e){this.style=t,this.matrix=e}).prototype).exec=function(t){if(this.style){t.fillStyle=this.style;var e=this.matrix;e&&(t.save(),t.transform(e.a,e.b,e.c,e.d,e.tx,e.ty)),t.fill(),e&&t.restore()}},t.linearGradient=function(t,e,i,n,r,a){for(var o=this.style=y._ctx.createLinearGradient(i,n,r,a),s=0,l=t.length;s<l;s++)o.addColorStop(e[s],t[s]);return o.props={colors:t,ratios:e,x0:i,y0:n,x1:r,y1:a,type:"linear"},this},t.radialGradient=function(t,e,i,n,r,a,o,s){for(var l=this.style=y._ctx.createRadialGradient(i,n,r,a,o,s),c=0,h=t.length;c<h;c++)l.addColorStop(e[c],t[c]);return l.props={colors:t,ratios:e,x0:i,y0:n,r0:r,x1:a,y1:o,r1:s,type:"radial"},this},t.bitmap=function(t,e){(t.naturalWidth||t.getContext||2<=t.readyState)&&((this.style=y._ctx.createPattern(t,e||"")).props={image:t,repetition:e,type:"bitmap"});return this},t.path=!1,(t=(l.Stroke=function(t,e){this.style=t,this.ignoreScale=e}).prototype).exec=function(t){this.style&&(t.strokeStyle=this.style,this.ignoreScale&&(t.save(),t.setTransform(1,0,0,1,0,0)),t.stroke(),this.ignoreScale&&t.restore())},t.linearGradient=l.Fill.prototype.linearGradient,t.radialGradient=l.Fill.prototype.radialGradient,t.bitmap=l.Fill.prototype.bitmap,t.path=!1,(t=(l.StrokeStyle=function(t,e,i,n,r){this.width=t,this.caps=e,this.joints=i,this.miterLimit=n,this.ignoreScale=r}).prototype).exec=function(t){t.lineWidth=null==this.width?"1":this.width,t.lineCap=null==this.caps?"butt":isNaN(this.caps)?this.caps:y.STROKE_CAPS_MAP[this.caps],t.lineJoin=null==this.joints?"miter":isNaN(this.joints)?this.joints:y.STROKE_JOINTS_MAP[this.joints],t.miterLimit=null==this.miterLimit?"10":this.miterLimit,t.ignoreScale=null!=this.ignoreScale&&this.ignoreScale},t.path=!1,(l.StrokeDash=function(t,e){this.segments=t,this.offset=e||0}).prototype.exec=function(t){t.setLineDash&&(t.setLineDash(this.segments||l.StrokeDash.EMPTY_SEGMENTS),t.lineDashOffset=this.offset||0)},l.StrokeDash.EMPTY_SEGMENTS=[],(l.RoundRect=function(t,e,i,n,r,a,o,s){this.x=t,this.y=e,this.w=i,this.h=n,this.radiusTL=r,this.radiusTR=a,this.radiusBR=o,this.radiusBL=s}).prototype.exec=function(t){var e=(l<c?l:c)/2,i=0,n=0,r=0,a=0,o=this.x,s=this.y,l=this.w,c=this.h,h=this.radiusTL,u=this.radiusTR,d=this.radiusBR,p=this.radiusBL;h<0&&(h*=i=-1),e<h&&(h=e),u<0&&(u*=n=-1),e<u&&(u=e),d<0&&(d*=r=-1),e<d&&(d=e),p<0&&(p*=a=-1),e<p&&(p=e),t.moveTo(o+l-u,s),t.arcTo(o+l+u*n,s-u*n,o+l,s+u,u),t.lineTo(o+l,s+c-d),t.arcTo(o+l+d*r,s+c+d*r,o+l-d,s+c,d),t.lineTo(o+p,s+c),t.arcTo(o-p*a,s+c+p*a,o,s+c-p,p),t.lineTo(o,s+h),t.arcTo(o-h*i,s-h*i,o+h,s,h),t.closePath()},(l.Circle=function(t,e,i){this.x=t,this.y=e,this.radius=i}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,0,2*Math.PI)},(l.Ellipse=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.w,r=this.h,a=n/2*.5522848,o=r/2*.5522848,s=e+n,l=i+r,c=e+n/2,h=i+r/2;t.moveTo(e,h),t.bezierCurveTo(e,h-o,c-a,i,c,i),t.bezierCurveTo(c+a,i,s,h-o,s,h),t.bezierCurveTo(s,h+o,c+a,l,c,l),t.bezierCurveTo(c-a,l,e,h+o,e,h)},(l.PolyStar=function(t,e,i,n,r,a){this.x=t,this.y=e,this.radius=i,this.sides=n,this.pointSize=r,this.angle=a}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.radius,r=(this.angle||0)/180*Math.PI,a=this.sides,o=1-(this.pointSize||0),s=Math.PI/a;t.moveTo(e+Math.cos(r)*n,i+Math.sin(r)*n);for(var l=0;l<a;l++)r+=s,1!=o&&t.lineTo(e+Math.cos(r)*n*o,i+Math.sin(r)*n*o),r+=s,t.lineTo(e+Math.cos(r)*n,i+Math.sin(r)*n);t.closePath()},y.beginCmd=new l.BeginPath,createjs.Graphics=y}(),this.createjs=this.createjs||{},function(){function a(){this.EventDispatcher_constructor(),this.alpha=1,this.cacheCanvas=null,this.bitmapCache=null,this.id=createjs.UID.get(),this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new createjs.DisplayProps,this._rectangle=new createjs.Rectangle,this._bounds=null,this._webGLRenderStyle=a._StageGL_NONE}var t=createjs.extend(a,createjs.EventDispatcher);a._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],a.suppressCrossDomainErrors=!1,a._snapToPixelEnabled=!1,a._StageGL_NONE=0,a._StageGL_SPRITE=1,a._StageGL_BITMAP=2;var e=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");e.getContext&&(a._hitTestCanvas=e,a._hitTestContext=e.getContext("2d"),e.width=e.height=1),t._getStage=function(){for(var t=this,e=createjs.Stage;t.parent;)t=t.parent;return t instanceof e?t:null},t.getStage=createjs.deprecate(t._getStage,"DisplayObject.getStage");try{Object.defineProperties(t,{stage:{get:t._getStage},cacheID:{get:function(){return this.bitmapCache&&this.bitmapCache.cacheID},set:function(t){this.bitmapCache&&(this.bitmapCache.cacheID=t)}},scale:{get:function(){return this.scaleX},set:function(t){this.scaleX=this.scaleY=t}}})}catch(t){}t.isVisible=function(){return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY)},t.draw=function(t,e){var i=this.bitmapCache;return!(!i||e)&&i.draw(t)},t.updateContext=function(t){var e=this.mask,i=this._props.matrix;e&&e.graphics&&!e.graphics.isEmpty()&&(e.getMatrix(i),t.transform(i.a,i.b,i.c,i.d,i.tx,i.ty),e.graphics.drawAsPath(t),t.clip(),i.invert(),t.transform(i.a,i.b,i.c,i.d,i.tx,i.ty)),this.getMatrix(i);var n=i.tx,r=i.ty;a._snapToPixelEnabled&&this.snapToPixel&&(n=n+(n<0?-.5:.5)|0,r=r+(r<0?-.5:.5)|0),t.transform(i.a,i.b,i.c,i.d,n,r),t.globalAlpha*=this.alpha,this.compositeOperation&&(t.globalCompositeOperation=this.compositeOperation),this.shadow&&this._applyShadow(t,this.shadow)},t.cache=function(t,e,i,n,r,a){this.bitmapCache||(this.bitmapCache=new createjs.BitmapCache),this.bitmapCache.define(this,t,e,i,n,r,a)},t.updateCache=function(t){if(!this.bitmapCache)throw"cache() must be called before updateCache()";this.bitmapCache.update(t)},t.uncache=function(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)},t.getCacheDataURL=function(){return this.bitmapCache?this.bitmapCache.getDataURL():null},t.localToGlobal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(t,e,i||new createjs.Point)},t.globalToLocal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(t,e,i||new createjs.Point)},t.localToLocal=function(t,e,i,n){return n=this.localToGlobal(t,e,n),i.globalToLocal(n.x,n.y,n)},t.setTransform=function(t,e,i,n,r,a,o,s,l){return this.x=t||0,this.y=e||0,this.scaleX=null==i?1:i,this.scaleY=null==n?1:n,this.rotation=r||0,this.skewX=a||0,this.skewY=o||0,this.regX=s||0,this.regY=l||0,this},t.getMatrix=function(t){var e=this,i=t&&t.identity()||new createjs.Matrix2D;return e.transformMatrix?i.copy(e.transformMatrix):i.appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY)},t.getConcatenatedMatrix=function(t){for(var e=this,i=this.getMatrix(t);e=e.parent;)i.prependMatrix(e.getMatrix(e._props.matrix));return i},t.getConcatenatedDisplayProps=function(t){t=t?t.identity():new createjs.DisplayProps;for(var e=this,i=e.getMatrix(t.matrix);t.prepend(e.visible,e.alpha,e.shadow,e.compositeOperation),e!=this&&i.prependMatrix(e.getMatrix(e._props.matrix)),e=e.parent;);return t},t.hitTest=function(t,e){var i=a._hitTestContext;i.setTransform(1,0,0,1,-t,-e),this.draw(i);var n=this._testHit(i);return i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,2,2),n},t.set=function(t){for(var e in t)this[e]=t[e];return this},t.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);var t=this.cacheCanvas;if(t){var e=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,t.width/e,t.height/e)}return null},t.getTransformedBounds=function(){return this._getBounds()},t.setBounds=function(t,e,i,n){return null==t?void(this._bounds=t):void(this._bounds=(this._bounds||new createjs.Rectangle).setValues(t,e,i,n))},t.clone=function(){return this._cloneProps(new a)},t.toString=function(){return"[DisplayObject (name="+this.name+")]"},t._updateState=null,t._cloneProps=function(t){return t.alpha=this.alpha,t.mouseEnabled=this.mouseEnabled,t.tickEnabled=this.tickEnabled,t.name=this.name,t.regX=this.regX,t.regY=this.regY,t.rotation=this.rotation,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.shadow=this.shadow,t.skewX=this.skewX,t.skewY=this.skewY,t.visible=this.visible,t.x=this.x,t.y=this.y,t.compositeOperation=this.compositeOperation,t.snapToPixel=this.snapToPixel,t.filters=null==this.filters?null:this.filters.slice(0),t.mask=this.mask,t.hitArea=this.hitArea,t.cursor=this.cursor,t._bounds=this._bounds,t},t._applyShadow=function(t,e){e=e||Shadow.identity,t.shadowColor=e.color,t.shadowOffsetX=e.offsetX,t.shadowOffsetY=e.offsetY,t.shadowBlur=e.blur},t._tick=function(t){var e=this._listeners;e&&e.tick&&(t.target=null,t.propagationStopped=t.immediatePropagationStopped=!1,this.dispatchEvent(t))},t._testHit=function(t){try{var e=1<t.getImageData(0,0,1,1).data[3]}catch(t){if(!a.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}return e},t._getBounds=function(t,e){return this._transformBounds(this.getBounds(),t,e)},t._transformBounds=function(t,e,i){if(!t)return t;var n=t.x,r=t.y,a=t.width,o=t.height,s=this._props.matrix;s=i?s.identity():this.getMatrix(s),(n||r)&&s.appendTransform(0,0,1,1,0,0,0,-n,-r),e&&s.prependMatrix(e);var l=a*s.a,c=a*s.b,h=o*s.c,u=o*s.d,d=s.tx,p=s.ty,f=d,m=d,g=p,v=p;return(n=l+d)<f?f=n:m<n&&(m=n),(n=l+h+d)<f?f=n:m<n&&(m=n),(n=h+d)<f?f=n:m<n&&(m=n),(r=c+p)<g?g=r:v<r&&(v=r),(r=c+u+p)<g?g=r:v<r&&(v=r),(r=u+p)<g?g=r:v<r&&(v=r),t.setValues(f,g,m-f,v-g)},t._hasMouseEventListener=function(){for(var t=a._MOUSE_EVENTS,e=0,i=t.length;e<i;e++)if(this.hasEventListener(t[e]))return!0;return!!this.cursor},createjs.DisplayObject=createjs.promote(a,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function f(){this.DisplayObject_constructor(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}var t=createjs.extend(f,createjs.DisplayObject);t._getNumChildren=function(){return this.children.length},t.getNumChildren=createjs.deprecate(t._getNumChildren,"Container.getNumChildren");try{Object.defineProperties(t,{numChildren:{get:t._getNumChildren}})}catch(t){}t.initialize=f,t.isVisible=function(){var t=this.cacheCanvas||this.children.length;return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},t.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;for(var i=this.children.slice(),n=0,r=i.length;n<r;n++){var a=i[n];a.isVisible()&&(t.save(),a.updateContext(t),a.draw(t),t.restore())}return!0},t.addChild=function(t){if(null==t)return t;var e=arguments.length;if(1<e){for(var i=0;i<e;i++)this.addChild(arguments[i]);return arguments[e-1]}var n=t.parent,r=n===this;return n&&n._removeChildAt(createjs.indexOf(n.children,t),r),(t.parent=this).children.push(t),r||t.dispatchEvent("added"),t},t.addChildAt=function(t,e){var i=arguments.length,n=arguments[i-1];if(n<0||n>this.children.length)return arguments[i-2];if(2<i){for(var r=0;r<i-1;r++)this.addChildAt(arguments[r],n+r);return arguments[i-2]}var a=t.parent,o=a===this;return a&&a._removeChildAt(createjs.indexOf(a.children,t),o),(t.parent=this).children.splice(e,0,t),o||t.dispatchEvent("added"),t},t.removeChild=function(t){var e=arguments.length;if(1<e){for(var i=!0,n=0;n<e;n++)i=i&&this.removeChild(arguments[n]);return i}return this._removeChildAt(createjs.indexOf(this.children,t))},t.removeChildAt=function(t){var e=arguments.length;if(1<e){for(var i=[],n=0;n<e;n++)i[n]=arguments[n];i.sort(function(t,e){return e-t});var r=!0;for(n=0;n<e;n++)r=r&&this._removeChildAt(i[n]);return r}return this._removeChildAt(t)},t.removeAllChildren=function(){for(var t=this.children;t.length;)this._removeChildAt(0)},t.getChildAt=function(t){return this.children[t]},t.getChildByName=function(t){for(var e=this.children,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},t.sortChildren=function(t){this.children.sort(t)},t.getChildIndex=function(t){return createjs.indexOf(this.children,t)},t.swapChildrenAt=function(t,e){var i=this.children,n=i[t],r=i[e];n&&r&&(i[t]=r,i[e]=n)},t.swapChildren=function(t,e){for(var i,n,r=this.children,a=0,o=r.length;a<o&&(r[a]==t&&(i=a),r[a]==e&&(n=a),null==i||null==n);a++);a!=o&&(r[i]=e,r[n]=t)},t.setChildIndex=function(t,e){var i=this.children,n=i.length;if(!(t.parent!=this||e<0||n<=e)){for(var r=0;r<n&&i[r]!=t;r++);r!=n&&r!=e&&(i.splice(r,1),i.splice(e,0,t))}},t.contains=function(t){for(;t;){if(t==this)return!0;t=t.parent}return!1},t.hitTest=function(t,e){return null!=this.getObjectUnderPoint(t,e)},t.getObjectsUnderPoint=function(t,e,i){var n=[],r=this.localToGlobal(t,e);return this._getObjectsUnderPoint(r.x,r.y,n,0<i,1==i),n},t.getObjectUnderPoint=function(t,e,i){var n=this.localToGlobal(t,e);return this._getObjectsUnderPoint(n.x,n.y,null,0<i,1==i)},t.getBounds=function(){return this._getBounds(null,!0)},t.getTransformedBounds=function(){return this._getBounds()},t.clone=function(t){var e=this._cloneProps(new f);return t&&this._cloneChildren(e),e},t.toString=function(){return"[Container (name="+this.name+")]"},t._tick=function(t){if(this.tickChildren)for(var e=this.children.length-1;0<=e;e--){var i=this.children[e];i.tickEnabled&&i._tick&&i._tick(t)}this.DisplayObject__tick(t)},t._cloneChildren=function(t){t.children.length&&t.removeAllChildren();for(var e=t.children,i=0,n=this.children.length;i<n;i++){var r=this.children[i].clone(!0);r.parent=t,e.push(r)}},t._removeChildAt=function(t,e){if(t<0||t>this.children.length-1)return!1;var i=this.children[t];return i&&(i.parent=null),this.children.splice(t,1),e||i.dispatchEvent("removed"),!0},t._getObjectsUnderPoint=function(t,e,i,n,r,a){if(!(a=a||0)&&!this._testMask(this,t,e))return null;var o,s=createjs.DisplayObject._hitTestContext;r=r||n&&this._hasMouseEventListener();for(var l=this.children,c=l.length-1;0<=c;c--){var h=l[c],u=h.hitArea;if(h.visible&&(u||h.isVisible())&&(!n||h.mouseEnabled)&&(u||this._testMask(h,t,e)))if(!u&&h instanceof f){var d=h._getObjectsUnderPoint(t,e,i,n,r,a+1);if(!i&&d)return n&&!this.mouseChildren?this:d}else{if(n&&!r&&!h._hasMouseEventListener())continue;var p=h.getConcatenatedDisplayProps(h._props);if(o=p.matrix,u&&(o.appendMatrix(u.getMatrix(u._props.matrix)),p.alpha=u.alpha),s.globalAlpha=p.alpha,s.setTransform(o.a,o.b,o.c,o.d,o.tx-t,o.ty-e),(u||h).draw(s),!this._testHit(s))continue;if(s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,2,2),!i)return n&&!this.mouseChildren?this:h;i.push(h)}}return null},t._testMask=function(t,e,i){var n=t.mask;if(!n||!n.graphics||n.graphics.isEmpty())return!0;var r=this._props.matrix,a=t.parent;r=a?a.getConcatenatedMatrix(r):r.identity(),r=n.getMatrix(n._props.matrix).prependMatrix(r);var o=createjs.DisplayObject._hitTestContext;return o.setTransform(r.a,r.b,r.c,r.d,r.tx-e,r.ty-i),n.graphics.drawAsPath(o),o.fillStyle="#000",o.fill(),!!this._testHit(o)&&(o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,2,2),!0)},t._getBounds=function(t,e){var i=this.DisplayObject_getBounds();if(i)return this._transformBounds(i,t,e);var n=this._props.matrix;n=e?n.identity():this.getMatrix(n),t&&n.prependMatrix(t);for(var r=this.children.length,a=null,o=0;o<r;o++){var s=this.children[o];s.visible&&(i=s._getBounds(n))&&(a?a.extend(i.x,i.y,i.width,i.height):a=i.clone())}return a},createjs.Container=createjs.promote(f,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(t){this.Container_constructor(),this.autoClear=!0,this.canvas="string"==typeof t?document.getElementById(t):t,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}var e=createjs.extend(t,createjs.Container);e._get_nextStage=function(){return this._nextStage},e._set_nextStage=function(t){this._nextStage&&(this._nextStage._prevStage=null),t&&(t._prevStage=this),this._nextStage=t};try{Object.defineProperties(e,{nextStage:{get:e._get_nextStage,set:e._set_nextStage}})}catch(t){}e.update=function(t){if(this.canvas&&(this.tickOnUpdate&&this.tick(t),!1!==this.dispatchEvent("drawstart",!1,!0))){createjs.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled;var e=this.drawRect,i=this.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0),this.autoClear&&(e?i.clearRect(e.x,e.y,e.width,e.height):i.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),i.save(),this.drawRect&&(i.beginPath(),i.rect(e.x,e.y,e.width,e.height),i.clip()),this.updateContext(i),this.draw(i,!1),i.restore(),this.dispatchEvent("drawend")}},e.tick=function(t){if(this.tickEnabled&&!1!==this.dispatchEvent("tickstart",!1,!0)){var e=new createjs.Event("tick");if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);this._tick(e),this.dispatchEvent("tickend")}},e.handleEvent=function(t){"tick"==t.type&&this.update(t)},e.clear=function(){if(this.canvas){var t=this.canvas.getContext("2d");t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)}},e.toDataURL=function(t,e){var i,n=this.canvas.getContext("2d"),r=this.canvas.width,a=this.canvas.height;if(t){i=n.getImageData(0,0,r,a);var o=n.globalCompositeOperation;n.globalCompositeOperation="destination-over",n.fillStyle=t,n.fillRect(0,0,r,a)}var s=this.canvas.toDataURL(e||"image/png");return t&&(n.putImageData(i,0,0),n.globalCompositeOperation=o),s},e.enableMouseOver=function(t){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,0==t&&this._testMouseOver(!0)),null==t)t=20;else if(t<=0)return;var e=this;this._mouseOverIntervalID=setInterval(function(){e._testMouseOver()},1e3/Math.min(50,t))},e.enableDOMEvents=function(t){null==t&&(t=!0);var e,i,n=this._eventListeners;if(!t&&n){for(e in n)(i=n[e]).t.removeEventListener(e,i.f,!1);this._eventListeners=null}else if(t&&!n&&this.canvas){var r=window.addEventListener?window:document,a=this;for(e in(n=this._eventListeners={}).mouseup={t:r,f:function(t){a._handleMouseUp(t)}},n.mousemove={t:r,f:function(t){a._handleMouseMove(t)}},n.dblclick={t:this.canvas,f:function(t){a._handleDoubleClick(t)}},n.mousedown={t:this.canvas,f:function(t){a._handleMouseDown(t)}},n)(i=n[e]).t.addEventListener(e,i.f,!1)}},e.clone=function(){throw"Stage cannot be cloned."},e.toString=function(){return"[Stage (name="+this.name+")]"},e._getElementRect=function(e){var i;try{i=e.getBoundingClientRect()}catch(t){i={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}var t=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),n=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),r=window.getComputedStyle?getComputedStyle(e,null):e.currentStyle,a=parseInt(r.paddingLeft)+parseInt(r.borderLeftWidth),o=parseInt(r.paddingTop)+parseInt(r.borderTopWidth),s=parseInt(r.paddingRight)+parseInt(r.borderRightWidth),l=parseInt(r.paddingBottom)+parseInt(r.borderBottomWidth);return{left:i.left+t+a,right:i.right+t-s,top:i.top+n+o,bottom:i.bottom+n-l}},e._getPointerData=function(t){var e=this._pointerData[t];return e||(e=this._pointerData[t]={x:0,y:0}),e},e._handleMouseMove=function(t){t||(t=window.event),this._handlePointerMove(-1,t,t.pageX,t.pageY)},e._handlePointerMove=function(t,e,i,n,r){if((!this._prevStage||void 0!==r)&&this.canvas){var a=this._nextStage,o=this._getPointerData(t),s=o.inBounds;this._updatePointerPosition(t,e,i,n),(s||o.inBounds||this.mouseMoveOutside)&&(-1===t&&o.inBounds==!s&&this._dispatchMouseEvent(this,s?"mouseleave":"mouseenter",!1,t,o,e),this._dispatchMouseEvent(this,"stagemousemove",!1,t,o,e),this._dispatchMouseEvent(o.target,"pressmove",!0,t,o,e)),a&&a._handlePointerMove(t,e,i,n,null)}},e._updatePointerPosition=function(t,e,i,n){var r=this._getElementRect(this.canvas);i-=r.left,n-=r.top;var a=this.canvas.width,o=this.canvas.height;i/=(r.right-r.left)/a,n/=(r.bottom-r.top)/o;var s=this._getPointerData(t);(s.inBounds=0<=i&&0<=n&&i<=a-1&&n<=o-1)?(s.x=i,s.y=n):this.mouseMoveOutside&&(s.x=i<0?0:a-1<i?a-1:i,s.y=n<0?0:o-1<n?o-1:n),s.posEvtObj=e,s.rawX=i,s.rawY=n,(t===this._primaryPointerID||-1===t)&&(this.mouseX=s.x,this.mouseY=s.y,this.mouseInBounds=s.inBounds)},e._handleMouseUp=function(t){this._handlePointerUp(-1,t,!1)},e._handlePointerUp=function(t,e,i,n){var r=this._nextStage,a=this._getPointerData(t);if(!this._prevStage||void 0!==n){var o=null,s=a.target;n||!s&&!r||(o=this._getObjectsUnderPoint(a.x,a.y,null,!0)),a.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,t,a,e,o),a.down=!1),o==s&&this._dispatchMouseEvent(s,"click",!0,t,a,e),this._dispatchMouseEvent(s,"pressup",!0,t,a,e),i?(t==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[t]):a.target=null,r&&r._handlePointerUp(t,e,i,n||o&&this)}},e._handleMouseDown=function(t){this._handlePointerDown(-1,t,t.pageX,t.pageY)},e._handlePointerDown=function(t,e,i,n,r){this.preventSelection&&e.preventDefault(),(null==this._primaryPointerID||-1===t)&&(this._primaryPointerID=t),null!=n&&this._updatePointerPosition(t,e,i,n);var a=null,o=this._nextStage,s=this._getPointerData(t);r||(a=s.target=this._getObjectsUnderPoint(s.x,s.y,null,!0)),s.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,t,s,e,a),s.down=!0),this._dispatchMouseEvent(a,"mousedown",!0,t,s,e),o&&o._handlePointerDown(t,e,i,n,r||a&&this)},e._testMouseOver=function(t,e,i){if(!this._prevStage||void 0!==e){var n=this._nextStage;if(!this._mouseOverIntervalID)return void(n&&n._testMouseOver(t,e,i));var r=this._getPointerData(-1);if(r&&(t||this.mouseX!=this._mouseOverX||this.mouseY!=this._mouseOverY||!this.mouseInBounds)){var a,o,s,l=r.posEvtObj,c=i||l&&l.target==this.canvas,h=null,u=-1,d="";!e&&(t||this.mouseInBounds&&c)&&(h=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);var p=this._mouseOverTarget||[],f=p[p.length-1],m=this._mouseOverTarget=[];for(a=h;a;)m.unshift(a),d||(d=a.cursor),a=a.parent;for(this.canvas.style.cursor=d,!e&&i&&(i.canvas.style.cursor=d),o=0,s=m.length;o<s&&m[o]==p[o];o++)u=o;for(f!=h&&this._dispatchMouseEvent(f,"mouseout",!0,-1,r,l,h),o=p.length-1;u<o;o--)this._dispatchMouseEvent(p[o],"rollout",!1,-1,r,l,h);for(o=m.length-1;u<o;o--)this._dispatchMouseEvent(m[o],"rollover",!1,-1,r,l,f);f!=h&&this._dispatchMouseEvent(h,"mouseover",!0,-1,r,l,f),n&&n._testMouseOver(t,e||h&&this,i||c&&this)}}},e._handleDoubleClick=function(t,e){var i=null,n=this._nextStage,r=this._getPointerData(-1);e||(i=this._getObjectsUnderPoint(r.x,r.y,null,!0),this._dispatchMouseEvent(i,"dblclick",!0,-1,r,t)),n&&n._handleDoubleClick(t,e||i&&this)},e._dispatchMouseEvent=function(t,e,i,n,r,a,o){if(t&&(i||t.hasEventListener(e))){var s=new createjs.MouseEvent(e,i,!1,r.x,r.y,a,n,n===this._primaryPointerID||-1===n,r.rawX,r.rawY,o);t.dispatchEvent(s)}},createjs.Stage=createjs.promote(t,"Container")}(),this.createjs=this.createjs||{},function(){function L(t,e){if(this.Stage_constructor(t),void 0!==e){if("object"!=typeof e)throw"Invalid options object";var i=e.premultiply,n=e.transparent,r=e.antialias,a=e.preserveBuffer,o=e.autoPurge}this.vocalDebug=!1,this._preserveBuffer=a||!1,this._antialias=r||!1,this._transparent=n||!1,this._premultiply=i||!1,this._autoPurge=void 0,this.autoPurge=o,this._viewportWidth=0,this._viewportHeight=0,this._projectionMatrix=null,this._webGLContext=null,this._clearColor={r:.5,g:.5,b:.5,a:0},this._maxCardsPerBatch=L.DEFAULT_MAX_BATCH_SIZE,this._activeShader=null,this._vertices=null,this._vertexPositionBuffer=null,this._uvs=null,this._uvPositionBuffer=null,this._indices=null,this._textureIndexBuffer=null,this._alphas=null,this._alphaBuffer=null,this._textureDictionary=[],this._textureIDs={},this._batchTextures=[],this._baseTextures=[],this._batchTextureCount=8,this._lastTextureInsert=-1,this._batchID=0,this._drawID=0,this._slotBlacklist=[],this._isDrawing=0,this._lastTrackedCanvas=0,this.isCacheControlled=!1,this._cacheContainer=new createjs.Container,this._initializeWebGL()}var t=createjs.extend(L,createjs.Stage);L.buildUVRects=function(t,e,i){if(!t||!t._frames)return null;void 0===e&&(e=-1),void 0===i&&(i=!1);for(var n=-1!=e&&i?e:0,r=-1!=e&&i?e+1:t._frames.length,a=n;a<r;a++){var o=t._frames[a];if(!(o.uvRect||o.image.width<=0||o.image.height<=0)){var s=o.rect;o.uvRect={t:s.y/o.image.height,l:s.x/o.image.width,b:(s.y+s.height)/o.image.height,r:(s.x+s.width)/o.image.width}}}return t._frames[-1!=e?e:0].uvRect||{t:0,l:0,b:1,r:1}},L.isWebGLActive=function(t){return t&&t instanceof WebGLRenderingContext&&"undefined"!=typeof WebGLRenderingContext},L.VERTEX_PROPERTY_COUNT=6,L.INDICIES_PER_CARD=6,L.DEFAULT_MAX_BATCH_SIZE=1e4,L.WEBGL_MAX_INDEX_NUM=Math.pow(2,16),L.UV_RECT={t:0,l:0,b:1,r:1};try{L.COVER_VERT=new Float32Array([-1,1,1,1,-1,-1,1,1,1,-1,-1,-1]),L.COVER_UV=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]),L.COVER_UV_FLIP=new Float32Array([0,1,1,1,0,0,1,1,1,0,0,0])}catch(t){}L.REGULAR_VERTEX_HEADER=(L.REGULAR_VARYING_HEADER="precision mediump float;varying vec2 vTextureCoord;varying lowp float indexPicker;varying lowp float alphaValue;")+"attribute vec2 vertexPosition;attribute vec2 uvPosition;attribute lowp float textureIndex;attribute lowp float objectAlpha;uniform mat4 pMatrix;",L.REGULAR_FRAGMENT_HEADER=L.REGULAR_VARYING_HEADER+"uniform sampler2D uSampler[{{count}}];",L.REGULAR_VERTEX_BODY="void main(void) {gl_Position = vec4((vertexPosition.x * pMatrix[0][0]) + pMatrix[3][0],(vertexPosition.y * pMatrix[1][1]) + pMatrix[3][1],pMatrix[3][2],1.0);alphaValue = objectAlpha;indexPicker = textureIndex;vTextureCoord = uvPosition;}",L.REGULAR_FRAGMENT_BODY="void main(void) {vec4 color = vec4(1.0, 0.0, 0.0, 1.0);if (indexPicker <= 0.5) {color = texture2D(uSampler[0], vTextureCoord);{{alternates}}}{{fragColor}}}",L.REGULAR_FRAG_COLOR_NORMAL="gl_FragColor = vec4(color.rgb, color.a * alphaValue);",L.REGULAR_FRAG_COLOR_PREMULTIPLY="if(color.a > 0.0035) {gl_FragColor = vec4(color.rgb/color.a, color.a * alphaValue);} else {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}",L.PARTICLE_VERTEX_BODY=L.REGULAR_VERTEX_BODY,L.PARTICLE_FRAGMENT_BODY=L.REGULAR_FRAGMENT_BODY,L.COVER_VERTEX_HEADER=(L.COVER_VARYING_HEADER="precision mediump float;varying highp vec2 vRenderCoord;varying highp vec2 vTextureCoord;")+"attribute vec2 vertexPosition;attribute vec2 uvPosition;uniform float uUpright;",L.COVER_FRAGMENT_HEADER=L.COVER_VARYING_HEADER+"uniform sampler2D uSampler;",L.COVER_VERTEX_BODY="void main(void) {gl_Position = vec4(vertexPosition.x, vertexPosition.y, 0.0, 1.0);vRenderCoord = uvPosition;vTextureCoord = vec2(uvPosition.x, abs(uUpright - uvPosition.y));}",L.COVER_FRAGMENT_BODY="void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = color;}",t._get_isWebGL=function(){return!!this._webGLContext},t._set_autoPurge=function(t){-1!=(t=isNaN(t)?1200:t)&&(t=t<10?10:t),this._autoPurge=t},t._get_autoPurge=function(){return Number(this._autoPurge)};try{Object.defineProperties(t,{isWebGL:{get:t._get_isWebGL},autoPurge:{get:t._get_autoPurge,set:t._set_autoPurge}})}catch(t){}t._initializeWebGL=function(){if(this.canvas){if(!this._webGLContext||this._webGLContext.canvas!==this.canvas){var t={depth:!1,alpha:this._transparent,stencil:!0,antialias:this._antialias,premultipliedAlpha:this._premultiply,preserveDrawingBuffer:this._preserveBuffer},e=this._webGLContext=this._fetchWebGLContext(this.canvas,t);if(!e)return null;this.updateSimultaneousTextureCount(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),this._maxTextureSlots=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this._createBuffers(e),this._initTextures(e),e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiply),this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),this.updateViewport(this._viewportWidth||this.canvas.width,this._viewportHeight||this.canvas.height)}}else this._webGLContext=null;return this._webGLContext},t.update=function(t){if(this.canvas){if(this.tickOnUpdate&&this.tick(t),this.dispatchEvent("drawstart"),this.autoClear&&this.clear(),this._webGLContext)this._batchDraw(this,this._webGLContext),-1==this._autoPurge||this._drawID%(this._autoPurge/2|0)||this.purgeTextures(this._autoPurge);else{var e=this.canvas.getContext("2d");e.save(),this.updateContext(e),this.draw(e,!1),e.restore()}this.dispatchEvent("drawend")}},t.clear=function(){if(this.canvas)if(L.isWebGLActive(this._webGLContext)){var t=this._webGLContext,e=this._clearColor,i=this._transparent?e.a:1;this._webGLContext.clearColor(e.r*i,e.g*i,e.b*i,i),t.clear(t.COLOR_BUFFER_BIT),this._webGLContext.clearColor(e.r,e.g,e.b,e.a)}else this.Stage_clear()},t.draw=function(t,e){if(t===this._webGLContext&&L.isWebGLActive(this._webGLContext)){var i=this._webGLContext;return this._batchDraw(this,i,e),!0}return this.Stage_draw(t,e)},t.cacheDraw=function(t,e,i){if(L.isWebGLActive(this._webGLContext)){var n=this._webGLContext;return this._cacheDraw(n,t,e,i),!0}return!1},t.protectTextureSlot=function(t,e){if(t>this._maxTextureSlots||t<0)throw"Slot outside of acceptable range";this._slotBlacklist[t]=!!e},t.getTargetRenderTexture=function(t,e,i){var n,r=!1,a=this._webGLContext;if(void 0!==t.__lastRT&&t.__lastRT===t.__rtA&&(r=!0),!(n=r?(void 0===t.__rtB?t.__rtB=this.getRenderBufferTexture(e,i):((e!=t.__rtB._width||i!=t.__rtB._height)&&this.resizeTexture(t.__rtB,e,i),this.setTextureParams(a)),t.__rtB):(void 0===t.__rtA?t.__rtA=this.getRenderBufferTexture(e,i):((e!=t.__rtA._width||i!=t.__rtA._height)&&this.resizeTexture(t.__rtA,e,i),this.setTextureParams(a)),t.__rtA)))throw"Problems creating render textures, known causes include using too much VRAM by not releasing WebGL texture instances";return t.__lastRT=n},t.releaseTexture=function(t){var e,i;if(t){if(t.children)for(e=0,i=t.children.length;e<i;e++)this.releaseTexture(t.children[e]);t.cacheCanvas&&t.uncache();var n=void 0;if(void 0!==t._storeID){if(t===this._textureDictionary[t._storeID])return this._killTextureObject(t),void(t._storeID=void 0);n=t}else if(2===t._webGLRenderStyle)n=t.image;else if(1===t._webGLRenderStyle){for(e=0,i=t.spriteSheet._images.length;e<i;e++)this.releaseTexture(t.spriteSheet._images[e]);return}if(void 0===n)return void(this.vocalDebug&&console.log("No associated texture found on release"));this._killTextureObject(this._textureDictionary[n._storeID]),n._storeID=void 0}},t.purgeTextures=function(t){null==t&&(t=100);for(var e=this._textureDictionary,i=e.length,n=0;n<i;n++){var r=e[n];r&&r._drawID+t<=this._drawID&&this._killTextureObject(r)}},t.updateSimultaneousTextureCount=function(t){var e=this._webGLContext,i=!1;for((t<1||isNaN(t))&&(t=1),this._batchTextureCount=t;!i;)try{this._activeShader=this._fetchShaderProgram(e),i=!0}catch(t){if(1==this._batchTextureCount)throw"Cannot compile shader "+t;this._batchTextureCount-=4,this._batchTextureCount<1&&(this._batchTextureCount=1),this.vocalDebug&&console.log("Reducing desired texture count due to errors: "+this._batchTextureCount)}},t.updateViewport=function(t,e){this._viewportWidth=0|t,this._viewportHeight=0|e;var i=this._webGLContext;i&&(i.viewport(0,0,this._viewportWidth,this._viewportHeight),this._projectionMatrix=new Float32Array([2/this._viewportWidth,0,0,0,0,-2/this._viewportHeight,1,0,0,0,1,0,-1,1,.1,0]),this._projectionMatrixFlip=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this._projectionMatrixFlip.set(this._projectionMatrix),this._projectionMatrixFlip[5]*=-1,this._projectionMatrixFlip[13]*=-1)},t.getFilterShader=function(t){t||(t=this);var e=this._webGLContext,i=this._activeShader;if(t._builtShader)i=t._builtShader,t.shaderParamSetup&&(e.useProgram(i),t.shaderParamSetup(e,this,i));else try{i=this._fetchShaderProgram(e,"filter",t.VTX_SHADER_BODY,t.FRAG_SHADER_BODY,t.shaderParamSetup&&t.shaderParamSetup.bind(t)),(t._builtShader=i)._name=t.toString()}catch(t){console&&console.log("SHADER SWITCH FAILURE",t)}return i},t.getBaseTexture=function(t,e){var i=Math.ceil(0<t?t:1)||1,n=Math.ceil(0<e?e:1)||1,r=this._webGLContext,a=r.createTexture();return this.resizeTexture(a,i,n),this.setTextureParams(r,!1),a},t.resizeTexture=function(t,e,i){var n=this._webGLContext;n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,i,0,n.RGBA,n.UNSIGNED_BYTE,null),t.width=e,t.height=i},t.getRenderBufferTexture=function(t,e){var i=this._webGLContext,n=this.getBaseTexture(t,e);if(!n)return null;var r=i.createFramebuffer();return r?(n.width=t,n.height=e,i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0),(r._renderTexture=n)._frameBuffer=r,n._storeID=this._textureDictionary.length,this._textureDictionary[n._storeID]=n,i.bindFramebuffer(i.FRAMEBUFFER,null),n):null},t.setTextureParams=function(t,e){e&&this._antialias?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},t.setClearColor=function(t){var e,i,n,r,a;"string"==typeof t?0==t.indexOf("#")?(4==t.length&&(t="#"+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)+t.charAt(3)+t.charAt(3)),e=Number("0x"+t.slice(1,3))/255,i=Number("0x"+t.slice(3,5))/255,n=Number("0x"+t.slice(5,7))/255,r=Number("0x"+t.slice(7,9))/255):0==t.indexOf("rgba(")&&(a=t.slice(5,-1).split(","),e=Number(a[0])/255,i=Number(a[1])/255,n=Number(a[2])/255,r=Number(a[3])):(e=((4278190080&t)>>>24)/255,i=((16711680&t)>>>16)/255,n=((65280&t)>>>8)/255,r=(255&t)/255),this._clearColor.r=e||0,this._clearColor.g=i||0,this._clearColor.b=n||0,this._clearColor.a=r||0,this._webGLContext&&this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)},t.toString=function(){return"[StageGL (name="+this.name+")]"},t._fetchWebGLContext=function(t,e){var i;try{i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}catch(t){}if(i)i.viewportWidth=t.width,i.viewportHeight=t.height;else{var n="Could not initialize WebGL";console.error?console.error(n):console.log(n)}return i},t._fetchShaderProgram=function(t,e,i,n,r){var a,o;switch(t.useProgram(null),e){case"filter":o=L.COVER_VERTEX_HEADER+(i||L.COVER_VERTEX_BODY),a=L.COVER_FRAGMENT_HEADER+(n||L.COVER_FRAGMENT_BODY);break;case"particle":o=L.REGULAR_VERTEX_HEADER+L.PARTICLE_VERTEX_BODY,a=L.REGULAR_FRAGMENT_HEADER+L.PARTICLE_FRAGMENT_BODY;break;case"override":o=L.REGULAR_VERTEX_HEADER+(i||L.REGULAR_VERTEX_BODY),a=L.REGULAR_FRAGMENT_HEADER+(n||L.REGULAR_FRAGMENT_BODY);break;case"regular":default:o=L.REGULAR_VERTEX_HEADER+L.REGULAR_VERTEX_BODY,a=L.REGULAR_FRAGMENT_HEADER+L.REGULAR_FRAGMENT_BODY}var s=this._createShader(t,t.VERTEX_SHADER,o),l=this._createShader(t,t.FRAGMENT_SHADER,a),c=t.createProgram();if(t.attachShader(c,s),t.attachShader(c,l),t.linkProgram(c),c._type=e,!t.getProgramParameter(c,t.LINK_STATUS))throw t.useProgram(this._activeShader),t.getProgramInfoLog(c);switch(t.useProgram(c),e){case"filter":c.vertexPositionAttribute=t.getAttribLocation(c,"vertexPosition"),t.enableVertexAttribArray(c.vertexPositionAttribute),c.uvPositionAttribute=t.getAttribLocation(c,"uvPosition"),t.enableVertexAttribArray(c.uvPositionAttribute),c.samplerUniform=t.getUniformLocation(c,"uSampler"),t.uniform1i(c.samplerUniform,0),c.uprightUniform=t.getUniformLocation(c,"uUpright"),t.uniform1f(c.uprightUniform,0),r&&r(t,this,c);break;case"override":case"particle":case"regular":default:c.vertexPositionAttribute=t.getAttribLocation(c,"vertexPosition"),t.enableVertexAttribArray(c.vertexPositionAttribute),c.uvPositionAttribute=t.getAttribLocation(c,"uvPosition"),t.enableVertexAttribArray(c.uvPositionAttribute),c.textureIndexAttribute=t.getAttribLocation(c,"textureIndex"),t.enableVertexAttribArray(c.textureIndexAttribute),c.alphaAttribute=t.getAttribLocation(c,"objectAlpha"),t.enableVertexAttribArray(c.alphaAttribute);for(var h=[],u=0;u<this._batchTextureCount;u++)h[u]=u;c.samplerData=h,c.samplerUniform=t.getUniformLocation(c,"uSampler"),t.uniform1iv(c.samplerUniform,h),c.pMatrixUniform=t.getUniformLocation(c,"pMatrix")}return t.useProgram(this._activeShader),c},t._createShader=function(t,e,i){i=i.replace(/{{count}}/g,this._batchTextureCount);for(var n="",r=1;r<this._batchTextureCount;r++)n+="} else if (indexPicker <= "+r+".5) { color = texture2D(uSampler["+r+"], vTextureCoord);";i=(i=i.replace(/{{alternates}}/g,n)).replace(/{{fragColor}}/g,this._premultiply?L.REGULAR_FRAG_COLOR_PREMULTIPLY:L.REGULAR_FRAG_COLOR_NORMAL);var a=t.createShader(e);if(t.shaderSource(a,i),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS))throw t.getShaderInfoLog(a);return a},t._createBuffers=function(t){var e,i,n,r=this._maxCardsPerBatch*L.INDICIES_PER_CARD,a=this._vertexPositionBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),e=2;var o=this._vertices=new Float32Array(r*e);for(i=0,n=o.length;i<n;i+=e)o[i]=o[i+1]=0;t.bufferData(t.ARRAY_BUFFER,o,t.DYNAMIC_DRAW),a.itemSize=e,a.numItems=r;var s=this._uvPositionBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),e=2;var l=this._uvs=new Float32Array(r*e);for(i=0,n=l.length;i<n;i+=e)l[i]=l[i+1]=0;t.bufferData(t.ARRAY_BUFFER,l,t.DYNAMIC_DRAW),s.itemSize=e,s.numItems=r;var c=this._textureIndexBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,c),e=1;var h=this._indices=new Float32Array(r*e);for(i=0,n=h.length;i<n;i++)h[i]=0;t.bufferData(t.ARRAY_BUFFER,h,t.DYNAMIC_DRAW),c.itemSize=e,c.numItems=r;var u=this._alphaBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),e=1;var d=this._alphas=new Float32Array(r*e);for(i=0,n=d.length;i<n;i++)d[i]=1;t.bufferData(t.ARRAY_BUFFER,d,t.DYNAMIC_DRAW),u.itemSize=e,u.numItems=r},t._initTextures=function(){this._lastTextureInsert=-1,this._textureDictionary=[],this._textureIDs={},this._baseTextures=[],this._batchTextures=[];for(var t=0;t<this._batchTextureCount;t++){var e=this.getBaseTexture();if(this._baseTextures[t]=this._batchTextures[t]=e,!e)throw"Problems creating basic textures, known causes include using too much VRAM by not releasing WebGL texture instances"}},t._loadTextureImage=function(t,e){var i=e.src;i||(e._isCanvas=!0,i=e.src="canvas_"+this._lastTrackedCanvas++);var n=this._textureIDs[i];void 0===n&&(n=this._textureIDs[i]=this._textureDictionary.length),void 0===this._textureDictionary[n]&&(this._textureDictionary[n]=this.getBaseTexture());var r=this._textureDictionary[n];if(r)r._batchID=this._batchID,r._storeID=n,r._imageData=e,this._insertTextureInBatch(t,r),e._storeID=n,e.complete||e.naturalWidth||e._isCanvas?this._updateTextureImageData(t,e):e.addEventListener("load",this._updateTextureImageData.bind(this,t,e));else{var a="Problem creating desired texture, known causes include using too much VRAM by not releasing WebGL texture instances";console.error&&console.error(a)||console.log(a),(r=this._baseTextures[0])._batchID=this._batchID,r._storeID=-1,r._imageData=r,this._insertTextureInBatch(t,r)}return r},t._updateTextureImageData=function(t,e){var i=e.width&e.width-1||e.height&e.height-1,n=this._textureDictionary[e._storeID];t.activeTexture(t.TEXTURE0+n._activeIndex),t.bindTexture(t.TEXTURE_2D,n),n.isPOT=!i,this.setTextureParams(t,n.isPOT);try{t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}catch(t){var r="\nAn error has occurred. This is most likely due to security restrictions on WebGL images with local or cross-domain origins";console.error?(console.error(r),console.error(t)):console&&(console.log(r),console.log(t))}e._invalid=!1,n._w=e.width,n._h=e.height,this.vocalDebug&&(i&&console.warn("NPOT(Non Power of Two) Texture: "+e.src),(e.width>t.MAX_TEXTURE_SIZE||e.height>t.MAX_TEXTURE_SIZE)&&console&&console.error("Oversized Texture: "+e.width+"x"+e.height+" vs "+t.MAX_TEXTURE_SIZE+"max"))},t._insertTextureInBatch=function(t,e){if(this._batchTextures[e._activeIndex]!==e){var i=-1,n=(this._lastTextureInsert+1)%this._batchTextureCount,r=n;do{if(this._batchTextures[r]._batchID!=this._batchID&&!this._slotBlacklist[r]){i=r;break}r=(r+1)%this._batchTextureCount}while(r!==n);-1===i&&(this.batchReason="textureOverflow",this._drawBuffers(t),this.batchCardCount=0,i=n),(this._batchTextures[i]=e)._activeIndex=i,(a=e._imageData)&&a._invalid&&void 0!==e._drawID?this._updateTextureImageData(t,a):(t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,e),this.setTextureParams(t)),this._lastTextureInsert=i}else{var a=e._imageData;null!=e._storeID&&a&&a._invalid&&this._updateTextureImageData(t,a)}e._drawID=this._drawID,e._batchID=this._batchID},t._killTextureObject=function(t){if(t){var e=this._webGLContext;if(void 0!==t._storeID&&0<=t._storeID){for(var i in this._textureDictionary[t._storeID]=void 0,this._textureIDs)this._textureIDs[i]==t._storeID&&delete this._textureIDs[i];t._imageData&&(t._imageData._storeID=void 0),t._imageData=t._storeID=void 0}void 0!==t._activeIndex&&this._batchTextures[t._activeIndex]===t&&(this._batchTextures[t._activeIndex]=this._baseTextures[t._activeIndex]);try{t._frameBuffer&&e.deleteFramebuffer(t._frameBuffer),t._frameBuffer=void 0}catch(t){this.vocalDebug&&console.log(t)}try{e.deleteTexture(t)}catch(t){this.vocalDebug&&console.log(t)}}},t._backupBatchTextures=function(t,e){var i=this._webGLContext;this._backupTextures||(this._backupTextures=[]),void 0===e&&(e=this._backupTextures);for(var n=0;n<this._batchTextureCount;n++)i.activeTexture(i.TEXTURE0+n),this._batchTextures[n]=t?e[n]:(e[n]=this._batchTextures[n],this._baseTextures[n]),i.bindTexture(i.TEXTURE_2D,this._batchTextures[n]),this.setTextureParams(i,this._batchTextures[n].isPOT);t&&e===this._backupTextures&&(this._backupTextures=[])},t._batchDraw=function(t,e,i){0<this._isDrawing&&this._drawBuffers(e),this._isDrawing++,this._drawID++,this.batchCardCount=0,this.depth=0,this._appendToBatchGroup(t,e,new createjs.Matrix2D,this.alpha,i),this.batchReason="drawFinish",this._drawBuffers(e),this._isDrawing--},t._cacheDraw=function(t,e,i,n){var r,a=this._activeShader,o=this._slotBlacklist,s=this._maxTextureSlots-1,l=this._viewportWidth,c=this._viewportHeight;this.protectTextureSlot(s,!0);var h=e.getMatrix();(h=h.clone()).scale(1/n.scale,1/n.scale),(h=h.invert()).translate(-n.offX/n.scale*e.scaleX,-n.offY/n.scale*e.scaleY);var u=this._cacheContainer;u.children=[e],u.transformMatrix=h,this._backupBatchTextures(!1),i&&i.length?this._drawFilters(e,i,n):this.isCacheControlled?(t.clear(t.COLOR_BUFFER_BIT),this._batchDraw(u,t,!0)):(t.activeTexture(t.TEXTURE0+s),e.cacheCanvas=this.getTargetRenderTexture(e,n._drawWidth,n._drawHeight),r=e.cacheCanvas,t.bindFramebuffer(t.FRAMEBUFFER,r._frameBuffer),this.updateViewport(n._drawWidth,n._drawHeight),this._projectionMatrix=this._projectionMatrixFlip,t.clear(t.COLOR_BUFFER_BIT),this._batchDraw(u,t,!0),t.bindFramebuffer(t.FRAMEBUFFER,null),this.updateViewport(l,c)),this._backupBatchTextures(!0),this.protectTextureSlot(s,!1),this._activeShader=a,this._slotBlacklist=o},t._drawFilters=function(t,e,i){var n,r=this._webGLContext,a=this._maxTextureSlots-1,o=this._viewportWidth,s=this._viewportHeight,l=this._cacheContainer,c=e.length;r.activeTexture(r.TEXTURE0+a),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,n._frameBuffer),this.updateViewport(i._drawWidth,i._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._batchDraw(l,r,!0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n),this.setTextureParams(r);for(var h=!1,u=0,d=e[u];this._activeShader=this.getFilterShader(d),this._activeShader&&(r.activeTexture(r.TEXTURE0+a),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,n._frameBuffer),r.viewport(0,0,i._drawWidth,i._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,h),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n),this.setTextureParams(r),(1<c||e[0]._multiPass)&&(h=!h),d=null!==d._multiPass?d._multiPass:e[++u]),d;);this.isCacheControlled?(r.bindFramebuffer(r.FRAMEBUFFER,null),this.updateViewport(o,s),this._activeShader=this.getFilterShader(this),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,h)):(h&&(r.activeTexture(r.TEXTURE0+a),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,n._frameBuffer),this._activeShader=this.getFilterShader(this),r.viewport(0,0,i._drawWidth,i._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,!h)),r.bindFramebuffer(r.FRAMEBUFFER,null),this.updateViewport(o,s),t.cacheCanvas=n)},t._appendToBatchGroup=function(t,e,i,n,r){t._glMtx||(t._glMtx=new createjs.Matrix2D);var a=t._glMtx;a.copy(i),t.transformMatrix?a.appendMatrix(t.transformMatrix):a.appendTransform(t.x,t.y,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,t.regX,t.regY);for(var o,s,l,c,h=t.children.length,u=0;u<h;u++){var d=t.children[u];if(d.visible&&n)if(d.cacheCanvas&&!r||(d._updateState&&d._updateState(),!d.children)){this.batchCardCount+1>this._maxCardsPerBatch&&(this.batchReason="vertexOverflow",this._drawBuffers(e),this.batchCardCount=0),d._glMtx||(d._glMtx=new createjs.Matrix2D);var p=d._glMtx;p.copy(a),d.transformMatrix?p.appendMatrix(d.transformMatrix):p.appendTransform(d.x,d.y,d.scaleX,d.scaleY,d.rotation,d.skewX,d.skewY,d.regX,d.regY);var f,m,g,v,y,_,b=d.cacheCanvas&&!r;if(2===d._webGLRenderStyle||b)g=!r&&d.cacheCanvas||d.image;else{if(1!==d._webGLRenderStyle)continue;if(null===(v=d.spriteSheet.getFrame(d.currentFrame)))continue;g=v.image}var x=this._uvs,w=this._vertices,T=this._indices,M=this._alphas;if(g){if(void 0===g._storeID)y=this._loadTextureImage(e,g),this._insertTextureInBatch(e,y);else{if(!(y=this._textureDictionary[g._storeID])){this.vocalDebug&&console.log("Texture should not be looked up while not being stored.");continue}y._batchID!==this._batchID&&this._insertTextureInBatch(e,y)}if(m=y._activeIndex,2===d._webGLRenderStyle||b)c=!b&&d.sourceRect?(d._uvRect||(d._uvRect={}),_=d.sourceRect,(f=d._uvRect).t=_.y/g.height,f.l=_.x/g.width,f.b=(_.y+_.height)/g.height,f.r=(_.x+_.width)/g.width,s=o=0,l=_.width+o,_.height+s):(f=L.UV_RECT,b?(o=(_=d.bitmapCache).x+_._filterOffX/_.scale,s=_.y+_._filterOffY/_.scale,l=_._drawWidth/_.scale+o,_._drawHeight/_.scale+s):(s=o=0,l=g.width+o,g.height+s));else if(1===d._webGLRenderStyle){var S=v.rect;(f=v.uvRect)||(f=L.buildUVRects(d.spriteSheet,d.currentFrame,!1)),o=-v.regX,s=-v.regY,l=S.width-v.regX,c=S.height-v.regY}var E=this.batchCardCount*L.INDICIES_PER_CARD,C=2*E;w[C]=o*p.a+s*p.c+p.tx,w[C+1]=o*p.b+s*p.d+p.ty,w[C+2]=o*p.a+c*p.c+p.tx,w[C+3]=o*p.b+c*p.d+p.ty,w[C+4]=l*p.a+s*p.c+p.tx,w[C+5]=l*p.b+s*p.d+p.ty,w[C+6]=w[C+2],w[C+7]=w[C+3],w[C+8]=w[C+4],w[C+9]=w[C+5],w[C+10]=l*p.a+c*p.c+p.tx,w[C+11]=l*p.b+c*p.d+p.ty,x[C]=f.l,x[C+1]=f.t,x[C+2]=f.l,x[C+3]=f.b,x[C+4]=f.r,x[C+5]=f.t,x[C+6]=f.l,x[C+7]=f.b,x[C+8]=f.r,x[C+9]=f.t,x[C+10]=f.r,x[C+11]=f.b,T[E]=T[E+1]=T[E+2]=T[E+3]=T[E+4]=T[E+5]=m,M[E]=M[E+1]=M[E+2]=M[E+3]=M[E+4]=M[E+5]=d.alpha*n,this.batchCardCount++}}else this._appendToBatchGroup(d,e,a,d.alpha*n)}},t._drawBuffers=function(t){if(!(this.batchCardCount<=0)){this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : "+this.batchReason);var e=this._activeShader,i=this._vertexPositionBuffer,n=this._textureIndexBuffer,r=this._uvPositionBuffer,a=this._alphaBuffer;t.useProgram(e),t.bindBuffer(t.ARRAY_BUFFER,i),t.vertexAttribPointer(e.vertexPositionAttribute,i.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(e.textureIndexAttribute,n.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._indices),t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(e.uvPositionAttribute,r.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._uvs),t.bindBuffer(t.ARRAY_BUFFER,a),t.vertexAttribPointer(e.alphaAttribute,a.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,this._alphas),t.uniformMatrix4fv(e.pMatrixUniform,t.FALSE,this._projectionMatrix);for(var o=0;o<this._batchTextureCount;o++){var s=this._batchTextures[o];t.activeTexture(t.TEXTURE0+o),t.bindTexture(t.TEXTURE_2D,s),this.setTextureParams(t,s.isPOT)}t.drawArrays(t.TRIANGLES,0,this.batchCardCount*L.INDICIES_PER_CARD),this._batchID++}},t._drawCover=function(t,e){0<this._isDrawing&&this._drawBuffers(t),this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : Cover");var i=this._activeShader,n=this._vertexPositionBuffer,r=this._uvPositionBuffer;t.clear(t.COLOR_BUFFER_BIT),t.useProgram(i),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(i.vertexPositionAttribute,n.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,L.COVER_VERT),t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(i.uvPositionAttribute,r.itemSize,t.FLOAT,!1,0,0),t.bufferSubData(t.ARRAY_BUFFER,0,e?L.COVER_UV_FLIP:L.COVER_UV),t.uniform1i(i.samplerUniform,0),t.uniform1f(i.uprightUniform,e?0:1),t.drawArrays(t.TRIANGLES,0,L.INDICIES_PER_CARD)},createjs.StageGL=createjs.promote(L,"Stage")}(),this.createjs=this.createjs||{},function(){function n(t){this.DisplayObject_constructor(),"string"==typeof t?(this.image=document.createElement("img"),this.image.src=t):this.image=t,this.sourceRect=null,this._webGLRenderStyle=createjs.DisplayObject._StageGL_BITMAP}var t=createjs.extend(n,createjs.DisplayObject);t.initialize=n,t.isVisible=function(){var t=this.image,e=this.cacheCanvas||t&&(t.naturalWidth||t.getContext||2<=t.readyState);return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&e)},t.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;var i=this.image,n=this.sourceRect;if(i.getImage&&(i=i.getImage()),!i)return!0;if(n){var r=n.x,a=n.y,o=r+n.width,s=a+n.height,l=0,c=0,h=i.width,u=i.height;r<0&&(l-=r,r=0),h<o&&(o=h),a<0&&(c-=a,a=0),u<s&&(s=u),t.drawImage(i,r,a,o-r,s-a,l,c,o-r,s-a)}else t.drawImage(i,0,0);return!0},t.getBounds=function(){var t=this.DisplayObject_getBounds();if(t)return t;var e=this.image,i=this.sourceRect||e;return e&&(e.naturalWidth||e.getContext||2<=e.readyState)?this._rectangle.setValues(0,0,i.width,i.height):null},t.clone=function(t){var e=this.image;e&&t&&(e=e.cloneNode());var i=new n(e);return this.sourceRect&&(i.sourceRect=this.sourceRect.clone()),this._cloneProps(i),i},t.toString=function(){return"[Bitmap (name="+this.name+")]"},createjs.Bitmap=createjs.promote(n,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.DisplayObject_constructor(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=t,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,this._webGLRenderStyle=createjs.DisplayObject._StageGL_SPRITE,null!=e&&this.gotoAndPlay(e)}var e=createjs.extend(t,createjs.DisplayObject);e.initialize=t,e.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;this._normalizeFrame();var i=this.spriteSheet.getFrame(0|this._currentFrame);if(!i)return!1;var n=i.rect;return n.width&&n.height&&t.drawImage(i.image,n.x,n.y,n.width,n.height,-i.regX,-i.regY,n.width,n.height),!0},e.play=function(){this.paused=!1},e.stop=function(){this.paused=!0},e.gotoAndPlay=function(t){this.paused=!1,this._skipAdvance=!0,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.advance=function(t){var e=this.framerate||this.spriteSheet.framerate,i=e&&null!=t?t/(1e3/e):1;this._normalizeFrame(i)},e.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)},e.clone=function(){return this._cloneProps(new t(this.spriteSheet))},e.toString=function(){return"[Sprite (name="+this.name+")]"},e._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.currentFrame=this.currentFrame,t.currentAnimation=this.currentAnimation,t.paused=this.paused,t.currentAnimationFrame=this.currentAnimationFrame,t.framerate=this.framerate,t._animation=this._animation,t._currentFrame=this._currentFrame,t._skipAdvance=this._skipAdvance,t},e._tick=function(t){this.paused||(this._skipAdvance||this.advance(t&&t.delta),this._skipAdvance=!1),this.DisplayObject__tick(t)},e._normalizeFrame=function(t){t=t||0;var e,i=this._animation,n=this.paused,r=this._currentFrame;if(i){var a=i.speed||1,o=this.currentAnimationFrame;if((e=i.frames.length)<=o+t*a){var s=i.next;if(this._dispatchAnimationEnd(i,r,n,s,e-1))return;if(s)return this._goto(s,t-(e-o)/a);this.paused=!0,o=i.frames.length-1}else o+=t*a;this.currentAnimationFrame=o,this._currentFrame=i.frames[0|o]}else if(r=this._currentFrame+=t,(e=this.spriteSheet.getNumFrames())<=r&&0<e&&!this._dispatchAnimationEnd(i,r,n,e-1)&&(this._currentFrame-=e)>=e)return this._normalizeFrame();r=0|this._currentFrame,this.currentFrame!=r&&(this.currentFrame=r,this.dispatchEvent("change"))},e._dispatchAnimationEnd=function(t,e,i,n,r){var a=t?t.name:null;if(this.hasEventListener("animationend")){var o=new createjs.Event("animationend");o.name=a,o.next=n,this.dispatchEvent(o)}var s=this._animation!=t||this._currentFrame!=e;return s||i||!this.paused||(this.currentAnimationFrame=r,s=!0),s},e._goto=function(t,e){if(this.currentAnimationFrame=0,isNaN(t)){var i=this.spriteSheet.getAnimation(t);i&&(this._animation=i,this.currentAnimation=t,this._normalizeFrame(e))}else this.currentAnimation=this._animation=null,this._currentFrame=t,this._normalizeFrame()},createjs.Sprite=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function i(t){this.DisplayObject_constructor(),this.graphics=t||new createjs.Graphics}var t=createjs.extend(i,createjs.DisplayObject);t.isVisible=function(){var t=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},t.draw=function(t,e){return this.DisplayObject_draw(t,e)||this.graphics.draw(t,this),!0},t.clone=function(t){var e=t&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new i(e))},t.toString=function(){return"[Shape (name="+this.name+")]"},createjs.Shape=createjs.promote(i,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function g(t,e,i){this.DisplayObject_constructor(),this.text=t,this.font=e,this.color=i,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}var t=createjs.extend(g,createjs.DisplayObject),e=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");e.getContext&&(g._workingContext=e.getContext("2d"),e.width=e.height=1),g.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},g.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},t.isVisible=function(){var t=this.cacheCanvas||null!=this.text&&""!==this.text;return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&t)},t.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;var i=this.color||"#000";return this.outline?(t.strokeStyle=i,t.lineWidth=1*this.outline):t.fillStyle=i,this._drawText(this._prepContext(t)),!0},t.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)},t.getMeasuredLineHeight=function(){return 1.2*this._getMeasuredWidth("M")},t.getMeasuredHeight=function(){return this._drawText(null,{}).height},t.getBounds=function(){var t=this.DisplayObject_getBounds();if(t)return t;if(null==this.text||""===this.text)return null;var e=this._drawText(null,{}),i=this.maxWidth&&this.maxWidth<e.width?this.maxWidth:e.width,n=i*g.H_OFFSETS[this.textAlign||"left"],r=(this.lineHeight||this.getMeasuredLineHeight())*g.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(n,r,i,e.height)},t.getMetrics=function(){var t={lines:[]};return t.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),t.vOffset=t.lineHeight*g.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,t,t.lines)},t.clone=function(){return this._cloneProps(new g(this.text,this.font,this.color))},t.toString=function(){return"[Text (text="+(20<this.text.length?this.text.substr(0,17)+"...":this.text)+")]"},t._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.maxWidth=this.maxWidth,t.outline=this.outline,t.lineHeight=this.lineHeight,t.lineWidth=this.lineWidth,t},t._prepContext=function(t){return t.font=this.font||"10px sans-serif",t.textAlign=this.textAlign||"left",t.textBaseline=this.textBaseline||"top",t.lineJoin="miter",t.miterLimit=2.5,t},t._drawText=function(t,e,i){var n=!!t;n||((t=g._workingContext).save(),this._prepContext(t));for(var r=this.lineHeight||this.getMeasuredLineHeight(),a=0,o=0,s=String(this.text).split(/(?:\r\n|\r|\n)/),l=0,c=s.length;l<c;l++){var h=s[l],u=null;if(null!=this.lineWidth&&(u=t.measureText(h).width)>this.lineWidth){var d=h.split(/(\s)/);h=d[0],u=t.measureText(h).width;for(var p=1,f=d.length;p<f;p+=2){var m=t.measureText(d[p]+d[p+1]).width;u+m>this.lineWidth?(n&&this._drawTextLine(t,h,o*r),i&&i.push(h),a<u&&(a=u),h=d[p+1],u=t.measureText(h).width,o++):(h+=d[p]+d[p+1],u+=m)}}n&&this._drawTextLine(t,h,o*r),i&&i.push(h),e&&null==u&&(u=t.measureText(h).width),a<u&&(a=u),o++}return e&&(e.width=a,e.height=o*r),n||t.restore(),e},t._drawTextLine=function(t,e,i){this.outline?t.strokeText(e,0,i,this.maxWidth||65535):t.fillText(e,0,i,this.maxWidth||65535)},t._getMeasuredWidth=function(t){var e=g._workingContext;e.save();var i=this._prepContext(e).measureText(t).width;return e.restore(),i},createjs.Text=createjs.promote(g,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function y(t,e){this.Container_constructor(),this.text=t||"",this.spriteSheet=e,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0},this._oldStage=null,this._drawAction=null}var t=createjs.extend(y,createjs.Container);y.maxPoolSize=100,y._spritePool=[],t.draw=function(t,e){this.DisplayObject_draw(t,e)||(this._updateState(),this.Container_draw(t,e))},t.getBounds=function(){return this._updateText(),this.Container_getBounds()},t.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&0<this.alpha&&0!==this.scaleX&&0!==this.scaleY&&t)},t.clone=function(){return this._cloneProps(new y(this.text,this.spriteSheet))},t.addChild=t.addChildAt=t.removeChild=t.removeChildAt=t.removeAllChildren=function(){},t._updateState=function(){this._updateText()},t._cloneProps=function(t){return this.Container__cloneProps(t),t.lineHeight=this.lineHeight,t.letterSpacing=this.letterSpacing,t.spaceWidth=this.spaceWidth,t},t._getFrameIndex=function(t,e){var i,n=e.getAnimation(t);return n||(t!=(i=t.toUpperCase())||t!=(i=t.toLowerCase())||(i=null),i&&(n=e.getAnimation(i))),n&&n.frames[0]},t._getFrame=function(t,e){var i=this._getFrameIndex(t,e);return null==i?i:e.getFrame(i)},t._getLineHeight=function(t){var e=this._getFrame("1",t)||this._getFrame("T",t)||this._getFrame("L",t)||t.getFrame(0);return e?e.rect.height:1},t._getSpaceWidth=function(t){var e=this._getFrame("1",t)||this._getFrame("l",t)||this._getFrame("e",t)||this._getFrame("a",t)||t.getFrame(0);return e?e.rect.width:1},t._updateText=function(){var t,e=0,i=0,n=this._oldProps,r=!1,a=this.spaceWidth,o=this.lineHeight,s=this.spriteSheet,l=y._spritePool,c=this.children,h=0,u=c.length;for(var d in n)n[d]!=this[d]&&(n[d]=this[d],r=!0);if(r){var p=!!this._getFrame(" ",s);p||a||(a=this._getSpaceWidth(s)),o||(o=this._getLineHeight(s));for(var f=0,m=this.text.length;f<m;f++){var g=this.text.charAt(f);if(" "!=g||p)if("\n"!=g&&"\r"!=g){var v=this._getFrameIndex(g,s);null!=v&&(h<u?t=c[h]:(c.push(t=l.length?l.pop():new createjs.Sprite),t.parent=this,u++),t.spriteSheet=s,t.gotoAndStop(v),t.x=e,t.y=i,h++,e+=t.getBounds().width+this.letterSpacing)}else"\r"==g&&"\n"==this.text.charAt(f+1)&&f++,e=0,i+=o;else e+=a}for(;h<u;)l.push(t=c.pop()),t.parent=null,u--;l.length>y.maxPoolSize&&(l.length=y.maxPoolSize)}},createjs.BitmapText=createjs.promote(y,"Container")}(),this.createjs=this.createjs||{},function(){function o(t){var e,i,n,r;this.Container_constructor(),!o.inited&&o.init(),t instanceof String||1<arguments.length?(e=t,i=arguments[1],n=arguments[2],r=arguments[3],null==n&&(n=-1),t=null):t&&(e=t.mode,i=t.startPosition,n=t.loop,r=t.labels),t||(t={labels:r}),this.mode=e||o.INDEPENDENT,this.startPosition=i||0,this.loop=!0===n?-1:n||0,this.currentFrame=0,this.paused=t.paused||!1,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||t.frameBounds,this.framerate=null,t.useTicks=t.paused=!0,this.timeline=new createjs.Timeline(t),this._synchOffset=0,this._rawPosition=-1,this._bound_resolveState=this._resolveState.bind(this),this._t=0,this._managed={}}function n(){throw"MovieClipPlugin cannot be instantiated."}var t=createjs.extend(o,createjs.Container);o.INDEPENDENT="independent",o.SINGLE_FRAME="single",o.SYNCHED="synched",o.inited=!1,o.init=function(){o.inited||(n.install(),o.inited=!0)},t._getLabels=function(){return this.timeline.getLabels()},t.getLabels=createjs.deprecate(t._getLabels,"MovieClip.getLabels"),t._getCurrentLabel=function(){return this.timeline.currentLabel},t.getCurrentLabel=createjs.deprecate(t._getCurrentLabel,"MovieClip.getCurrentLabel"),t._getDuration=function(){return this.timeline.duration},t.getDuration=createjs.deprecate(t._getDuration,"MovieClip.getDuration");try{Object.defineProperties(t,{labels:{get:t._getLabels},currentLabel:{get:t._getCurrentLabel},totalFrames:{get:t._getDuration},duration:{get:t._getDuration}})}catch(t){}t.initialize=o,t.isVisible=function(){return!!(this.visible&&0<this.alpha&&0!=this.scaleX&&0!=this.scaleY)},t.draw=function(t,e){return this.DisplayObject_draw(t,e)||(this._updateState(),this.Container_draw(t,e)),!0},t.play=function(){this.paused=!1},t.stop=function(){this.paused=!0},t.gotoAndPlay=function(t){this.paused=!1,this._goto(t)},t.gotoAndStop=function(t){this.paused=!0,this._goto(t)},t.advance=function(t){var e=o.INDEPENDENT;if(this.mode===e){for(var i=this,n=i.framerate;(i=i.parent)&&null===n;)i.mode===e&&(n=i._framerate);if(this._framerate=n,!this.paused){var r=null!==n&&-1!==n&&null!==t?t/(1e3/n)+this._t:1,a=0|r;for(this._t=r-a;a--;)this._updateTimeline(this._rawPosition+1,!1)}}},t.clone=function(){throw"MovieClip cannot be cloned."},t.toString=function(){return"[MovieClip (name="+this.name+")]"},t._updateState=function(){(-1===this._rawPosition||this.mode!==o.INDEPENDENT)&&this._updateTimeline(-1)},t._tick=function(t){this.advance(t&&t.delta),this.Container__tick(t)},t._goto=function(t){var e=this.timeline.resolve(t);null!=e&&(this._t=0,this._updateTimeline(e,!0))},t._reset=function(){this._rawPosition=-1,this._t=this.currentFrame=0,this.paused=!1},t._updateTimeline=function(t,e){var i=this.mode!==o.INDEPENDENT,n=this.timeline;i&&(t=this.startPosition+(this.mode===o.SINGLE_FRAME?0:this._synchOffset)),t<0&&(t=0),(this._rawPosition!==t||i)&&(this._rawPosition=t,n.loop=this.loop,n.setPosition(t,i||!this.actionsEnabled,e,this._bound_resolveState))},t._renderFirstFrame=function(){var t=this.timeline,e=t.rawPosition;t.setPosition(0,!0,!0,this._bound_resolveState),t.rawPosition=e},t._resolveState=function(){var t=this.timeline;for(var e in this.currentFrame=t.position,this._managed)this._managed[e]=1;for(var i=t.tweens,n=0,r=i.length;n<r;n++){var a=i[n],o=a.target;if(o!==this&&!a.passive){var s=a._stepPosition;o instanceof createjs.DisplayObject?this._addManagedChild(o,s):this._setState(o.state,s)}}var l=this.children;for(n=l.length-1;0<=n;n--){var c=l[n].id;1===this._managed[c]&&(this.removeChildAt(n),delete this._managed[c])}},t._setState=function(t,e){if(t)for(var i=t.length-1;0<=i;i--){var n=t[i],r=n.t,a=n.p;for(var o in a)r[o]=a[o];this._addManagedChild(r,e)}},t._addManagedChild=function(t,e){t._off||(this.addChildAt(t,0),t instanceof o&&(t._synchOffset=e,t.mode===o.INDEPENDENT&&t.autoReset&&!this._managed[t.id]&&t._reset()),this._managed[t.id]=2)},t._getBounds=function(t,e){var i=this.DisplayObject_getBounds();return i||this.frameBounds&&(i=this._rectangle.copy(this.frameBounds[this.currentFrame])),i?this._transformBounds(i,t,e):this.Container__getBounds(t,e)},createjs.MovieClip=createjs.promote(o,"Container"),n.priority=100,n.ID="MovieClip",n.install=function(){createjs.Tween._installPlugin(n)},n.init=function(t,e,i){"startPosition"===e&&t.target instanceof o&&t._addPlugin(n)},n.step=function(t,e,i){},n.change=function(t,e,i,n,r,a){return"startPosition"===i?1===r?e.props[i]:e.prev.props[i]:void 0}}(),this.createjs=this.createjs||{},function(){function T(){throw"SpriteSheetUtils cannot be instantiated"}var t=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");t.getContext&&(T._workingCanvas=t,T._workingContext=t.getContext("2d"),t.width=t.height=1),T.extractFrame=function(t,e){isNaN(e)&&(e=t.getAnimation(e).frames[0]);var i=t.getFrame(e);if(!i)return null;var n=i.rect,r=T._workingCanvas;r.width=n.width,r.height=n.height,T._workingContext.drawImage(i.image,n.x,n.y,n.width,n.height,0,0,n.width,n.height);var a=document.createElement("img");return a.src=r.toDataURL("image/png"),a},T.addFlippedFrames=createjs.deprecate(null,"SpriteSheetUtils.addFlippedFrames"),T.mergeAlpha=createjs.deprecate(null,"SpriteSheetUtils.mergeAlpha"),T._flip=function(t,e,i,n){for(var r=t._images,a=T._workingCanvas,o=T._workingContext,s=r.length/e,l=0;l<s;l++){var c=r[l];c.__tmp=l,o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,a.width+1,a.height+1),a.width=c.width,a.height=c.height,o.setTransform(i?-1:1,0,0,n?-1:1,i?c.width:0,n?c.height:0),o.drawImage(c,0,0);var h=document.createElement("img");h.src=a.toDataURL("image/png"),h.width=c.width||c.naturalWidth,h.height=c.height||c.naturalHeight,r.push(h)}var u=t._frames,d=u.length/e;for(l=0;l<d;l++){var p=(c=u[l]).rect.clone(),f={image:h=r[c.image.__tmp+s*e],rect:p,regX:c.regX,regY:c.regY};i&&(p.x=(h.width||h.naturalWidth)-p.x-p.width,f.regX=p.width-c.regX),n&&(p.y=(h.height||h.naturalHeight)-p.y-p.height,f.regY=p.height-c.regY),u.push(f)}var m="_"+(i?"h":"")+(n?"v":""),g=t._animations,v=t._data,y=g.length/e;for(l=0;l<y;l++){var _=g[l],b={name:_+m,speed:(c=v[_]).speed,next:c.next,frames:[]};c.next&&(b.next+=m);for(var x=0,w=(u=c.frames).length;x<w;x++)b.frames.push(u[x]+d*e);v[b.name]=b,g.push(b.name)}},createjs.SpriteSheetUtils=T}(),this.createjs=this.createjs||{},function(){function x(t){this.EventDispatcher_constructor(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=t||0,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,this._index=0,this._timerID=null,this._scale=1}var t=createjs.extend(x,createjs.EventDispatcher);x.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",x.ERR_RUNNING="a build is already running",t.addFrame=function(t,e,i,n,r){if(this._data)throw x.ERR_RUNNING;var a=e||t.bounds||t.nominalBounds;return!a&&t.getBounds&&(a=t.getBounds()),a?(i=i||1,this._frames.push({source:t,sourceRect:a,scale:i,funct:n,data:r,index:this._frames.length,height:a.height*i})-1):null},t.addAnimation=function(t,e,i,n){if(this._data)throw x.ERR_RUNNING;this._animations[t]={frames:e,next:i,speed:n}},t.addMovieClip=function(t,e,i,n,r,a){if(this._data)throw x.ERR_RUNNING;var o=t.frameBounds,s=e||t.bounds||t.nominalBounds;if(!s&&t.getBounds&&(s=t.getBounds()),s||o){var l,c,h=this._frames.length,u=t.timeline.duration;for(l=0;l<u;l++){var d=o&&o[l]?o[l]:s;this.addFrame(t,d,i,this._setupMovieClipFrame,{i:l,f:n,d:r})}var p=t.timeline._labels,f=[];for(var m in p)f.push({index:p[m],label:m});if(f.length)for(f.sort(function(t,e){return t.index-e.index}),l=0,c=f.length;l<c;l++){for(var g=f[l].label,v=h+f[l].index,y=h+(l==c-1?u:f[l+1].index),_=[],b=v;b<y;b++)_.push(b);(!a||(g=a(g,t,v,y)))&&this.addAnimation(g,_,!0)}}},t.build=function(){if(this._data)throw x.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet},t.buildAsync=function(t){if(this._data)throw x.ERR_RUNNING;this.timeSlice=t,this._startBuild();var e=this;this._timerID=setTimeout(function(){e._run()},50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))},t.stopAsync=function(){clearTimeout(this._timerID),this._data=null},t.clone=function(){throw"SpriteSheetBuilder cannot be cloned."},t.toString=function(){return"[SpriteSheetBuilder]"},t._startBuild=function(){var t=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;var e=[];this._data={images:[],frames:e,framerate:this.framerate,animations:this._animations};var i=this._frames.slice();if(i.sort(function(t,e){return t.height<=e.height?-1:1}),i[i.length-1].height+2*t>this.maxHeight)throw x.ERR_DIMENSIONS;for(var n=0,r=0,a=0;i.length;){var o=this._fillRow(i,n,a,e,t);if(o.w>r&&(r=o.w),n+=o.h,!o.h||!i.length){var s=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");s.width=this._getSize(r,this.maxWidth),s.height=this._getSize(n,this.maxHeight),this._data.images[a]=s,o.h||(r=n=0,a++)}}},t._setupMovieClipFrame=function(t,e){var i=t.actionsEnabled;t.actionsEnabled=!1,t.gotoAndStop(e.i),t.actionsEnabled=i,e.f&&e.f(t,e.d,e.i)},t._getSize=function(t,e){for(var i=4;Math.pow(2,++i)<t;);return Math.min(e,Math.pow(2,i))},t._fillRow=function(t,e,i,n,r){for(var a=this.maxWidth,o=this.maxHeight-(e+=r),s=r,l=0,c=t.length-1;0<=c;c--){var h=t[c],u=this._scale*h.scale,d=h.sourceRect,p=h.source,f=Math.floor(u*d.x-r),m=Math.floor(u*d.y-r),g=Math.ceil(u*d.height+2*r),v=Math.ceil(u*d.width+2*r);if(a<v)throw x.ERR_DIMENSIONS;o<g||a<s+v||(h.img=i,h.rect=new createjs.Rectangle(s,e,v,g),l=l||g,t.splice(c,1),n[h.index]=[s,e,v,g,i,Math.round(-f+u*p.regX-r),Math.round(-m+u*p.regY-r)],s+=v)}return{w:s,h:l}},t._endBuild=function(){this.spriteSheet=new createjs.SpriteSheet(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")},t._run=function(){for(var t=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),e=(new Date).getTime()+t,i=!1;e>(new Date).getTime();)if(!this._drawNext()){i=!0;break}if(i)this._endBuild();else{var n=this;this._timerID=setTimeout(function(){n._run()},50-t)}var r=this.progress=this._index/this._frames.length;if(this.hasEventListener("progress")){var a=new createjs.Event("progress");a.progress=r,this.dispatchEvent(a)}},t._drawNext=function(){var t=this._frames[this._index],e=t.scale*this._scale,i=t.rect,n=t.sourceRect,r=this._data.images[t.img].getContext("2d");return t.funct&&t.funct(t.source,t.data),r.save(),r.beginPath(),r.rect(i.x,i.y,i.width,i.height),r.clip(),r.translate(Math.ceil(i.x-n.x*e),Math.ceil(i.y-n.y*e)),r.scale(e,e),t.source.draw(r),r.restore(),++this._index<this._frames.length},createjs.SpriteSheetBuilder=createjs.promote(x,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t){this.DisplayObject_constructor(),"string"==typeof t&&(t=document.getElementById(t)),this.mouseEnabled=!1;var e=t.style;e.position="absolute",e.transformOrigin=e.WebkitTransformOrigin=e.msTransformOrigin=e.MozTransformOrigin=e.OTransformOrigin="0% 0%",this.htmlElement=t,this._oldProps=null,this._oldStage=null,this._drawAction=null}var e=createjs.extend(t,createjs.DisplayObject);e.isVisible=function(){return null!=this.htmlElement},e.draw=function(t,e){return!0},e.cache=function(){},e.uncache=function(){},e.updateCache=function(){},e.hitTest=function(){},e.localToGlobal=function(){},e.globalToLocal=function(){},e.localToLocal=function(){},e.clone=function(){throw"DOMElement cannot be cloned."},e.toString=function(){return"[DOMElement (name="+this.name+")]"},e._tick=function(t){var e=this.stage;e&&e!==this._oldStage&&(this._drawAction&&e.off("drawend",this._drawAction),this._drawAction=e.on("drawend",this._handleDrawEnd,this),this._oldStage=e),this.DisplayObject__tick(t)},e._handleDrawEnd=function(t){var e=this.htmlElement;if(e){var i=e.style,n=this.getConcatenatedDisplayProps(this._props),r=n.matrix,a=n.visible?"visible":"hidden";if(a!=i.visibility&&(i.visibility=a),n.visible){var o=this._oldProps,s=o&&o.matrix;if(!s||!s.equals(r)){var l="matrix("+(1e4*r.a|0)/1e4+","+(1e4*r.b|0)/1e4+","+(1e4*r.c|0)/1e4+","+(1e4*r.d|0)/1e4+","+(r.tx+.5|0);i.transform=i.WebkitTransform=i.OTransform=i.msTransform=l+","+(r.ty+.5|0)+")",i.MozTransform=l+"px,"+(r.ty+.5|0)+"px)",o||(o=this._oldProps=new createjs.DisplayProps(!0,null)),o.matrix.copy(r)}o.alpha!=n.alpha&&(i.opacity=""+(1e4*n.alpha|0)/1e4,o.alpha=n.alpha)}}},createjs.DOMElement=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(){this.usesContext=!1,this._multiPass=null,this.VTX_SHADER_BODY=null,this.FRAG_SHADER_BODY=null}var e=t.prototype;e.getBounds=function(t){return t},e.shaderParamSetup=function(t,e,i){},e.applyFilter=function(t,e,i,n,r,a,o,s){a=a||t,null==o&&(o=e),null==s&&(s=i);try{var l=t.getImageData(e,i,n,r)}catch(t){return!1}return!!this._applyFilter(l)&&(a.putImageData(l,o,s),!0)},e.toString=function(){return"[Filter]"},e.clone=function(){return new t},e._applyFilter=function(t){return!0},createjs.Filter=t}(),this.createjs=this.createjs||{},function(){function n(){this.width=void 0,this.height=void 0,this.x=void 0,this.y=void 0,this.scale=1,this.offX=0,this.offY=0,this.cacheID=0,this._filterOffX=0,this._filterOffY=0,this._cacheDataURLID=0,this._cacheDataURL=null,this._drawWidth=0,this._drawHeight=0}var t=n.prototype;n.getFilterBounds=function(t,e){e||(e=new createjs.Rectangle);var i=t.filters,n=i&&i.length;if(!!n<=0)return e;for(var r=0;r<n;r++){var a=i[r];if(a&&a.getBounds){var o=a.getBounds();o&&(0==r?e.setValues(o.x,o.y,o.width,o.height):e.extend(o.x,o.y,o.width,o.height))}}return e},t.toString=function(){return"[BitmapCache]"},t.define=function(t,e,i,n,r,a,o){if(!t)throw"No symbol to cache";this._options=o,this.target=t,this.width=1<=n?n:1,this.height=1<=r?r:1,this.x=e||0,this.y=i||0,this.scale=a||1,this.update()},t.update=function(t){if(!this.target)throw"define() must be called before update()";var e=n.getFilterBounds(this.target),i=this.target.cacheCanvas;this._drawWidth=Math.ceil(this.width*this.scale)+e.width,this._drawHeight=Math.ceil(this.height*this.scale)+e.height,i&&this._drawWidth==i.width&&this._drawHeight==i.height||this._updateSurface(),this._filterOffX=e.x,this._filterOffY=e.y,this.offX=this.x*this.scale+this._filterOffX,this.offY=this.y*this.scale+this._filterOffY,this._drawToCache(t),this.cacheID=this.cacheID?this.cacheID+1:1},t.release=function(){if(this._webGLCache)this._webGLCache.isCacheControlled||(this.__lastRT&&(this.__lastRT=void 0),this.__rtA&&this._webGLCache._killTextureObject(this.__rtA),this.__rtB&&this._webGLCache._killTextureObject(this.__rtB),this.target&&this.target.cacheCanvas&&this._webGLCache._killTextureObject(this.target.cacheCanvas)),this._webGLCache=!1;else{var t=this.target.stage;t instanceof createjs.StageGL&&t.releaseTexture(this.target.cacheCanvas)}this.target=this.target.cacheCanvas=null,this.cacheID=this._cacheDataURLID=this._cacheDataURL=void 0,this.width=this.height=this.x=this.y=this.offX=this.offY=0,this.scale=1},t.getCacheDataURL=function(){var t=this.target&&this.target.cacheCanvas;return t?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURLID=this.cacheID,this._cacheDataURL=t.toDataURL?t.toDataURL():null),this._cacheDataURL):null},t.draw=function(t){return!!this.target&&(t.drawImage(this.target.cacheCanvas,this.x+this._filterOffX/this.scale,this.y+this._filterOffY/this.scale,this._drawWidth/this.scale,this._drawHeight/this.scale),!0)},t._updateSurface=function(){if(!this._options||!this._options.useGL)return(t=this.target.cacheCanvas)||(t=this.target.cacheCanvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")),t.width=this._drawWidth,void(t.height=this._drawHeight);if(!this._webGLCache)if("stage"===this._options.useGL){if(!this.target.stage||!this.target.stage.isWebGL)throw"Cannot use 'stage' for cache because the object's parent stage is "+(this.target.stage?"non WebGL.":"not set, please addChild to the correct stage.");this.target.cacheCanvas=!0,this._webGLCache=this.target.stage}else if("new"===this._options.useGL)this.target.cacheCanvas=document.createElement("canvas"),this._webGLCache=new createjs.StageGL(this.target.cacheCanvas,{antialias:!0,transparent:!0,autoPurge:-1}),this._webGLCache.isCacheControlled=!0;else{if(!(this._options.useGL instanceof createjs.StageGL))throw"Invalid option provided to useGL, expected ['stage', 'new', StageGL, undefined], got "+this._options.useGL;this.target.cacheCanvas=!0,this._webGLCache=this._options.useGL,this._webGLCache.isCacheControlled=!0}var t=this.target.cacheCanvas,e=this._webGLCache;e.isCacheControlled&&(t.width=this._drawWidth,t.height=this._drawHeight,e.updateViewport(this._drawWidth,this._drawHeight)),this.target.filters?(e.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight),e.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)):e.isCacheControlled||e.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)},t._drawToCache=function(t){var e=this.target.cacheCanvas,i=this.target,n=this._webGLCache;if(n)n.cacheDraw(i,i.filters,this),(e=this.target.cacheCanvas).width=this._drawWidth,e.height=this._drawHeight;else{var r=e.getContext("2d");t||r.clearRect(0,0,this._drawWidth+1,this._drawHeight+1),r.save(),r.globalCompositeOperation=t,r.setTransform(this.scale,0,0,this.scale,-this._filterOffX,-this._filterOffY),r.translate(-this.x,-this.y),i.draw(r,!0),r.restore(),i.filters&&i.filters.length&&this._applyFilters(r)}e._invalid=!0},t._applyFilters=function(t){for(var e,i=this.target.filters,n=this._drawWidth,r=this._drawHeight,a=0,o=i[a];o.usesContext?(e&&(t.putImageData(e,0,0),e=null),o.applyFilter(t,0,0,n,r)):(e||(e=t.getImageData(0,0,n,r)),o._applyFilter(e)),o=null!==o._multiPass?o._multiPass:i[++a];);e&&t.putImageData(e,0,0)},createjs.BitmapCache=n}(),this.createjs=this.createjs||{},function(){function B(t,e,i){this.Filter_constructor(),this._blurX=t,this._blurXTable=[],this._lastBlurX=null,this._blurY=e,this._blurYTable=[],this._lastBlurY=null,this._quality,this._lastQuality=null,this.FRAG_SHADER_TEMPLATE="uniform float xWeight[{{blurX}}];uniform float yWeight[{{blurY}}];uniform vec2 textureOffset;void main(void) {vec4 color = vec4(0.0);float xAdj = ({{blurX}}.0-1.0)/2.0;float yAdj = ({{blurY}}.0-1.0)/2.0;vec2 sampleOffset;for(int i=0; i<{{blurX}}; i++) {for(int j=0; j<{{blurY}}; j++) {sampleOffset = vRenderCoord + (textureOffset * vec2(float(i)-xAdj, float(j)-yAdj));color += texture2D(uSampler, sampleOffset) * (xWeight[i] * yWeight[j]);}}gl_FragColor = color.rgba;}",(isNaN(i)||i<1)&&(i=1),this.setQuality(0|i)}var t=createjs.extend(B,createjs.Filter);t.getBlurX=function(){return this._blurX},t.getBlurY=function(){return this._blurY},t.setBlurX=function(t){(isNaN(t)||t<0)&&(t=0),this._blurX=t},t.setBlurY=function(t){(isNaN(t)||t<0)&&(t=0),this._blurY=t},t.getQuality=function(){return this._quality},t.setQuality=function(t){(isNaN(t)||t<0)&&(t=0),this._quality=0|t},t._getShader=function(){var t=this._lastBlurX!==this._blurX,e=this._lastBlurY!==this._blurY,i=this._lastQuality!==this._quality;return t||e||i?((t||i)&&(this._blurXTable=this._getTable(this._blurX*this._quality)),(e||i)&&(this._blurYTable=this._getTable(this._blurY*this._quality)),this._updateShader(),this._lastBlurX=this._blurX,this._lastBlurY=this._blurY,void(this._lastQuality=this._quality)):this._compiledShader},t._setShader=function(){this._compiledShader};try{Object.defineProperties(t,{blurX:{get:t.getBlurX,set:t.setBlurX},blurY:{get:t.getBlurY,set:t.setBlurY},quality:{get:t.getQuality,set:t.setQuality},_builtShader:{get:t._getShader,set:t._setShader}})}catch(t){console.log(t)}t._getTable=function(t){if(t<=1)return[1];for(var e=[],i=Math.ceil(2*t),n=(i+=i%2?0:1)/2|0,r=-n;r<=n;r++){var a=r/n*4.2;e.push(1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-Math.pow(a,2)/4))}var o=e.reduce(function(t,e){return t+e});return e.map(function(t,e,i){return t/o})},t._updateShader=function(){if(void 0!==this._blurX&&void 0!==this._blurY){var t=this.FRAG_SHADER_TEMPLATE;t=(t=t.replace(/\{\{blurX\}\}/g,this._blurXTable.length.toFixed(0))).replace(/\{\{blurY\}\}/g,this._blurYTable.length.toFixed(0)),this.FRAG_SHADER_BODY=t}},t.shaderParamSetup=function(t,e,i){t.uniform1fv(t.getUniformLocation(i,"xWeight"),this._blurXTable),t.uniform1fv(t.getUniformLocation(i,"yWeight"),this._blurYTable),t.uniform2f(t.getUniformLocation(i,"textureOffset"),2/(e._viewportWidth*this._quality),2/(e._viewportHeight*this._quality))},B.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],B.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9],t.getBounds=function(t){var e=0|this.blurX,i=0|this.blurY;if(e<=0&&i<=0)return t;var n=Math.pow(this.quality,.2);return(t||new createjs.Rectangle).pad(i*n+1,e*n+1,i*n+1,e*n+1)},t.clone=function(){return new B(this.blurX,this.blurY,this.quality)},t.toString=function(){return"[BlurFilter]"},t._applyFilter=function(t){var e=this._blurX>>1;if(isNaN(e)||e<0)return!1;var i=this._blurY>>1;if(isNaN(i)||i<0)return!1;if(0==e&&0==i)return!1;var n=this.quality;(isNaN(n)||n<1)&&(n=1),3<(n|=0)&&(n=3),n<1&&(n=1);var r=t.data,a=0,o=0,s=0,l=0,c=0,h=0,u=0,d=0,p=0,f=0,m=0,g=0,v=0,y=0,_=0,b=e+e+1|0,x=i+i+1|0,w=0|t.width,T=0|t.height,M=w-1|0,S=T-1|0,E=e+1|0,C=i+1|0,L={r:0,b:0,g:0,a:0},A=L;for(s=1;s<b;s++)A=A.n={r:0,b:0,g:0,a:0};A.n=L;var P={r:0,b:0,g:0,a:0},R=P;for(s=1;s<x;s++)R=R.n={r:0,b:0,g:0,a:0};R.n=P;for(var O=null,I=0|B.MUL_TABLE[e],D=0|B.SHG_TABLE[e],j=0|B.MUL_TABLE[i],k=0|B.SHG_TABLE[i];0<n--;){u=h=0;var N=I,F=D;for(o=T;-1<--o;){for(d=E*(g=r[0|h]),p=E*(v=r[h+1|0]),f=E*(y=r[h+2|0]),m=E*(_=r[h+3|0]),A=L,s=E;-1<--s;)A.r=g,A.g=v,A.b=y,A.a=_,A=A.n;for(s=1;s<E;s++)l=h+((M<s?M:s)<<2)|0,d+=A.r=r[l],p+=A.g=r[l+1],f+=A.b=r[l+2],m+=A.a=r[l+3],A=A.n;for(O=L,a=0;a<w;a++)r[h++]=d*N>>>F,r[h++]=p*N>>>F,r[h++]=f*N>>>F,r[h++]=m*N>>>F,l=u+((l=a+e+1)<M?l:M)<<2,d-=O.r-(O.r=r[l]),p-=O.g-(O.g=r[l+1]),f-=O.b-(O.b=r[l+2]),m-=O.a-(O.a=r[l+3]),O=O.n;u+=w}for(N=j,F=k,a=0;a<w;a++){for(d=C*(g=r[h=a<<2|0])|0,p=C*(v=r[h+1|0])|0,f=C*(y=r[h+2|0])|0,m=C*(_=r[h+3|0])|0,R=P,s=0;s<C;s++)R.r=g,R.g=v,R.b=y,R.a=_,R=R.n;for(c=w,s=1;s<=i;s++)h=c+a<<2,d+=R.r=r[h],p+=R.g=r[h+1],f+=R.b=r[h+2],m+=R.a=r[h+3],R=R.n,s<S&&(c+=w);if(h=a,O=P,0<n)for(o=0;o<T;o++)r[(l=h<<2)+3]=_=m*N>>>F,0<_?(r[l]=d*N>>>F,r[l+1]=p*N>>>F,r[l+2]=f*N>>>F):r[l]=r[l+1]=r[l+2]=0,l=a+((l=o+C)<S?l:S)*w<<2,d-=O.r-(O.r=r[l]),p-=O.g-(O.g=r[l+1]),f-=O.b-(O.b=r[l+2]),m-=O.a-(O.a=r[l+3]),O=O.n,h+=w;else for(o=0;o<T;o++)r[(l=h<<2)+3]=_=m*N>>>F,0<_?(_=255/_,r[l]=(d*N>>>F)*_,r[l+1]=(p*N>>>F)*_,r[l+2]=(f*N>>>F)*_):r[l]=r[l+1]=r[l+2]=0,l=a+((l=o+C)<S?l:S)*w<<2,d-=O.r-(O.r=r[l]),p-=O.g-(O.g=r[l+1]),f-=O.b-(O.b=r[l+2]),m-=O.a-(O.a=r[l+3]),O=O.n,h+=w}}return!0},createjs.BlurFilter=createjs.promote(B,"Filter")}(),this.createjs=this.createjs||{},function(){function e(t){this.Filter_constructor(),this.alphaMap=t,this._alphaMap=null,this._mapData=null,this._mapTexture=null,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * (alphaMap.r * ceil(alphaMap.a)));}"}var t=createjs.extend(e,createjs.Filter);t.shaderParamSetup=function(t,e,i){this._mapTexture||(this._mapTexture=t.createTexture()),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._mapTexture),e.setTextureParams(t),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.alphaMap),t.uniform1i(t.getUniformLocation(i,"uAlphaSampler"),1)},t.clone=function(){var t=new e(this.alphaMap);return t._alphaMap=this._alphaMap,t._mapData=this._mapData,t},t.toString=function(){return"[AlphaMapFilter]"},t._applyFilter=function(t){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;for(var e=t.data,i=this._mapData,n=0,r=e.length;n<r;n+=4)e[n+3]=i[n]||0;return!0},t._prepAlphaMap=function(){if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;var t,e=this._alphaMap=this.alphaMap,i=e;e instanceof HTMLCanvasElement?t=i.getContext("2d"):((i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")).width=e.width,i.height=e.height,(t=i.getContext("2d")).drawImage(e,0,0));try{var n=t.getImageData(0,0,e.width,e.height)}catch(t){return!1}return this._mapData=n.data,!0},createjs.AlphaMapFilter=createjs.promote(e,"Filter")}(),this.createjs=this.createjs||{},function(){function t(t){this.Filter_constructor(),this.mask=t,this.usesContext=!0,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * alphaMap.a);}"}var e=createjs.extend(t,createjs.Filter);e.shaderParamSetup=function(t,e,i){this._mapTexture||(this._mapTexture=t.createTexture()),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._mapTexture),e.setTextureParams(t),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.mask),t.uniform1i(t.getUniformLocation(i,"uAlphaSampler"),1)},e.applyFilter=function(t,e,i,n,r,a,o,s){return!this.mask||(null==o&&(o=e),null==s&&(s=i),(a=a||t).save(),t==a&&(a.globalCompositeOperation="destination-in",a.drawImage(this.mask,o,s),a.restore(),!0))},e.clone=function(){return new t(this.mask)},e.toString=function(){return"[AlphaMaskFilter]"},createjs.AlphaMaskFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,r,a,o,s){this.Filter_constructor(),this.redMultiplier=null!=t?t:1,this.greenMultiplier=null!=e?e:1,this.blueMultiplier=null!=i?i:1,this.alphaMultiplier=null!=n?n:1,this.redOffset=r||0,this.greenOffset=a||0,this.blueOffset=o||0,this.alphaOffset=s||0,this.FRAG_SHADER_BODY="uniform vec4 uColorMultiplier;uniform vec4 uColorOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = (color * uColorMultiplier) + uColorOffset;}"}var e=createjs.extend(t,createjs.Filter);e.shaderParamSetup=function(t,e,i){t.uniform4f(t.getUniformLocation(i,"uColorMultiplier"),this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier),t.uniform4f(t.getUniformLocation(i,"uColorOffset"),this.redOffset/255,this.greenOffset/255,this.blueOffset/255,this.alphaOffset/255)},e.toString=function(){return"[ColorFilter]"},e.clone=function(){return new t(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)},e._applyFilter=function(t){for(var e=t.data,i=e.length,n=0;n<i;n+=4)e[n]=e[n]*this.redMultiplier+this.redOffset,e[n+1]=e[n+1]*this.greenMultiplier+this.greenOffset,e[n+2]=e[n+2]*this.blueMultiplier+this.blueOffset,e[n+3]=e[n+3]*this.alphaMultiplier+this.alphaOffset;return!0},createjs.ColorFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function n(t,e,i,n){this.setColor(t,e,i,n)}var t=n.prototype;n.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],n.LENGTH=(n.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]).length,t.setColor=function(t,e,i,n){return this.reset().adjustColor(t,e,i,n)},t.reset=function(){return this.copy(n.IDENTITY_MATRIX)},t.adjustColor=function(t,e,i,n){return this.adjustHue(n),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i)},t.adjustBrightness=function(t){return 0==t||isNaN(t)||(t=this._cleanValue(t,255),this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])),this},t.adjustContrast=function(t){return 0==t||isNaN(t)||(e=(t=this._cleanValue(t,100))<0?127+t/100*127:127*(e=0==(e=t%1)?n.DELTA_INDEX[t]:n.DELTA_INDEX[t<<0]*(1-e)+n.DELTA_INDEX[1+(t<<0)]*e)+127,this._multiplyMatrix([e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])),this;var e},t.adjustSaturation=function(t){if(0==t||isNaN(t))return this;var e=1+(0<(t=this._cleanValue(t,100))?3*t/100:t/100);return this._multiplyMatrix([.3086*(1-e)+e,.6094*(1-e),.082*(1-e),0,0,.3086*(1-e),.6094*(1-e)+e,.082*(1-e),0,0,.3086*(1-e),.6094*(1-e),.082*(1-e)+e,0,0,0,0,0,1,0,0,0,0,0,1]),this},t.adjustHue=function(t){if(0==t||isNaN(t))return this;t=this._cleanValue(t,180)/180*Math.PI;var e=Math.cos(t),i=Math.sin(t);return this._multiplyMatrix([.213+.787*e+-.213*i,.715+-.715*e+-.715*i,.072+-.072*e+.928*i,0,0,.213+-.213*e+.143*i,.715+e*(1-.715)+.14*i,.072+-.072*e+-.283*i,0,0,.213+-.213*e+-.787*i,.715+-.715*e+.715*i,.072+.928*e+.072*i,0,0,0,0,0,1,0,0,0,0,0,1]),this},t.concat=function(t){return(t=this._fixMatrix(t)).length!=n.LENGTH||this._multiplyMatrix(t),this},t.clone=function(){return(new n).copy(this)},t.toArray=function(){for(var t=[],e=0,i=n.LENGTH;e<i;e++)t[e]=this[e];return t},t.copy=function(t){for(var e=n.LENGTH,i=0;i<e;i++)this[i]=t[i];return this},t.toString=function(){return"[ColorMatrix]"},t._multiplyMatrix=function(t){var e,i,n,r=[];for(e=0;e<5;e++){for(i=0;i<5;i++)r[i]=this[i+5*e];for(i=0;i<5;i++){var a=0;for(n=0;n<5;n++)a+=t[i+5*n]*r[n];this[i+5*e]=a}}},t._cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},t._fixMatrix=function(t){return t instanceof n&&(t=t.toArray()),t.length<n.LENGTH?t=t.slice(0,t.length).concat(n.IDENTITY_MATRIX.slice(t.length,n.LENGTH)):t.length>n.LENGTH&&(t=t.slice(0,n.LENGTH)),t},createjs.ColorMatrix=n}(),this.createjs=this.createjs||{},function(){function t(t){this.Filter_constructor(),this.matrix=t,this.FRAG_SHADER_BODY="uniform mat4 uColorMatrix;uniform vec4 uColorMatrixOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);mat4 m = uColorMatrix;vec4 newColor = vec4(0,0,0,0);newColor.r = color.r*m[0][0] + color.g*m[0][1] + color.b*m[0][2] + color.a*m[0][3];newColor.g = color.r*m[1][0] + color.g*m[1][1] + color.b*m[1][2] + color.a*m[1][3];newColor.b = color.r*m[2][0] + color.g*m[2][1] + color.b*m[2][2] + color.a*m[2][3];newColor.a = color.r*m[3][0] + color.g*m[3][1] + color.b*m[3][2] + color.a*m[3][3];gl_FragColor = newColor + uColorMatrixOffset;}"}var e=createjs.extend(t,createjs.Filter);e.shaderParamSetup=function(t,e,i){var n=this.matrix,r=new Float32Array([n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]]);t.uniformMatrix4fv(t.getUniformLocation(i,"uColorMatrix"),!1,r),t.uniform4f(t.getUniformLocation(i,"uColorMatrixOffset"),n[4]/255,n[9]/255,n[14]/255,n[19]/255)},e.toString=function(){return"[ColorMatrixFilter]"},e.clone=function(){return new t(this.matrix)},e._applyFilter=function(t){for(var e,i,n,r,a=t.data,o=a.length,s=this.matrix,l=s[0],c=s[1],h=s[2],u=s[3],d=s[4],p=s[5],f=s[6],m=s[7],g=s[8],v=s[9],y=s[10],_=s[11],b=s[12],x=s[13],w=s[14],T=s[15],M=s[16],S=s[17],E=s[18],C=s[19],L=0;L<o;L+=4)e=a[L],i=a[L+1],n=a[L+2],r=a[L+3],a[L]=e*l+i*c+n*h+r*u+d,a[L+1]=e*p+i*f+n*m+r*g+v,a[L+2]=e*y+i*_+n*b+r*x+w,a[L+3]=e*T+i*M+n*S+r*E+C;return!0},createjs.ColorMatrixFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function n(){throw"Touch cannot be instantiated"}n.isSupported=function(){return!!("ontouchstart"in window||window.navigator.msPointerEnabled&&0<window.navigator.msMaxTouchPoints||window.navigator.pointerEnabled&&0<window.navigator.maxTouchPoints)},n.enable=function(t,e,i){return!!(t&&t.canvas&&n.isSupported())&&(t.__touch||(t.__touch={pointers:{},multitouch:!e,preventDefault:!i,count:0},"ontouchstart"in window?n._IOS_enable(t):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&n._IE_enable(t)),!0)},n.disable=function(t){t&&("ontouchstart"in window?n._IOS_disable(t):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&n._IE_disable(t),delete t.__touch)},n._IOS_enable=function(e){var t=e.canvas,i=e.__touch.f=function(t){n._IOS_handleEvent(e,t)};t.addEventListener("touchstart",i,!1),t.addEventListener("touchmove",i,!1),t.addEventListener("touchend",i,!1),t.addEventListener("touchcancel",i,!1)},n._IOS_disable=function(t){var e=t.canvas;if(e){var i=t.__touch.f;e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchmove",i,!1),e.removeEventListener("touchend",i,!1),e.removeEventListener("touchcancel",i,!1)}},n._IOS_handleEvent=function(t,e){if(t){t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();for(var i=e.changedTouches,n=e.type,r=0,a=i.length;r<a;r++){var o=i[r],s=o.identifier;o.target==t.canvas&&("touchstart"==n?this._handleStart(t,s,e,o.pageX,o.pageY):"touchmove"==n?this._handleMove(t,s,e,o.pageX,o.pageY):("touchend"==n||"touchcancel"==n)&&this._handleEnd(t,s,e))}}},n._IE_enable=function(e){var t=e.canvas,i=e.__touch.f=function(t){n._IE_handleEvent(e,t)};void 0===window.navigator.pointerEnabled?(t.addEventListener("MSPointerDown",i,!1),window.addEventListener("MSPointerMove",i,!1),window.addEventListener("MSPointerUp",i,!1),window.addEventListener("MSPointerCancel",i,!1),e.__touch.preventDefault&&(t.style.msTouchAction="none")):(t.addEventListener("pointerdown",i,!1),window.addEventListener("pointermove",i,!1),window.addEventListener("pointerup",i,!1),window.addEventListener("pointercancel",i,!1),e.__touch.preventDefault&&(t.style.touchAction="none")),e.__touch.activeIDs={}},n._IE_disable=function(t){var e=t.__touch.f;void 0===window.navigator.pointerEnabled?(window.removeEventListener("MSPointerMove",e,!1),window.removeEventListener("MSPointerUp",e,!1),window.removeEventListener("MSPointerCancel",e,!1),t.canvas&&t.canvas.removeEventListener("MSPointerDown",e,!1)):(window.removeEventListener("pointermove",e,!1),window.removeEventListener("pointerup",e,!1),window.removeEventListener("pointercancel",e,!1),t.canvas&&t.canvas.removeEventListener("pointerdown",e,!1))},n._IE_handleEvent=function(t,e){if(t){t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();var i=e.type,n=e.pointerId,r=t.__touch.activeIDs;if("MSPointerDown"==i||"pointerdown"==i){if(e.srcElement!=t.canvas)return;r[n]=!0,this._handleStart(t,n,e,e.pageX,e.pageY)}else r[n]&&("MSPointerMove"==i||"pointermove"==i?this._handleMove(t,n,e,e.pageX,e.pageY):("MSPointerUp"==i||"MSPointerCancel"==i||"pointerup"==i||"pointercancel"==i)&&(delete r[n],this._handleEnd(t,n,e)))}},n._handleStart=function(t,e,i,n,r){var a=t.__touch;if(a.multitouch||!a.count){var o=a.pointers;o[e]||(o[e]=!0,a.count++,t._handlePointerDown(e,i,n,r))}},n._handleMove=function(t,e,i,n,r){t.__touch.pointers[e]&&t._handlePointerMove(e,i,n,r)},n._handleEnd=function(t,e,i){var n=t.__touch,r=n.pointers;r[e]&&(n.count--,t._handlePointerUp(e,i,!0),delete r[e])},createjs.Touch=n}(),this.createjs=this.createjs||{},function(){var t=createjs.EaselJS=createjs.EaselJS||{};t.version="1.0.0",t.buildDate="Thu, 12 Oct 2017 16:34:10 GMT"}(),this.createjs=this.createjs||{},function(){var t=createjs.PreloadJS=createjs.PreloadJS||{};t.version="1.0.0",t.buildDate="Thu, 12 Oct 2017 16:34:05 GMT"}(),this.createjs=this.createjs||{},createjs.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}},this.createjs=this.createjs||{},function(){function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}createjs.extend(t,createjs.Event).clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(t){function e(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}createjs.extend(e,createjs.Event).clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(e,"Event")}(window),function(){function F(t,l){function c(t){if(c[t]!==E)return c[t];var e;if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=c("json-stringify")&&c("json-parse");else{var i,n='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var r=l.stringify,a="function"==typeof r&&p;if(a){(i=function(){return 1}).toJSON=i;try{a="0"===r(0)&&"0"===r(new h)&&'""'==r(new u)&&r(C)===E&&r(E)===E&&r()===E&&"1"===r(i)&&"[1]"==r([i])&&"[null]"==r([E])&&"null"==r(null)&&"[null,null,null]"==r([E,C,null])&&r({a:[i,!0,!1,null,"\0\b\n\f\r\t"]})==n&&"1"===r(null,i)&&"[\n 1,\n 2\n]"==r([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==r(new d(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==r(new d(864e13))&&'"-000001-01-01T00:00:00.000Z"'==r(new d(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==r(new d(-1))}catch(t){a=!1}}e=a}if("json-parse"==t){var o=l.parse;if("function"==typeof o)try{if(0===o("0")&&!o(!1)){var s=5==(i=o(n)).a.length&&1===i.a[0];if(s){try{s=!o('"\t"')}catch(t){}if(s)try{s=1!==o("01")}catch(t){}if(s)try{s=1!==o("1.")}catch(t){}}}}catch(t){s=!1}e=s}}return c[t]=!!e}t||(t=H.Object()),l||(l=H.Object());var h=t.Number||H.Number,u=t.String||H.String,e=t.Object||H.Object,d=t.Date||H.Date,i=t.SyntaxError||H.SyntaxError,T=t.TypeError||H.TypeError,n=t.Math||H.Math,r=t.JSON||H.JSON;"object"==typeof r&&r&&(l.stringify=r.stringify,l.parse=r.parse);var M,S,E,a=e.prototype,C=a.toString,p=new d(-0xc782b5b800cec);try{p=-109252==p.getUTCFullYear()&&0===p.getUTCMonth()&&1===p.getUTCDate()&&10==p.getUTCHours()&&37==p.getUTCMinutes()&&6==p.getUTCSeconds()&&708==p.getUTCMilliseconds()}catch(t){}if(!c("json")){var f="[object Function]",L="[object Number]",A="[object String]",P="[object Array]",s=c("bug-string-char-index");if(!p)var R=n.floor,o=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(t,e){return o[e]+365*(t-1970)+R((t-1969+(e=+(1<e)))/4)-R((t-1901+e)/100)+R((t-1601+e)/400)};if((M=a.hasOwnProperty)||(M=function(t){var i,e={};return M=(e.__proto__=null,e.__proto__={toString:1},e).toString!=C?function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(i=e.constructor,function(t){var e=(this.constructor||i).prototype;return t in this&&!(t in e&&this[t]===e[t])}),e=null,M.call(this,t)}),S=function(t,e){var i,o,n,r=0;for(n in(i=function(){this.valueOf=0}).prototype.valueOf=0,o=new i)M.call(o,n)&&r++;return i=o=null,(S=r?2==r?function(t,e){var i,n={},r=C.call(t)==f;for(i in t)r&&"prototype"==i||M.call(n,i)||!(n[i]=1)||!M.call(t,i)||e(i)}:function(t,e){var i,n,r=C.call(t)==f;for(i in t)r&&"prototype"==i||!M.call(t,i)||(n="constructor"===i)||e(i);(n||M.call(t,i="constructor"))&&e(i)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(t,e){var i,n,r=C.call(t)==f,a=!r&&"function"!=typeof t.constructor&&B[typeof t.hasOwnProperty]&&t.hasOwnProperty||M;for(i in t)r&&"prototype"==i||!a.call(t,i)||e(i);for(n=o.length;i=o[--n];a.call(t,i)&&e(i));}))(t,e)},!c("json-stringify")){var m={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},I=function(t,e){return("000000"+(e||0)).slice(-t)},D=function(t){for(var e='"',i=0,n=t.length,r=!s||10<n,a=r&&(s?t.split(""):t);i<n;i++){var o=t.charCodeAt(i);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=m[o];break;default:if(o<32){e+="\\u00"+I(2,o.toString(16));break}e+=r?a[i]:t.charAt(i)}}return e+'"'},j=function(t,e,i,n,r,a,o){var s,l,c,h,u,d,p,f,m,g,v,y,_,b,x,w;try{s=e[t]}catch(t){}if("object"==typeof s&&s)if("[object Date]"!=(l=C.call(s))||M.call(s,"toJSON"))"function"==typeof s.toJSON&&(l!=L&&l!=A&&l!=P||M.call(s,"toJSON"))&&(s=s.toJSON(t));else if(-1/0<s&&s<1/0){if(O){for(u=R(s/864e5),c=R(u/365.2425)+1970-1;O(c+1,0)<=u;c++);for(h=R((u-O(c,0))/30.42);O(c,h+1)<=u;h++);u=1+u-O(c,h),p=R((d=(s%864e5+864e5)%864e5)/36e5)%24,f=R(d/6e4)%60,m=R(d/1e3)%60,g=d%1e3}else c=s.getUTCFullYear(),h=s.getUTCMonth(),u=s.getUTCDate(),p=s.getUTCHours(),f=s.getUTCMinutes(),m=s.getUTCSeconds(),g=s.getUTCMilliseconds();s=(c<=0||1e4<=c?(c<0?"-":"+")+I(6,c<0?-c:c):I(4,c))+"-"+I(2,h+1)+"-"+I(2,u)+"T"+I(2,p)+":"+I(2,f)+":"+I(2,m)+"."+I(3,g)+"Z"}else s=null;if(i&&(s=i.call(e,t,s)),null===s)return"null";if("[object Boolean]"==(l=C.call(s)))return""+s;if(l==L)return-1/0<s&&s<1/0?""+s:"null";if(l==A)return D(""+s);if("object"==typeof s){for(b=o.length;b--;)if(o[b]===s)throw T();if(o.push(s),v=[],x=a,a+=r,l==P){for(_=0,b=s.length;_<b;_++)y=j(_,s,i,n,r,a,o),v.push(y===E?"null":y);w=v.length?r?"[\n"+a+v.join(",\n"+a)+"\n"+x+"]":"["+v.join(",")+"]":"[]"}else S(n||s,function(t){var e=j(t,s,i,n,r,a,o);e!==E&&v.push(D(t)+":"+(r?" ":"")+e)}),w=v.length?r?"{\n"+a+v.join(",\n"+a)+"\n"+x+"}":"{"+v.join(",")+"}":"{}";return o.pop(),w}};l.stringify=function(t,e,i){var n,r,a,o;if(B[typeof e]&&e)if((o=C.call(e))==f)r=e;else if(o==P){a={};for(var s,l=0,c=e.length;l<c;s=e[l++],((o=C.call(s))==A||o==L)&&(a[s]=1));}if(i)if((o=C.call(i))==L){if(0<(i-=i%1))for(n="",10<i&&(i=10);n.length<i;n+=" ");}else o==A&&(n=i.length<=10?i:i.slice(0,10));return j("",((s={})[""]=t,s),r,a,n,"",[])}}if(!c("json-parse")){var g,v,y=u.fromCharCode,_={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},b=function(){throw g=v=null,i()},x=function(){for(var t,e,i,n,r,a=v,o=a.length;g<o;)switch(r=a.charCodeAt(g)){case 9:case 10:case 13:case 32:g++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=s?a.charAt(g):a[g],g++,t;case 34:for(t="@",g++;g<o;)if((r=a.charCodeAt(g))<32)b();else if(92==r)switch(r=a.charCodeAt(++g)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=_[r],g++;break;case 117:for(e=++g,i=g+4;g<i;g++)48<=(r=a.charCodeAt(g))&&r<=57||97<=r&&r<=102||65<=r&&r<=70||b();t+=y("0x"+a.slice(e,g));break;default:b()}else{if(34==r)break;for(r=a.charCodeAt(g),e=g;32<=r&&92!=r&&34!=r;)r=a.charCodeAt(++g);t+=a.slice(e,g)}if(34==a.charCodeAt(g))return g++,t;b();default:if(e=g,45==r&&(n=!0,r=a.charCodeAt(++g)),48<=r&&r<=57){for(48==r&&(48<=(r=a.charCodeAt(g+1))&&r<=57)&&b(),n=!1;g<o&&(48<=(r=a.charCodeAt(g))&&r<=57);g++);if(46==a.charCodeAt(g)){for(i=++g;i<o&&(48<=(r=a.charCodeAt(i))&&r<=57);i++);i==g&&b(),g=i}if(101==(r=a.charCodeAt(g))||69==r){for((43==(r=a.charCodeAt(++g))||45==r)&&g++,i=g;i<o&&(48<=(r=a.charCodeAt(i))&&r<=57);i++);i==g&&b(),g=i}return+a.slice(e,g)}if(n&&b(),"true"==a.slice(g,g+4))return g+=4,!0;if("false"==a.slice(g,g+5))return g+=5,!1;if("null"==a.slice(g,g+4))return g+=4,null;b()}return"$"},w=function(t){var e,i;if("$"==t&&b(),"string"==typeof t){if("@"==(s?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];"]"!=(t=x());i||(i=!0))i&&(","==t?"]"==(t=x())&&b():b()),","==t&&b(),e.push(w(t));return e}if("{"==t){for(e={};"}"!=(t=x());i||(i=!0))i&&(","==t?"}"==(t=x())&&b():b()),(","==t||"string"!=typeof t||"@"!=(s?t.charAt(0):t[0])||":"!=x())&&b(),e[t.slice(1)]=w(x());return e}b()}return t},k=function(t,e,i){var n=N(t,e,i);n===E?delete t[e]:t[e]=n},N=function(t,e,i){var n,r=t[e];if("object"==typeof r&&r)if(C.call(r)==P)for(n=r.length;n--;)k(r,n,i);else S(r,function(t){k(r,t,i)});return i.call(t,e,r)};l.parse=function(t,e){var i,n;return g=0,v=""+t,i=w(x()),"$"!=x()&&b(),g=v=null,e&&C.call(e)==f?N(((n={})[""]=i,n),"",e):i}}}return l.runInContext=F,l}var t="function"==typeof define&&define.amd,B={function:!0,object:!0},e=B[typeof exports]&&exports&&!exports.nodeType&&exports,H=B[typeof window]&&window||this,i=e&&B[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!i||i.global!==i&&i.window!==i&&i.self!==i||(H=i),e&&!t)F(H,e);else{var n=H.JSON,r=H.JSON3,a=!1,o=F(H,H.JSON3={noConflict:function(){return a||(a=!0,H.JSON=n,H.JSON3=r,n=r=null),o}});H.JSON={parse:o.parse,stringify:o.stringify}}t&&define(function(){return o})}.call(this),function(){var t={a:function(){return t.el("a")},svg:function(){return t.el("svg")},object:function(){return t.el("object")},image:function(){return t.el("image")},img:function(){return t.el("img")},style:function(){return t.el("style")},link:function(){return t.el("link")},script:function(){return t.el("script")},audio:function(){return t.el("audio")},video:function(){return t.el("video")},text:function(t){return document.createTextNode(t)},el:function(t){return document.createElement(t)}};createjs.Elements=t}(),function(){var o={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[.\/]*?\//i,EXTENSION_PATT:/\/?[^\/]+\.(\w{1,5})$/i,parseURI:function(t){var e={absolute:!1,relative:!1,protocol:null,hostname:null,port:null,pathname:null,search:null,hash:null,host:null};if(null==t)return e;var i=createjs.Elements.a();for(var n in i.href=t,e)n in i&&(e[n]=i[n]);var r,a=t.indexOf("?");return-1<a&&(t=t.substr(0,a)),o.ABSOLUTE_PATT.test(t)?e.absolute=!0:o.RELATIVE_PATT.test(t)&&(e.relative=!0),(r=t.match(o.EXTENSION_PATT))&&(e.extension=r[1].toLowerCase()),e},formatQueryString:function(t,e){if(null==t)throw new Error("You must specify data.");var i=[];for(var n in t)i.push(n+"="+escape(t[n]));return e&&(i=i.concat(e)),i.join("&")},buildURI:function(t,e){if(null==e)return t;var i=[],n=t.indexOf("?");if(-1!=n){var r=t.slice(n+1);i=i.concat(r.split("&"))}return-1!=n?t.slice(0,n)+"?"+this.formatQueryString(e,i):t+"?"+this.formatQueryString(e,i)},isCrossDomain:function(t){var e=createjs.Elements.a();e.href=t.src;var i=createjs.Elements.a();return i.href=location.href,""!=e.hostname&&(e.port!=i.port||e.protocol!=i.protocol||e.hostname!=i.hostname)},isLocal:function(t){var e=createjs.Elements.a();return e.href=t.src,""==e.hostname&&"file:"==e.protocol}};createjs.URLUtils=o}(),function(){var i={container:null,appendToHead:function(t){i.getHead().appendChild(t)},appendToBody:function(t){if(null==i.container){i.container=document.createElement("div"),i.container.id="preloadjs-container";var e=i.container.style;e.visibility="hidden",e.position="absolute",e.width=i.container.style.height="10px",e.overflow="hidden",e.transform=e.msTransform=e.webkitTransform=e.oTransform="translate(-10px, -10px)",i.getBody().appendChild(i.container)}i.container.appendChild(t)},getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getBody:function(){return document.body||document.getElementsByTagName("body")[0]},removeChild:function(t){t.parent&&t.parent.removeChild(t)},isImageTag:function(t){return t instanceof HTMLImageElement},isAudioTag:function(t){return!!window.HTMLAudioElement&&t instanceof HTMLAudioElement},isVideoTag:function(t){return!!window.HTMLVideoElement&&t instanceof HTMLVideoElement}};createjs.DomUtils=i}(),function(){var t={parseXML:function(t){var e=null;try{if(window.DOMParser)e=(new DOMParser).parseFromString(t,"text/xml")}catch(t){}if(!e)try{(e=new ActiveXObject("Microsoft.XMLDOM")).async=!1,e.loadXML(t)}catch(t){e=null}return e},parseJSON:function(t){if(null==t)return null;try{return JSON.parse(t)}catch(t){throw t}}};createjs.DataUtils=t}(),this.createjs=this.createjs||{},function(){var t={BINARY:"binary",CSS:"css",FONT:"font",FONTCSS:"fontcss",IMAGE:"image",JAVASCRIPT:"javascript",JSON:"json",JSONP:"jsonp",MANIFEST:"manifest",SOUND:"sound",VIDEO:"video",SPRITESHEET:"spritesheet",SVG:"svg",TEXT:"text",XML:"xml"};createjs.Types=t}(),this.createjs=this.createjs||{},function(){var t={POST:"POST",GET:"GET"};createjs.Methods=t}(),this.createjs=this.createjs||{},function(){function i(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.Methods.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=n.LOAD_TIMEOUT_DEFAULT}var t=i.prototype={},n=i;n.LOAD_TIMEOUT_DEFAULT=8e3,n.create=function(t){if("string"==typeof t){var e=new i;return e.src=t,e}if(t instanceof n)return t;if(t instanceof Object&&t.src)return null==t.loadTimeout&&(t.loadTimeout=n.LOAD_TIMEOUT_DEFAULT),t;throw new Error("Type not recognized.")},t.set=function(t){for(var e in t)this[e]=t[e];return this},createjs.LoadItem=n}(),function(){var t={isBinary:function(t){switch(t){case createjs.Types.IMAGE:case createjs.Types.BINARY:return!0;default:return!1}},isText:function(t){switch(t){case createjs.Types.TEXT:case createjs.Types.JSON:case createjs.Types.MANIFEST:case createjs.Types.XML:case createjs.Types.CSS:case createjs.Types.SVG:case createjs.Types.JAVASCRIPT:case createjs.Types.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(t){if(null==t)return createjs.Types.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.Types.IMAGE;case"ogg":case"mp3":case"webm":return createjs.Types.SOUND;case"mp4":case"webm":case"ts":return createjs.Types.VIDEO;case"json":return createjs.Types.JSON;case"xml":return createjs.Types.XML;case"css":return createjs.Types.CSS;case"js":return createjs.Types.JAVASCRIPT;case"svg":return createjs.Types.SVG;default:return createjs.Types.TEXT}}};createjs.RequestUtils=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?createjs.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=createjs.extend(t,createjs.EventDispatcher),i=t;try{Object.defineProperties(i,{POST:{get:createjs.deprecate(function(){return createjs.Methods.POST},"AbstractLoader.POST")},GET:{get:createjs.deprecate(function(){return createjs.Methods.GET},"AbstractLoader.GET")},BINARY:{get:createjs.deprecate(function(){return createjs.Types.BINARY},"AbstractLoader.BINARY")},CSS:{get:createjs.deprecate(function(){return createjs.Types.CSS},"AbstractLoader.CSS")},FONT:{get:createjs.deprecate(function(){return createjs.Types.FONT},"AbstractLoader.FONT")},FONTCSS:{get:createjs.deprecate(function(){return createjs.Types.FONTCSS},"AbstractLoader.FONTCSS")},IMAGE:{get:createjs.deprecate(function(){return createjs.Types.IMAGE},"AbstractLoader.IMAGE")},JAVASCRIPT:{get:createjs.deprecate(function(){return createjs.Types.JAVASCRIPT},"AbstractLoader.JAVASCRIPT")},JSON:{get:createjs.deprecate(function(){return createjs.Types.JSON},"AbstractLoader.JSON")},JSONP:{get:createjs.deprecate(function(){return createjs.Types.JSONP},"AbstractLoader.JSONP")},MANIFEST:{get:createjs.deprecate(function(){return createjs.Types.MANIFEST},"AbstractLoader.MANIFEST")},SOUND:{get:createjs.deprecate(function(){return createjs.Types.SOUND},"AbstractLoader.SOUND")},VIDEO:{get:createjs.deprecate(function(){return createjs.Types.VIDEO},"AbstractLoader.VIDEO")},SPRITESHEET:{get:createjs.deprecate(function(){return createjs.Types.SPRITESHEET},"AbstractLoader.SPRITESHEET")},SVG:{get:createjs.deprecate(function(){return createjs.Types.SVG},"AbstractLoader.SVG")},TEXT:{get:createjs.deprecate(function(){return createjs.Types.TEXT},"AbstractLoader.TEXT")},XML:{get:createjs.deprecate(function(){return createjs.Types.XML},"AbstractLoader.XML")}})}catch(t){}e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new createjs.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(t){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new createjs.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},e._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new createjs.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this);e instanceof Function?e.call(this,createjs.proxy(this._resultFormatSuccess,this),createjs.proxy(this._resultFormatFailed,this)):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_"+t.type.toUpperCase()+"_ERROR"))}},e._resultFormatSuccess=function(t){this._result=t,this._sendComplete()},e._resultFormatFailed=function(t){this._sendError(t)},e.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._updateXHR=function(t){t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){if(this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR){var e=window.URL||window.webkitURL,i=t.getResult(!0);t.getTag().src=e.createObjectURL(i)}return t.getTag()},createjs.AbstractMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){var t=function(t){this._item=t},e=createjs.extend(t,createjs.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},createjs.AbstractRequest=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1}var e=createjs.extend(t,createjs.AbstractRequest);e.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var t=new createjs.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(createjs.DomUtils.appendToBody(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._handleStalled=function(){},createjs.TagRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var e=createjs.extend(t,createjs.TagRequest);e.load=function(){var t=createjs.proxy(this._handleStalled,this);this._stalledCallback=t;var e=createjs.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(0<t.loaded&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),this._createXHR(t)}var e=createjs.extend(t,createjs.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values?this._request.send(createjs.URLUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,t))}}else this._handleError()},e.setResponseType=function(t){"blob"===t&&(t=window.URL?"blob":"arraybuffer",this._responseType=t),this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){if(t&&!(0<t.loaded&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._handleLoadStart=function(t){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(t.message))},e._handleReadyStateChange=function(t){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(t){if(!this.loaded){this.loaded=!0;var e=this._checkError();if(e)return void this._handleError(e);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(t){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===t.name&&window.BlobBuilder){var i=new BlobBuilder;i.append(this._response),this._response=i.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);return 400<=t&&t<=599?new Error(t):0==t&&/^https?:/.test(location.protocol)?new Error(0):null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=createjs.URLUtils.isCrossDomain(t),i={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,e&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var r=0,a=s.ACTIVEX_VERSIONS.length;r<a;r++){var o=s.ACTIVEX_VERSIONS[r];try{n=new ActiveXObject(o);break}catch(t){}}if(null==n)return!1}null==t.mimeType&&createjs.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;var l;if(l=t.method==createjs.Methods.GET?createjs.URLUtils.buildURI(t.src,t.values):t.src,n.open(t.method||createjs.Methods.GET,l,!0),e&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),t.values&&t.method==createjs.Methods.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),e||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var c in t.headers)i[c]=t.headers[c];for(c in i)n.setRequestHeader(c,i[c]);return n instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(n.withCredentials=t.withCredentials),this._request=n,!0},e._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},e.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[createjs.FontLoader,createjs.ImageLoader,createjs.JavaScriptLoader,createjs.CSSLoader,createjs.JSONLoader,createjs.JSONPLoader,createjs.SoundLoader,createjs.ManifestLoader,createjs.SpriteSheetLoader,createjs.XMLLoader,createjs.SVGLoader,createjs.BinaryLoader,createjs.VideoLoader,createjs.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(t,e,i)}var e=createjs.extend(t,createjs.AbstractLoader),l=t;try{Object.defineProperties(l,{POST:{get:createjs.deprecate(function(){return createjs.Methods.POST},"AbstractLoader.POST")},GET:{get:createjs.deprecate(function(){return createjs.Methods.GET},"AbstractLoader.GET")},BINARY:{get:createjs.deprecate(function(){return createjs.Types.BINARY},"AbstractLoader.BINARY")},CSS:{get:createjs.deprecate(function(){return createjs.Types.CSS},"AbstractLoader.CSS")},FONT:{get:createjs.deprecate(function(){return createjs.Types.FONT},"AbstractLoader.FONT")},FONTCSS:{get:createjs.deprecate(function(){return createjs.Types.FONTCSS},"AbstractLoader.FONTCSS")},IMAGE:{get:createjs.deprecate(function(){return createjs.Types.IMAGE},"AbstractLoader.IMAGE")},JAVASCRIPT:{get:createjs.deprecate(function(){return createjs.Types.JAVASCRIPT},"AbstractLoader.JAVASCRIPT")},JSON:{get:createjs.deprecate(function(){return createjs.Types.JSON},"AbstractLoader.JSON")},JSONP:{get:createjs.deprecate(function(){return createjs.Types.JSONP},"AbstractLoader.JSONP")},MANIFEST:{get:createjs.deprecate(function(){return createjs.Types.MANIFEST},"AbstractLoader.MANIFEST")},SOUND:{get:createjs.deprecate(function(){return createjs.Types.SOUND},"AbstractLoader.SOUND")},VIDEO:{get:createjs.deprecate(function(){return createjs.Types.VIDEO},"AbstractLoader.VIDEO")},SPRITESHEET:{get:createjs.deprecate(function(){return createjs.Types.SPRITESHEET},"AbstractLoader.SPRITESHEET")},SVG:{get:createjs.deprecate(function(){return createjs.Types.SVG},"AbstractLoader.SVG")},TEXT:{get:createjs.deprecate(function(){return createjs.Types.TEXT},"AbstractLoader.TEXT")},XML:{get:createjs.deprecate(function(){return createjs.Types.XML},"AbstractLoader.XML")}})}catch(t){}e.init=function(t,e,i){this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(t),this._paused=!1,this._basePath=e,this._crossOrigin=i,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},e.registerLoader=function(t){if(!t||!t.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(t))throw new Error("loader already exists.");this._availableLoaders.unshift(t)},e.unregisterLoader=function(t){var e=this._availableLoaders.indexOf(t);-1!=e&&e<this._defaultLoaderLength-1&&this._availableLoaders.splice(e,1)},e.setPreferXHR=function(t){return this.preferXHR=0!=t&&null!=window.XMLHttpRequest,this.preferXHR},e.removeAll=function(){this.remove()},e.remove=function(t){var e=null;if(t&&!Array.isArray(t))e=[t];else if(t)e=t;else if(0<arguments.length)return;var i=!1;if(e){for(;e.length;){var n=e.pop(),r=this.getResult(n);for(a=this._loadQueue.length-1;0<=a;a--)if((o=this._loadQueue[a].getItem()).id==n||o.src==n){this._loadQueue.splice(a,1)[0].cancel();break}for(a=this._loadQueueBackup.length-1;0<=a;a--)if((o=this._loadQueueBackup[a].getItem()).id==n||o.src==n){this._loadQueueBackup.splice(a,1)[0].cancel();break}if(r)this._disposeItem(this.getItem(n));else for(var a=this._currentLoads.length-1;0<=a;a--){var o=this._currentLoads[a].getItem();if(o.id==n||o.src==n){this._currentLoads.splice(a,1)[0].cancel(),i=!0;break}}}i&&this._loadNext()}else{for(var s in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[s]);this.init(this.preferXHR,this._basePath)}},e.reset=function(){for(var t in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[t]);for(var e=[],i=0,n=this._loadQueueBackup.length;i<n;i++)e.push(this._loadQueueBackup[i].getItem());this.loadManifest(e,!1)},e.installPlugin=function(t){if(null!=t&&null!=t.getPreloadHandlers){this._plugins.push(t);var e=t.getPreloadHandlers();if(e.scope=t,null!=e.types)for(var i=0,n=e.types.length;i<n;i++)this._typeCallbacks[e.types[i]]=e;if(null!=e.extensions)for(i=0,n=e.extensions.length;i<n;i++)this._extensionCallbacks[e.extensions[i]]=e}},e.setMaxConnections=function(t){this._maxConnections=t,!this._paused&&0<this._loadQueue.length&&this._loadNext()},e.loadFile=function(t,e,i){if(null!=t)this._addItem(t,null,i),!1!==e?this.setPaused(!1):this.setPaused(!0);else{var n=new createjs.ErrorEvent("PRELOAD_NO_FILE");this._sendError(n)}},e.loadManifest=function(t,e,i){var n=null,r=null;if(Array.isArray(t)){if(0==t.length){var a=new createjs.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(a)}n=t}else if("string"==typeof t)n=[{src:t,type:l.MANIFEST}];else{if("object"!=typeof t){a=new createjs.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(a)}if(void 0!==t.src){if(null==t.type)t.type=l.MANIFEST;else if(t.type!=l.MANIFEST){a=new createjs.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(a)}n=[t]}else void 0!==t.manifest&&(n=t.manifest,r=t.path)}for(var o=0,s=n.length;o<s;o++)this._addItem(n[o],r,i);!1!==e?this.setPaused(!1):this.setPaused(!0)},e.load=function(){this.setPaused(!1)},e.getItem=function(t){return this._loadItemsById[t]||this._loadItemsBySrc[t]},e.getResult=function(t,e){var i=this._loadItemsById[t]||this._loadItemsBySrc[t];if(null==i)return null;var n=i.id;return e&&this._loadedRawResults[n]?this._loadedRawResults[n]:this._loadedResults[n]},e.getItems=function(t){var e=[];for(var i in this._loadItemsById){var n=this._loadItemsById[i],r=this.getResult(i);(!0!==t||null!=r)&&e.push({item:n,result:r,rawResult:this.getResult(i,!0)})}return e},e.setPaused=function(t){this._paused=t,this._paused||this._loadNext()},e.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},e._addItem=function(t,e,i){var n=this._createLoadItem(t,e,i);if(null!=n){var r=this._createLoader(n);null!=r&&("plugins"in r&&(r.plugins=this._plugins),n._loader=r,this._loadQueue.push(r),this._loadQueueBackup.push(r),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&n.type==createjs.Types.JAVASCRIPT||!0===n.maintainOrder)&&(this._scriptOrder.push(n),this._loadedScripts.push(null)))}},e._createLoadItem=function(t,e,i){var n=createjs.LoadItem.create(t);if(null==n)return null;var r="",a=i||this._basePath;if(n.src instanceof Object){if(!n.type)return null;if(e){r=e;var o=createjs.URLUtils.parseURI(e);null==a||o.absolute||o.relative||(r=a+r)}else null!=a&&(r=a)}else{var s=createjs.URLUtils.parseURI(n.src);s.extension&&(n.ext=s.extension),null==n.type&&(n.type=createjs.RequestUtils.getTypeByExtension(n.ext));var l=n.src;if(!s.absolute&&!s.relative)if(e){r=e;o=createjs.URLUtils.parseURI(e);l=e+l,null==a||o.absolute||o.relative||(r=a+r)}else null!=a&&(r=a);n.src=r+n.src}n.path=r,(void 0===n.id||null===n.id||""===n.id)&&(n.id=l);var c=this._typeCallbacks[n.type]||this._extensionCallbacks[n.ext];if(c){var h=c.callback.call(c.scope,n,this);if(!1===h)return null;!0===h||null!=h&&(n._loader=h),null!=(s=createjs.URLUtils.parseURI(n.src)).extension&&(n.ext=s.extension)}return this._loadItemsById[n.id]=n,null==(this._loadItemsBySrc[n.src]=n).crossOrigin&&(n.crossOrigin=this._crossOrigin),n},e._createLoader=function(t){if(null!=t._loader)return t._loader;for(var e=this.preferXHR,i=0;i<this._availableLoaders.length;i++){var n=this._availableLoaders[i];if(n&&n.canLoadItem(t))return new n(t,e)}return null},e._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var t=0;t<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);t++){var e=this._loadQueue[t];this._canStartLoad(e)&&(this._loadQueue.splice(t,1),t--,this._loadItem(e))}}},e._loadItem=function(t){t.on("fileload",this._handleFileLoad,this),t.on("progress",this._handleProgress,this),t.on("complete",this._handleFileComplete,this),t.on("error",this._handleError,this),t.on("fileerror",this._handleFileError,this),this._currentLoads.push(t),this._sendFileStart(t.getItem()),t.load()},e._handleFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleFileError=function(t){var e=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,t.item);this._sendError(e)},e._handleError=function(t){var e=t.target;this._numItemsLoaded++,this._finishOrderedItem(e,!0),this._updateProgress();var i=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,e.getItem());this._sendError(i),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(e),this._cleanLoadItem(e),this._loadNext())},e._handleFileComplete=function(t){var e=t.target,i=e.getItem(),n=e.getResult();this._loadedResults[i.id]=n;var r=e.getResult(!0);null!=r&&r!==n&&(this._loadedRawResults[i.id]=r),this._saveLoadedItems(e),this._removeLoadItem(e),this._finishOrderedItem(e)||this._processFinishedLoad(i,e),this._cleanLoadItem(e)},e._saveLoadedItems=function(t){var e=t.getLoadedItems();if(null!==e)for(var i=0;i<e.length;i++){var n=e[i].item;this._loadItemsBySrc[n.src]=n,this._loadItemsById[n.id]=n,this._loadedResults[n.id]=e[i].result,this._loadedRawResults[n.id]=e[i].rawResult}},e._finishOrderedItem=function(t,e){var i=t.getItem();if(this.maintainScriptOrder&&i.type==createjs.Types.JAVASCRIPT||i.maintainOrder){t instanceof createjs.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var n=createjs.indexOf(this._scriptOrder,i);return-1!=n&&(this._loadedScripts[n]=!0===e||i,this._checkScriptLoadOrder(),!0)}return!1},e._checkScriptLoadOrder=function(){for(var t=this._loadedScripts.length,e=0;e<t;e++){var i=this._loadedScripts[e];if(null===i)break;if(!0!==i){var n=this._loadedResults[i.id];i.type==createjs.Types.JAVASCRIPT&&createjs.DomUtils.appendToHead(n);var r=i._loader;this._processFinishedLoad(i,r),this._loadedScripts[e]=!0}}},e._processFinishedLoad=function(t,e){if(this._numItemsLoaded++,!this.maintainScriptOrder&&t.type==createjs.Types.JAVASCRIPT){var i=e.getTag();createjs.DomUtils.appendToHead(i)}this._updateProgress(),this._sendFileComplete(t,e),this._loadNext()},e._canStartLoad=function(t){if(!this.maintainScriptOrder||t.preferXHR)return!0;var e=t.getItem();if(e.type!=createjs.Types.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var i=this._scriptOrder.indexOf(e),n=0;n<i;){if(null==this._loadedScripts[n])return!1;n++}return this._currentlyLoadingScript=!0},e._removeLoadItem=function(t){for(var e=this._currentLoads.length,i=0;i<e;i++)if(this._currentLoads[i]==t){this._currentLoads.splice(i,1);break}},e._cleanLoadItem=function(t){var e=t.getItem();e&&delete e._loader},e._handleProgress=function(t){var e=t.target;this._sendFileProgress(e.getItem(),e.progress),this._updateProgress()},e._updateProgress=function(){var t=this._numItemsLoaded/this._numItems,e=this._numItems-this._numItemsLoaded;if(0<e){for(var i=0,n=0,r=this._currentLoads.length;n<r;n++)i+=this._currentLoads[n].progress;t+=i/e*(e/this._numItems)}this._lastProgress!=t&&(this._sendProgress(t),this._lastProgress=t)},e._disposeItem=function(t){delete this._loadedResults[t.id],delete this._loadedRawResults[t.id],delete this._loadItemsById[t.id],delete this._loadItemsBySrc[t.src]},e._sendFileProgress=function(t,e){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var i=new createjs.Event("fileprogress");i.progress=e,i.loaded=e,i.total=1,i.item=t,this.dispatchEvent(i)}},e._sendFileComplete=function(t,e){if(!this._isCanceled()&&!this._paused){var i=new createjs.Event("fileload");i.loader=e,i.item=t,i.result=this._loadedResults[t.id],i.rawResult=this._loadedRawResults[t.id],t.completeHandler&&t.completeHandler(i),this.hasEventListener("fileload")&&this.dispatchEvent(i)}},e._sendFileStart=function(t){var e=new createjs.Event("filestart");e.item=t,this.hasEventListener("filestart")&&this.dispatchEvent(e)},e.toString=function(){return"[PreloadJS LoadQueue]"},createjs.LoadQueue=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,createjs.Types.TEXT)}(createjs.extend(t,createjs.AbstractLoader),t).canLoadItem=function(t){return t.type==createjs.Types.TEXT},createjs.TextLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,createjs.Types.BINARY),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.BINARY},e._updateXHR=function(t){t.loader.setResponseType("arraybuffer")},createjs.BinaryLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,createjs.Types.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=e?createjs.Elements.style():createjs.Elements.link(),this._tag.rel="stylesheet",this._tag.type="text/css"}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.CSS},e._formatResult=function(t){if(this._preferXHR){var e=t.getTag();if(e.styleSheet)e.styleSheet.cssText=t.getResult(!0);else{var i=createjs.Elements.text(t.getResult(!0));e.appendChild(i)}}else e=this._tag;return createjs.DomUtils.appendToHead(e),e},createjs.CSSLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function h(t,e){this.AbstractLoader_constructor(t,e,t.type),this._faces={},this._watched=[],this._count=0,this._watchInterval=null,this._loadTimeout=null,this._injectCSS=void 0===t.injectCSS||t.injectCSS,this.dispatchEvent("initialize")}var t=createjs.extend(h,createjs.AbstractLoader);h.canLoadItem=function(t){return t.type==createjs.Types.FONT||t.type==createjs.Types.FONTCSS},h.sampleText="abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ",h._ctx=document.createElement("canvas").getContext("2d"),h._referenceFonts=["serif","monospace"],h.WEIGHT_REGEX=/[- ._]*(thin|normal|book|regular|medium|black|heavy|[1-9]00|(?:extra|ultra|semi|demi)?[- ._]*(?:light|bold))[- ._]*/gi,h.STYLE_REGEX=/[- ._]*(italic|oblique)[- ._]*/gi,h.FONT_FORMAT={woff2:"woff2",woff:"woff",ttf:"truetype",otf:"truetype"},h.FONT_WEIGHT={thin:100,extralight:200,ultralight:200,light:300,semilight:300,demilight:300,book:"normal",regular:"normal",semibold:600,demibold:600,extrabold:800,ultrabold:800,black:900,heavy:900},h.WATCH_DURATION=10,t.load=function(){if(this.type==createjs.Types.FONTCSS){if(!this._watchCSS())return void this.AbstractLoader_load()}else if(this._item.src instanceof Array)this._watchFontArray();else{var t=this._defFromSrc(this._item.src);this._watchFont(t),this._injectStyleTag(this._cssFromDef(t))}this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this.dispatchEvent("loadstart")},t._handleTimeout=function(){this._stopWatching(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT"))},t._createRequest=function(){return this._request},t.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response,this._result=!0,this._parseCSS(this._rawResult);break;case"error":this._stopWatching(),this.AbstractLoader_handleEvent(t)}},t._watchCSS=function(){var t=this._item.src;return t instanceof HTMLStyleElement&&(this._injectCSS&&!t.parentNode&&(document.head||document.getElementsByTagName("head")[0]).appendChild(t),this._injectCSS=!1,t="\n"+t.textContent),-1!==t.search(/\n|\r|@font-face/i)?(this._parseCSS(t),!0):(this._request=new createjs.XHRRequest(this._item),!1)},t._parseCSS=function(t){for(var e=/@font-face\s*\{([^}]+)}/g;;){var i=e.exec(t);if(!i)break;this._watchFont(this._parseFontFace(i[1]))}this._injectStyleTag(t)},t._watchFontArray=function(){for(var t,e=this._item.src,i="",n=e.length-1;0<=n;n--){var r=e[n];t="string"==typeof r?this._defFromSrc(r):this._defFromObj(r),this._watchFont(t),i+=this._cssFromDef(t)+"\n"}this._injectStyleTag(i)},t._injectStyleTag=function(t){if(this._injectCSS){var e=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),e.appendChild(i)}},t._parseFontFace=function(t){var e=this._getCSSValue(t,"font-family"),i=this._getCSSValue(t,"src");return e&&i?this._defFromObj({family:e,src:i,style:this._getCSSValue(t,"font-style"),weight:this._getCSSValue(t,"font-weight")}):null},t._watchFont=function(t){t&&!this._faces[t.id]&&(this._faces[t.id]=t,this._watched.push(t),this._count++,this._calculateReferenceSizes(t),this._startWatching())},t._startWatching=function(){null==this._watchInterval&&(this._watchInterval=setInterval(createjs.proxy(this._watch,this),h.WATCH_DURATION))},t._stopWatching=function(){clearInterval(this._watchInterval),clearTimeout(this._loadTimeout),this._watchInterval=null},t._watch=function(){for(var t=this._watched,e=h._referenceFonts,i=t.length,n=i-1;0<=n;n--)for(var r=t[n],a=r.refs,o=a.length-1;0<=o;o--){if(this._getTextWidth(r.family+","+e[o],r.weight,r.style)!=a[o]){var s=new createjs.Event("fileload");r.type="font-family",s.item=r,this.dispatchEvent(s),t.splice(n,1);break}}if(i!==t.length){s=new createjs.ProgressEvent(this._count-t.length,this._count);this.dispatchEvent(s)}0===i&&(this._stopWatching(),this._sendComplete())},t._calculateReferenceSizes=function(t){for(var e=h._referenceFonts,i=t.refs=[],n=0;n<e.length;n++)i[n]=this._getTextWidth(e[n],t.weight,t.style)},t._defFromSrc=function(t){var e,i=/[- ._]+/g,n=t,r=null;-1!==(e=n.search(/[?#]/))&&(n=n.substr(0,e)),-1!==(e=n.lastIndexOf("."))&&(r=n.substr(e+1),n=n.substr(0,e)),-1!==(e=n.lastIndexOf("/"))&&(n=n.substr(e+1));var a=n,o=a.match(h.WEIGHT_REGEX);o&&(o=o[0],a=a.replace(o,""),o=o.replace(i,"").toLowerCase());var s=n.match(h.STYLE_REGEX);s&&(a=a.replace(s[0],""),s="italic"),a=a.replace(i,"");var l="local('"+n.replace(i," ")+"'), url('"+t+"')",c=h.FONT_FORMAT[r];return c&&(l+=" format('"+c+"')"),this._defFromObj({family:a,weight:h.FONT_WEIGHT[o]||o,style:s,src:l})},t._defFromObj=function(t){var e={family:t.family,src:t.src,style:t.style||"normal",weight:t.weight||"normal"};return e.id=e.family+";"+e.style+";"+e.weight,e},t._cssFromDef=function(t){return"@font-face {\n\tfont-family: '"+t.family+"';\n\tfont-style: "+t.style+";\n\tfont-weight: "+t.weight+";\n\tsrc: "+t.src+";\n}"},t._getTextWidth=function(t,e,i){var n=h._ctx;return n.font=i+" "+e+" 72px "+t,n.measureText(h.sampleText).width},t._getCSSValue=function(t,e){var i=new RegExp(e+":s*([^;}]+?)s*[;}]").exec(t);return i&&i[1]?i[1]:null},createjs.FontLoader=createjs.promote(h,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,createjs.Types.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",createjs.DomUtils.isImageTag(t)?this._tag=t:createjs.DomUtils.isImageTag(t.src)?this._tag=t.src:createjs.DomUtils.isImageTag(t.tag)&&(this._tag=t.tag),null!=this._tag?this._preferXHR=!1:this._tag=createjs.Elements.img(),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.IMAGE},e.load=function(){if(""!=this._tag.src&&this._tag.complete)this._sendComplete();else{var t=this._item.crossOrigin;1==t&&(t="Anonymous"),null==t||createjs.URLUtils.isLocal(this._item)||(this._tag.crossOrigin=t),this.AbstractLoader_load()}},e._updateXHR=function(t){t.loader.mimeType="text/plain; charset=x-user-defined-binary",t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){return this._formatImage},e._formatImage=function(t,e){var i=this._tag,n=window.URL||window.webkitURL;if(this._preferXHR)if(n){var r=n.createObjectURL(this.getResult(!0));i.src=r,i.addEventListener("load",this._cleanUpURL,!1),i.addEventListener("error",this._cleanUpURL,!1)}else i.src=this._item.src;i.complete?t(i):(i.onload=createjs.proxy(function(){t(this._tag),i.onload=i.onerror=null},this),i.onerror=createjs.proxy(function(t){e(new createjs.ErrorEvent("IMAGE_FORMAT",null,t)),i.onload=i.onerror=null},this))},e._cleanUpURL=function(t){(window.URL||window.webkitURL).revokeObjectURL(t.target.src)},createjs.ImageLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,createjs.Types.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(createjs.Elements.script())}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.JAVASCRIPT},e._formatResult=function(t){var e=t.getTag();return this._preferXHR&&(e.text=t.getResult(!0)),e},createjs.JavaScriptLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,createjs.Types.JSON),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.JSON},e._formatResult=function(t){var e=null;try{e=createjs.DataUtils.parseJSON(t.getResult(!0))}catch(t){var i=new createjs.ErrorEvent("JSON_FORMAT",null,t);return this._sendError(i),t}return e},createjs.JSONLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!1,createjs.Types.JSONP),this.setTag(createjs.Elements.script()),this.getTag().type="text/javascript"}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.JSONP},e.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},e.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=createjs.proxy(this._handleLoad,this),createjs.DomUtils.appendToBody(this._tag),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},e._handleLoad=function(t){this._result=this._rawResult=t,this._sendComplete(),this._dispose()},e._handleTimeout=function(){this._dispose(),this.dispatchEvent(new createjs.ErrorEvent("timeout"))},e._dispose=function(){createjs.DomUtils.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},createjs.JSONPLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,createjs.Types.MANIFEST),this.plugins=null,this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.MANIFEST_PROGRESS=.25,i.canLoadItem=function(t){return t.type==createjs.Types.MANIFEST},e.load=function(){this.AbstractLoader_load()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.MANIFEST_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._loadManifest=function(t){if(t&&t.manifest){var e=this._manifestQueue=new createjs.LoadQueue(this._preferXHR);e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("complete",this._handleManifestComplete,this,!0),e.on("error",this._handleManifestError,this,!0);for(var i=0,n=this.plugins.length;i<n;i++)e.installPlugin(this.plugins[i]);e.loadManifest(t)}else this._sendComplete()},e._handleManifestFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleManifestComplete=function(t){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.MANIFEST_PROGRESS)+i.MANIFEST_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.ManifestLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.Types.SOUND),createjs.DomUtils.isAudioTag(t)?this._tag=t:createjs.DomUtils.isAudioTag(t.src)?this._tag=t:createjs.DomUtils.isAudioTag(t.tag)&&(this._tag=createjs.DomUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=createjs.extend(t,createjs.AbstractMediaLoader);t.canLoadItem=function(t){return t.type==createjs.Types.SOUND},e._createTag=function(t){var e=createjs.Elements.audio();return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.SoundLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.Types.VIDEO),createjs.DomUtils.isVideoTag(t)||createjs.DomUtils.isVideoTag(t.src)?(this.setTag(createjs.DomUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())}var e=t;createjs.extend(t,createjs.AbstractMediaLoader)._createTag=function(){return createjs.Elements.video()},e.canLoadItem=function(t){return t.type==createjs.Types.VIDEO},createjs.VideoLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,createjs.Types.SPRITESHEET),this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.SPRITESHEET_PROGRESS=.25,i.canLoadItem=function(t){return t.type==createjs.Types.SPRITESHEET},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.SPRITESHEET_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e._loadManifest=function(t){if(t&&t.images){var e=this._manifestQueue=new createjs.LoadQueue(this._preferXHR,this._item.path,this._item.crossOrigin);e.on("complete",this._handleManifestComplete,this,!0),e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("error",this._handleManifestError,this,!0),e.loadManifest(t.images)}},e._handleManifestFileLoad=function(t){var e=t.result;if(null!=e){var i=this.getResult().images,n=i.indexOf(t.item.src);i[n]=e}},e._handleManifestComplete=function(t){this._result=new createjs.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.SPRITESHEET_PROGRESS)+i.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.SpriteSheetLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,createjs.Types.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",e?this.setTag(createjs.Elements.svg()):(this.setTag(createjs.Elements.object()),this.getTag().type="image/svg+xml")}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.SVG},e._formatResult=function(t){var e=createjs.DataUtils.parseXML(t.getResult(!0)),i=t.getTag();if(!this._preferXHR&&document.body.contains(i)&&document.body.removeChild(i),null==e.documentElement)return e;var n=e.documentElement;return document.importNode&&(n=document.importNode(n,!0)),i.appendChild(n),i},createjs.SVGLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,createjs.Types.XML),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.Types.XML},e._formatResult=function(t){return createjs.DataUtils.parseXML(t.getResult(!0))},createjs.XMLLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){var t=createjs.SoundJS=createjs.SoundJS||{};t.version="1.0.0",t.buildDate="Thu, 12 Oct 2017 16:34:05 GMT"}(),this.createjs=this.createjs||{},function(){function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=-1<e.indexOf("IEMobile")||-1<e.indexOf("Windows Phone"),t.isFirefox=-1<e.indexOf("Firefox"),t.isOpera=null!=window.opera,t.isChrome=-1<e.indexOf("Chrome"),t.isIOS=(-1<e.indexOf("iPod")||-1<e.indexOf("iPhone")||-1<e.indexOf("iPad"))&&!t.isWindowPhone,t.isAndroid=-1<e.indexOf("Android")&&!t.isWindowPhone,t.isBlackberry=-1<e.indexOf("Blackberry"),createjs.BrowserDetect=t}(),this.createjs=this.createjs||{},function(){var t=function(){this.interrupt=null,this.delay=null,this.offset=null,this.loop=null,this.volume=null,this.pan=null,this.startTime=null,this.duration=null},e=t.prototype={},i=t;i.create=function(t){if("string"==typeof t)return console&&(console.warn||console.log)("Deprecated behaviour. Sound.play takes a configuration object instead of individual arguments. See docs for info."),(new createjs.PlayPropsConfig).set({interrupt:t});if(null==t||t instanceof i||t instanceof Object)return(new createjs.PlayPropsConfig).set(t);if(null==t)throw new Error("PlayProps configuration not recognized.")},e.set=function(t){if(null!=t)for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[PlayPropsConfig]"},createjs.PlayPropsConfig=i}(),this.createjs=this.createjs||{},function(){function o(){throw"Sound cannot be instantiated"}function s(t,e){this.init(t,e)}var l=o;l.INTERRUPT_ANY="any",l.INTERRUPT_EARLY="early",l.INTERRUPT_LATE="late",l.INTERRUPT_NONE="none",l.PLAY_INITED="playInited",l.PLAY_SUCCEEDED="playSucceeded",l.PLAY_INTERRUPTED="playInterrupted",l.PLAY_FINISHED="playFinished",l.PLAY_FAILED="playFailed",l.SUPPORTED_EXTENSIONS=["mp3","ogg","opus","mpeg","wav","m4a","mp4","aiff","wma","mid"],l.EXTENSION_MAP={m4a:"mp4"},l.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([\/.]*?(?:[^?]+)?\/)?((?:[^\/?]+)\.(\w+))(?:\?(\S+)?)?$/,l.defaultInterruptBehavior=l.INTERRUPT_NONE,l.alternateExtensions=[],l.activePlugin=null,l._masterVolume=1,l._getMasterVolume=function(){return this._masterVolume},l.getVolume=createjs.deprecate(l._getMasterVolume,"Sound.getVolume"),l._setMasterVolume=function(t){if(null!=Number(t)&&(t=Math.max(0,Math.min(1,t)),l._masterVolume=t,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(t)))for(var e=this._instances,i=0,n=e.length;i<n;i++)e[i].setMasterVolume(t)},l.setVolume=createjs.deprecate(l._setMasterVolume,"Sound.setVolume"),l._masterMute=!1,l._getMute=function(){return this._masterMute},l.getMute=createjs.deprecate(l._getMute,"Sound.getMute"),l._setMute=function(t){if(null!=t&&(this._masterMute=t,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(t)))for(var e=this._instances,i=0,n=e.length;i<n;i++)e[i].setMasterMute(t)},l.setMute=createjs.deprecate(l._setMute,"Sound.setMute"),l._getCapabilities=function(){return null==l.activePlugin?null:l.activePlugin._capabilities},l.getCapabilities=createjs.deprecate(l._getCapabilities,"Sound.getCapabilities"),Object.defineProperties(l,{volume:{get:l._getMasterVolume,set:l._setMasterVolume},muted:{get:l._getMute,set:l._setMute},capabilities:{get:l._getCapabilities}}),l._pluginsRegistered=!1,l._lastID=0,l._instances=[],l._idHash={},l._preloadHash={},l._defaultPlayPropsHash={},l.addEventListener=null,l.removeEventListener=null,l.removeAllEventListeners=null,l.dispatchEvent=null,l.hasEventListener=null,l._listeners=null,createjs.EventDispatcher.initialize(l),l.getPreloadHandlers=function(){return{callback:createjs.proxy(l.initLoad,l),types:["sound"],extensions:l.SUPPORTED_EXTENSIONS}},l._handleLoadComplete=function(t){var e=t.target.getItem().src;if(l._preloadHash[e])for(var i=0,n=l._preloadHash[e].length;i<n;i++){var r=l._preloadHash[e][i];if(l._preloadHash[e][i]=!0,l.hasEventListener("fileload"))(t=new createjs.Event("fileload")).src=r.src,t.id=r.id,t.data=r.data,t.sprite=r.sprite,l.dispatchEvent(t)}},l._handleLoadError=function(t){var e=t.target.getItem().src;if(l._preloadHash[e])for(var i=0,n=l._preloadHash[e].length;i<n;i++){var r=l._preloadHash[e][i];if(l._preloadHash[e][i]=!1,l.hasEventListener("fileerror"))(t=new createjs.Event("fileerror")).src=r.src,t.id=r.id,t.data=r.data,t.sprite=r.sprite,l.dispatchEvent(t)}},l._registerPlugin=function(t){return!!t.isSupported()&&(l.activePlugin=new t,!0)},l.registerPlugins=function(t){l._pluginsRegistered=!0;for(var e=0,i=t.length;e<i;e++)if(l._registerPlugin(t[e]))return!0;return!1},l.initializeDefaultPlugins=function(){return null!=l.activePlugin||!l._pluginsRegistered&&!!l.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin])},l.isReady=function(){return null!=l.activePlugin},l.initLoad=function(t){return"video"==t.type||l._registerSound(t)},l._registerSound=function(t){if(!l.initializeDefaultPlugins())return!1;var e;if(t.src instanceof Object?(e=l._parseSrc(t.src)).src=t.path+e.src:e=l._parsePath(t.src),null==e)return!1;t.src=e.src,t.type="sound";var i=t.data,n=null;if(null!=i&&(isNaN(i.channels)?isNaN(i)||(n=parseInt(i)):n=parseInt(i.channels),i.audioSprite))for(var r,a=i.audioSprite.length;a--;)r=i.audioSprite[a],l._idHash[r.id]={src:t.src,startTime:parseInt(r.startTime),duration:parseInt(r.duration)},r.defaultPlayProps&&(l._defaultPlayPropsHash[r.id]=createjs.PlayPropsConfig.create(r.defaultPlayProps));null!=t.id&&(l._idHash[t.id]={src:t.src});var o=l.activePlugin.register(t);return s.create(t.src,n),null!=i&&isNaN(i)?t.data.channels=n||s.maxPerChannel():t.data=n||s.maxPerChannel(),o.type&&(t.type=o.type),t.defaultPlayProps&&(l._defaultPlayPropsHash[t.src]=createjs.PlayPropsConfig.create(t.defaultPlayProps)),o},l.registerSound=function(t,e,i,n,r){var a={src:t,id:e,data:i,defaultPlayProps:r};t instanceof Object&&t.src&&(n=e,a=t),null==((a=createjs.LoadItem.create(a)).path=n)||a.src instanceof Object||(a.src=n+a.src);var o=l._registerSound(a);if(!o)return!1;if(l._preloadHash[a.src]||(l._preloadHash[a.src]=[]),l._preloadHash[a.src].push(a),1==l._preloadHash[a.src].length)o.on("complete",this._handleLoadComplete,this),o.on("error",this._handleLoadError,this),l.activePlugin.preload(o);else if(1==l._preloadHash[a.src][0])return!0;return a},l.registerSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,r=t.length;n<r;n++)i[n]=createjs.Sound.registerSound(t[n].src,t[n].id,t[n].data,e,t[n].defaultPlayProps);return i},l.removeSound=function(t,e){if(null==l.activePlugin)return!1;var i;if(t instanceof Object&&t.src&&(t=t.src),null==(i=t instanceof Object?l._parseSrc(t):(t=l._getSrcById(t).src,l._parsePath(t))))return!1;for(var n in t=i.src,null!=e&&(t=e+t),l._idHash)l._idHash[n].src==t&&delete l._idHash[n];return s.removeSrc(t),delete l._preloadHash[t],l.activePlugin.removeSound(t),!0},l.removeSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,r=t.length;n<r;n++)i[n]=createjs.Sound.removeSound(t[n].src,e);return i},l.removeAllSounds=function(){l._idHash={},l._preloadHash={},s.removeAll(),l.activePlugin&&l.activePlugin.removeAllSounds()},l.loadComplete=function(t){if(!l.isReady())return!1;var e=l._parsePath(t);return t=e?l._getSrcById(e.src).src:l._getSrcById(t).src,null!=l._preloadHash[t]&&1==l._preloadHash[t][0]},l._parsePath=function(t){"string"!=typeof t&&(t=t.toString());var e=t.match(l.FILE_PATTERN);if(null==e)return!1;for(var i=e[4],n=e[5],r=l.capabilities,a=0;!r[n];)if(n=l.alternateExtensions[a++],a>l.alternateExtensions.length)return null;return{name:i,src:t=t.replace("."+e[5],"."+n),extension:n}},l._parseSrc=function(t){var e={name:void 0,src:void 0,extension:void 0},i=l.capabilities;for(var n in t)if(t.hasOwnProperty(n)&&i[n]){e.src=t[n],e.extension=n;break}if(!e.src)return!1;var r=e.src.lastIndexOf("/");return e.name=-1!=r?e.src.slice(r+1):e.src,e},l.play=function(t,e){var i=createjs.PlayPropsConfig.create(e),n=l.createInstance(t,i.startTime,i.duration);return l._playInstance(n,i)||n._playFailed(),n},l.createInstance=function(t,e,i){if(!l.initializeDefaultPlugins())return new createjs.DefaultSoundInstance(t,e,i);var n=l._defaultPlayPropsHash[t];t=l._getSrcById(t);var r=l._parsePath(t.src),a=null;return null!=r&&null!=r.src?(s.create(r.src),null==e&&(e=t.startTime),a=l.activePlugin.create(r.src,e,i||t.duration),(n=n||l._defaultPlayPropsHash[r.src])&&a.applyPlayProps(n)):a=new createjs.DefaultSoundInstance(t,e,i),a.uniqueId=l._lastID++,a},l.stop=function(){for(var t=this._instances,e=t.length;e--;)t[e].stop()},l.setDefaultPlayProps=function(t,e){t=l._getSrcById(t),l._defaultPlayPropsHash[l._parsePath(t.src).src]=createjs.PlayPropsConfig.create(e)},l.getDefaultPlayProps=function(t){return t=l._getSrcById(t),l._defaultPlayPropsHash[l._parsePath(t.src).src]},l._playInstance=function(t,e){var i=l._defaultPlayPropsHash[t.src]||{};if(null==e.interrupt&&(e.interrupt=i.interrupt||l.defaultInterruptBehavior),null==e.delay&&(e.delay=i.delay||0),null==e.offset&&(e.offset=t.position),null==e.loop&&(e.loop=t.loop),null==e.volume&&(e.volume=t.volume),null==e.pan&&(e.pan=t.pan),0==e.delay){if(!l._beginPlaying(t,e))return!1}else{var n=setTimeout(function(){l._beginPlaying(t,e)},e.delay);t.delayTimeoutId=n}return this._instances.push(t),!0},l._beginPlaying=function(t,e){if(!s.add(t,e.interrupt))return!1;if(t._beginPlaying(e))return!0;var i=createjs.indexOf(this._instances,t);return-1<i&&this._instances.splice(i,1),!1},l._getSrcById=function(t){return l._idHash[t]||{src:t}},l._playFinished=function(t){s.remove(t);var e=createjs.indexOf(this._instances,t);-1<e&&this._instances.splice(e,1)},createjs.Sound=o,s.channels={},s.create=function(t,e){return null==s.get(t)&&(s.channels[t]=new s(t,e),!0)},s.removeSrc=function(t){var e=s.get(t);return null!=e&&(e._removeAll(),delete s.channels[t],!0)},s.removeAll=function(){for(var t in s.channels)s.channels[t]._removeAll();s.channels={}},s.add=function(t,e){var i=s.get(t.src);return null!=i&&i._add(t,e)},s.remove=function(t){var e=s.get(t.src);return null!=e&&(e._remove(t),!0)},s.maxPerChannel=function(){return t.maxDefault},s.get=function(t){return s.channels[t]};var t=s.prototype;t.constructor=s,t.src=null,t.max=null,t.maxDefault=100,t.length=0,t.init=function(t,e){this.src=t,this.max=e||this.maxDefault,-1==this.max&&(this.max=this.maxDefault),this._instances=[]},t._get=function(t){return this._instances[t]},t._add=function(t,e){return!!this._getSlot(e,t)&&(this._instances.push(t),this.length++,!0)},t._remove=function(t){var e=createjs.indexOf(this._instances,t);return-1!=e&&(this._instances.splice(e,1),this.length--,!0)},t._removeAll=function(){for(var t=this.length-1;0<=t;t--)this._instances[t].stop()},t._getSlot=function(t,e){var i,n;if(t!=o.INTERRUPT_NONE&&null==(n=this._get(0)))return!0;for(var r=0,a=this.max;r<a;r++){if(null==(i=this._get(r)))return!0;if(i.playState==o.PLAY_FINISHED||i.playState==o.PLAY_INTERRUPTED||i.playState==o.PLAY_FAILED){n=i;break}t!=o.INTERRUPT_NONE&&(t==o.INTERRUPT_EARLY&&i.position<n.position||t==o.INTERRUPT_LATE&&i.position>n.position)&&(n=i)}return null!=n&&(n._interrupt(),this._remove(n),!0)},t.toString=function(){return"[Sound SoundChannel]"}}(),this.createjs=this.createjs||{},function(){var t=function(t,e,i,n){this.EventDispatcher_constructor(),this.src=t,this.uniqueId=-1,this.playState=null,this.delayTimeoutId=null,this._volume=1,Object.defineProperty(this,"volume",{get:this._getVolume,set:this._setVolume}),this.getVolume=createjs.deprecate(this._getVolume,"AbstractSoundInstance.getVolume"),this.setVolume=createjs.deprecate(this._setVolume,"AbstractSoundInstance.setVolume"),this._pan=0,Object.defineProperty(this,"pan",{get:this._getPan,set:this._setPan}),this.getPan=createjs.deprecate(this._getPan,"AbstractSoundInstance.getPan"),this.setPan=createjs.deprecate(this._setPan,"AbstractSoundInstance.setPan"),this._startTime=Math.max(0,e||0),Object.defineProperty(this,"startTime",{get:this._getStartTime,set:this._setStartTime}),this.getStartTime=createjs.deprecate(this._getStartTime,"AbstractSoundInstance.getStartTime"),this.setStartTime=createjs.deprecate(this._setStartTime,"AbstractSoundInstance.setStartTime"),this._duration=Math.max(0,i||0),Object.defineProperty(this,"duration",{get:this._getDuration,set:this._setDuration}),this.getDuration=createjs.deprecate(this._getDuration,"AbstractSoundInstance.getDuration"),this.setDuration=createjs.deprecate(this._setDuration,"AbstractSoundInstance.setDuration"),this._playbackResource=null,Object.defineProperty(this,"playbackResource",{get:this._getPlaybackResource,set:this._setPlaybackResource}),!1!==n&&!0!==n&&this._setPlaybackResource(n),this.getPlaybackResource=createjs.deprecate(this._getPlaybackResource,"AbstractSoundInstance.getPlaybackResource"),this.setPlaybackResource=createjs.deprecate(this._setPlaybackResource,"AbstractSoundInstance.setPlaybackResource"),this._position=0,Object.defineProperty(this,"position",{get:this._getPosition,set:this._setPosition}),this.getPosition=createjs.deprecate(this._getPosition,"AbstractSoundInstance.getPosition"),this.setPosition=createjs.deprecate(this._setPosition,"AbstractSoundInstance.setPosition"),this._loop=0,Object.defineProperty(this,"loop",{get:this._getLoop,set:this._setLoop}),this.getLoop=createjs.deprecate(this._getLoop,"AbstractSoundInstance.getLoop"),this.setLoop=createjs.deprecate(this._setLoop,"AbstractSoundInstance.setLoop"),this._muted=!1,Object.defineProperty(this,"muted",{get:this._getMuted,set:this._setMuted}),this.getMuted=createjs.deprecate(this._getMuted,"AbstractSoundInstance.getMuted"),this.setMuted=createjs.deprecate(this._setMuted,"AbstractSoundInstance.setMuted"),this._paused=!1,Object.defineProperty(this,"paused",{get:this._getPaused,set:this._setPaused}),this.getPaused=createjs.deprecate(this._getPaused,"AbstractSoundInstance.getPaused"),this.setPaused=createjs.deprecate(this._setPaused,"AbstractSoundInstance.setPaused")},e=createjs.extend(t,createjs.EventDispatcher);e.play=function(t){var e=createjs.PlayPropsConfig.create(t);return this.playState==createjs.Sound.PLAY_SUCCEEDED?(this.applyPlayProps(e),void(this._paused&&this._setPaused(!1))):(this._cleanUp(),createjs.Sound._playInstance(this,e),this)},e.stop=function(){return this._position=0,this._paused=!1,this._handleStop(),this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this},e.destroy=function(){this._cleanUp(),this.src=null,this.playbackResource=null,this.removeAllEventListeners()},e.applyPlayProps=function(t){return null!=t.offset&&this._setPosition(t.offset),null!=t.loop&&this._setLoop(t.loop),null!=t.volume&&this._setVolume(t.volume),null!=t.pan&&this._setPan(t.pan),null!=t.startTime&&(this._setStartTime(t.startTime),this._setDuration(t.duration)),this},e.toString=function(){return"[AbstractSoundInstance]"},e._getPaused=function(){return this._paused},e._setPaused=function(t){return!0!==t&&!1!==t||this._paused==t||1==t&&this.playState!=createjs.Sound.PLAY_SUCCEEDED?void 0:((this._paused=t)?this._pause():this._resume(),clearTimeout(this.delayTimeoutId),this)},e._setVolume=function(t){return t==this._volume||(this._volume=Math.max(0,Math.min(1,t)),this._muted||this._updateVolume()),this},e._getVolume=function(){return this._volume},e._setMuted=function(t){return!0===t||!1===t?(this._muted=t,this._updateVolume(),this):void 0},e._getMuted=function(){return this._muted},e._setPan=function(t){return t==this._pan||(this._pan=Math.max(-1,Math.min(1,t)),this._updatePan()),this},e._getPan=function(){return this._pan},e._getPosition=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED||(this._position=this._calculateCurrentPosition()),this._position},e._setPosition=function(t){return this._position=Math.max(0,t),this.playState==createjs.Sound.PLAY_SUCCEEDED&&this._updatePosition(),this},e._getStartTime=function(){return this._startTime},e._setStartTime=function(t){return t==this._startTime||(this._startTime=Math.max(0,t||0),this._updateStartTime()),this},e._getDuration=function(){return this._duration},e._setDuration=function(t){return t==this._duration||(this._duration=Math.max(0,t||0),this._updateDuration()),this},e._setPlaybackResource=function(t){return this._playbackResource=t,0==this._duration&&this._playbackResource&&this._setDurationFromSource(),this},e._getPlaybackResource=function(){return this._playbackResource},e._getLoop=function(){return this._loop},e._setLoop=function(t){null!=this._playbackResource&&(0!=this._loop&&0==t?this._removeLooping(t):0==this._loop&&0!=t&&this._addLooping(t)),this._loop=t},e._sendEvent=function(t){var e=new createjs.Event(t);this.dispatchEvent(e)},e._cleanUp=function(){clearTimeout(this.delayTimeoutId),this._handleCleanUp(),this._paused=!1,createjs.Sound._playFinished(this)},e._interrupt=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_INTERRUPTED,this._sendEvent("interrupted")},e._beginPlaying=function(t){return this._setPosition(t.offset),this._setLoop(t.loop),this._setVolume(t.volume),this._setPan(t.pan),null!=t.startTime&&(this._setStartTime(t.startTime),this._setDuration(t.duration)),null!=this._playbackResource&&this._position<this._duration?(this._paused=!1,this._handleSoundReady(),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0):(this._playFailed(),!1)},e._playFailed=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_FAILED,this._sendEvent("failed")},e._handleSoundComplete=function(t){return(this._position=0)!=this._loop?(this._loop--,this._handleLoop(),void this._sendEvent("loop")):(this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,void this._sendEvent("complete"))},e._handleSoundReady=function(){},e._updateVolume=function(){},e._updatePan=function(){},e._updateStartTime=function(){},e._updateDuration=function(){},e._setDurationFromSource=function(){},e._calculateCurrentPosition=function(){},e._updatePosition=function(){},e._removeLooping=function(t){},e._addLooping=function(t){},e._pause=function(){},e._resume=function(){},e._handleStop=function(){},e._handleCleanUp=function(){},e._handleLoop=function(){},createjs.AbstractSoundInstance=createjs.promote(t,"EventDispatcher"),createjs.DefaultSoundInstance=createjs.AbstractSoundInstance}(),this.createjs=this.createjs||{},function(){var t=function(){this._capabilities=null,this._loaders={},this._audioSources={},this._soundInstances={},this._volume=1,this._loaderClass,this._soundInstanceClass},e=t.prototype;t._capabilities=null,t.isSupported=function(){return!0},e.register=function(t){var e=this._loaders[t.src];return e&&!e.canceled?this._loaders[t.src]:(this._audioSources[t.src]=!0,this._soundInstances[t.src]=[],(e=new this._loaderClass(t)).on("complete",this._handlePreloadComplete,this),this._loaders[t.src]=e)},e.preload=function(t){t.on("error",this._handlePreloadError,this),t.load()},e.isPreloadStarted=function(t){return null!=this._audioSources[t]},e.isPreloadComplete=function(t){return!(null==this._audioSources[t]||1==this._audioSources[t])},e.removeSound=function(t){if(this._soundInstances[t]){for(var e=this._soundInstances[t].length;e--;){this._soundInstances[t][e].destroy()}delete this._soundInstances[t],delete this._audioSources[t],this._loaders[t]&&this._loaders[t].destroy(),delete this._loaders[t]}},e.removeAllSounds=function(){for(var t in this._audioSources)this.removeSound(t)},e.create=function(t,e,i){this.isPreloadStarted(t)||this.preload(this.register(t));var n=new this._soundInstanceClass(t,e,i,this._audioSources[t]);return this._soundInstances[t]&&this._soundInstances[t].push(n),n.setMasterVolume&&n.setMasterVolume(createjs.Sound.volume),n.setMasterMute&&n.setMasterMute(createjs.Sound.muted),n},e.setVolume=function(t){return this._volume=t,this._updateVolume(),!0},e.getVolume=function(){return this._volume},e.setMute=function(t){return this._updateVolume(),!0},e.toString=function(){return"[AbstractPlugin]"},e._handlePreloadComplete=function(t){var e=t.target.getItem().src;this._audioSources[e]=t.result;for(var i=0,n=this._soundInstances[e].length;i<n;i++){this._soundInstances[e][i].playbackResource=this._audioSources[e],this._soundInstances[e]=null}},e._handlePreloadError=function(t){},e._updateVolume=function(){},createjs.AbstractPlugin=t}(),this.createjs=this.createjs||{},function(){function e(t){this.AbstractLoader_constructor(t,!0,createjs.Types.SOUND)}var t=createjs.extend(e,createjs.AbstractLoader);e.context=null,t.toString=function(){return"[WebAudioLoader]"},t._createRequest=function(){this._request=new createjs.XHRRequest(this._item,!1),this._request.setResponseType("arraybuffer")},t._sendComplete=function(t){e.context.decodeAudioData(this._rawResult,createjs.proxy(this._handleAudioDecoded,this),createjs.proxy(this._sendError,this))},t._handleAudioDecoded=function(t){this._result=t,this.AbstractLoader__sendComplete()},createjs.WebAudioLoader=createjs.promote(e,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this.gainNode=r.context.createGain(),this.panNode=r.context.createPanner(),this.panNode.panningModel=r._panningModel,this.panNode.connect(this.gainNode),this._updatePan(),this.sourceNode=null,this._soundCompleteTimeout=null,this._sourceNodeNext=null,this._playbackStartTime=0,this._endedHandler=createjs.proxy(this._handleSoundComplete,this)}var e=createjs.extend(t,createjs.AbstractSoundInstance),r=t;r.context=null,r._scratchBuffer=null,r.destinationNode=null,r._panningModel="equalpower",e.destroy=function(){this.AbstractSoundInstance_destroy(),this.panNode.disconnect(0),this.panNode=null,this.gainNode.disconnect(0),this.gainNode=null},e.toString=function(){return"[WebAudioSoundInstance]"},e._updatePan=function(){this.panNode.setPosition(this._pan,0,-.5)},e._removeLooping=function(t){this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)},e._addLooping=function(t){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._setDurationFromSource=function(){this._duration=1e3*this.playbackResource.duration},e._handleCleanUp=function(){this.sourceNode&&this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout),this._playbackStartTime=0},e._cleanUpAudioNode=function(t){if(t){if(t.stop(0),t.disconnect(0),createjs.BrowserDetect.isIOS)try{t.buffer=r._scratchBuffer}catch(t){}t=null}return t},e._handleSoundReady=function(t){this.gainNode.connect(r.destinationNode);var e=.001*this._duration,i=Math.min(.001*Math.max(0,this._position),e);this.sourceNode=this._createAndPlayAudioNode(r.context.currentTime-e,i),this._playbackStartTime=this.sourceNode.startTime-i,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(e-i)),0!=this._loop&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._createAndPlayAudioNode=function(t,e){var i=r.context.createBufferSource();i.buffer=this.playbackResource,i.connect(this.panNode);var n=.001*this._duration;return i.startTime=t+n,i.start(i.startTime,e+.001*this._startTime,n-e),i},e._pause=function(){this._position=1e3*(r.context.currentTime-this._playbackStartTime),this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout)},e._resume=function(){this._handleSoundReady()},e._updateVolume=function(){var t=this._muted?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},e._calculateCurrentPosition=function(){return 1e3*(r.context.currentTime-this._playbackStartTime)},e._updatePosition=function(){this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout),this._paused||this._handleSoundReady()},e._handleLoop=function(){this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._playbackStartTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)},e._updateDuration=function(){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._pause(),this._resume())},createjs.WebAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){function t(){this.AbstractPlugin_constructor(),this._panningModel=s._panningModel,this.context=s.context,this.dynamicsCompressorNode=this.context.createDynamicsCompressor(),this.dynamicsCompressorNode.connect(this.context.destination),this.gainNode=this.context.createGain(),this.gainNode.connect(this.dynamicsCompressorNode),createjs.WebAudioSoundInstance.destinationNode=this.gainNode,this._capabilities=s._capabilities,this._loaderClass=createjs.WebAudioLoader,this._soundInstanceClass=createjs.WebAudioSoundInstance,this._addPropsToClasses()}var e=createjs.extend(t,createjs.AbstractPlugin),s=t;s._capabilities=null,s._panningModel="equalpower",s.context=null,s._scratchBuffer=null,s._unlocked=!1,s.DEFAULT_SAMPLE_RATE=44100,s.isSupported=function(){var t=createjs.BrowserDetect.isIOS||createjs.BrowserDetect.isAndroid||createjs.BrowserDetect.isBlackberry;return!("file:"==location.protocol&&!t&&!this._isFileXHRSupported())&&(s._generateCapabilities(),null!=s.context)},s.playEmptySound=function(){if(null!=s.context){var t=s.context.createBufferSource();t.buffer=s._scratchBuffer,t.connect(s.context.destination),t.start(0,0,0)}},s._isFileXHRSupported=function(){var e=!0,t=new XMLHttpRequest;try{t.open("GET","WebAudioPluginTest.fail",!1)}catch(t){return e=!1}t.onerror=function(){e=!1},t.onload=function(){e=404==this.status||200==this.status||0==this.status&&""!=this.response};try{t.send()}catch(t){e=!1}return e},s._generateCapabilities=function(){if(null==s._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;if(null==s.context&&(s.context=s._createAudioContext(),null==s.context))return null;null==s._scratchBuffer&&(s._scratchBuffer=s.context.createBuffer(1,1,22050)),s._compatibilitySetUp(),"ontouchstart"in window&&"running"!=s.context.state&&(s._unlock(),document.addEventListener("mousedown",s._unlock,!0),document.addEventListener("touchstart",s._unlock,!0),document.addEventListener("touchend",s._unlock,!0)),s._capabilities={panning:!0,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,i=createjs.Sound.EXTENSION_MAP,n=0,r=e.length;n<r;n++){var a=e[n],o=i[a]||a;s._capabilities[a]="no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)||"no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)}s.context.destination.numberOfChannels<2&&(s._capabilities.panning=!1)}},s._createAudioContext=function(){var t=window.AudioContext||window.webkitAudioContext;if(null==t)return null;var e=new t;if(/(iPhone|iPad)/i.test(navigator.userAgent)&&e.sampleRate!==s.DEFAULT_SAMPLE_RATE){var i=e.createBuffer(1,1,s.DEFAULT_SAMPLE_RATE),n=e.createBufferSource();n.buffer=i,n.connect(e.destination),n.start(0),n.disconnect(),e.close(),e=new t}return e},s._compatibilitySetUp=function(){if(s._panningModel="equalpower",!s.context.createGain){s.context.createGain=s.context.createGainNode;var t=s.context.createBufferSource();t.__proto__.start=t.__proto__.noteGrainOn,t.__proto__.stop=t.__proto__.noteOff,s._panningModel=0}},s._unlock=function(){s._unlocked||(s.playEmptySound(),"running"==s.context.state&&(document.removeEventListener("mousedown",s._unlock,!0),document.removeEventListener("touchend",s._unlock,!0),document.removeEventListener("touchstart",s._unlock,!0),s._unlocked=!0))},e.toString=function(){return"[WebAudioPlugin]"},e._addPropsToClasses=function(){var t=this._soundInstanceClass;t.context=this.context,t._scratchBuffer=s._scratchBuffer,t.destinationNode=this.gainNode,t._panningModel=this._panningModel,this._loaderClass.context=this.context},e._updateVolume=function(){var t=createjs.Sound._masterMute?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},createjs.WebAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){function t(){throw"HTMLAudioTagPool cannot be instantiated"}function e(t){this._tags=[]}var i=t;i._tags={},i._tagPool=new e,i._tagUsed={},i.get=function(t){var e=i._tags[t];return null==e?(e=i._tags[t]=i._tagPool.get()).src=t:i._tagUsed[t]?(e=i._tagPool.get()).src=t:i._tagUsed[t]=!0,e},i.set=function(t,e){e==i._tags[t]?i._tagUsed[t]=!1:i._tagPool.set(e)},i.remove=function(t){var e=i._tags[t];return null!=e&&(i._tagPool.set(e),delete i._tags[t],delete i._tagUsed[t],!0)},i.getDuration=function(t){var e=i._tags[t];return null!=e&&e.duration?1e3*e.duration:0},createjs.HTMLAudioTagPool=t;var n=e.prototype;n.constructor=e,n.get=function(){var t;return null==(t=0==this._tags.length?this._createTag():this._tags.pop()).parentNode&&document.body.appendChild(t),t},n.set=function(t){-1==createjs.indexOf(this._tags,t)&&(this._tags.src=null,this._tags.push(t))},n.toString=function(){return"[TagPool]"},n._createTag=function(){var t=document.createElement("audio");return t.autoplay=!1,t.preload="none",t}}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this._audioSpriteStopTime=null,this._delayTimeoutId=null,this._endedHandler=createjs.proxy(this._handleSoundComplete,this),this._readyHandler=createjs.proxy(this._handleTagReady,this),this._stalledHandler=createjs.proxy(this._playFailed,this),this._audioSpriteEndHandler=createjs.proxy(this._handleAudioSpriteLoop,this),this._loopHandler=createjs.proxy(this._handleSoundComplete,this),i?this._audioSpriteStopTime=.001*(e+i):this._duration=createjs.HTMLAudioTagPool.getDuration(this.src)}var e=createjs.extend(t,createjs.AbstractSoundInstance);e.setMasterVolume=function(t){this._updateVolume()},e.setMasterMute=function(t){this._updateVolume()},e.toString=function(){return"[HTMLAudioSoundInstance]"},e._removeLooping=function(){null!=this._playbackResource&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._addLooping=function(){null==this._playbackResource||this._audioSpriteStopTime||(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)},e._handleCleanUp=function(){var t=this._playbackResource;if(null!=t){t.pause(),t.loop=!1,t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1);try{t.currentTime=this._startTime}catch(t){}createjs.HTMLAudioTagPool.set(this.src,t),this._playbackResource=null}},e._beginPlaying=function(t){return this._playbackResource=createjs.HTMLAudioTagPool.get(this.src),this.AbstractSoundInstance__beginPlaying(t)},e._handleSoundReady=function(t){if(4!==this._playbackResource.readyState){var e=this._playbackResource;return e.addEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),e.addEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),e.preload="auto",void e.load()}this._updateVolume(),this._playbackResource.currentTime=.001*(this._startTime+this._position),this._audioSpriteStopTime?this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1):(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),0!=this._loop&&(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)),this._playbackResource.play()},e._handleTagReady=function(t){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),this._handleSoundReady()},e._pause=function(){this._playbackResource.pause()},e._resume=function(){this._playbackResource.play()},e._updateVolume=function(){if(null!=this._playbackResource){var t=this._muted||createjs.Sound._masterMute?0:this._volume*createjs.Sound._masterVolume;t!=this._playbackResource.volume&&(this._playbackResource.volume=t)}},e._calculateCurrentPosition=function(){return 1e3*this._playbackResource.currentTime-this._startTime},e._updatePosition=function(){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1);try{this._playbackResource.currentTime=.001*(this._position+this._startTime)}catch(t){this._handleSetPositionSeek(null)}},e._handleSetPositionSeek=function(t){null!=this._playbackResource&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._handleAudioSpriteLoop=function(t){this._playbackResource.currentTime<=this._audioSpriteStopTime||(this._playbackResource.pause(),0==this._loop?this._handleSoundComplete(null):(this._position=0,this._loop--,this._playbackResource.currentTime=.001*this._startTime,this._paused||this._playbackResource.play(),this._sendEvent("loop")))},e._handleLoop=function(t){0==this._loop&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._updateStartTime=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},e._updateDuration=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},e._setDurationFromSource=function(){this._duration=createjs.HTMLAudioTagPool.getDuration(this.src),this._playbackResource=null},createjs.HTMLAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){function t(){this.AbstractPlugin_constructor(),this._capabilities=s._capabilities,this._loaderClass=createjs.SoundLoader,this._soundInstanceClass=createjs.HTMLAudioSoundInstance}var e=createjs.extend(t,createjs.AbstractPlugin),s=t;s.MAX_INSTANCES=30,s._AUDIO_READY="canplaythrough",s._AUDIO_ENDED="ended",s._AUDIO_SEEKED="seeked",s._AUDIO_STALLED="stalled",s._TIME_UPDATE="timeupdate",s._capabilities=null,s.isSupported=function(){return s._generateCapabilities(),null!=s._capabilities},s._generateCapabilities=function(){if(null==s._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;s._capabilities={panning:!1,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,i=createjs.Sound.EXTENSION_MAP,n=0,r=e.length;n<r;n++){var a=e[n],o=i[a]||a;s._capabilities[a]="no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)||"no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)}}},e.register=function(t){var e=createjs.HTMLAudioTagPool.get(t.src),i=this.AbstractPlugin_register(t);return i.setTag(e),i},e.removeSound=function(t){this.AbstractPlugin_removeSound(t),createjs.HTMLAudioTagPool.remove(t)},e.create=function(t,e,i){var n=this.AbstractPlugin_create(t,e,i);return n.playbackResource=null,n},e.toString=function(){return"[HTMLAudioPlugin]"},e.setVolume=e.getVolume=e.setMute=null,createjs.HTMLAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){function t(t){this.EventDispatcher_constructor(),this.ignoreGlobalPause=!1,this.loop=0,this.useTicks=!1,this.reversed=!1,this.bounce=!1,this.timeScale=1,this.duration=0,this.position=0,this.rawPosition=-1,this._paused=!0,this._next=null,this._prev=null,this._parent=null,this._labels=null,this._labelList=null,t&&(this.useTicks=!!t.useTicks,this.ignoreGlobalPause=!!t.ignoreGlobalPause,this.loop=!0===t.loop?-1:t.loop||0,this.reversed=!!t.reversed,this.bounce=!!t.bounce,this.timeScale=t.timeScale||1,t.onChange&&this.addEventListener("change",t.onChange),t.onComplete&&this.addEventListener("complete",t.onComplete))}var e=createjs.extend(t,createjs.EventDispatcher);e._setPaused=function(t){return createjs.Tween._register(this,t),this},e.setPaused=createjs.deprecate(e._setPaused,"AbstractTween.setPaused"),e._getPaused=function(){return this._paused},e.getPaused=createjs.deprecate(e._getPaused,"AbstactTween.getPaused"),e._getCurrentLabel=function(t){var e=this.getLabels();null==t&&(t=this.position);for(var i=0,n=e.length;i<n&&!(t<e[i].position);i++);return 0===i?null:e[i-1].label},e.getCurrentLabel=createjs.deprecate(e._getCurrentLabel,"AbstractTween.getCurrentLabel");try{Object.defineProperties(e,{paused:{set:e._setPaused,get:e._getPaused},currentLabel:{get:e._getCurrentLabel}})}catch(t){}e.advance=function(t,e){this.setPosition(this.rawPosition+t*this.timeScale,e)},e.setPosition=function(t,e,i,n){var r=this.duration,a=this.loop,o=this.rawPosition,s=0,l=0,c=!1;if(t<0&&(t=0),0===r){if(c=!0,-1!==o)return c}else{if(l=t-(s=t/r|0)*r,(c=-1!==a&&a*r+r<=t)&&(t=(l=r)*(s=a)+r),t===o)return c;!this.reversed!=!(this.bounce&&s%2)&&(l=r-l)}this.position=l,this.rawPosition=t,this._updatePosition(i,c),c&&(this.paused=!0),n&&n(this),e||this._runActions(o,t,i,!i&&-1===o),this.dispatchEvent("change"),c&&this.dispatchEvent("complete")},e.calculatePosition=function(t){var e=this.duration,i=this.loop,n=0,r=0;return 0===e?0:(-1!==i&&i*e+e<=t?(r=e,n=i):r=t<0?0:t-(n=t/e|0)*e,!this.reversed!=!(this.bounce&&n%2)?e-r:r)},e.getLabels=function(){var t=this._labelList;if(!t){t=this._labelList=[];var e=this._labels;for(var i in e)t.push({label:i,position:e[i]});t.sort(function(t,e){return t.position-e.position})}return t},e.setLabels=function(t){this._labels=t,this._labelList=null},e.addLabel=function(t,e){this._labels||(this._labels={}),this._labels[t]=e;var i=this._labelList;if(i){for(var n=0,r=i.length;n<r&&!(e<i[n].position);n++);i.splice(n,0,{label:t,position:e})}},e.gotoAndPlay=function(t){this.paused=!1,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.resolve=function(t){var e=Number(t);return isNaN(e)&&(e=this._labels&&this._labels[t]),e},e.toString=function(){return"[AbstractTween]"},e.clone=function(){throw"AbstractTween can not be cloned."},e._init=function(t){t&&t.paused||(this.paused=!1),t&&null!=t.position&&this.setPosition(t.position)},e._updatePosition=function(t,e){},e._goto=function(t){var e=this.resolve(t);null!=e&&this.setPosition(e,!1,!0)},e._runActions=function(t,e,i,n){if(this._actionHead||this.tweens){var r,a,o,s,l=this.duration,c=this.reversed,h=this.bounce,u=this.loop;if(0===l?(r=a=o=s=0,c=h=!1):(o=t-(r=t/l|0)*l,s=e-(a=e/l|0)*l),-1!==u&&(u<a&&(s=l,a=u),u<r&&(o=l,r=u)),i)return this._runActionsRange(s,s,i,n);if(r!==a||o!==s||i||n){-1===r&&(r=o=0);var d=t<=e,p=r;do{var f=p===r?o:d?0:l,m=p===a?s:d?l:0;if(!c!=!(h&&p%2)&&(f=l-f,m=l-m),h&&p!==r&&f===m);else if(this._runActionsRange(f,m,i,n||p!==r&&!h))return!0;n=!1}while(d&&++p<=a||!d&&--p>=a)}}},e._runActionsRange=function(t,e,i,n){},createjs.AbstractTween=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function v(t,e){this.AbstractTween_constructor(e),this.pluginData=null,this.target=t,this.passive=!1,this._stepHead=new a(null,0,0,{},null,!0),this._stepTail=this._stepHead,this._stepPosition=0,this._actionHead=null,this._actionTail=null,this._plugins=null,this._pluginIds=null,this._injected=null,e&&(this.pluginData=e.pluginData,e.override&&v.removeTweens(t)),this.pluginData||(this.pluginData={}),this._init(e)}function a(t,e,i,n,r,a){this.next=null,this.prev=t,this.t=e,this.d=i,this.props=n,this.ease=r,this.passive=a,this.index=t?t.index+1:0}function r(t,e,i,n,r){this.next=null,this.prev=t,this.t=e,this.d=0,this.scope=i,this.funct=n,this.params=r}var t=createjs.extend(v,createjs.AbstractTween);v.IGNORE={},v._tweens=[],v._plugins=null,v._tweenHead=null,v._tweenTail=null,v.get=function(t,e){return new v(t,e)},v.tick=function(t,e){for(var i=v._tweenHead;i;){var n=i._next;e&&!i.ignoreGlobalPause||i._paused||i.advance(i.useTicks?1:t),i=n}},v.handleEvent=function(t){"tick"===t.type&&this.tick(t.delta,t.paused)},v.removeTweens=function(t){if(t.tweenjs_count){for(var e=v._tweenHead;e;){var i=e._next;e.target===t&&v._register(e,!0),e=i}t.tweenjs_count=0}},v.removeAllTweens=function(){for(var t=v._tweenHead;t;){var e=t._next;t._paused=!0,t.target&&(t.target.tweenjs_count=0),t._next=t._prev=null,t=e}v._tweenHead=v._tweenTail=null},v.hasActiveTweens=function(t){return t?!!t.tweenjs_count:!!v._tweenHead},v._installPlugin=function(t){for(var e=t.priority=t.priority||0,i=v._plugins=v._plugins||[],n=0,r=i.length;n<r&&!(e<i[n].priority);n++);i.splice(n,0,t)},v._register=function(t,e){var i=t.target;if(!e&&t._paused){i&&(i.tweenjs_count=i.tweenjs_count?i.tweenjs_count+1:1);var n=v._tweenTail;n?(v._tweenTail=n._next=t,t._prev=n):v._tweenHead=v._tweenTail=t,!v._inited&&createjs.Ticker&&(createjs.Ticker.addEventListener("tick",v),v._inited=!0)}else if(e&&!t._paused){i&&i.tweenjs_count--;var r=t._next,a=t._prev;r?r._prev=a:v._tweenTail=a,a?a._next=r:v._tweenHead=r,t._next=t._prev=null}t._paused=e},t.wait=function(t,e){return 0<t&&this._addStep(+t,this._stepTail.props,null,e),this},t.to=function(t,e,i){(null==e||e<0)&&(e=0);var n=this._addStep(+e,null,i);return this._appendProps(t,n),this},t.label=function(t){return this.addLabel(t,this.duration),this},t.call=function(t,e,i){return this._addAction(i||this.target,t,e||[this])},t.set=function(t,e){return this._addAction(e||this.target,this._set,[t])},t.play=function(t){return this._addAction(t||this,this._set,[{paused:!1}])},t.pause=function(t){return this._addAction(t||this,this._set,[{paused:!0}])},t.w=t.wait,t.t=t.to,t.c=t.call,t.s=t.set,t.toString=function(){return"[Tween]"},t.clone=function(){throw"Tween can not be cloned."},t._addPlugin=function(t){var e=this._pluginIds||(this._pluginIds={}),i=t.ID;if(i&&!e[i]){e[i]=!0;for(var n=this._plugins||(this._plugins=[]),r=t.priority||0,a=0,o=n.length;a<o;a++)if(r<n[a].priority)return void n.splice(a,0,t);n.push(t)}},t._updatePosition=function(t,e){var i=this._stepHead.next,n=this.position,r=this.duration;if(this.target&&i){for(var a=i.next;a&&a.t<=n;)a=(i=i.next).next;var o=e?0===r?1:n/r:(n-i.t)/i.d;this._updateTargetProps(i,o,e)}this._stepPosition=i?n-i.t:0},t._updateTargetProps=function(t,e,i){if(!(this.passive=!!t.passive)){var n,r,a,o,s=t.prev.props,l=t.props;(o=t.ease)&&(e=o(e,0,1,1));var c=this._plugins;t:for(var h in s){if(n=(r=s[h])!==(a=l[h])&&"number"==typeof r?r+(a-r)*e:1<=e?a:r,c)for(var u=0,d=c.length;u<d;u++){var p=c[u].change(this,t,h,n,e,i);if(p===v.IGNORE)continue t;void 0!==p&&(n=p)}this.target[h]=n}}},t._runActionsRange=function(t,e,i,n){var r=e<t,a=r?this._actionTail:this._actionHead,o=e,s=t;r&&(o=t,s=e);for(var l=this.position;a;){var c=a.t;if((c===e||s<c&&c<o||n&&c===t)&&(a.funct.apply(a.scope,a.params),l!==this.position))return!0;a=r?a.prev:a.next}},t._appendProps=function(t,e,i){var n,r,a,o,s,l=this._stepHead.props,c=this.target,h=v._plugins,u=e.prev,d=u.props,p=e.props||(e.props=this._cloneProps(d)),f={};for(n in t)if(t.hasOwnProperty(n)&&(f[n]=p[n]=t[n],void 0===l[n])){if(o=void 0,h)for(r=h.length-1;0<=r;r--)if(void 0!==(a=h[r].init(this,n,o))&&(o=a),o===v.IGNORE){delete p[n],delete f[n];break}o!==v.IGNORE&&(void 0===o&&(o=c[n]),d[n]=void 0===o?null:o)}for(n in f){a=t[n];for(var m,g=u;(m=g)&&(g=m.prev);)if(g.props!==m.props){if(void 0!==g.props[n])break;g.props[n]=d[n]}}if(!1!==i&&(h=this._plugins))for(r=h.length-1;0<=r;r--)h[r].step(this,e,f);(s=this._injected)&&(this._injected=null,this._appendProps(s,e,!1))},t._injectProp=function(t,e){(this._injected||(this._injected={}))[t]=e},t._addStep=function(t,e,i,n){var r=new a(this._stepTail,this.duration,t,e,i,n||!1);return this.duration+=t,this._stepTail=this._stepTail.next=r},t._addAction=function(t,e,i){var n=new r(this._actionTail,this.duration,t,e,i);return this._actionTail?this._actionTail.next=n:this._actionHead=n,this._actionTail=n,this},t._set=function(t){for(var e in t)this[e]=t[e]},t._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},createjs.Tween=createjs.promote(v,"AbstractTween")}(),this.createjs=this.createjs||{},function(){function t(t){var e,i;t instanceof Array||null==t&&1<arguments.length?(e=t,i=arguments[1],t=arguments[2]):t&&(e=t.tweens,i=t.labels),this.AbstractTween_constructor(t),this.tweens=[],e&&this.addTween.apply(this,e),this.setLabels(i),this._init(t)}var e=createjs.extend(t,createjs.AbstractTween);e.addTween=function(t){t._parent&&t._parent.removeTween(t);var e=arguments.length;if(1<e){for(var i=0;i<e;i++)this.addTween(arguments[i]);return arguments[e-1]}if(0===e)return null;this.tweens.push(t),t._parent=this,t.paused=!0;var n=t.duration;return 0<t.loop&&(n*=t.loop+1),n>this.duration&&(this.duration=n),0<=this.rawPosition&&t.setPosition(this.rawPosition),t},e.removeTween=function(t){var e=arguments.length;if(1<e){for(var i=!0,n=0;n<e;n++)i=i&&this.removeTween(arguments[n]);return i}if(0===e)return!0;var r=this.tweens;for(n=r.length;n--;)if(r[n]===t)return r.splice(n,1),t._parent=null,t.duration>=this.duration&&this.updateDuration(),!0;return!1},e.updateDuration=function(){for(var t=this.duration=0,e=this.tweens.length;t<e;t++){var i=this.tweens[t],n=i.duration;0<i.loop&&(n*=i.loop+1),n>this.duration&&(this.duration=n)}},e.toString=function(){return"[Timeline]"},e.clone=function(){throw"Timeline can not be cloned."},e._updatePosition=function(t,e){for(var i=this.position,n=0,r=this.tweens.length;n<r;n++)this.tweens[n].setPosition(i,!0,t)},e._runActionsRange=function(t,e,i,n){for(var r=this.position,a=0,o=this.tweens.length;a<o;a++)if(this.tweens[a]._runActions(t,e,i,n),r!==this.position)return!0},createjs.Timeline=createjs.promote(t,"AbstractTween")}(),this.createjs=this.createjs||{},function(){function e(){throw"Ease cannot be instantiated."}e.none=e.linear=function(t){return t},e.get=function(e){return e<-1?e=-1:1<e&&(e=1),function(t){return 0==e?t:e<0?t*(t*-e+1+e):t*((2-t)*e+(1-e))}},e.getPowIn=function(e){return function(t){return Math.pow(t,e)}},e.getPowOut=function(e){return function(t){return 1-Math.pow(1-t,e)}},e.getPowInOut=function(e){return function(t){return(t*=2)<1?.5*Math.pow(t,e):1-.5*Math.abs(Math.pow(2-t,e))}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(e){return function(t){return t*t*((e+1)*t-e)}},e.backIn=e.getBackIn(1.7),e.getBackOut=function(e){return function(t){return--t*t*((e+1)*t+e)+1}},e.backOut=e.getBackOut(1.7),e.getBackInOut=function(e){return e*=1.525,function(t){return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},e.backInOut=e.getBackInOut(1.7),e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return t<.5?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(i,n){var r=2*Math.PI;return function(t){if(0==t||1==t)return t;var e=n/r*Math.asin(1/i);return-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*r/n)}},e.elasticIn=e.getElasticIn(1,.3),e.getElasticOut=function(i,n){var r=2*Math.PI;return function(t){if(0==t||1==t)return t;var e=n/r*Math.asin(1/i);return i*Math.pow(2,-10*t)*Math.sin((t-e)*r/n)+1}},e.elasticOut=e.getElasticOut(1,.3),e.getElasticInOut=function(i,n){var r=2*Math.PI;return function(t){var e=n/r*Math.asin(1/i);return(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*r/n)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*r/n)*.5+1}},e.elasticInOut=e.getElasticInOut(1,.3*1.5),createjs.Ease=e}(),this.createjs=this.createjs||{},function(){function t(){throw"MotionGuidePlugin cannot be instantiated."}var T=t;T.priority=0,T.ID="MotionGuide",T.install=function(){return createjs.Tween._installPlugin(t),createjs.Tween.IGNORE},T.init=function(t,e,i){"guide"==e&&t._addPlugin(T)},T.step=function(t,e,i){for(var n in i)if("guide"===n){var r=e.props.guide,a=T._solveGuideData(i.guide,r);r.valid=!a;var o=r.endData;if(t._injectProp("x",o.x),t._injectProp("y",o.y),a||!r.orient)break;var s=void 0===e.prev.props.rotation?t.target.rotation||0:e.prev.props.rotation;if(r.startOffsetRot=s-r.startData.rotation,"fixed"==r.orient)r.endAbsRot=o.rotation+r.startOffsetRot,r.deltaRotation=0;else{var l=void 0===i.rotation?t.target.rotation||0:i.rotation,c=l-r.endData.rotation-r.startOffsetRot,h=c%360;switch(r.endAbsRot=l,r.orient){case"auto":r.deltaRotation=c;break;case"cw":r.deltaRotation=(h+360)%360+360*Math.abs(c/360|0);break;case"ccw":r.deltaRotation=(h-360)%360+-360*Math.abs(c/360|0)}}t._injectProp("rotation",r.endAbsRot)}},T.change=function(t,e,i,n,r,a){var o=e.props.guide;if(o&&e.props!==e.prev.props&&o!==e.prev.props.guide)return"guide"===i&&!o.valid||"x"==i||"y"==i||"rotation"===i&&o.orient?createjs.Tween.IGNORE:void T._ratioToPositionData(r,o,t.target)},T.debug=function(t,e,i){t=t.guide||t;var n=T._findPathProblems(t);if(n&&console.error("MotionGuidePlugin Error found: \n"+n),!e)return n;var r=t.path,a=r.length;for(e.save(),e.lineCap="round",e.lineJoin="miter",e.beginPath(),e.moveTo(r[0],r[1]),c=2;c<a;c+=4)e.quadraticCurveTo(r[c],r[c+1],r[c+2],r[c+3]);e.strokeStyle="black",e.lineWidth=4.5,e.stroke(),e.strokeStyle="white",e.lineWidth=3,e.stroke(),e.closePath();var o=i.length;if(i&&o){var s={},l={};T._solveGuideData(t,s);for(var c=0;c<o;c++)s.orient="fixed",T._ratioToPositionData(i[c],s,l),e.beginPath(),e.moveTo(l.x,l.y),e.lineTo(l.x+9*Math.cos(.0174533*l.rotation),l.y+9*Math.sin(.0174533*l.rotation)),e.strokeStyle="black",e.lineWidth=4.5,e.stroke(),e.strokeStyle="red",e.lineWidth=3,e.stroke(),e.closePath()}return e.restore(),n},T._solveGuideData=function(t,e){var i;if(i=T.debug(t))return i;var n=e.path=t.path;e.orient=t.orient,e.subLines=[],e.totalLength=0,e.startOffsetRot=0,e.deltaRotation=0,e.startData={ratio:0},e.endData={ratio:1},e.animSpan=1;var r,a,o,s,l,c,h,u,d,p=n.length,f={};for(r=n[0],a=n[1],h=2;h<p;h+=4){o=n[h],s=n[h+1],l=n[h+2],c=n[h+3];var m={weightings:[],estLength:0,portion:0},g=r,v=a;for(u=1;u<=10;u++){T._getParamsForCurve(r,a,o,s,l,c,u/10,!1,f);var y=f.x-g,_=f.y-v;d=Math.sqrt(y*y+_*_),m.weightings.push(d),m.estLength+=d,g=f.x,v=f.y}for(e.totalLength+=m.estLength,u=0;u<10;u++)d=m.estLength,m.weightings[u]=m.weightings[u]/d;e.subLines.push(m),r=l,a=c}d=e.totalLength;var b=e.subLines.length;for(h=0;h<b;h++)e.subLines[h].portion=e.subLines[h].estLength/d;var x=isNaN(t.start)?0:t.start,w=isNaN(t.end)?1:t.end;T._ratioToPositionData(x,e,e.startData),T._ratioToPositionData(w,e,e.endData),e.startData.ratio=x,e.endData.ratio=w,e.animSpan=e.endData.ratio-e.startData.ratio},T._ratioToPositionData=function(t,e,i){var n,r,a,o,s,l=e.subLines,c=0,h=t*e.animSpan+e.startData.ratio;for(r=l.length,n=0;n<r;n++){if(h<=c+(o=l[n].portion)){s=n;break}c+=o}void 0===s&&(s=r-1,c-=o);var u=l[s].weightings,d=o;for(r=u.length,n=0;n<r&&!(h<=c+(o=u[n]*d));n++)c+=o;s=4*s+2,a=n/10+(h-c)/o*.1;var p=e.path;return T._getParamsForCurve(p[s-2],p[s-1],p[s],p[s+1],p[s+2],p[s+3],a,e.orient,i),e.orient&&(.99999<=t&&t<=1.00001&&void 0!==e.endAbsRot?i.rotation=e.endAbsRot:i.rotation+=e.startOffsetRot+t*e.deltaRotation),i},T._getParamsForCurve=function(t,e,i,n,r,a,o,s,l){var c=1-o;l.x=c*c*t+2*c*o*i+o*o*r,l.y=c*c*e+2*c*o*n+o*o*a,s&&(l.rotation=57.2957795*Math.atan2((n-e)*c+(a-n)*o,(i-t)*c+(r-i)*o))},T._findPathProblems=function(t){var e=t.path,i=e&&e.length||0;if(i<6||(i-2)%4){var n="\tCannot parse 'path' array due to invalid number of entries in path. ";return n+="There should be an odd number of points, at least 3 points, and 2 entries per point (x & y). ",(n+="See 'CanvasRenderingContext2D.quadraticCurveTo' for details as 'path' models a quadratic bezier.\n\n")+"Only [ "+i+" ] values found. Expected: "+Math.max(4*Math.ceil((i-2)/4)+2,6)}for(var r=0;r<i;r++)if(isNaN(e[r]))return"All data in path array must be numeric";var a=t.start;if(isNaN(a)&&void 0!==a)return"'start' out of bounds. Expected 0 to 1, got: "+a;var o=t.end;if(isNaN(o)&&void 0!==o)return"'end' out of bounds. Expected 0 to 1, got: "+o;var s=t.orient;return s&&"fixed"!=s&&"auto"!=s&&"cw"!=s&&"ccw"!=s?'Invalid orientation value. Expected ["fixed", "auto", "cw", "ccw", undefined], got: '+s:void 0},createjs.MotionGuidePlugin=t}(),this.createjs=this.createjs||{},function(){var t=createjs.TweenJS=createjs.TweenJS||{};t.version="1.0.0",t.buildDate="Thu, 12 Oct 2017 16:34:05 GMT"}();var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function stackBlurImage(t,e,i,n,r,a,o,s){document.getElementsByClassName(e)[0];isNaN(i)||i<1||(n?stackBlurCanvasRGBA(e,r,a,o,s,i):stackBlurCanvasRGB(e,r,a,o,s,i))}function stackBlurCanvasRGBA(t,e,i,n,r,a){if(!(isNaN(a)||a<1)){a|=0;var o,s=document.getElementsByClassName(t).getContext("2d");try{try{o=s.getImageData(e,i,n,r)}catch(t){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),o=s.getImageData(e,i,n,r)}catch(t){throw alert("Cannot access local image"),new Error("unable to access local image data: "+t)}}}catch(t){throw alert("Cannot access image"),new Error("unable to access image data: "+t)}var l,c,h,u,d,p,f,m,g,v,y,_,b,x,w,T,M,S,E,C,L,A,P,R,O=o.data,I=a+a+1,D=n-1,j=r-1,k=a+1,N=k*(k+1)/2,F=new BlurStack,B=F;for(h=1;h<I;h++)if(B=B.next=new BlurStack,h==k)var H=B;B.next=F;var U=null,z=null;f=p=0;var V=mul_table[a],G=shg_table[a];for(c=0;c<r;c++){for(T=M=S=E=m=g=v=y=0,_=k*(C=O[p]),b=k*(L=O[p+1]),x=k*(A=O[p+2]),w=k*(P=O[p+3]),m+=N*C,g+=N*L,v+=N*A,y+=N*P,B=F,h=0;h<k;h++)B.r=C,B.g=L,B.b=A,B.a=P,B=B.next;for(h=1;h<k;h++)u=p+((D<h?D:h)<<2),m+=(B.r=C=O[u])*(R=k-h),g+=(B.g=L=O[u+1])*R,v+=(B.b=A=O[u+2])*R,y+=(B.a=P=O[u+3])*R,T+=C,M+=L,S+=A,E+=P,B=B.next;for(U=F,z=H,l=0;l<n;l++)O[p+3]=P=y*V>>G,0!=P?(P=255/P,O[p]=(m*V>>G)*P,O[p+1]=(g*V>>G)*P,O[p+2]=(v*V>>G)*P):O[p]=O[p+1]=O[p+2]=0,m-=_,g-=b,v-=x,y-=w,_-=U.r,b-=U.g,x-=U.b,w-=U.a,u=f+((u=l+a+1)<D?u:D)<<2,m+=T+=U.r=O[u],g+=M+=U.g=O[u+1],v+=S+=U.b=O[u+2],y+=E+=U.a=O[u+3],U=U.next,_+=C=z.r,b+=L=z.g,x+=A=z.b,w+=P=z.a,T-=C,M-=L,S-=A,E-=P,z=z.next,p+=4;f+=n}for(l=0;l<n;l++){for(M=S=E=T=g=v=y=m=0,_=k*(C=O[p=l<<2]),b=k*(L=O[p+1]),x=k*(A=O[p+2]),w=k*(P=O[p+3]),m+=N*C,g+=N*L,v+=N*A,y+=N*P,B=F,h=0;h<k;h++)B.r=C,B.g=L,B.b=A,B.a=P,B=B.next;for(d=n,h=1;h<=a;h++)p=d+l<<2,m+=(B.r=C=O[p])*(R=k-h),g+=(B.g=L=O[p+1])*R,v+=(B.b=A=O[p+2])*R,y+=(B.a=P=O[p+3])*R,T+=C,M+=L,S+=A,E+=P,B=B.next,h<j&&(d+=n);for(p=l,U=F,z=H,c=0;c<r;c++)O[(u=p<<2)+3]=P=y*V>>G,0<P?(P=255/P,O[u]=(m*V>>G)*P,O[u+1]=(g*V>>G)*P,O[u+2]=(v*V>>G)*P):O[u]=O[u+1]=O[u+2]=0,m-=_,g-=b,v-=x,y-=w,_-=U.r,b-=U.g,x-=U.b,w-=U.a,u=l+((u=c+k)<j?u:j)*n<<2,m+=T+=U.r=O[u],g+=M+=U.g=O[u+1],v+=S+=U.b=O[u+2],y+=E+=U.a=O[u+3],U=U.next,_+=C=z.r,b+=L=z.g,x+=A=z.b,w+=P=z.a,T-=C,M-=L,S-=A,E-=P,z=z.next,p+=n}s.putImageData(o,e,i)}}function stackBlurCanvasRGB(t,e,i,n,r,a){if(!(isNaN(a)||a<1)){a|=0;var o,s=document.getElementsByClassName(t)[0].getContext("2d");try{try{o=s.getImageData(e,i,n,r)}catch(t){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),o=s.getImageData(e,i,n,r)}catch(t){throw alert("Cannot access local image"),new Error("unable to access local image data: "+t)}}}catch(t){throw alert("Cannot access image"),new Error("unable to access image data: "+t)}var l,c,h,u,d,p,f,m,g,v,y,_,b,x,w,T,M,S,E,C,L=o.data,A=a+a+1,P=n-1,R=r-1,O=a+1,I=O*(O+1)/2,D=new BlurStack,j=D;for(h=1;h<A;h++)if(j=j.next=new BlurStack,h==O)var k=j;j.next=D;var N=null,F=null;f=p=0;var B=mul_table[a],H=shg_table[a];for(c=0;c<r;c++){for(x=w=T=m=g=v=0,y=O*(M=L[p]),_=O*(S=L[p+1]),b=O*(E=L[p+2]),m+=I*M,g+=I*S,v+=I*E,j=D,h=0;h<O;h++)j.r=M,j.g=S,j.b=E,j=j.next;for(h=1;h<O;h++)u=p+((P<h?P:h)<<2),m+=(j.r=M=L[u])*(C=O-h),g+=(j.g=S=L[u+1])*C,v+=(j.b=E=L[u+2])*C,x+=M,w+=S,T+=E,j=j.next;for(N=D,F=k,l=0;l<n;l++)L[p]=m*B>>H,L[p+1]=g*B>>H,L[p+2]=v*B>>H,m-=y,g-=_,v-=b,y-=N.r,_-=N.g,b-=N.b,u=f+((u=l+a+1)<P?u:P)<<2,m+=x+=N.r=L[u],g+=w+=N.g=L[u+1],v+=T+=N.b=L[u+2],N=N.next,y+=M=F.r,_+=S=F.g,b+=E=F.b,x-=M,w-=S,T-=E,F=F.next,p+=4;f+=n}for(l=0;l<n;l++){for(w=T=x=g=v=m=0,y=O*(M=L[p=l<<2]),_=O*(S=L[p+1]),b=O*(E=L[p+2]),m+=I*M,g+=I*S,v+=I*E,j=D,h=0;h<O;h++)j.r=M,j.g=S,j.b=E,j=j.next;for(d=n,h=1;h<=a;h++)p=d+l<<2,m+=(j.r=M=L[p])*(C=O-h),g+=(j.g=S=L[p+1])*C,v+=(j.b=E=L[p+2])*C,x+=M,w+=S,T+=E,j=j.next,h<R&&(d+=n);for(p=l,N=D,F=k,c=0;c<r;c++)L[u=p<<2]=m*B>>H,L[u+1]=g*B>>H,L[u+2]=v*B>>H,m-=y,g-=_,v-=b,y-=N.r,_-=N.g,b-=N.b,u=l+((u=c+O)<R?u:R)*n<<2,m+=x+=N.r=L[u],g+=w+=N.g=L[u+1],v+=T+=N.b=L[u+2],N=N.next,y+=M=F.r,_+=S=F.g,b+=E=F.b,x-=M,w-=S,T-=E,F=F.next,p+=n}s.putImageData(o,e,i)}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function ColorPalletCompClass(e){var o={},s={bgColorState:{normal:"rgb(255, 102, 0)",hover:"",down:"rgb(255, 0, 0)",disable:"#afafaf"},height:28,lowerColor:"rgba(255,255,255,1)",state:!0,imgList:["colour.png"],colorList:["#ff0000","#ff0000","#ff0000","#ff0000","#ff0000","#ff0000","#ff0000","#ff0000","#ff0000","#ff0000"],colorData:[],width:32,x:105,y:313,currentLevel:0,selected:NaN,baseToggle:!1,sliderBool:!1,show:!0,innerTrangle:{w:16,h:8},base:{color:"rgba(211, 211, 211,1)",borderColor:"rgba(255,255,255,0.5)",selectedColor:"rgb(255, 102, 0)",xDiff:20,trangle:{w:20,h:8},yDiff:20,radius:0,points:[],width:160,height:170,box:{outerW:40,outerH:40,innerW:30,innerH:30,borderColor:"rgba(255,255,255,1)"},allPath:{id:"Paths",text:"-",x:10,y:10,h:35,w:140,textPos:{x:0,y:0},border:{x:0,y:0,w:0,h:0}}},button:{points:[]},slider:{up:{x:125,y:100,state:"normal"},down:{x:125,y:130,state:"normal"},btnDim:{h:15,w:15,pad:3}},headFontSize:18,headFontColor:"#000000",position:"bottom",rotateAngle:0,text:"allPath_txt",jaws_text:"jaws_colorPallet",jaws_allPathText:"",jaws_uparrowText:"",jaws_downarrowText:"",jaws_colorBoxText:""},i=!1;Object.keys(e).forEach(function(t){s[t]=e[t]}),s.LabComClass.globalLangText[s.text]&&(s.base.allPath.text=s.LabComClass.globalLangText[s.text]);s.context.textWrapperClass({xNum:0,yNum:0,maxWidthNum:s.base.width,textStr:s.base.allPath.text,fontFamilyStr:s.LabComClass.klettFontRegular,fontSizeNum:s.headFontSize,fontColor:s.headFontColor});M(),x(),s.LabComClass.requestGlobalImage(s.imgList,function(t){t,onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:s.id}})},function(t){console.log("Images Loading Error...")});var n=document.createElement("div"),r=document.createElement("button"),a=new Image,l=document.createElement("div"),c=document.createElement("div"),h=document.createElement("div"),u=document.createElement("button"),d=document.createElement("div"),p=new Image,f=document.createTextNode(s.LabComClass.globalLangText[s.text]),m=document.createElement("button");m.id="up";var g=document.createElement("div"),v=document.createElement("button");v.id="down";var y=document.createElement("div"),_=document.createElement("div"),b=document.createElement("div");function x(){if(s.show&&s.state)if(s.state?n&&(n.addEventListener("mousedown",T),n.addEventListener("click",T),n.addEventListener("mouseup",T)):(n.removeEventListener("mousedown",T),n.removeEventListener("click",T),n.removeEventListener("mouseup",T)),s.baseToggle){window.addEventListener("click",w),u&&(u.removeEventListener("mousedown",T),u.removeEventListener("mouseup",T),u.removeEventListener("click",T),u.addEventListener("mousedown",T),u.addEventListener("mouseup",T),u.addEventListener("click",T)),d&&(d.removeEventListener("mousedown",T),d.removeEventListener("mouseup",T),d.removeEventListener("click",T),d.addEventListener("mousedown",T),d.addEventListener("mouseup",T),d.addEventListener("click",T)),"normal"===s.slider.up.state&&m&&(m.removeEventListener("mousedown",T),m.removeEventListener("mouseup",T),m.removeEventListener("click",T),m.addEventListener("mousedown",T),m.addEventListener("mouseup",T),m.addEventListener("click",T)),"normal"===s.slider.down.state&&v&&(v.removeEventListener("mousedown",T),v.removeEventListener("mouseup",T),v.removeEventListener("click",T),v.addEventListener("mousedown",T),v.addEventListener("mouseup",T),v.addEventListener("click",T));for(var t=0;t<s.colorData.length&&!(t+3*s.currentLevel>=s.colorList.length);t++){var e=document.getElementById("color_".concat(t+3*s.currentLevel));e&&(e.removeEventListener("mousedown",T),e.removeEventListener("mouseup",T),e.removeEventListener("click",T),e.addEventListener("mousedown",T),e.addEventListener("mouseup",T),e.addEventListener("click",T))}}else window.removeEventListener("click",w)}function w(t){t.target.id!==s.id&&(s.baseToggle=!1,h.style.display="none",x())}function T(t){switch(t.stopPropagation(),t.type){case"mousedown":if(t.target.id!==s.id&&"col"!==t.target.id||!s.state||(i=!0,r.style.backgroundColor=s.bgColorState.down),"down"===t.target.id)if("disable"===s.slider.down.state)v.style.backgroundColor=s.bgColorState[s.slider.down.state],document.getElementsByClassName("checkbox")[7].value===String(!0)?v.style.backgroundColor="#454540":v.style.backgroundColor=s.bgColorState[s.slider.down.state],v.setAttribute("aria-disabled",!0),t.stopPropagation();else s.slider.down.state="down",v.style.backgroundColor=s.bgColorState[s.slider.down.state];if("up"===t.target.id)if("disable"===s.slider.up.state)document.getElementsByClassName("checkbox")[7].value===String(!0)?m.style.backgroundColor="#454540":m.style.backgroundColor=s.bgColorState[s.slider.up.state],m.setAttribute("aria-disabled",!0),t.stopPropagation();else s.slider.up.state="down",m.style.backgroundColor=s.bgColorState[s.slider.up.state];break;case"click":t.target.classList.contains("colorbox")&&(t.target.id===s.id&&(i=!1),M(),function(t){var e=Math.ceil((s.colorList.length+1)/3);t.target.id===s.id||"col"===t.target.id?s.baseToggle?(s.baseToggle=!1,h.style.display="none"):s.state&&!s.baseToggle&&(s.baseToggle=!0,setTimeout(function(){document.getElementById("base")&&(window.trapFocus(document.getElementById("base")),u.focus())},200)):"up"===t.target.id?(0<s.currentLevel&&s.currentLevel--,0===s.currentLevel&&(s.currentLevel=0),setTimeout(function(){document.getElementById("base")&&(window.trapFocus(document.getElementById("base")),document.getElementById("up").focus())},200)):"down"===t.target.id?(5<s.colorList.length&&(s.currentLevel++,s.currentLevel>=e-1&&(s.currentLevel=e-2)),setTimeout(function(){document.getElementById("base")&&(window.trapFocus(document.getElementById("base")),document.getElementById("down").focus())},200)):(isNaN(t.target.id.split("_")[1])?s.selected=NaN:s.selected=t.target.id.split("_")[1],o.change&&o.change({id:s.id,value:s.selected}),s.baseToggle=!1,h.style.display="none");if(0===s.currentLevel){s.slider.up.state="disable";var i=document.getElementsByClassName("checkbox")[7].value;i===String(!0)?m.style.backgroundColor="#454540":m.style.backgroundColor=s.bgColorState[s.slider.up.state],m.setAttribute("aria-disabled",!0),m.style.cursor="default",g.style.cursor="default"}else{s.slider.up.state="normal";var n=document.getElementsByClassName("checkbox")[7].value;n===String(!0)?m.style.backgroundColor="#DB5800":m.style.backgroundColor=s.bgColorState[s.slider.up.state],m.setAttribute("aria-disabled",!1),m.tabIndex=0,m.style.cursor="pointer",g.style.cursor="pointer"}if(s.currentLevel>=Math.floor(s.colorList.length/3)-1){s.slider.down.state="disable";var r=document.getElementsByClassName("checkbox")[7].value;r===String(!0)?v.style.backgroundColor="#454540":v.style.backgroundColor=s.bgColorState[s.slider.down.state],v.setAttribute("aria-disabled",!0),v.style.cursor="default",y.style.cursor="default"}else{s.slider.down.state="normal";var a=document.getElementsByClassName("checkbox")[7].value;a===String(!0)?v.style.backgroundColor="#DB5800":v.style.backgroundColor=s.bgColorState[s.slider.down.state],v.setAttribute("aria-disabled",!1),v.tabIndex=0,v.style.cursor="pointer",y.style.cursor="pointer"}}(t),x()),onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"});break;case"mouseup":if(t.target.classList.contains("colorbox"))if(t.target.id===s.id||"col"===t.target.id)i=!1,document.getElementsByClassName("checkbox")[7].value===String(!0)?r.style.backgroundColor="#DB5800":r.style.backgroundColor=s.bgColorState.normal}}function M(){var t=s.x+s.width/2-16.5,e=s.y+s.height/2-16.5;s.button.points=[t,e,33,33];var i=s.base.allPath.y+s.base.allPath.h-s.base.box.outerH/2;s.base.height=i+2*s.base.box.outerH,s.colorList.length<4?s.base.height=i+2*s.base.box.outerH:s.base.height=i+3*s.base.box.outerH;for(var n,r=[{position:"left",angle:90,x:s.x-s.base.width-s.base.trangle.h,y:s.y-s.base.yDiff},{position:"bottom",angle:0,x:s.x-s.base.xDiff,y:s.y+s.height+s.base.trangle.h},{position:"right",angle:-90,x:s.x+s.width+s.base.trangle.h,y:s.y-s.base.yDiff},{position:"top",angle:180,x:s.x-s.base.xDiff,y:s.y-s.base.trangle.h-s.base.height+1}],a=0;a<r.length;a++)if(s.position===r[a].position){s.base.points=[r[a].x,r[a].y],s.rotateAngle=r[a].angle*Math.PI/180;break}s.base.allPath.points=[s.base.points[0]+s.base.allPath.x,s.base.points[1]+s.base.allPath.y],s.base.allPath.w=s.base.width-s.base.xDiff,s.base.allPath.h=s.base.box.outerH,s.base.allPath.points[2]=s.base.allPath.points[0]+(s.base.box.outerW-s.base.box.innerW)/2,s.base.allPath.points[3]=s.base.allPath.points[1]+(s.base.box.outerH-s.base.box.innerH)/2,s.base.allPath.textPos.x=s.base.allPath.points[2]+s.base.box.outerW,s.base.allPath.textPos.y=s.base.allPath.points[3];var o=s.base.points[1]+i;s.slider.up.y=o+s.base.box.outerH,s.slider.up.x=s.base.points[0]+s.base.width-s.slider.btnDim.w-s.slider.btnDim.pad,s.slider.down.x=s.base.points[0]+s.base.width-s.slider.btnDim.w-s.slider.btnDim.pad,s.colorData=[];for(a=0;a<s.colorList.length&&a<6;a++)a%3==0&&(n=s.base.allPath.points[0],o+=s.base.box.outerH),s.colorData[a]={},s.colorData[a].outerX=n,s.colorData[a].outerY=o+s.base.box.innerH/2-s.base.box.outerH/2,s.colorData[a].x=n+(s.base.box.outerW-s.base.box.innerW)/2,s.colorData[a].y=o,n+=s.base.box.outerW;s.slider.down.y=s.base.points[1]+s.base.height-s.slider.btnDim.h-s.slider.btnDim.pad,6<s.colorList.length?s.sliderBool=!0:s.sliderBool=!1}this.init=function(t){n.id=t.id,n.className="colorbox",n.style.width=t.width+"px",n.style.height=t.height+"px",n.style.position="absolute",n.style.left=t.x+"px",n.style.top=t.y+"px",n.style.borderWidth="0px",r.id="col",r.className="colorbox",r.style.position="fixed",r.style.width=t.width+"px",r.style.height=t.height+"px",r.style.left=t.x+"px",r.style.top=t.y+"px",r.style.borderWidth="0px",r.setAttribute("aria-label",t.LabComClass.globalLangText[t.jaws_text]),a.className="colorbox",a.style.pointerEvents="none",a.style.position="fixed",a.src="assets/images/".concat(t.imgList[0]),a.onload=function(){a.style.width="".concat(t.button.points[2]," px"),a.style.height="".concat(t.button.points[3],"px"),a.style.left=t.button.points[0]+"px",a.style.top=t.button.points[1]+"px"},l.className="colorbox",l.style.pointerEvents="none",l.style.width=t.button.points[2]+"px",l.style.height=t.button.points[3]+2+"px",l.style.position="fixed",l.style.left=t.button.points[0]+"px",l.style.top=t.button.points[1]-1+"px",l.style.backgroundColor=a,l.style.borderWidth="0px",c.className="colorbox",c.style.pointerEvents="none",c.style.position="fixed",c.style.left="1096px",c.style.top="657px",c.style.width="0px",c.style.height="0px",c.style.borderLeft="8px solid transparent",c.style.borderRight="8px solid transparent",c.style.borderBottom="9px solid white",d.className="colorbox",d.style.pointerEvents="none",d.style.position="static",d.style.width=t.base.box.innerW+"px",d.style.height=t.base.box.innerH+"px",d.style.left=t.base.allPath.points[2]+"px",d.style.top=t.base.allPath.points[3]+"px",d.style.backgroundColor=t.base.color,d.style.border="1px solid",d.style.borderColor=t.base.selectedColor,d.style.marginRight="0.65rem",d.style.cursor="pointer",p.className="colorbox",p.style.pointerEvents="none",p.src="assets/images/".concat(t.imgList[0]),p.onload=function(){p.style.width="".concat(t.base.box.innerW," px"),p.style.height="".concat(t.base.box.innerH,"px"),p.style.left=t.base.allPath.points[2]+"px",p.style.top=t.base.allPath.points[3]+"px"},t.show&&t.domLayer.appendChild(n),u.id=t.base.allPath.id,u.className="colorbox",u.style.position="static",u.style.display="flex",u.style.alignItems="center",u.style.width=t.base.allPath.w+"px",u.style.height=t.base.allPath.h+"px",u.style.backgroundColor=t.base.color,u.style.borderColor=t.base.selectedColor,u.style.marginTop="0.5rem",u.style.marginLeft="0.6rem",u.style.padding="4px",u.style.color=t.headFontColor,u.style.fontSize=t.headFontSize+"px",u.style.fontFamily=t.LabComClass.klettFontRegular,u.style.fontWeight="500",_.style.border="none",u.style.cursor="pointer",u.setAttribute("aria-label",t.LabComClass.globalLangText[t.jaws_allPathText])},this.init(s),this.addEventListener=function(t,e){o[t]=e},this.setValue=function(t){s.colorList=t.colors?t.colors:s.colorList,s.selected=void 0!==t.selected?t.selected:s.selected,isNaN(s.selected)&&(s.currentLevel=0),M(),x()},this.getValue=function(){return{colors:s.colorList,selected:s.selected}},this.enable=function(){s.state=!0,n.style.cursor="pointer",r.style.cursor="pointer",c.style.cursor="pointer",r.tabIndex=0,r.setAttribute("aria-disabled",!1),x()},this.disable=function(){s.state=!1,n.style.cursor="default",r.style.cursor="default",c.style.cursor="default",r.style.backgroundColor=s.bgColorState.disable,s.baseToggle=!1,h.style.display="none",r.setAttribute("aria-disabled",!0),x()},this.setPos=function(t,e){s.x=t,s.y=e,M(),x()},this.getPos=function(){return{x:s.x,y:s.y}},this.show=function(){s.show=!0,x()},this.hide=function(){s.show=!1,x()},this.draw=function(){if(s.show){if(s.state)if(i)r.style.backgroundColor=s.bgColorState.down;else document.getElementsByClassName("checkbox")[7].value===String(!0)?r.style.backgroundColor="#DB5800":r.style.backgroundColor=s.bgColorState.normal;else document.getElementsByClassName("checkbox")[7].value===String(!0)?r.style.backgroundColor="#454540":r.style.backgroundColor=s.bgColorState.disable,h.style.display="none";n.appendChild(r),n.appendChild(h),isNaN(s.selected)?(r.appendChild(a),0<r.children.length&&(r.innerHTML="",r.appendChild(a))):(l.style.backgroundColor=s.colorList[s.selected].value,r.appendChild(l))}if(n.appendChild(c),s.baseToggle){h.id="base",h.innerHTML="",h.appendChild(u),h.style.width=s.base.width+"px",h.style.height=s.base.height+"px",h.style.position="fixed",h.style.display="block",h.style.justifyContent="center",h.style.left=s.base.points[0]+"px",h.style.top=s.base.points[1]+"px",h.style.backgroundColor=s.base.color,h.style.border="1px solid",h.style.borderColor=s.base.borderColor,h.style.cursor="default",h.style.zIndex=1,b.style.position="fixed",b.style.left="1100px",b.style.top="649px",b.style.border="solid #f9f8f8",b.style.borderWidth="0 1px 1px 0",b.style.display="inline-block",b.style.padding="4px",b.style.transform="rotate(45deg)",h.appendChild(b),isNaN(s.selected)||h.appendChild(u),isNaN(s.selected)&&(u.style.border="1px solid",u.style.borderColor=s.base.selectedColor),u.appendChild(d),d.appendChild(p),u.appendChild(f);for(var t=0;t<s.colorData.length&&(0<=s.currentLevel&&Number(s.selected)===t+3*s.currentLevel&&(_.style.position="fixed",u.style.border="none",_.style.width=s.base.box.outerW+"px",_.style.height=s.base.box.outerH-1+"px",_.style.left=s.colorData[t].outerX+"px",_.style.top=s.colorData[t].outerY+"px",_.style.borderWidth="0px",_.style.cursor="pointer",_.style.backgroundColor=s.base.color,_.style.border="1px solid",_.style.borderColor=s.base.selectedColor,h.appendChild(_)),!(t+3*s.currentLevel>=s.colorList.length));t++){var e=document.createElement("button");e.className="colorbox",e.id="color_".concat(t+3*s.currentLevel),e.style.position="fixed",e.style.width=s.base.box.innerW+"px",e.style.height=s.base.box.innerH+"px",e.style.left=s.colorData[t].x+1+"px",e.style.top=s.colorData[t].y+1+"px",e.style.backgroundColor=s.colorList[t+3*s.currentLevel].value,e.style.border="1.5px solid",e.style.borderColor="white",e.style.cursor="pointer",e.setAttribute("aria-label",s.colorList[t+3*s.currentLevel].name),h.appendChild(e)}"normal"===s.slider.up.state&&(m.disabled=!1),m.className="colorbox",m.style.position="fixed",m.style.display="flex",m.style.justifyContent="center",m.style.alignItems="center",m.style.width=s.slider.btnDim.w+"px",m.style.height=s.slider.btnDim.h+"px",m.style.left=s.slider.up.x+"px",m.style.top=s.slider.up.y+"px",m.style.borderWidth="0px",g.style.pointerEvents="none",g.className="colorbox",g.style.position="fixed",g.style.left=s.slider.up.x+"px",g.style.top=s.slider.up.y+"px",g.style.width="0px",g.style.height="0px",g.style.borderLeft="7px solid transparent",g.style.borderRight="7px solid transparent",g.style.borderBottom="7px solid white",g.style.marginTop="0.2rem",m.appendChild(g),v.className="colorbox",v.style.position="fixed",v.style.display="flex",v.style.justifyContent="center",v.style.alignItems="center",v.style.width=s.slider.btnDim.w+"px",v.style.height=s.slider.btnDim.h+"px",v.style.left=s.slider.down.x+"px",v.style.top=s.slider.down.y+"px",v.style.borderWidth="0px",y.className="colorbox",y.style.pointerEvents="none",y.style.position="fixed",y.style.left=s.slider.up.x+"px",y.style.top="638px",y.style.width="0px",y.style.height="0px",y.style.borderLeft="7px solid transparent",y.style.borderRight="7px solid transparent",y.style.borderTop="7px solid white",v.appendChild(y),m.setAttribute("aria-label",s.LabComClass.globalLangText[s.jaws_uparrowText]),h.appendChild(m),v.setAttribute("aria-label",s.LabComClass.globalLangText[s.jaws_downarrowText]),h.appendChild(v)}}}function ButtonCompClass(n){var i={},r={bgColorState:{normal:"rgb(255, 102, 0)",hover:"",down:"rgb(255, 0, 0)",disable:"#afafaf"},height:44,visible:!0,state:!0,imgList:[],width:44,x:105,y:313,text:"",isItalic:!1,isBold:!1,fontSize:25,textColor:"#ffffff",jaws_text:""},e=!1,a=document.createElement("button");a.id=n.id;var o=new Image;document.createTextNode(r.text);function s(){r.state&&r.visible?(a.addEventListener("mousedown",t),a.addEventListener("mouseupout",t),a.addEventListener("click",t)):(a.removeEventListener("mousedown",t),a.removeEventListener("mouseupout",t),a.removeEventListener("click",t))}function t(t){switch(t.type){case"mousedown":e=!0;break;case"mousemove":break;case"mouseup":case"click":l(),s(),e=!1;break;case"mouseupout":e=!1}onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"})}function l(){void 0!==i.click&&i.click({id:r.id,value:e})}this.init=function(t){a.style.width=n.width+"px",a.style.height=n.height+"px",a.style.position="absolute",a.style.left=n.x+"px",a.style.top=n.y+"px",a.style.backgroundColor="#afafaf",a.style.borderWidth="0px";var e=0<t.imageWidth?t.imageWidth:27,i=0<t.imageHeight?t.imageHeight:27;o.src="assets/images/".concat(n.imgList[0]),o.style.pointerEvents="none",o.onload=function(){o.style.width="".concat(e," px"),o.style.height="".concat(i,"px"),o.style.position="absolute",o.style.left="50%",o.style.top="50%",o.style.transform="translate(-50%, -50%)"},a.appendChild(o),a.setAttribute("aria-label",t.LabComClass.globalLangText[t.jaws_text]),t.domLayer.appendChild(a)},Object.keys(n).forEach(function(t){r[t]=n[t]}),this.init(r),s(),r.imgList[0]?r.LabComClass.requestGlobalImage(r.imgList,function(t){t,onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:r.id}})},function(t){console.log("Images Loading Error...")}):onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:r.id}}),this.addEventListener=function(t,e){i[t]=e},this.setValue=function(t){r.checked=t},this.getValue=function(){},this.setText=function(t){r.text=t},this.getText=function(){return r.text},this.show=function(){r.visible=!0,s()},this.hide=function(){r.visible=!1,s()},this.setPos=function(t,e){r.x=t,r.y=e,s()},this.getPos=function(){return{x:r.x,y:r.y}},this.enable=function(){r.state=!0,a.style.cursor="pointer",a.tabIndex=0,a.setAttribute("aria-disabled",!1),s()},this.disable=function(){r.state=!1,a.style.cursor="default",a.setAttribute("aria-disabled",!0),s()},this.getState=function(){return r.state},this.draw=function(){r.visible&&(document.getElementsByClassName("checkbox")[7].value===String(!0)?r.state?e?(a.style.backgroundColor=r.bgColorState.down,r.imgList[1]?o.src="assets/images/".concat(n.imgList[1]):r.imgList[0]&&(o.src="assets/images/".concat(n.imgList[0]))):(a.style.backgroundColor="#DB5800",r.imgList[0]&&(o.src="assets/images/".concat(n.imgList[0]))):(a.style.backgroundColor="#454540",r.imgList[0]&&(o.src="assets/images/".concat(n.imgList[0]))):r.state?e?(a.style.backgroundColor=r.bgColorState.down,r.imgList[1]?o.src="assets/images/".concat(n.imgList[1]):r.imgList[0]&&(o.src="assets/images/".concat(n.imgList[0]))):(a.style.backgroundColor=r.bgColorState.normal,r.imgList[0]&&(o.src="assets/images/".concat(n.imgList[0]))):(a.style.backgroundColor=r.bgColorState.disable,r.imgList[0]&&(o.src="assets/images/".concat(n.imgList[0]))),r.state&&e&&r.imgList[1]?o.src="assets/images/".concat(n.imgList[1]):r.imgList[0]&&(o.src="assets/images/".concat(n.imgList[0])));r.text&&r.visible&&(a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.fontSize=r.fontSize+"px",a.style.fontStyle=r.isItalic?"italic":"normal",a.style.fontWeight=r.isBold?"bold":"normal")}}function ProtactorCompClass(e){var i={},n={cAngle:0,imgList:["protractorbg.png"],visible:!0,enabled:!0,showArrow:!0,rotate:0,x:105,y:313,width:270,bgColorState:{normal:"rgb(255, 102, 0)",hover:"",down:"rgb(255, 0, 0)",disable:"rgb(193, 170, 155)"},height:241,jaws_text:""},r=!1;Object.keys(e).forEach(function(t){n[t]=e[t]});var a={x1:n.x+18,y1:n.y+n.height-25,x2:0,y2:0,radient:0},o=document.createElement("div"),t=document.createElement("img"),s=document.createElement("div"),l=document.createElement("div"),c=document.createElement("span");n.LabComClass.requestGlobalImage(n.imgList,function(t){t,onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:n.id}})},function(t){console.log("Images Loading Error...")}),this.addEventListener=function(t,e){i[t]=e},this.setValue=function(t){n.x=t.x?t.x:n.x,a.x1=n.x+18,n.y=t.y?t.y:n.y,a.y1=n.y+n.height-25,n.cAngle=0<=t.angle?t.angle:n.cAngle,a.radient=g(),p()},this.getValue=function(){return{x:n.x,y:n.y,angle:n.cAngle}},this.enable=function(){n.enabled=!0,p()},this.disable=function(){n.enabled=!1,p()},this.show=function(){n.visible=!0,o.style.display="block",t.style.display="block",s.style.display="block",l.style.display="block",p()},this.hide=function(){n.visible=!1,o.style.display="none",t.style.display="none",s.style.display="none",l.style.display="none",p()},this.draw=function(){o.style.width=n.width,o.style.height=n.height,o.style.position="absolute",o.style.left=n.x+"px",o.style.top=n.y+"px",c.style.position="absolute",c.style.id="protspan",c.style.width=n.width+"px",c.style.height=n.height+"px",c.style.left="0px",c.style.top="0px",c.style.opacity=0,c.innerHTML=n.LabComClass.globalLangText[n.jaws_text],s.style.position="absolute",s.style.zIndex="100",s.id="qcircle",s.style.top="9px",s.style.left="14px",s.style.width="208px",s.style.height="207px",s.style.backgroundColor="transparent",s.style.overflow="hidden",s.style.borderRadius="0 100% 0 0",s.style.cursor="pointer",l.style.position="absolute",l.style.width="200px",l.style.height="200px",l.style.border="3px solid blue;",l.style.borderRadius="100%",l.style.clipPath="ellipse(100px 100px at 100% 0%)",s.appendChild(l),o.appendChild(s),t.src="assets/images/protractorbg.png",t.height=n.height,t.width=n.width,t.style.position="absolute",o.appendChild(c),o.appendChild(t),!0===n.visible&&(n.domLayer.appendChild(o),function(){var t="";t=n.enabled?r?n.bgColorState.down:n.bgColorState.normal:n.bgColorState.disable;h.id=n.id,h.value=n.cAngle,h.style.position="fixed",h.style.left=a.x1+"px",h.style.top=a.y1+"px",h.style.transformOrigin="0 50%",h.style.transform="rotate(-".concat(n.cAngle,"deg)"),u.style.width="202px",u.style.height="3px",u.style.backgroundColor=t,d.style.position="absolute",d.style.left="85%",d.style.top="-207%",d.style.width="0px",d.style.height="0px",d.style.borderBottom="8px solid transparent",d.style.borderRight="16px solid ".concat(t),d.style.borderTop="8px solid transparent",h.appendChild(u),h.appendChild(d),o.appendChild(h)}())};var h=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div");function p(){!0===n.visible&&!0===n.enabled?(s.addEventListener("mousedown",f),s.addEventListener("mousemove",f),s.addEventListener("mouseup",f),s.addEventListener("mouseupout",f)):(s.removeEventListener("mousedown",f),s.removeEventListener("mousemove",f),s.removeEventListener("mouseup",f),s.removeEventListener("mouseupout",f))}function f(t){switch(t.type){case"mousedown":r=!0,m(t.offsetX,t.offsetY-s.offsetHeight);break;case"mousemove":if(r)m(t.offsetX,t.offsetY-s.offsetHeight);break;case"mouseup":r=!1;case"mouseupout":r=!1,p()}onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"})}function m(t,e){a.x2=t+a.x1,a.y2=e+a.y1,a.radient=n.LabComClass.Maths.getAngle(a.x1,a.y1,a.x2,a.y2),n.cAngle=-1*Math.round(180*a.radient/Math.PI),90<n.cAngle&&(n.cAngle=90,a.radient=g()),n.cAngle<0&&(n.cAngle=0,a.radient=g()),i.change&&i.change({id:n.id,value:n.cAngle})}function g(){return n.cAngle*Math.PI/180*-1}p()}function ConfBoxClass(e){var i={x:0,y:0,width:100,height:100,visible:!0,bgColor:"#e6e6e6",headX:0,headY:0,headHeight:40,headColor:"#b3b3b3",headText:"Header",headTextX:16,headTextY:12,headFontSize:20,headFontColor:"#ffffff",bodyTextX:16,bodyTextY:60,bodyFontSize:21,bodyFontColor:"#000000",btnColor:"#ff6600",btnFontSize:20,yesX:25,yesY:35,yesW:120,yesH:45,noX:25,noY:35,noW:120,noH:45,yesBtnTxt:"yesBtnTxt",noBtnTxt:"noBtnTxt",bodyText:"",jaws_yesText:"",jaws_noText:""};Object.keys(e).forEach(function(t){i[t]=e[t]});var n=this,r=[!1,!1,!1],a=i.playerConfigObj.baseWidth,o=i.playerConfigObj.baseHeight,s=0,l={};i.boxX=a/2-i.width/2,i.boxY=o/2-i.height/2,i.yesX=i.boxX+i.width/2-(i.yesW+15),i.noX=i.boxX+i.width/2+15,b();var t=i.context.textWrapperClass({xNum:0,yNum:0,maxWidthNum:i.width-2*i.bodyTextX,textStr:i.LabComClass.globalLangText[i.bodyText],fontFamilyStr:i.LabComClass.klettFontRegular,fontSizeNum:i.bodyFontSize,fontColor:i.bodyFontColor,fontFormat:"px "});void 0!==t.imageObj&&(s=i.boxX+(i.width/2-t.imageObj.widthInt/2),i.boxY,i.height,t.imageObj.heightInt);var c=document.createElement("div"),h=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),p=document.createTextNode(i.LabComClass.globalLangText[i.headText]),f=document.createElement("div"),m=document.createTextNode(i.LabComClass.globalLangText[i.bodyText]),g=document.createElement("button"),v=document.createElement("button"),y=document.createTextNode(i.LabComClass.globalLangText[i.yesBtnTxt]),_=document.createTextNode(i.LabComClass.globalLangText[i.noBtnTxt]);function b(){!0===i.visible&&(g&&(g.removeEventListener("mousedown",x),g.removeEventListener("mouseup",x),g.removeEventListener("mouseupout",x),g.removeEventListener("click",x),g.addEventListener("mousedown",x),g.addEventListener("mouseup",x),g.addEventListener("mouseupout",x),g.addEventListener("click",x)),v&&(v.removeEventListener("mousedown",x),v.removeEventListener("mouseup",x),v.removeEventListener("mouseupout",x),v.removeEventListener("click",x),v.addEventListener("mousedown",x),v.addEventListener("mouseup",x),v.addEventListener("mouseupout",x),v.addEventListener("click",x)))}function x(t){switch(t.type){case"mousedown":r[t.target.id]=!0,r.yesBtn?g.style.backgroundColor="#FF0000":r.noBtn&&(v.style.backgroundColor="#FF0000");break;case"click":r[t.target.id]=!1,0!==t.target.id&&(n.hide(),function(t){switch(t){case"yesBtn":l.yes&&l.yes({id:i.id});break;case"noBtn":l.no&&l.no({id:i.id})}}(t.target.id));break;case"mouseupout":r[t.target.id]=!1}}this.init=function(t){c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width=a+"px",c.style.height=o+"px",c.style.backgroundColor="rgba(0,0,0,0.85)",h.style.position="absolute",h.style.left=t.boxX+"px",h.style.top=t.boxY+"px",h.style.width=t.width+"px",h.style.height=t.height+"px",h.style.backgroundColor="white",u.style.position="absolute",u.style.left=t.boxX+t.headX+"px",u.style.top=t.boxY+t.headY+"px",u.style.width=t.width+"px",u.style.height=t.headHeight+"px",u.style.backgroundColor=t.headColor,d.style.position="absolute",d.style.left="15px",d.style.top="10px",d.style.color=t.headFontColor,d.style.fontSize=t.headFontSize+"px",d.style.fontFamily=t.LabComClass.klettFontRegular,d.appendChild(p),f.style.position="absolute",f.style.left=s+"px",f.style.top="328px",f.style.color="black",f.style.fontSize=t.headFontSize+"px",f.style.fontFamily=t.LabComClass.klettFontRegular,f.style.fontWeight="bold",f.appendChild(m)},this.init(i),onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:i.id}}),this.show=function(){i.visible=!0,c.style.display="block",h.style.display="block",u.style.display="block",d.style.display="block",f.style.display="block",g.style.display="block",v.style.display="inline-block",b(),setTimeout(function(){c&&(window.trapFocus(c),g.focus())},200)},this.hide=function(){c.style.display="none",h.style.display="none",u.style.display="none",d.style.display="none",f.style.display="none",g.style.display="none",v.style.display="none",i.visible=!1,window.trapFocus(i.domLayer)},this.addEventListener=function(t,e){l[t]=e},this.draw=function(){i.visible&&(i.domLayer.appendChild(c),c.appendChild(h),c.appendChild(u),u.appendChild(d),c.appendChild(f),c.appendChild(g),c.appendChild(v),i.LabComClass.globalLangText[i.yesBtnTxt]&&i.LabComClass.globalLangText[i.noBtnTxt]&&(c.id=0,g.id="yesBtn",g.style.position="absolute",g.style.display="flex",g.style.justifyContent="center",g.style.alignItems="center",g.style.left=i.yesX+"px",g.style.top="370px",g.style.width=i.yesW+"px",g.style.height=i.yesH+"px",g.style.borderWidth="0px",g.style.fontSize=i.btnFontSize+"px",g.style.fontFamily=i.LabComClass.klettFontRegular,g.style.color="white",g.style.cursor="pointer",g.appendChild(y),g.setAttribute("aria-label",i.LabComClass.globalLangText[i.jaws_yesText]),v.id="noBtn",v.style.position="absolute",v.style.display="flex",v.style.justifyContent="center",v.style.alignItems="center",v.style.left="650px",v.style.top="370px",v.style.width=i.noW+"px",v.style.height=i.noH+"px",v.style.borderWidth="0px",v.style.fontSize=i.btnFontSize+"px",v.style.fontFamily=i.LabComClass.klettFontRegular,v.style.color="white",v.style.cursor="pointer",v.appendChild(_),v.setAttribute("aria-label",i.LabComClass.globalLangText[i.jaws_noText]),document.getElementsByClassName("checkbox")[7].value===String(!0)?(u.style.backgroundColor="#454540",g.style.backgroundColor="#DB5800",v.style.backgroundColor="#DB5800"):(u.style.backgroundColor=i.headColor,g.style.backgroundColor=i.btnColor,v.style.backgroundColor=i.btnColor)))}}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function NumberPadClass(e){var n=this,i=e.id,u=e.deviceTypeBool,r=(e.context,{x:0,y:0,btnWidth:45,btnHeight:45,textBtnWidth:88,holderBgColor:"rgba(233, 233, 233, 1)",numberBtnBgColor:"rgb(255, 102, 0)",numberBtnTextColor:"#FFFFFF",nonNumberBtnBgColor:"rgba(246, 246, 246, 1)",nonNumberBtnTextColor:"#000000",holderPadding:[15,15,15,15],btnVertPadding:20,btnHorizPadding:10,borderRadius:0,fontStyle:"normal",fontSize:24,fontFamily:"Arial",showComponent:!1,headerText:"Number Pad",headerHeight:40,headerBgColor:"rgb(255, 102, 0)",headerFontFamily:"Arial",headerFontSize:24,headerFontStyle:"normal",headerTextColor:"#FFFFFF"});Object.keys(e).forEach(function(t){r[t]=e[t]});var h={diff:"–",dot:".",back:"Del",clear:"Clear",enter:"Enter"},t=[[1,2,3,"back"],[4,5,6,"clear"],[7,8,9,"enter"],["diff",0,"dot"]],a=null,o=null,d=null,s=null,l=null,c={};Object.defineProperties(this,{enable:{set:function(t){t&&d.forEach(function(t){var e=t.key,i=(t.x,t.y,t.width,t.height,document.getElementById(e));i&&(i.removeEventListener("mousedown",et),i.removeEventListener("mouseup",et),i.addEventListener("mousedown",et),i.addEventListener("mouseup",et))})}},show:{set:function(t){var e;e=t,r.showComponent=e,n.enable=e,r.showComponent||$.setAttribute("tabindex",-1),at()}},compId:{get:function(){return i}},isCompVisible:{get:function(){return r.showComponent}}});var p,f,m,g,v,y,_,b,x,w,T,M,S,E,C,L,A,P,R,O,I,D,j,k,N,F,B,H,U,z,V,G,W,Y,X,q,J,Z,Q,K,$=document.createElement("div"),tt=document.createElement("div");function et(t){switch(t.preventDefault(),t.type){case"mousedown":case"mousemove":break;case"mouseup":if(l)switch(t.target.id){case"enter":l.focusOut();break;default:l.setNumberPadValue(t.target.id)}}at()}function it(i){Object.keys(s).forEach(function(t){var e=s[t];i?(e.on("focusIn",nt),e.on("focusOut",rt)):(e.off("focusIn",nt),e.off("focusOut",rt))})}function nt(t){l=s[t.id],n.show=!0,void 0!==c.numpadState&&c.numpadState({id:i,type:"open"},!0)}function rt(t){l=null,n.show=!1,void 0!==c.numpadState&&c.numpadState({id:i,type:"close"},!0)}function at(){onViewUpdateCls.trigger("onGlobalUpdate",{type:"updateView"})}this.registerEntryBox=function(){if(u){s={};for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(t){t.numberPadCompId=n.compId,s[t.compId]=t}),it(!0)}},this.unregisterEntryBox=function(){it(!1),s=null},this.addEventListener=function(t,e){c[t]=e},E=r.x,C=r.y,L=r.btnWidth,A=r.btnHeight,P=r.textBtnWidth,R=r.btnVertPadding,O=r.btnHorizPadding,I=r.holderPadding,D=r.headerHeight,j=(Math.max.apply(Math,_toConsumableArray(t.map(function(t){return t.length})))-1)*(L+O)+P+(I[1]+I[3]),k=t.length*A+(t.length-1)*R+(I[0]+I[2]),a={x:E,y:C,width:j,height:k+=D+R},function(){r.holderPadding;var t=r.headerHeight,e=a.width;o={x:a.x,y:a.y,width:e,height:t}}(),p=r.btnWidth,f=r.btnHeight,m=r.textBtnWidth,g=r.btnHorizPadding,v=r.btnVertPadding,y=r.holderPadding,_=r.numberBtnBgColor,b=r.numberBtnTextColor,x=r.nonNumberBtnBgColor,w=r.nonNumberBtnTextColor,T=o.height,M=o.x+y[1],S=o.y+T+v,d=[],t.forEach(function(t,c){t.forEach(function(t,e){var i=h[t]?h[t]:t,n=i.toString().length<=2,r=M+e*(p+g),a=S+c*(f+v),o=p,s=_,l=b;n||(o=m),isNaN(Number(i))&&(s=x,l=w),d.push({key:t,value:i,x:r,y:a,width:o,height:f,fillStyle:s,color:l})})}),N=r.holderBgColor,F=r.borderRadius,B=r.fontStyle,H=r.fontSize,U=r.fontFamily,z=r.headerText,V=r.headerFontFamily,G=r.headerFontSize,W=r.headerFontStyle,Y=r.headerBgColor,X=r.headerTextColor,J=(q=a).x,Z=q.y,Q=q.width,K=q.height,$.innerHTML="",$.className="numberPad",$.id="holder",$.style.position="absolute",$.style.left=J+"px",$.style.top=Z+"px",$.style.width=Q+"px",$.style.height=K+"px",$.style.radius=F+"px",$.style.backgroundColor=N,$.style.zIndex=1,$.style.display="none",tt.id="header",tt.style.position="fixed",tt.style.display="flex",tt.className="numberPad",tt.style.justifyContent="center",tt.style.alignItems="center",tt.style.left=o.x+"px",tt.style.top=o.y+"px",tt.style.width=o.width+"px",tt.style.height=o.height+"px",tt.style.radius=F+"px",tt.style.backgroundColor=Y,tt.innerHTML=z,tt.style.fontSize=G+"px",tt.style.fontStyle=W,tt.style.fontFamily=V,tt.style.color=X,tt.style.textAlign="left",$.appendChild(tt),d.forEach(function(t,e){var i=document.createElement("button"),n=t.x,r=t.y,a=t.width,o=t.height,s=t.color,l=t.fillStyle,c=t.value,h=t.key;i.id=h,i.className="numberPad",i.style.position="fixed",i.style.width=a+"px",i.style.height=o+"px",i.style.left=n+"px",i.style.top=r+"px",i.style.radius=F+"px",i.style.backgroundColor=l,i.style.borderWidth="0px",i.innerHTML=c,i.style.fontSize=H+"px",i.style.fontStyle=B,i.style.fontFamily=U,i.style.color=s,$.appendChild(i),!u&&i&&i.setAttribute("disabled",!0)}),e.domLayer.appendChild($),u||(n.show=!1),onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:e.id}})}function MsgBoxClass(e){var i={x:0,y:0,width:100,height:100,visible:!0,showSlider:!1,bgColor:"#e6e6e6",headX:0,headY:0,headHeight:40,headColor:"#b3b3b3",headText:"Header",headTextX:16,headTextY:12,headFontSize:20,headFontColor:"#ffffff",bodyTextX:16,bodyTextY:60,bodyPading:20,bodyFontSize:21,bodyFontColor:"#000000",sliderW:20,sliderBtnH:20,sliderPad:5,closeX:10,closeY:10,closeW:20,closeH:20,upBtnState:"normal",downBtnState:"normal",bodyText:"",jaws_text:""};Object.keys(e).forEach(function(t){i[t]=e[t]});var n=this,r={},a=i.playerConfigObj.baseWidth,o=i.playerConfigObj.baseHeight;i.boxX=a/2-i.width/2,i.boxY=o/2-i.height/2,i.bodyTextY=i.headHeight+i.bodyPading,i.upButton={x:i.boxX+i.width-i.sliderW,y:i.boxY+i.headHeight},i.downButton={x:i.boxX+i.width-i.sliderW,y:i.boxY+i.height-i.sliderBtnH},i.slider={x:i.boxX+i.width-i.sliderW,y:i.boxY+i.headHeight+i.sliderBtnH,w:i.sliderW,h:i.sliderBtnH},v();var t=i.context.textWrapperClass({xNum:0,yNum:0,maxWidthNum:i.width-2*i.bodyTextX,textStr:i.LabComClass.globalLangText[i.bodyText],fontFamilyStr:i.LabComClass.klettFontRegular,fontSizeNum:i.bodyFontSize,fontColor:i.bodyFontColor,fontFormat:"px "}).imageObj;i.imageY=i.bodyTextY,void 0!==t.imageObj&&t.heightInt>i.height-i.bodyTextY&&(i.showSlider=!0,t=i.context.textWrapperClass({xNum:0,yNum:0,maxWidthNum:i.width-2*i.bodyTextX-i.sliderW,textStr:i.LabComClass.globalLangText[i.bodyText],fontFamilyStr:i.LabComClass.klettFontRegular,fontSizeNum:i.bodyFontSize,fontColor:i.bodyFontColor,fontFormat:"px "}).imageObj),i.animClass=new i.LabComClass.GlobalAnimClass,i.LabComClass.requestGlobalImage(["globalclose.png"],function(t){t["globalclose.png"],onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:i.id}})});var s=i.boxX+i.headTextX,l=i.boxY+i.headTextY,c=document.createElement("div"),h=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),p=document.createElement("button"),f=new Image,m=document.createElement("div"),g=document.createTextNode(i.LabComClass.globalLangText[i.bodyText]);function v(){!0===i.visible&&(p?p.addEventListener("click",y):p.removeEventListener("click",y))}function y(t){switch(t.preventDefault(),t.type){case"mousedown":case"mousemove":break;case"click":"closeBtn"===t.target.id&&(n.hide(),void 0!==r.popupClose&&r.popupClose({id:i.id,type:"popupClose"},!0))}}this.init=function(t){c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width=a+"px",c.style.height=o+"px",c.style.backgroundColor="rgba(0,0,0,0.85)",h.style.position="absolute",h.style.left=t.boxX+"px",h.style.top=t.boxY+"px",h.style.width=t.width+"px",h.style.height=t.height+"px",h.style.backgroundColor=t.bgColor,u.style.position="relative",u.style.display="flex",u.style.justifyContent="center",u.style.alignItems="center",u.style.left=t.headX+"px",u.style.top=t.headY+"px",u.style.width=t.width+"px",u.style.height=t.headHeight-1+"px",d.style.position="fixed",d.innerHTML=t.LabComClass.globalLangText[t.headText],d.style.left=s+"px",d.style.top=l+"px",d.style.color=t.headFontColor,d.style.fontSize=t.headFontSize+"px",d.style.fontFamily=t.LabComClass.klettFontRegular,d.style.textAlign="left",d.style.verticalAlign="bottom",u.appendChild(d),p.id="closeBtn",p.style.position="relative",p.style.display="flex",p.style.justifyContent="center",p.style.alignItems="center",p.style.left=t.width-t.closeX-t.closeW-2+"px",p.style.top=t.closeY+"px",p.style.width="27px",p.style.height="25px",p.style.borderWidth="0px",p.style.cursor="pointer",f.src="assets/images/globalclose.png",f.onload=function(){f.style.position="absolute",f.style.width="20px",f.style.height="".concat(t.closeH,"px"),f.style.cursor="pointer",f.style.pointerEvents="none"},p.appendChild(f),p.setAttribute("aria-label",t.LabComClass.globalLangText[t.jaws_text]),u.appendChild(p)},this.init(i),this.show=function(){c.style.display="block",h.style.display="block",u.style.display="block",d.style.display="block",f.style.display="block",m.style.display="block",i.visible=!0,setTimeout(function(){c&&(window.trapFocus(c),p.focus())},200),v()},this.hide=function(){c.style.display="none",h.style.display="none",u.style.display="none",d.style.display="none",f.style.display="none",m.style.display="none",i.visible=!1,window.trapFocus(i.domLayer),v()},this.addEventListener=function(t,e){r[t]=e},this.draw=function(){i.visible&&(i.domLayer.appendChild(c),c.appendChild(h),h.appendChild(u),document.getElementsByClassName("checkbox")[7].value===String(!0)?(u.style.backgroundColor="#454540",p.style.backgroundColor="#454540"):(u.style.backgroundColor=i.headColor,p.style.backgroundColor=i.headColor),i.showSlider&&(m.innerText=String(i.LabComClass.globalLangText[i.bodyText]),m.style.position="fixed",m.style.left=i.boxX+"px",m.style.top=i.boxY+i.headHeight+"px",m.style.width="624px",m.style.height=i.height-i.headHeight-22+"px",m.style.backgroundColor=i.bgColor,m.style.fontSize=i.bodyFontSize+"px",m.style.color=i.bodyFontColor,m.style.fontFamily=i.LabComClass.klettFontRegular,m.style.padding="10px",m.style.overflowY="scroll",m.style.scrollBehavior="smooth",m.appendChild(g),h.appendChild(m)))}}function PlayerClass(){function ModelClass(){var r=this,a=Object.prototype.hasOwnProperty;function i(e,t,i){var n=[];Object.keys(e).forEach(function(t){a.call(r[i],t)?(n.push(t),LabComClass.defineObject(r[i],t,e[t])):console.log(t+": property doesnt exist in Model "+i+".")}),onModelUpdateCls.trigger("onChange",{type:t,propList:n})}this.cPropObj={},this.vPropObj={},this.sildePropObj={},onModelUpdateCls.on("setCProp",function(t,e){i(t,e,"cPropObj")}),onModelUpdateCls.on("setVProp",function(t,e){i(t,e,"vPropObj")}),onModelUpdateCls.on("setSlideProp",function(t,e){i(t,e,"sildePropObj")}),LabComClass.defineObject(this.cPropObj,"playerPath",""),LabComClass.defineObject(this.cPropObj,"playerConfigObj",{}),LabComClass.defineObject(this.cPropObj,"configObj",{}),LabComClass.defineObject(this.cPropObj,"deviceTypeBool",!1),LabComClass.defineObject(this.cPropObj,"audioContextCls",new AudioContextClass),LabComClass.defineObject(this.cPropObj,"audioNativeCls",new AudioNativeClass),LabComClass.defineObject(this.cPropObj,"mouseHandleCls",new MouseHandlerClass),LabComClass.defineObject(this.cPropObj,"keyHandlerCls",new KeyHandlerClass),LabComClass.defineObject(this.cPropObj,"labObj",{}),LabComClass.defineObject(this.cPropObj,"compListObj",{}),LabComClass.defineObject(this.cPropObj,"brainObj",{}),LabComClass.defineObject(this.cPropObj,"compCountInt",0),LabComClass.defineObject(this.cPropObj,"totalCompCountInt",0),LabComClass.defineObject(this.cPropObj,"activityObj",{}),LabComClass.defineObject(this.cPropObj,"interactiveLayerArr",[]),LabComClass.defineObject(this.vPropObj,"domLayerObj",document.createElement("div")),LabComClass.defineObject(this.vPropObj,"preloadObj",document.createElement("div")),LabComClass.defineObject(this.vPropObj,"bgCanvasObj",document.createElement("canvas")),LabComClass.defineObject(this.vPropObj,"bgContextObj",{}),LabComClass.defineObject(this.vPropObj,"contCanvasObj",document.createElement("canvas")),LabComClass.defineObject(this.vPropObj,"virtualCanvasObj",document.createElement("canvas")),LabComClass.defineObject(this.vPropObj,"contContextObj",{}),LabComClass.defineObject(this.vPropObj,"mouseCanvasObj",document.createElement("canvas")),LabComClass.defineObject(this.vPropObj,"mTextWrapperObj",document.createElement("canvas")),LabComClass.defineObject(this.vPropObj,"snapshotCnvObj",document.createElement("canvas")),LabComClass.defineObject(this.vPropObj,"playerImagesObj",{}),LabComClass.defineObject(this.vPropObj,"componentImagesObj",{}),LabComClass.defineObject(this.vPropObj,"resizeTimeoutObj",{}),LabComClass.defineObject(this.vPropObj,"scaledDataObj",{}),LabComClass.defineObject(this.vPropObj,"bgImageObj",{})}function ViewClass(){Object.prototype.hasOwnProperty;function e(){var t=modelCls.vPropObj.contCanvasObj,e=modelCls.vPropObj.contContextObj,i=modelCls.vPropObj.scaledDataObj;e.clearRect(0,0,t.width,t.height),e.save(),e.scale(i.scale*i.devScaleRatioInt,i.scale*i.devScaleRatioInt);var n=modelCls.cPropObj.compListObj;Object.keys(n).forEach(function(t){n[t].obj.draw&&n[t].obj.draw()}),e.restore()}function i(){var t=modelCls.vPropObj.bgCanvasObj,e=modelCls.vPropObj.bgContextObj;e.clearRect(0,0,t.width,t.height),e.drawImage(modelCls.vPropObj.bgImageObj,0,0,t.width,t.height)}onModelUpdateCls.on("onChange",function(t){switch(t.type){case"onActivityInited":modelCls.cPropObj.mouseHandleCls.updateInteractiveLayer(modelCls.cPropObj.interactiveLayerArr),i(),document.body.removeChild(modelCls.vPropObj.preloadObj);break;case"mouseEventAdded":break;case"onScaleSet":document.addEventListener("contextmenu",function(t){return t.preventDefault()}),modelCls.cPropObj.mouseHandleCls.init({deviceTypeBool:modelCls.cPropObj.deviceTypeBool,mouseCanvasObj:modelCls.vPropObj.mouseCanvasObj}),modelCls.cPropObj.mouseHandleCls.updateOnResize(modelCls.vPropObj.scaledDataObj)}}),onViewUpdateCls.on("onGlobalUpdate",function(t){switch(t.type){case"addMouseEvent":modelCls.cPropObj.mouseHandleCls.addMouseEvent(t.data);break;case"addKeyEvent":modelCls.cPropObj.keyHandlerCls.addKeyEvents(t.data);break;case"removeMouseEvent":modelCls.cPropObj.mouseHandleCls.removeMouseEvent(t.data);break;case"removeKeyEvent":modelCls.cPropObj.keyHandlerCls.removeKeyEvents(t.data);break;case"rendererUpdate":requestAnimationFrame(e);break;case"onNavStageResize":i(),e()}})}function ControllerClass(){var hasOProp=Object.prototype.hasOwnProperty,focusableEls,firstFocusableEl,lastFocusableEl;function init(){setUpPlayer(),modelCls.cPropObj.keyHandlerCls.init();var t=document.createElement("div");t.setAttribute("id","inputFieldDummyDiv"),t.setAttribute("contenteditable",!0),t.style.position="absolute",t.style.width="0px",t.style.height="0px",t.style.top="-100px",t.style.left="-100px",t.addEventListener("keydown",function(){this.innerHTML=""}),document.body.appendChild(t)}function onChange(t){switch(t.type){case"onPlayerConfigLoad":LabComClass.childPreloadProgress(30),LabComClass.BrowserDetect.isDevice()?onModelUpdateCls.trigger("setCProp",{deviceTypeBool:!0},"onDeviceSelected"):onModelUpdateCls.trigger("setCProp",{deviceTypeBool:!1},"onDeviceSelected");break;case"onDeviceSelected":setPlayerScale();break;case"onScaleSet":LabComClass.childPreloadProgress(48),httpRequest("labstructure.json","json",function(t){onModelUpdateCls.trigger("setCProp",t,"onLessonStructureLoad")});break;case"onLessonStructureLoad":httpRequest(modelCls.cPropObj.labObj.lang+"/labtext.json","json",function(t){LabComClass.globalLangText=t;try{LabComClass.urlParams=JSON.parse('{"'+location.search.substring(1).replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch(t){LabComClass.urlParams={}}LabComClass.klettFontRegular=modelCls.cPropObj.playerConfigObj["klettFontRegular-"+modelCls.cPropObj.labObj.lang],LabComClass.bold=modelCls.cPropObj.playerConfigObj.bold,LabComClass.italic=modelCls.cPropObj.playerConfigObj.italic,LabComClass.italicbold=modelCls.cPropObj.playerConfigObj.italicbold,LabComClass.subscript=modelCls.cPropObj.playerConfigObj.subscript,LabComClass.superscript=modelCls.cPropObj.playerConfigObj.superscript,LabComClass.end=modelCls.cPropObj.playerConfigObj.end,LabComClass.requestLocalImage(["background.png"],function(t){onModelUpdateCls.trigger("setVProp",{bgImageObj:t["background.png"]},"onLocaliseTextLoad")})});break;case"onLocaliseTextLoad":LabComClass.childPreloadProgress(60),loadSFXAudio();break;case"onSFXLoad":createCompList();break;case"onCompListAdd":sendInstanceToAct()}}function onGlobalUpdate(t){switch(t.type){case"onCheckForSubway":break;case"componentLoaded":allCompLoaded(t.data);break;case"playSFX":modelCls.cPropObj.audioContextCls.sfxObj.play(t.data,t.callBack);break;case"stopSFX":modelCls.cPropObj.audioContextCls.sfxObj.stop()}}function setUpPlayer(){LabComClass.localImagePath="assets/images/",LabComClass.globalImagePath="assets/images/",httpRequest(modelCls.cPropObj.playerPath+"playerconfig.json","json",function(t){LabComClass.childPreloadProgress(18),onModelUpdateCls.trigger("setCProp",t,"onPlayerConfigLoad")})}function httpRequest(t,e,i,n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){4===this.readyState&&i&&"json"===e.toLowerCase()&&i(JSON.parse(this.responseText))},a.open("GET",t,!0),a.send()}function setPlayerScale(){var t=0;modelCls.cPropObj.deviceTypeBool&&(t=1500),setTimeout(function(){window.onresize=function(){setStageSize()},setStageSize(!0)},t)}function setStageSize(r){clearTimeout(modelCls.vPropObj.resizeTimeoutObj);var t=setTimeout(function(){var t="",e=calculateScaleVal({w:modelCls.cPropObj.playerConfigObj.baseWidth,h:modelCls.cPropObj.playerConfigObj.baseHeight});e.devScaleRatioInt=calculateDevicePixelRatio(modelCls.vPropObj.contCanvasObj);e.w,e.h,e.devScaleRatioInt;if(r){modelCls.vPropObj.mTextWrapperObj.className="mStage mTextWrapper",document.body.appendChild(modelCls.vPropObj.mTextWrapperObj),modelCls.vPropObj.bgCanvasObj.className="mStage mStagebgCanvas",document.body.appendChild(modelCls.vPropObj.bgCanvasObj),modelCls.vPropObj.contCanvasObj.className="mStage mStagecontCanvas",document.body.appendChild(modelCls.vPropObj.contCanvasObj),modelCls.vPropObj.virtualCanvasObj.className="mStage mVirtualStagecontCanvas",modelCls.vPropObj.domLayerObj.className="mStage mDomLayer",document.body.appendChild(modelCls.vPropObj.domLayerObj),modelCls.vPropObj.preloadObj.className="mStage preloadDiv",document.body.appendChild(modelCls.vPropObj.preloadObj),CanvasRenderingContext2D.prototype.textWrapperClass=LabComClass.TextImgClass,CanvasRenderingContext2D.prototype.tweenClass=LabComClass.TweenClass,CanvasRenderingContext2D.prototype.drawCurveRect=LabComClass.drawCurveRect,CanvasRenderingContext2D.prototype.drawStyledText=LabComClass.drawStyledText;var n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(){try{n.apply(this,arguments)}catch(t){var e=t.stack||"",i="Failed to draw error, ";i+="trace === "+(e=e.split("\n").map(function(t){return t.trim()})).join(",")+", ",i+="arguments === "+JSON.stringify(arguments),console.log(i),"undefined"!=typeof trackJs&&trackJs.console.error(i)}},t="onScaleSet"}var i={};i.bgContextObj=modelCls.vPropObj.bgCanvasObj.getContext("2d"),i.contContextObj=modelCls.vPropObj.contCanvasObj.getContext("2d"),onModelUpdateCls.trigger("setVProp",i,""),modelCls.vPropObj.bgCanvasObj.style.left=e.x+"px",modelCls.vPropObj.bgCanvasObj.style.top=e.y+"px",modelCls.vPropObj.bgCanvasObj.width=e.w*e.devScaleRatioInt,modelCls.vPropObj.bgCanvasObj.height=e.h*e.devScaleRatioInt,modelCls.vPropObj.bgCanvasObj.style.width=e.w+"px",modelCls.vPropObj.bgCanvasObj.style.height=e.h+"px",modelCls.vPropObj.contCanvasObj.style.left=e.x+"px",modelCls.vPropObj.contCanvasObj.style.top=e.y+"px",modelCls.vPropObj.contCanvasObj.width=e.w*e.devScaleRatioInt,modelCls.vPropObj.contCanvasObj.height=e.h*e.devScaleRatioInt,modelCls.vPropObj.contCanvasObj.style.width=e.w+"px",modelCls.vPropObj.contCanvasObj.style.height=e.h+"px",modelCls.vPropObj.virtualCanvasObj.width=e.w*e.devScaleRatioInt,modelCls.vPropObj.virtualCanvasObj.height=e.h*e.devScaleRatioInt,modelCls.vPropObj.virtualCanvasObj.style.width=e.w+"px",modelCls.vPropObj.virtualCanvasObj.style.height=e.h+"px",modelCls.vPropObj.domLayerObj.style.left=e.x+"px",modelCls.vPropObj.domLayerObj.style.top=e.y+"px",modelCls.vPropObj.domLayerObj.style.width=modelCls.cPropObj.playerConfigObj.baseWidth+"px",modelCls.vPropObj.domLayerObj.style.height=modelCls.cPropObj.playerConfigObj.baseHeight+"px",modelCls.vPropObj.domLayerObj.style.transform="scale("+e.scale+")",modelCls.vPropObj.snapshotCnvObj.width=e.w*e.devScaleRatioInt,modelCls.vPropObj.snapshotCnvObj.height=e.h*e.devScaleRatioInt,modelCls.vPropObj.mouseCanvasObj.width=e.w,modelCls.vPropObj.mouseCanvasObj.height=e.h,modelCls.vPropObj.mTextWrapperObj.style.display="none",modelCls.vPropObj.preloadObj.style.left=e.x+"px",modelCls.vPropObj.preloadObj.style.top=e.y+"px",modelCls.vPropObj.preloadObj.style.width=e.w+"px",modelCls.vPropObj.preloadObj.style.height=e.h+"px",modelCls.cPropObj.mouseHandleCls.updateOnResize(e),LabComClass.setVirtualCnv(modelCls.vPropObj.virtualCanvasObj),LabComClass.setSnapshotCnv({snapshotCnvObj:modelCls.vPropObj.snapshotCnvObj,bgCanvasObj:modelCls.vPropObj.bgCanvasObj,contCanvasObj:modelCls.vPropObj.contCanvasObj,devScaleRatioInt:e.devScaleRatioInt,scale:e.scale}),onModelUpdateCls.trigger("setVProp",{scaledDataObj:e},t),LabComClass.setCnvScale(modelCls.vPropObj.scaledDataObj),r||onViewUpdateCls.trigger("onGlobalUpdate",{type:"onNavStageResize",data:{}})},300);onModelUpdateCls.trigger("setVProp",{resizeTimeoutObj:t},"")}function calculateScaleVal(t){var e={};try{e=JSON.parse('{"'+location.search.substring(1).replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch(t){console.log("To switch off the scale: ?noscale=true")}if("true"===e.noscale)return document.body.style.overflow="auto",{w:t.w,h:t.h,scale:1,x:0,y:0};var i,n,r=t.w,a=t.h,o=window.innerWidth,s=window.innerHeight,l=1,c=1;s<o?(i=s,l=Number(a/i),n=r/a*i,o/2-Number(n)/2<0&&(n=o,l=Number(r/n),i=a/r*n),(c=1/l)<.6&&(c=.6)):(i=a/r*(n=o),(c=1/(l=Number(r/n)))<.6&&(c=.6));return{w:Math.round(r*c),h:Math.round(a*c),scale:c,x:Math.round(window.innerWidth/2-Number(n)/2),y:Math.round(window.innerHeight/2-Number(i)/2)}}function calculateDevicePixelRatio(t){var e=t.getContext("2d");return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}function loadUIFonts(t){var e=modelCls.cPropObj.labObj.fonts,i=[];if(0<e.length)for(var n=0;n<e.length;n+=1)i.push(e[n]);LabComClass.fontLoader({timeout:15e3,fontArr:i,callback:t,error:function(t){console.log("List of fonts failed to load === ",JSON.stringify(t)),"undefined"!=typeof trackJs&&trackJs.console.error("List of fonts failed to load === ",JSON.stringify(t))}})}function loadSFXAudio(){LabComClass.childPreloadProgress(78);var i=[],n=modelCls.cPropObj.labObj.globalSfx;(Object.keys(n).forEach(function(t){var e=n[t];n[t].source=modelCls.cPropObj.playerPath+"assets/audio/"+e.source,i.push(n[t])}),0<n.length)?modelCls.cPropObj.audioContextCls.sfxObj.add(i,function(){onModelUpdateCls.trigger("setCProp",{},"onSFXLoad")}):onModelUpdateCls.trigger("setCProp",{},"onSFXLoad")}function scriptLoader(t,e,i){for(var n=0,r=0;r<e.length;r++)n++,addScript(e[r],a,0);function a(){--n<=0&&i()}}function addScript(e,i,n){var t=document.createElement("script");t.setAttribute("data-load-cnt",n),t.onload=i,t.onerror=function(t){n<=2?setTimeout(function(){addScript(e,i,n+1)},500):"undefined"!=typeof trackJs&&(trackJs.console.error("script onload error URL : "+e),window.alert("There was an error loading a critical file for this lesson. The lesson needs to close"),onViewUpdateCls.trigger("onGlobalUpdate",{type:"onClosePlayerWindow"}))},t.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(t)}function createCompList(){var _iInt=0,_interactiveLayerArr=modelCls.cPropObj.interactiveLayerArr,_compListObj={},_globalData=modelCls.cPropObj.labObj.components;for(_iInt=0;_iInt<_globalData.length;_iInt++){var _idObj=_globalData[_iInt].initdata||{};_idObj.id=_globalData[_iInt].id,_idObj.domLayer=modelCls.vPropObj.domLayerObj,_idObj.canvas=modelCls.vPropObj.contCanvasObj,_idObj.context=modelCls.vPropObj.contContextObj,_idObj.deviceTypeBool=modelCls.cPropObj.deviceTypeBool,_idObj.devScaleRatioInt=modelCls.vPropObj.scaledDataObj.devScaleRatioInt,_idObj.playerConfigObj=modelCls.cPropObj.playerConfigObj,_idObj.LabComClass=LabComClass;var _func=eval(_globalData[_iInt].ref);_compListObj[_globalData[_iInt].id]={},_compListObj[_globalData[_iInt].id].obj=new _func(_idObj),_interactiveLayerArr.push(_globalData[_iInt].id)}onModelUpdateCls.trigger("setCProp",{compListObj:_compListObj,interactiveLayerArr:_interactiveLayerArr},"")}function allCompLoaded(t){var e="",i=modelCls.cPropObj.compCountInt;++i===modelCls.cPropObj.labObj.components.length&&(e="onCompListAdd",setTimeout(function(){trapFocus(modelCls.vPropObj.domLayerObj)},200)),onModelUpdateCls.trigger("setCProp",{compCountInt:i},e)}function trapFocus(t){focusableEls=t.querySelectorAll('div[role="button"]:not([disabled]), a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), input[type="range"]:not([disabled])'),firstFocusableEl=focusableEls[0],lastFocusableEl=focusableEls[focusableEls.length-1],t.addEventListener("keydown",function(t){keydownEve(t)})}function keydownEve(t){var e="Tab"===t.key||9===t.keyCode,i="Enter"===t.key||13===t.keyCode;e&&!i&&(t.shiftKey?document.activeElement===firstFocusableEl&&(console.info(!1),lastFocusableEl.focus(),t.preventDefault()):document.activeElement===lastFocusableEl&&(console.info(!0),firstFocusableEl.focus(),t.preventDefault()))}function sendInstanceToAct(){var _compListObj=modelCls.cPropObj.compListObj,_obj={};if(Object.keys(_compListObj).length<=0)requestAnimationFrame(sendInstanceToAct);else{Object.keys(_compListObj).forEach(function(t){_obj[t]=_compListObj[t].obj});var _idObj={};_idObj.spineObj=_obj,_idObj.spineObj.LabComClass=LabComClass;var _brainClassObj=eval("BrainClass"),_brainObj=new _brainClassObj(_idObj);onModelUpdateCls.trigger("setCProp",{brainObj:_brainObj},"onActivityInited")}}window.trapFocus=trapFocus,onModelUpdateCls.on("controllerInit",init),onModelUpdateCls.on("onChange",onChange),onViewUpdateCls.on("onGlobalUpdate",onGlobalUpdate)}function AudioContextClass(){var a,o,s=this,l=(Object.prototype.hasOwnProperty,new AudioNativeClass,0),c=44100,h=new MediaErrorHandlingClass({refObj:s,element:null,type:"audioContext"});function u(t,e,i){this.context=t,this.urlList=e,this.onload=i,this.bufferList=[],this.loadCount=0}isAudioContextSupported()?(o=!0,a=new window.AudioContext):o=!1,o=!1,this.sfxObj=new function(){var n,r={};this.add=function(e,t){function i(t){console.log("loaderror",t),h.pushError(JSON.stringify(t))}function n(){l+=1,e.length===l&&t()}h.registerRequest({action:"add",audioListArr:e,callBackFn:t}),e,!0===o?new u(a,e,function(e){Object.keys(e).forEach(function(t){r[e[t].key]={},r[e[t].key]=e[t]}),t()}).load():Object.keys(e).forEach(function(t){!1===s.mp3Support()&&(e[t].source=e[t].source.replace(".mp3",".ogg")),r[e[t].key]=new Howl({src:[e[t].source]}),r[e[t].key].once("load",n),r[e[t].key].once("loaderror",i)})},this.play=function(t,e){if(n&&s.sfxObj.stop(),!0===o&&r[t]){if(r[t].context=a.createBufferSource(),r[t].context.context.sampleRate!==c){var i=a.createBuffer(1,1,c);r[t].context=a.createBufferSource(),r[t].context.buffer=i,r[t].context.connect(a.destination),r[t].context.start(0),r[t].context.disconnect(),a.close(),a=new window.AudioContext,r[t].context=a.createBufferSource()}e&&(r[t].context.onended=e),r[t].context.buffer=r[t].buffer,r[t].context.connect(a.destination),r[t].context.start(0)}else r[t]&&(r[t].play(),e&&r[t].on("end",e));n=t},this.stop=function(){!0===o&&r[n]?r[n].context.stop():r[n]&&r[n].stop(),n=void 0},this.setAudioList=function(t){t}},this.mp3Support=function(){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType("audio/mpeg;").replace(/no/,""))},u.prototype.loadBuffer=function(t,e){!1===s.mp3Support()&&(t=t.replace(".mp3",".ogg"));var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer";var n=this;i.onload=function(){n.context.decodeAudioData(i.response,function(t){n.bufferList[e]=e,n.urlList[e].buffer=t,++n.loadCount===n.urlList.length&&n.onload(n.urlList)},function(t){console.log("decodeAudioData error",t),"undefined"!=typeof trackJs&&trackJs.console.error("Audio load error "+JSON.stringify(t)),window.alert("There was an error loading a critical file for this lesson. The lesson needs to close"),onViewUpdateCls.trigger("onGlobalUpdate",{type:"onClosePlayerWindow"})})},i.onerror=function(t){console.log("onerror",t),"undefined"!=typeof trackJs&&trackJs.console.error("Audio load error"),window.alert("There was an error loading a critical file for this lesson. The lesson needs to close"),onViewUpdateCls.trigger("onGlobalUpdate",{type:"onClosePlayerWindow"})},i.send()},u.prototype.load=function(){for(var t=0;t<this.urlList.length;++t)this.loadBuffer(this.urlList[t].source,t)}}function AudioNativeClass(){var e,i,n=new Audio,r=Object.prototype.hasOwnProperty,a=this,o=function(){},s=function(){},l=!1,c=!1,h=new MediaErrorHandlingClass({refObj:a,element:n,type:"audio"});n.addEventListener("ended",function(){o()},!1),n.addEventListener("error",function(t){h.pushError(t)},!1),this.addAudio=function(t){i="add",h.registerRequest({action:"add",dataObj:t}),n.src="",o=r.call(t,"callback")?function(){t.callback()}:function(){},s=r.call(t,"startCallback")?function(){t.startCallback()}:function(){},r.call(t,"errorCallback")?function(){t.errorCallback()}:function(){},l=!!r.call(t,"stopOnLoad")&&t.stopOnLoad,!1===this.mp3Support()&&(t.src=t.src.replace(".mp3",".ogg")),h.setFilePath(t.src),n.src=t.src,n.load(),clearInterval(e),-1===n.src.indexOf("blank.")&&(e=setInterval(function(){0<n.currentTime&&(clearInterval(e),s(),s=function(){},!0===l&&(l=!1,a.pauseAudio()),"pause"===i&&a.pauseAudio())},5))},this.mp3Support=function(){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType("audio/mpeg;").replace(/no/,""))},this.removeAudio=function(){trace("remove audio..."),i="remove",n.src=""},this.callEnded=function(){trace("call ended...")},this.playAudio=function(t){if(i="play",h.registerRequest({action:"playAudio",dataObj:t}),void 0!==t&&(n.currentTime=t),""!==n.src){var e=n.play();void 0!==e&&e.then(function(){c=!0}).catch(function(t){null===n.error?!1===c&&(onModelUpdateCls.trigger("setCProp",{mediaPromiseErrorTypeStr:"audio"}),console.log("playPromise error audio",t),s(),s=function(){},onViewUpdateCls.trigger("onGlobalUpdate",{type:"navPauseBtnClick"})):h.pushError(t)})}},this.pauseAudio=function(){trace("pause audio..."),i="pause",""!==n.src&&0<n.currentTime&&n.pause()},this.getCurrentTime=function(){return trace("Get current Time ..."),n.currentTime},this.reload=function(){i="reload";var t=n.src;n.src="",n.src=t}}function trace(t){}function isAudioContextSupported(){return window.AudioContext=window.AudioContext||window.webkitAudioContext,!!window.AudioContext}function MediaErrorHandlingClass(t){var n=0,r=t.refObj,a=t.element,o=t.type,s=this,l={action:null,dataObj:null},c="No file source";this.registerRequest=function(t){l=t},this.setFilePath=function(t){void 0!==t&&(c=t)},this.pushError=function(t,e){var i;switch(n+=1,o){case"audio":case"video":switch(a.error.code){case a.error.MEDIA_ERR_ABORTED:i="You aborted the audio/video playback.";break;case a.error.MEDIA_ERR_NETWORK:i="A network error caused the audio/video download to fail part-way.";break;case a.error.MEDIA_ERR_DECODE:i="The video/Audio playback was aborted due to a corruption problem or because the audio/video used features your browser did not support.";break;case a.error.MEDIA_ERR_SRC_NOT_SUPPORTED:i="The video/Audio could not be loaded, either because the server or network failed or because the format is not supported.";break;default:i="An unknown error occurred."}break;case"audioContext":i="audio sfx missing"}n<=3?(console.log("media error retry delay started"),setTimeout(function(){switch(console.log("media error retry delay end"),o){case"video":"add"===l.action?r.add(l.dataObj):(r.reload(),r.playVideo(l.dataObj));break;case"audio":"add"===l.action?r.addAudio(l.dataObj):(r.reload(),r.playAudio(l.dataObj));break;case"audioContext":"add"===l.action&&r.sfxObj.add(l.audioListArr,l.callBackFn)}},500)):4===n&&(console.log(i+"file path = "+c),"undefined"!=typeof trackJs&&("No file source"!==c?trackJs.console.error(i+"; file path = "+c):trackJs.console.error(i)),s.backToDashboard())},this.backToDashboard=function(){window.alert("There was an error loading a critical file for this lesson. The lesson needs to close"),onViewUpdateCls.trigger("onGlobalUpdate",{type:"onClosePlayerWindow"})}}function KeyHandlerClass(){var a={};function t(i){Object.keys(a).forEach(function(e){a[e].forEach(function(t){t({nativeEvent:i,compId:e})})})}this.init=function(){window.addEventListener("keyup",t),window.addEventListener("keydown",t),window.addEventListener("keypress",t)},this.addKeyEvents=function(t){var e=t.id,i=t.callback;a[e]||(a[e]=[]),a[e].push(i)},this.removeKeyEvents=function(t){var e,i=t.id,n=t.callback;if(a[e=i]&&0<a[e].length){var r=a[i].indexOf(n);a[i].splice(r,1),0===a[i].length&&delete a[i]}}}function MouseHandlerClass(){var dataObj={},scaledDataObj={},mouseRegionObj={},lastPageX=0,lastPageY=0,mouseEvents={},mousePoniterStyle="default",activeElement=null,newMouseEnterElement=null,mouseContextObj,hitAreaArr;function onGlobalUpdate(t){switch(t.type){case"resumeGlobalMouseEvent":applyMouseEvents(!0);break;case"stopGlobalMouseEvent":applyMouseEvents(!1)}}function upadteHitAreas(){var t=dataObj.interactiveLayerArr;if(t){hitAreaArr=[];for(var e=t.length-1;0<=e;e--){var i=mouseRegionObj[t[e]];if(void 0!==i)for(var n=i.length-1;0<=n;n--){var r={id:t[e],subId:i[n].id,color:getRandomColor(),rect:i[n].rect,arc:i[n].arc,shape:i[n].shape};hitAreaArr.push(r)}}drawNav()}}function drawNav(){if(void 0!==scaledDataObj.scale){mouseContextObj.clearRect(0,0,dataObj.mouseCanvasObj.width,dataObj.mouseCanvasObj.height),mouseContextObj.save(),mouseContextObj.scale(scaledDataObj.scale,scaledDataObj.scale);for(var _ni=hitAreaArr.length-1;0<=_ni;_ni--){var _el=hitAreaArr[_ni];if(mouseContextObj.beginPath(),mouseContextObj.fillStyle=_el.color,void 0!==_el.rect)mouseContextObj.fillRect(_el.rect.x,_el.rect.y,_el.rect.w,_el.rect.h);else if(void 0!==_el.arc)mouseContextObj.arc(_el.arc.x,_el.arc.y,_el.arc.r,0,2*Math.PI),mouseContextObj.fill();else if(void 0!==_el.shape){for(var _sh=0;_sh<_el.shape.length;_sh++)eval("mouseContextObj."+_el.shape[_sh]);mouseContextObj.fill()}mouseContextObj.closePath()}mouseContextObj.restore()}}function mouseEventHandler(t){var e,i;i=LabComClass.BrowserDetect.isDevice()?(e=(void 0!==t.targetTouches[0]&&(lastPageX=t.targetTouches[0].pageX,lastPageY=t.targetTouches[0].pageY),lastPageX),lastPageY):(e=t.pageX,t.pageY);var n="";switch(t.type){case"touchstart":case"mousedown":n="mousedown";break;case"touchmove":case"mousemove":n="mousemove";break;case"touchend":case"mouseup":n="mouseup"}e-=scaledDataObj.x,i-=scaledDataObj.y,""!==n&&isMouseInRegion({pageX:e,pageY:i,typeStr:n})}function isMouseInRegion(t){var e="default",i=checkMouseIn(t.pageX,t.pageY);if("mousemove"===t.typeStr&&(null===activeElement?(null!==i?newMouseEnterElement!==i?(null!==newMouseEnterElement&&dispatchMouseEvent("mouseout",t,newMouseEnterElement),dispatchMouseEvent("mouseenter",t,i)):dispatchMouseEvent("mousemove",t,newMouseEnterElement):null!==newMouseEnterElement&&dispatchMouseEvent("mouseout",t,newMouseEnterElement),newMouseEnterElement=i):dispatchMouseEvent("mousemove",t,activeElement)),"mousedown"===t.typeStr&&(null===activeElement&&null!==i&&(activeElement=i,dispatchMouseEvent(t.typeStr,t,activeElement)),dispatchStageEvent(activeElement)),"mouseup"===t.typeStr&&null!==activeElement&&(null!==i&&activeElement.id===i.id&&activeElement.subId===i.subId?dispatchMouseEvent("mouseup",t,activeElement):dispatchMouseEvent("mouseupout",t,activeElement),activeElement=newMouseEnterElement=null),null!==activeElement)e=void 0===activeElement.cursor?"pointer":activeElement.cursor;else{var n=checkMouseIn(t.pageX,t.pageY);null!==n&&(e=void 0===n.cursor?"pointer":n.cursor)}mousePoniterStyle!==e&&(document.body.style.cursor=e),mousePoniterStyle=e}function dispatchMouseEvent(t,e,i){var n=mouseRegionObj[i.id]?mouseRegionObj[i.id][i.subIndex]:void 0;if(void 0!==n&&void 0!==n.eventListener){var r={id:i.id,subId:n.id,type:t,pageX:e.pageX/scaledDataObj.scale,pageY:e.pageY/scaledDataObj.scale};n.eventListener(r)}onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"})}function dispatchStageEvent(r){null===r&&(r={id:null,subId:null}),Object.keys(mouseRegionObj).forEach(function(t){for(var e=0;e<mouseRegionObj[t].length;e++){var i=mouseRegionObj[t][e];if(void 0!==i.eventListener){var n={id:r.id,subId:r.id,type:"stageevent",pageX:r.pageX/scaledDataObj.scale,pageY:r.pageY/scaledDataObj.scale};i.eventListener(n)}}})}function checkMouseIn(t,e){var i=mouseContextObj.getImageData(t,e,1,1),n=LabComClass.rgba2hex(i.data[0],i.data[1],i.data[2],i.data[3]).substring(0,6);if("000000"!==n)for(var r=0;r<hitAreaArr.length;r++){if(hitAreaArr[r].color.replace("#","")===n){for(var a=mouseRegionObj[hitAreaArr[r].id],o=0;o<a.length;o++)if(a[o].id===hitAreaArr[r].subId)return{id:hitAreaArr[r].id,subIndex:o,cursor:a[o].cursor};break}}return null}function getRandomColor(){for(var t="0123456789".split(""),e="#",i=0;i<6;i++)e+=t[Math.floor(Math.random()*t.length)];return e}function applyMouseEvents(t){document.body.style.cursor="default",document.body.removeEventListener(mouseEvents.down,mouseEventHandler),document.body.removeEventListener(mouseEvents.move,mouseEventHandler),document.body.removeEventListener(mouseEvents.up,mouseEventHandler),t&&(document.body.addEventListener(mouseEvents.down,mouseEventHandler,{passive:!1}),document.body.addEventListener(mouseEvents.move,mouseEventHandler,{passive:!1}),document.body.addEventListener(mouseEvents.up,mouseEventHandler,{passive:!1}))}this.init=function(t){mouseEvents=(dataObj=t).deviceTypeBool?{down:"touchstart",move:"touchmove",up:"touchend",click:"click"}:{down:"mousedown",move:"mousemove",up:"mouseup",click:"click"},mouseContextObj=dataObj.mouseCanvasObj.getContext("2d"),applyMouseEvents(!0),onViewUpdateCls.on("onGlobalUpdate",onGlobalUpdate)},this.updateOnResize=function(t){scaledDataObj=t,upadteHitAreas()},this.updateInteractiveLayer=function(t){dataObj.interactiveLayerArr=t,upadteHitAreas()},this.addMouseEvent=function(e){mouseRegionObj[e.id]||(mouseRegionObj[e.id]=[]);for(var i=0;i<e.r.length;i++){for(var t=!1,n=0;n<mouseRegionObj[e.id].length;n++)mouseRegionObj[e.id][n].id===e.r[i].id&&(t=!0,Object.keys(e.r[i]).forEach(function(t){mouseRegionObj[e.id][n][t]=e.r[i][t]}));t||mouseRegionObj[e.id].push(e.r[i])}upadteHitAreas()},this.removeMouseEvent=function(t){if(t.r&&mouseRegionObj[t.id])for(var e=0;e<t.r.length;e++)for(var i=0;i<mouseRegionObj[t.id].length;i++)mouseRegionObj[t.id][i].id===t.r[e]&&mouseRegionObj[t.id].splice(i,1);else mouseRegionObj[t.id]&&delete mouseRegionObj[t.id];upadteHitAreas()}}var LabComClass={contentAreaObj:{},globalLangText:"",snapshotCnvObj:{},setCnvScale:function(t){LabComClass.scale=t},setVirtualCnv:function(t){LabComClass.virtualCnv=t},setSnapshotCnv:function(t){LabComClass.snapshotCnvObj=t},globalSnapShot:function(o){var s=new Image;s.onload=function(){var a=new Image;a.onload=function(){var e=LabComClass.snapshotCnvObj.snapshotCnvObj;e.width=LabComClass.snapshotCnvObj.contCanvasObj.width,e.height=LabComClass.snapshotCnvObj.contCanvasObj.height;var t=0,i=0;void 0!==o.areaObj&&(e.width=o.areaObj.width*LabComClass.snapshotCnvObj.scale*LabComClass.snapshotCnvObj.devScaleRatioInt,e.height=o.areaObj.height*LabComClass.snapshotCnvObj.scale*LabComClass.snapshotCnvObj.devScaleRatioInt,t=o.areaObj.x*LabComClass.snapshotCnvObj.scale*LabComClass.snapshotCnvObj.devScaleRatioInt*-1,i=o.areaObj.y*LabComClass.snapshotCnvObj.scale*LabComClass.snapshotCnvObj.devScaleRatioInt*-1);var n=e.getContext("2d");n.drawImage(s,t,i),n.drawImage(a,t,i);var r=new Image;r.onload=function(){if(void 0!==o.callback){var t=new Image;t.src=e.toDataURL("image/png"),o.callback(t)}},r.src=e.toDataURL("image/png")},a.src=LabComClass.snapshotCnvObj.contCanvasObj.toDataURL("image/png")},s.src=LabComClass.snapshotCnvObj.bgCanvasObj.toDataURL("image/png")},EventClass:function(r){var a={},o=Object.prototype.hasOwnProperty;function s(t,e,i){if(void 0!==a[t])for(var n=0;n<a[t].length;n++)"function"==typeof a[t][n]&&a[t][n](e,i)}this.trigger=function(e,i,n){Object.keys(a).forEach(function(t){t===e&&o.call(a,t)&&(!0===r?s(t,i,n):requestAnimationFrame(function(){s(t,i,n)}))})},this.on=function(t,e){void 0===a[t]&&(a[t]=[]),a[t].push(e)},this.off=function(e,i){requestAnimationFrame(function(){if(void 0!==a[e])for(var t=0;t<a[e].length;t++)a[e][t]===i&&a[e].splice(t,1)})}},defineObject:function(t,e,i){Object.defineProperty(t,e,{value:i,writable:!1,configurable:!0,enumerable:!0})},global_line_intersect:function(t,e,i,n,r,a,o,s){var l,c,h=(s-a)*(i-t)-(o-r)*(n-e);return 0===h?null:{x:t+(l=((o-r)*(e-a)-(s-a)*(t-r))/h)*(i-t),y:e+(c=((i-t)*(e-a)-(n-e)*(t-r))/h)*(n-e),seg1:0<=l&&l<=1,seg2:0<=c&&c<=1}},localImagePath:"",globalImagePath:"",requestLocalImage:function(t,e,i){for(var n={},r=0;r<t.length;r++)n[t[r]]=LabComClass.localImagePath+t[r];LabComClass.imageLoader(n,e,i)},requestGlobalImage:function(t,e,i){for(var n={},r=0;r<t.length;r++)n[t[r]]=LabComClass.globalImagePath+t[r];LabComClass.imageLoader(n,e,i)},rgba2hex:function(t,e,i,n){if(255<t||255<e||255<i||255<n)throw"Invalid color component";return(256+t).toString(16).substr(1)+((1<<24)+(e<<16)|i<<8|n).toString(16).substr(1)},imageLoader:function(e,t,i){var n={},r=0,a=[],o=[],s=0;void 0!==i&&(s=i);var l=3;function c(){var t=o[r];n[t]=new Image,n[t].onerror=h,n[t].onload=u,n[t].src=a[r]}function h(){(s+=1)<=l?c():window.alert("There was an error loading a critical file for this lesson. The lesson needs to close")}function u(){s=0,(r+=1)===a.length?t(n):c()}Object.keys(e).forEach(function(t){a.push(e[t]),o.push(t)}),c()},BrowserDetect:{platformAndroid:function(){return!!navigator.userAgent.match(/Android/i)},platformBlackBerry:function(){return!!navigator.userAgent.match(/BlackBerry/i)},platformIOS:function(){return!!navigator.userAgent.match(/iPhone|iPad|iPod|caireadymobile/i)||0<navigator.maxTouchPoints&&void 0!==window.orientation},platformWindows:function(){return!!navigator.userAgent.match(/IEMobile/i)},isDevice:function(){return LabComClass.BrowserDetect.platformAndroid()||LabComClass.BrowserDetect.platformBlackBerry()||LabComClass.BrowserDetect.platformIOS()||LabComClass.BrowserDetect.platformWindows()},ie9:function(){return!!navigator.userAgent.match(/MSIE 9.0/i)},ie10:function(){return!!navigator.userAgent.match(/MSIE 10.0/i)},ie:function(){return"Microsoft Internet Explorer"===navigator.appName||!(!navigator.userAgent.match(/Trident/)&&!navigator.userAgent.match(/rv:11/))||0<navigator.userAgent.indexOf("MSIE")||!!navigator.userAgent.match(/Edge\/\d./i)||!!navigator.userAgent.match(/MSIE 9.0/i)||!!navigator.userAgent.match(/MSIE 10.0/i)}},GlobalAnimClass:function(){var n,r={},a=!1;function e(){var i=new Date;Object.keys(r).forEach(function(t){if(void 0!==r[t].delay)(void 0===r[t].oldDate||i-r[t].oldDate>=r[t].delay)&&(r[t].oldDate=i,r[t].frame&&r[t].frame(t));else if(void 0!==r[t].fps){var e=Math.ceil((i-r[t].oldDate)/(1/r[t].fps*1e3));r[t].lastFrame!==e&&(r[t].resetVal&&(r[t].oldDate=new Date,e=1,r[t].resetVal=null),r[t].lastFrame=e,r[t].frame&&r[t].frame({id:t,frame:e}))}}),a&&(n=requestAnimationFrame(e))}this.start=function(t){t.id&&((r[t.id]=t).immediate||(r[t.id].oldDate=new Date),r[t.id].lastFrame=null,r[t.id].start&&r[t.id].start()),a||(a=!0,e())},this.stop=function(t){var e,i;t&&r[t]&&(r[t].stop&&r[t].stop(),void 0!==r[t]&&delete r[t]),0===(e=r,i=0,Object.keys(e).forEach(function(t){e.hasOwnProperty(t)&&i++}),i)&&(a=!1,cancelAnimationFrame(n))},this.reset=function(t){r[t].resetVal=!0},function(){for(var a=0,t=["webkit","moz"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var i=(new Date).getTime(),n=Math.max(0,16-(i-a)),r=setTimeout(function(){t(i+n)},n);return a=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}()},Maths:{TO_DEGREES:180/Math.PI,TO_RADIANS:Math.PI/180,getDistance:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},getAngle:function(t,e,i,n){return Math.atan2(n-e,i-t)},getPoint:function(t,e,i){var n={};return n.x=t.x+i*Math.cos(e),n.y=t.y+i*Math.sin(e),n},getLineintersect:function(t,e,i,n,r,a,o,s){var l,c,h=(s-a)*(i-t)-(o-r)*(n-e);return 0===h?null:{x:t+(l=((o-r)*(e-a)-(s-a)*(t-r))/h)*(i-t),y:e+(c=((i-t)*(e-a)-(n-e)*(t-r))/h)*(n-e),seg1:0<=l&&l<=1,seg2:0<=c&&c<=1}},getIntersectTOfTwoCircles:function(t,e,i,n,r,a){var o=LabComClass.Maths.getDistance({x:t,y:e},{x:n,y:r}),s=.5*Math.sqrt(2*(Math.pow(i,2)+Math.pow(a,2))/Math.pow(o,2)-Math.pow(Math.pow(i,2)-Math.pow(a,2),2)/Math.pow(o,4)-1);return[{x:.5*(t+n)+(Math.pow(i,2)-Math.pow(a,2))*(n-t)/(2*Math.pow(o,2))+s*(r-e),y:.5*(e+r)+(Math.pow(i,2)-Math.pow(a,2))*(r-e)/(2*Math.pow(o,2))+s*(t-n)},{x:.5*(t+n)+(Math.pow(i,2)-Math.pow(a,2))*(n-t)/(2*Math.pow(o,2))-s*(r-e),y:.5*(e+r)+(Math.pow(i,2)-Math.pow(a,2))*(r-e)/(2*Math.pow(o,2))-s*(t-n)}]}},Vector:function(t,e,i){return this.x=t||0,this.y=e||0,this.z=i||0,this.reset=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},this.toString=function(t){t=t||3;var e=Math.pow(10,t);return"["+Math.round(this.x*e)/e+", "+Math.round(this.y*e)/e+", "+Math.round(this.z*e)/e+"]"},this.clone=function(){return new LabComClass.Vector(this.x,this.y,this.z)},this.copyTo=function(t){t.x=this.x,t.y=this.y,t.z=this.z},this.copyFrom=function(t){this.x=t.x,this.y=t.y,this.z=t.z},this.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},this.normalise=function(){var t=this.magnitude();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this},this.reverse=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},this.plusEq=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},this.plusNew=function(t){return new LabComClass.Vector(this.x+t.x,this.y+t.y,this.z+t.z)},this.minusEq=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},this.getNormal=function(){return new LabComClass.Vector(-this.y,this.x,this.z)},this.minusNew=function(t){return new LabComClass.Vector(this.x-t.x,this.y-t.y,this.z-t.z)},this.multiplyEq=function(t){return this.x*=t,this.y*=t,this.z*=t,this},this.multiplyNew=function(t){return this.clone().multiplyEq(t)},this.divideEq=function(t){return this.x/=t,this.y/=t,this.z/=t,this},this.divideNew=function(t){return this.clone().divideEq(t)},this.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},this.angle=function(t){return Math.atan2(this.y,this.x)*(t?1:LabComClass.Maths.TO_DEGREES)},this.rotate=function(t,e){var i=Math.cos(t*(e?1:LabComClass.Maths.TO_RADIANS)),n=Math.sin(t*(e?1:LabComClass.Maths.TO_RADIANS)),r={clone:new LabComClass.Vector};return r.clone.copyFrom(this),this.x=r.clone.x*i-r.clone.y*n,this.y=r.clone.x*n+r.clone.y*i,this},this.equals=function(t){return this.x===t.x&&this.y===t.x},this.length=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))},this.angleBetween=function(t){return this.z=void 0===this.z?0:this.z,t.z=void 0===t.z?0:t.z,Math.acos((this.x*t.x+this.y*t.y+this.z*t.z)/(Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))*Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)+Math.pow(t.z,2))))},this.crossProduct=function(t){var e=this.y*t.z-this.z*t.y,i=this.x*t.z-this.z*t.x,n=this.x*t.y-this.y*t.x;return new LabComClass.Vector(e,i,n)},this},Matrix:function(t,e,i){var n,r=this;this.elements=[],this.setElements=function(t){var e,i=t.elements||t;if(void 0!==i[0][0]){var n,r,a,o=i.length,s=o;this.elements=[];do{for(r=n=i[e=s-o].length,this.elements[e]=[];a=r-n,this.elements[e][a]=i[e][a],--n;);}while(--o);return this}var l=i.length,c=l;for(this.elements=[];e=c-l,this.elements.push([i[e]]),--l;);return this},this.elem=function(t,e){return t<1||t>this.elements.length||e<1||e>this.elements[0].length?null:this.elements[t-1][e-1]},this.row=function(t){return t>this.elements.length?null:this.elements[t-1]},this.col=function(t){if(t>this.elements[0].length)return null;for(var e,i=[],n=this.elements.length,r=1*n;e=r-n,i.push(this.elements[e][t-1]),--n;);return i},this.dimensions=function(){return{rows:this.elements.length,cols:this.elements[0].length}},this.rows=function(){return this.elements.length},this.cols=function(){return this.elements[0].length},this.eql=function(t){var e=t.elements||t;if(void 0===e[0][0]&&(e=(new LabComClass.Matrix).setElements(e).elements),this.elements.length!==e.length||this.elements[0].length!==e[0].length)return!1;var i,n,r,a=this.elements.length,o=a,s=this.elements[0].length;do{i=o-a,n=s;do{if(r=s-n,0<Math.abs(this.elements[i][r]-e[i][r]))return!1}while(--n)}while(--a);return!0},this.dup=function(){return(new LabComClass.Matrix).setElements(this.elements)},this.map=function(t){var e,i,n,r=[],a=this.elements.length,o=a,s=this.elements[0].length;do{for(i=s,r[e=o-a]=[];n=s-i,r[e][n]=t(this.elements[e][n],e+1,n+1),--i;);}while(--a);return(new LabComClass.Matrix).setElements(r)},this.isSameSizeAs=function(t){var e=t.elements||t;return void 0===e[0][0]&&(e=(new LabComClass.Matrix).setElements(e).elements),this.elements.length===e.length&&this.elements[0].length===e[0].length},this.add=function(t){var n=t.elements||t;return void 0===n[0][0]&&(n=(new LabComClass.Matrix).setElements(n).elements),this.isSameSizeAs(n)?this.map(function(t,e,i){return t+n[e-1][i-1]}):null},this.subtract=function(t){var n=t.elements||t;return void 0===n[0][0]&&(n=(new LabComClass.Matrix).setElements(n).elements),this.isSameSizeAs(n)?this.map(function(t,e,i){return t-n[e-1][i-1]}):null},this.canMultiplyFromLeft=function(t){var e=t.elements||t;return void 0===e[0][0]&&(e=(new LabComClass.Matrix).setElements(e).elements),this.elements[0].length===e.length},this.multiply=function(e){if(!e.elements)return this.map(function(t){return t*e});var t=!!e.modulus,i=e.elements||e;if(void 0===i[0][0]&&(i=(new LabComClass.Matrix).setElements(i).elements),!this.canMultiplyFromLeft(i))return null;var n,r,a,o,s,l,c=this.elements.length,h=c,u=i[0].length,d=this.elements[0].length,p=[];do{p[n=h-c]=[],r=u;do{for(a=u-r,o=0,s=d;l=d-s,o+=this.elements[n][l]*i[l][a],--s;);p[n][a]=o}while(--r)}while(--c);return i=(new LabComClass.Matrix).setElements(p),t?i.col(1):i},this.x=function(t){return this.multiply(t)},this.minor=function(t,e,i,n){var r,a,o,s=[],l=i,c=this.elements.length,h=this.elements[0].length;do{for(s[r=i-l]=[],a=n;o=n-a,s[r][o]=this.elements[(t+r-1)%c][(e+o-1)%h],--a;);}while(--l);return(new LabComClass.Matrix).setElements(s)},this.transpose=function(){var t,e,i,n=this.elements.length,r=this.elements[0].length,a=[],o=r;do{for(a[t=r-o]=[],e=n;i=n-e,a[t][i]=this.elements[i][t],--e;);}while(--o);return(new LabComClass.Matrix).setElements(a)},this.isSquare=function(){return this.elements.length===this.elements[0].length},this.max=function(){var t,e,i,n=0,r=this.elements.length,a=r,o=this.elements[0].length;do{for(t=a-r,e=o;i=o-e,Math.abs(this.elements[t][i])>Math.abs(n)&&(n=this.elements[t][i]),--e;);}while(--r);return n},this.indexOf=function(t){var e,i,n,r=this.elements.length,a=r,o=this.elements[0].length;do{e=a-r,i=o;do{if(n=o-i,this.elements[e][n]===t)return{i:e+1,j:n+1}}while(--i)}while(--r);return null},this.diagonal=function(){if(!this.isSquare)return null;for(var t,e=[],i=this.elements.length,n=i;t=n-i,e.push(this.elements[t][t]),--i;);return e},this.toRightTriangular=function(){var t,e,i,n,r=this.dup(),a=this.elements.length,o=a,s=this.elements[0].length;do{if(e=o-a,0===r.elements[e][e])for(var l=e+1;l<o;l++)if(0!==r.elements[l][e]){for(t=[],i=s;n=s-i,t.push(r.elements[e][n]+r.elements[l][n]),--i;);r.elements[e]=t;break}if(0!==r.elements[e][e])for(l=e+1;l<o;l++){var c=r.elements[l][e]/r.elements[e][e];for(t=[],i=s;n=s-i,t.push(n<=e?0:r.elements[l][n]-r.elements[e][n]*c),--i;);r.elements[l]=t}}while(--a);return r},this.toUpperTriangular=function(){return this.toRightTriangular()},this.determinant=function(){if(!this.isSquare())return null;for(var t,e=this.toRightTriangular(),i=e.elements[0][0],n=e.elements.length-1,r=n;t=r-n+1,i*=e.elements[t][t],--n;);return i},this.det=function(){return this.determinant()},this.isSingular=function(){return this.isSquare()&&0===this.determinant()},this.trace=function(){if(!this.isSquare())return null;for(var t,e=this.elements[0][0],i=this.elements.length-1,n=i;t=n-i+1,e+=this.elements[t][t],--i;);return e},this.tr=function(){return this.trace()},this.rank=function(){var t,e,i,n=this.toRightTriangular(),r=0,a=this.elements.length,o=a,s=this.elements[0].length;do{t=o-a,e=s;do{if(i=s-e,0<Math.abs(n.elements[t][i])){r++;break}}while(--e)}while(--a);return r},this.rk=function(){return this.rank()},this.augment=function(t){var e=t.elements||t;void 0===e[0][0]&&(e=(new LabComClass.Matrix).setElements(e).elements);var i,n,r,a=this.dup(),o=a.elements[0].length,s=a.elements.length,l=s,c=e[0].length;if(s!==e.length)return null;do{for(i=l-s,n=c;r=c-n,a.elements[i][o+r]=e[i][r],--n;);}while(--s);return a},this.inverse=function(){if(!this.isSquare()||this.isSingular())return null;var t,e,i,n,r,a,o,s=this.elements.length,l=s,c=this.augment(LabComClass.Matrix.I(s)).toRightTriangular(),h=c.elements[0].length,u=[];do{for(r=[],i=h,u[t=s-1]=[],a=c.elements[t][t];n=h-i,o=c.elements[t][n]/a,r.push(o),l<=n&&u[t].push(o),--i;);for(c.elements[t]=r,e=0;e<t;e++){for(r=[],i=h;n=h-i,r.push(c.elements[e][n]-c.elements[t][n]*c.elements[e][t]),--i;);c.elements[e]=r}}while(--s);return(new LabComClass.Matrix).setElements(u)},this.inv=function(){return this.inverse()},this.round=function(){return this.map(function(t){return Math.round(t)})},this.snapTo=function(e){return this.map(function(t){return Math.abs(t-e)<=0?e:t})},this.inspect=function(){for(var t,e=[],i=this.elements.length,n=i;t=n-i,e.push("["+this.elements[t].join(", ")+"]"),--i;);return e.join("\n")},this.RotationZ=function(t){var e=Math.cos(t),i=Math.sin(t);return(new LabComClass.Matrix).setElements([[e,-i,0],[i,e,0],[0,0,1]])},(n=t)&&r.setElements(n)},calculateSentenceHighlight:function(t,i,n){var r,a={},o=[],s=[],l=0;t.forEach(function(t,e){e>=n.s&&e<=n.e&&"number"==typeof t.lineIndex&&(a.hasOwnProperty(t.lineIndex)||(l<t.maxFontSize&&(l=t.maxFontSize),a[t.lineIndex]=[]),a[t.lineIndex].push(t))});Object.keys(a).length;return Object.keys(a).forEach(function(t){r=a[t].length-1," "===a[t][r].value&&(r-=1);var e=0;a[t][0].fontSizeNum<l&&(e=(l-a[t][0].fontSizeNum)/2),o.push({xInt:a[t][0].x,yInt:a[t][0].y-i/2-e},{xInt:a[t][0].x,yInt:a[t][0].y+a[t][0].fontSizeNum+i/2+e}),s.push({xInt:a[t][r].x+a[t][r].w,yInt:a[t][r].y-i/2-e},{xInt:a[t][r].x+a[t][r].w,yInt:a[t][r].y+a[t][r].fontSizeNum+i/2+e})}),0<o.length&&0<s.length&&o.forEach(function(t,e){s.push(o[o.length-1-e])}),s},getUnderline:function(t,e){for(var i=e.s,n=e.e,r=[i],a=0;a<t.length;a+=1)i<=a&&a<=n&&void 0!==t[a+1]&&t[a].lineIndex!==t[a+1].lineIndex&&(r.push(a),a+1<=n&&r.push(a+1));return-1===r.indexOf(n)&&r.push(n),r.length%2!=0&&r.push(n),r},TextImgClass:function(i,t,e){var n,r=document.createElement("pre"),a=document.createElement("canvas"),o=a.getContext("2d"),s={fontFamilyStr:"Polo22Klett-Regular",align:"left",color:"#000000",fontSizeNum:16,background:"rgba(0, 0, 0, 0)",stroke:0,fontFormat:"pt ",strokeColor:"#FFFFFF",lineHeight:"1.2em",bold:!1,italic:!1};t=t||i.textStr||"",i=i||{},Object.keys(s).forEach(function(t){i[t]||(i[t]=s[t])}),s="font: ",(i.italic||0<=t.indexOf(LabComClass.italic)||0<=t.indexOf(LabComClass.italicbold))&&(s+="italic "),(i.bold||0<=t.indexOf(LabComClass.bold)||0<=t.indexOf(LabComClass.italicbold))&&(s+="bold "),s+=i.fontSizeNum+i.fontFormat+i.fontFamilyStr+";",s+="line-height:"+i.lineHeight+";",s+="text-align: "+i.align+";",s+="color: "+i.color+";",s+="background-color: "+i.background+";",s+=";padding: 0; display: block; position: fixed; top: 100%; overflow: hidden;",0<=(n=String(t)).indexOf(LabComClass.subscript)&&(i.yNum+=Math.round(i.fontSizeNum/5)),r.innerText=n,i.maxWidthNum&&(s+="max-width: "+i.maxWidthNum+"px; word-spacing: normal;word-break: keep-all; white-space: pre-wrap; white-space: -moz-pre-wrap;white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word"),r.setAttribute("style",s),document.body.appendChild(r);var l=[],c=[],h="";if(i.italic&&(h+="italic "),i.bold&&(h+="bold "),i.italic&&i.bold?t=LabComClass.italicbold+t+LabComClass.end:i.italic?t=LabComClass.italic+t+LabComClass.end:i.bold&&(t=LabComClass.bold+t+LabComClass.end),h+=i.fontSizeNum+i.fontFormat+i.fontFamilyStr,o.font=h,o.textAlign=i.align,o.lineWidth=i.stroke,o.strokeStyle=i.strokeColor,o.fillStyle=i.color,i.maxWidthNum&&-1===t.indexOf("\n"))for(;t.length;){for(var u=t.length;o.measureText(t.substr(0,u)).width>i.maxWidthNum;u--);var d=t.substr(0,u);if(u!==t.length)for(var p=0;-1!==d.indexOf(" ",p);p=d.indexOf(" ",p)+1);l.push(d.substr(0,p||d.length));var f=Math.max(f,o.measureText(l[l.length-1]).width);t=t.substr(l[l.length-1].length,t.length)}else l=t.split("\n");l.forEach(function(t,e){c[e]=t,c[e]=c[e].replace(LabComClass.bold,""),c[e]=c[e].replace(LabComClass.italic,""),c[e]=c[e].replace(LabComClass.italicbold,""),c[e]=c[e].replace(LabComClass.superscript,""),c[e]=c[e].replace(LabComClass.subscript,""),c[e]=c[e].replace(LabComClass.end,"")});var m,g=i.stroke,v=r.offsetHeight/l.length,y=.25*v;switch(a.width=4*(r.offsetWidth+2*i.xNum),a.height=4*(r.offsetHeight+2*i.yNum),o.clearRect(0,0,a.width,a.height),o.fillStyle=i.background,o.beginPath(),o.fillRect(0,0,a.width,a.height),o.fill(),h="",i.italic&&(h+="italic "),i.bold&&(h+="bold "),h=i.fontSizeNum+i.fontFormat+i.fontFamilyStr,o.font=h,o.textAlign="left",o.lineWidth=i.stroke,o.strokeStyle=i.strokeColor,o.fillStyle=i.color,i.align){case"center":g=a.width/4/2;break;case"right":g=a.width/4}o.scale(4,4),l.forEach(function(t,e){m="center"===i.align?(f=o.measureText(c[e]).width,g-f/2):"right"===i.align?(f=o.measureText(c[e]).width,g-f):g,i.stroke&&o.strokeText(t,m+i.xNum,v*(e+1)+i.yNum),o.drawStyledText(t,m+i.xNum,v*(e+1)-y+i.yNum,i.fontFamilyStr,i.fontSizeNum)}),document.body.removeChild(r);var _=new Image;return e&&(_.onload=e),_.src=a.toDataURL(),{imageObj:{imageObj:_,widthInt:a.width/4,heightInt:a.height/4}}},drawCurveRect:function(t,e,i,n,r){var a=t+i,o=e+n;this.beginPath(),this.moveTo(t+r,e),this.lineTo(a-r,e),this.arcTo(a,e,a,e+r,r),this.lineTo(a,o-r),this.arcTo(a,o,a-r,o,r),this.lineTo(t+r,o),this.arcTo(t,o,t,o-r,r),this.lineTo(t,e+r),this.arcTo(t,e,t+r,e,r),this.lineTo(t+r,e),this.fill(),this.closePath()},TextStyleClass:{s1Obj:{fontColor:"#FFCC00"}},drawStyledText:function(t,e,i,n,r){var a,o={r:"",i:"italic",b:"bold",t:"italic bold",l:"lighter",p:"",q:""},s=.59,l=[],c="r";"string"!=typeof t&&(t=t.toString());do{a=p(n,r,c),this.font=a;var h=t.indexOf("§");-1===h&&(h=t.length);var u=t.substring(0,h),d=i;switch(this.textAlign){case"center":"p"===c?e-=.65*this.measureText(u).width:"q"===c&&(e-=.7*this.measureText(u).width)}if("p"===c?d-=.35*r:"q"===c&&(d+=.3*r),this.fillText(u,e,d),h===t.length)break;switch(e+=this.measureText(u).width,this.textAlign){case"center":"p"===c?e+=this.measureText(u).width:"q"===c&&(e+=this.measureText(u).width)}c=t[h+1],t=t.substring(h+2)}while(0<t.length);function p(t,e,i){var n="";return"r"===i?l.splice(l.length-1,1):l.push(i),l.forEach(function(t){n+=" "+o[t]}),0<=l.indexOf("p")||0<=l.indexOf("q")?n+e*s+"px "+t:n+" "+e+"px "+t}},TweenClass:function(t){Object.prototype.hasOwnProperty;var e={plain:function(t,e,i,n){return e+i*(t/n)},back:function(t,e,i,n){var r=(t/=n)*t,a=r*t;return e+i*(177635683940025e-29*a*r+4*a+-9*r+6*t)},cubic:function(t,e,i,n){var r=(t/=n)*t,a=r*t;return e+i*(177635683940025e-29*a*r+.999999999999998*a+-3*r+3*t)}},i=[];if(e[t.type])for(var n=t.endValue-t.startValue,r=0;r<=t.duration;r+=1e3/24)i.push(e[t.type](r,t.startValue,n,t.duration));return i},jumpToSlide:function(t){onViewUpdateCls.trigger("onGlobalUpdate",{type:"onJumpToSlide",data:{curSlideInt:t}})},rgbToHex:function(t,e,i){if(255<t||255<e||255<i)throw"Invalid color component";return(t<<16|e<<8|i).toString(16)},childPreloadProgress:function(t){var e=t;window!==window.parent&&void 0!==window.parent.childPreloadProgress&&window.parent.childPreloadProgress(e)},createShadow:function(t){var e,i,n,r=document.createElement("canvas");r.getContext("2d");r.width=800,r.height=600,e=new createjs.Stage(r),(i=new createjs.Bitmap(t.imgObj[t.imgNameStr])).x=t.xInt,i.y=t.yInt,i.scaleX=t.widthInt/t.imgObj[t.imgNameStr].naturalWidth,i.scaleY=t.heightInt/t.imgObj[t.imgNameStr].naturalHeight;var a=t.hasOwnProperty("colorStr")?t.colorStr.replace("#","0x"):"0xffff00",o=t.hasOwnProperty("alphaInt")?t.alphaInt:1,s=t.hasOwnProperty("blurXInt")?t.blurXInt:20,l=t.hasOwnProperty("blurYInt")?t.blurYInt:20,c=t.hasOwnProperty("strengthInt")?t.strengthInt:3,h=t.hasOwnProperty("qualityInt")?t.qualityInt:1,u=!!t.hasOwnProperty("innerBool")&&t.innerBool,d=!!t.hasOwnProperty("knockoutBool")&&t.knockoutBool;n=new createjs.GlowFilter(a,o,s,l,c,h,u,d),i.filters=[n],i.cache(0,0,800,600),e.addChild(i),e.update();var p=r.toDataURL(),f=new Image;return f.src=p,f},getHostName:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window;try{e=t.self!==t.top?t.parent.location.hostname:t.location.hostname}catch(t){e="defaultHostName"}return e},fontLoader:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.fontArr,r=[],t=document.getElementsByTagName("body")[0],a=0,o=[],s=!1,l=function(){void 0!==e.callback&&e.callback()};if(0<n.length)for(var i=0;i<n.length;i+=1)r[i]=document.createElement("span"),r[i].innerHTML="preloadFont",r[i].style.color="rgba(0,0,0,0)",r[i].style.fontSize="24px",t.appendChild(r[i]),r[i].setAttribute("data-fontsizebefore",r[i].offsetWidth),r[i].setAttribute("data-fontloaded","false"),r[i].style.fontFamily=n[i];!function t(){if(o=[],a<r.length){for(var e=0;e<r.length;e+=1)"false"===r[e].getAttribute("data-fontloaded")&&Number(r[e].offsetWidth)!==Number(r[e].getAttribute("data-fontsizebefore"))?(r[e].setAttribute("data-fontsizeafter",r[e].offsetWidth),r[e].setAttribute("data-fontloaded","true"),a+=1):"false"===r[e].getAttribute("data-fontloaded")&&(r[e].innerHTML="preloadFont",r[e].style.color="rgba(0,0,0,0)",r[e].style.fontSize="24px",o.push(n[e]));!1===s&&requestAnimationFrame(t)}else{console.log("total "+a+" fonts loaded out of "+n.length);for(var i=0;i<r.length;i+=1)document.body.removeChild(r[i]);l(),l=function(){}}}(),setTimeout(function(){if(a<n.length){s=!0;for(var t=0;t<r.length;t+=1)document.body.removeChild(r[t]);void 0!==e.error&&e.error(o),l(),l=function(){}}},e.timeout?e.timeout:3e4)},tracer:function tracer(){var _obj=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};eval("console.log(_obj)")}};window.onViewUpdateCls=new LabComClass.EventClass(!0);var onModelUpdateCls=new LabComClass.EventClass(!0),controllerCls=new ControllerClass,viewCls=new ViewClass,modelCls=new ModelClass;onModelUpdateCls.trigger("controllerInit")}function BrainClass(e){var n={x:0,y:0,width:1280,height:720,height1:0,height2:0,distance:350,angle:45,initVelo:50,gravity:9.8,currentPath:[],paths:[],colorList:[],lineData:[],drawBall:!1,drawPath:!0,drawGraph:!0,drawProtractor:!0,drawAccessibility:!1,selectedColor:NaN,blastImg:NaN,timerText:"",protractor:{base:202}},i={restrictions:{initVelo:{min:10,max:100,toFixed:1},gravity:{min:0,max:14,toFixed:1},angle:{min:0,max:90,toFixed:0},height1:{min:0,max:240,toFixed:1},height2:{min:0,max:240,toFixed:1},distance:{min:100,max:600,toFixed:1}},enableDisableComp:["protractor","sliderVelocity","sliderGravity","sliderh1","sliderh2","sliderd","text_v","text_g","text_alpha","text_h1","text_h2","text_d"],compValue:{sliderVelocity:"initVelo",sliderGravity:"gravity",sliderh1:"height1",sliderh2:"height2",sliderd:"distance",showPath:"drawPath",showProtrac:"drawProtractor",showGrid:"drawGraph",text_v:"initVelo",text_g:"gravity",text_alpha:"angle",text_h1:"height1",text_h2:"height2",text_d:"distance"},showHideComp:["showProtrac","sliderVelocity","sliderGravity","vinit1","m/s","g","m/s2_1","m/s2_2","alpha","degree","d","d_m","h1","h1_m","h2","h2_m","text_v","text_g","text_alpha","text_h1","text_h2","text_d"]},r={};Object.keys(e).forEach(function(t){n[t]=e[t]}),r=n.spineObj,n.timerText=r.LabComClass.globalLangText.time+"00.00.00",r.cannonActObj.init(n),r.cannonActObj.addEventListener("enable",o),r.cannonActObj.addEventListener("change",function(e,t){switch(e.type){case"updateModel":Object.keys(e.data).forEach(function(t){n[t]=e.data[t]});break;case"showAlert":r.infoBoxObj.show()}t||a()}),r.cannonActObj.addEventListener("delConfirm",s),r.confBox.addEventListener("yes",t),r.bottomPanel.addEventListener("openPopUp",t),r.sliderh1.addEventListener("change",t),r.sliderh2.addEventListener("change",t),r.sliderd.addEventListener("change",t),r.delButton.addEventListener("click",t),r.protractor.addEventListener("change",t),r.sliderVelocity.addEventListener("change",t),r.sliderGravity.addEventListener("change",t),r.playReset.addEventListener("change",t),r.showGrid.addEventListener("change",t),r.showPath.addEventListener("change",t),r.showProtrac.addEventListener("change",t),r.showAccessibility.addEventListener("change",t),r.colorPallet.addEventListener("change",t),r.text_v.on("focusOut",t),r.text_g.on("focusOut",t),r.text_alpha.on("focusOut",t),r.text_h1.on("focusOut",t),r.text_d.on("focusOut",t),r.text_h2.on("focusOut",t),r.numPad.registerEntryBox(r.text_v,r.text_g,r.text_alpha,r.text_h1,r.text_d,r.text_h2),t({}),o(!0),s(!1),onViewUpdateCls.trigger("onGlobalUpdate",{type:"componentLoaded",data:{id:n.id}}),this.init=function(t){};function t(t){switch(t.id){case"sliderh1":n.height1=t.value;break;case"sliderh2":n.height2=t.value;break;case"sliderd":n.distance=t.value;break;case"protractor":n.angle=t.value;break;case"sliderGravity":n.gravity=t.value;break;case"sliderVelocity":n.initVelo=t.value;break;case"playReset":n.playStarted=t;break;case"showGrid":n.drawGraph=t.value;break;case"showPath":n.drawPath=t.value;break;case"showProtrac":n.drawProtractor=t.value;break;case"showAccessibility":n.drawAccessibility=t.value;var e=document.getElementsByClassName("mStagebgCanvas")[0];n.drawAccessibility?e.style.display="none":e.style.display="block",r.sliderh1.setAccess(t.value),r.sliderh2.setAccess(t.value),r.sliderd.setAccess(t.value),r.sliderVelocity.setAccess(t.value),r.sliderGravity.setAccess(t.value);break;case"colorPallet":n.selectedColor=t.value;var i=n.lineData[n.selectedColor];i&&(n.initVelo=i.initVelo,n.gravity=i.gravity,n.height1=i.height1,n.height2=i.height2,n.angle=i.angle,n.distance=i.distance);break;case"delButton":s(!0);break;case"confBox":n.deleteSelected=!0;break;case"text_v":n.initVelo=Number(r.text_v.getValue());break;case"text_g":n.gravity=Number(r.text_g.getValue());break;case"text_alpha":n.angle=Number(r.text_alpha.getValue());break;case"text_h1":n.height1=Number(r.text_h1.getValue());break;case"text_h2":n.height2=Number(r.text_h2.getValue());break;case"text_d":n.distance=Number(r.text_d.getValue());break;case"bottomPanel":r.msgBoxObj.show();break;default:console.info("No event Added for "+t.id,t)}a(),r.cannonActObj.updateRender(n)}function a(){Object.keys(i.restrictions).forEach(function(t){n[t]<i.restrictions[t].min&&(n[t]=i.restrictions[t].min),n[t]>i.restrictions[t].max&&(n[t]=i.restrictions[t].max),0<=i.restrictions[t].toFixed&&(n[t]=Number(n[t].toFixed(i.restrictions[t].toFixed)))});var t=r.protractor.getValue();t.y!==n.protractor.y&&r.protractor.setValue({y:n.protractor.y}),t.angle!==n.angle&&r.protractor.setValue({angle:n.angle});var e=r.colorPallet.getValue();(e.colors!==n.colorList&&r.colorPallet.setValue({colors:n.colorList}),isNaN(e.selected)&&isNaN(n.selectedColor)||e.selected===n.selectedColor||r.colorPallet.setValue({selected:n.selectedColor}),r.timer.getValue()!==n.timerText&&r.timer.setValue(n.timerText),n.playResetState)&&(r.playReset.getValue()!==n.playResetState&&r.playReset.setValue(n.playResetState),n.playResetState=void 0);Object.keys(i.compValue).forEach(function(t){Number(n[i.compValue[t]])===Number(r[t].getValue())&&""!==r[t].getValue()||(0<=t.indexOf("text_")?r[t].setValue(n[i.compValue[t]].toFixed(i.restrictions[i.compValue[t]].toFixed)):r[t].setValue(n[i.compValue[t]]))}),n.drawProtractor?r.protractor.show():r.protractor.hide(),onViewUpdateCls.trigger("onGlobalUpdate",{type:"rendererUpdate"})}function o(t){if(t){for(var e=0;e<i.enableDisableComp.length;e++)r[i.enableDisableComp[e]].enable();0<n.colorList.length?(r.colorPallet.enable(),r.delButton.enable()):(r.delButton.disable(),r.colorPallet.disable())}else{for(e=0;e<i.enableDisableComp.length;e++)r[i.enableDisableComp[e]].disable();r.delButton.disable(),r.colorPallet.disable()}}function s(t){t?r.confBox.show():r.confBox.hide()}}!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).THREE={})}(this,function(t){void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e});var q=0,J=1,Z=2,V=1,G=2,W=3,R=0,xt=1,Q=2,o=0,v=2,K=0,$=1,tt=2,et=3,it=4,nt=5,rt=100,at=101,ot=102,st=103,lt=104,ct=200,ht=201,ut=202,dt=203,pt=204,ft=205,mt=206,gt=207,vt=208,yt=209,_t=210,bt=0,wt=1,Tt=2,Mt=3,St=4,Et=5,Ct=6,Lt=7,Y=0,X=1,At=2,Pt=0,Rt=1,Ot=2,It=3,Dt=4,jt=5,kt=301,Nt=302,Ft=303,Bt=304,Ht=305,Ut=306,zt=307,H=1e3,U=1001,z=1002,Vt=1003,Gt=1004,Wt=1005,Yt=1006,Xt=1007,qt=1008,Jt=1009,r=1010,a=1011,Zt=1012,s=1013,Qt=1014,Kt=1015,$t=1016,l=1017,c=1018,h=1019,te=1020,u=1021,ee=1022,ie=1023,d=1024,p=1025,e=ie,ne=1026,re=1027,f=1028,m=33776,g=33777,y=33778,_=33779,b=35840,x=35841,w=35842,T=35843,M=36196,S=37808,E=37809,C=37810,L=37811,A=37812,P=37813,O=37814,I=37815,D=37816,j=37817,k=37818,N=37819,F=37820,B=37821,ae=0,oe=3e3,i=3001,n=3007,se=3002,le=3003,ce=3004,he=3005,ue=3006,de=3200,pe=3201,fe=0,me=1,ge=7680,ve=519,ye=35044,_e=35048;function be(){}Object.assign(be.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners[t];if(void 0!==i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=e.slice(0),n=0,r=i.length;n<r;n++)i[n].call(this,t)}}}});for(var xe=[],we=0;we<256;we++)xe[we]=(we<16?"0":"")+we.toString(16);var Te={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(xe[255&t]+xe[t>>8&255]+xe[t>>16&255]+xe[t>>24&255]+"-"+xe[255&e]+xe[e>>8&255]+"-"+xe[e>>16&15|64]+xe[e>>24&255]+"-"+xe[63&i|128]+xe[i>>8&255]+"-"+xe[i>>16&255]+xe[i>>24&255]+xe[255&n]+xe[n>>8&255]+xe[n>>16&255]+xe[n>>24&255]).toUpperCase()},clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Te.DEG2RAD},radToDeg:function(t){return t*Te.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Me(t,e){this.x=t||0,this.y=e||0}function Se(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}Object.defineProperties(Me.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Me.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*i-a*n+t.x,this.y=r*n+a*i+t.y,this}}),Object.assign(Se,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,r,a,o){var s=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[a+0],d=r[a+1],p=r[a+2],f=r[a+3];if(h!==f||s!==u||l!==d||c!==p){var m=1-o,g=s*u+l*d+c*p+h*f,v=0<=g?1:-1,y=1-g*g;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,g*v);m=Math.sin(m*b)/_,o=Math.sin(o*b)/_}var x=o*v;if(s=s*m+u*x,l=l*m+d*x,c=c*m+p*x,h=h*m+f*x,m===1-o){var w=1/Math.sqrt(s*s+l*l+c*c+h*h);s*=w,l*=w,c*=w,h*=w}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=h}}),Object.defineProperties(Se.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(Se.prototype,{isQuaternion:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,n=t._y,r=t._z,a=t.order,o=Math.cos,s=Math.sin,l=o(i/2),c=o(n/2),h=o(r/2),u=s(i/2),d=s(n/2),p=s(r/2);return"XYZ"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"YXZ"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"ZXY"===a?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"ZYX"===a?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"YZX"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p):"XZY"===a&&(this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],r=i[4],a=i[8],o=i[1],s=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+s+u;return this._z=0<d?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(h-l)*e,this._y=(a-c)*e,(o-r)*e):s<n&&u<n?(e=2*Math.sqrt(1+n-s-u),this._w=(h-l)/e,this._x=.25*e,this._y=(r+o)/e,(a+c)/e):u<s?(e=2*Math.sqrt(1+s-n-u),this._w=(a-c)/e,this._x=(r+o)/e,this._y=.25*e,(l+h)/e):(e=2*Math.sqrt(1+u-n-s),this._w=(o-r)/e,this._x=(a+c)/e,this._y=(l+h)/e,.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var i=t.dot(e)+1;return this._w=(i<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),i),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Te.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var i=this.angleTo(t);if(0===i)return this;var n=Math.min(1,e/i);return this.slerp(t,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return this._w=0===t?(this._x=0,this._y=0,this._z=0,1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z,a=t._w,o=e._x,s=e._y,l=e._z,c=e._w;return this._x=i*c+a*o+n*l-r*s,this._y=n*c+a*s+r*o-i*l,this._z=r*c+a*l+i*s-n*o,this._w=a*c-i*o-n*s-r*l,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,a=this._w,o=a*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),1<=o)return this._w=a,this._x=i,this._y=n,this._z=r,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-e;return this._w=l*a+e*this._w,this._x=l*i+e*this._x,this._y=l*n+e*this._y,this._z=l*r+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),h=Math.atan2(c,o),u=Math.sin((1-e)*h)/c,d=Math.sin(e*h)/c;return this._w=a*u+this._w*d,this._x=i*u+this._x*d,this._y=n*u+this._y*d,this._z=r*u+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Ee=new Le,Ce=new Se;function Le(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}Object.assign(Le.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ce.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Ce.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,a=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*a,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,a=t.y,o=t.z,s=t.w,l=s*e+a*n-o*i,c=s*i+o*e-r*n,h=s*n+r*i-a*e,u=-r*e-a*i-o*n;return this.x=l*s+u*-r+c*-o-h*-a,this.y=c*s+u*-a+h*-r-l*-o,this.z=h*s+u*-o+l*-a-c*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,n=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=n*s-r*o,this.y=r*a-i*s,this.z=i*o-n*a,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(t){return Ee.copy(this).projectOnVector(t),this.sub(Ee)},reflect:function(t){return this.sub(Ee.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());0===e&&console.error("THREE.Vector3: angleTo() can't handle zero length vectors.");var i=this.dot(t)/e;return Math.acos(Te.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,i){var n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var Ae,Pe=new Le;function Re(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Re.prototype,{isMatrix3:!0,set:function(t,e,i,n,r,a,o,s,l){var c=this.elements;return c[0]=t,c[1]=n,c[2]=o,c[3]=e,c[4]=r,c[5]=s,c[6]=i,c[7]=a,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(t){for(var e=0,i=t.count;e<i;e++)Pe.x=t.getX(e),Pe.y=t.getY(e),Pe.z=t.getZ(e),Pe.applyMatrix3(this),t.setXYZ(e,Pe.x,Pe.y,Pe.z);return t},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[3],s=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],p=i[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],_=n[7],b=n[2],x=n[5],w=n[8];return r[0]=a*f+o*v+s*b,r[3]=a*m+o*y+s*x,r[6]=a*g+o*_+s*w,r[1]=l*f+c*v+h*b,r[4]=l*m+c*y+h*x,r[7]=l*g+c*_+h*w,r[2]=u*f+d*v+p*b,r[5]=u*m+d*y+p*x,r[8]=u*g+d*_+p*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*a*c-e*o*l-i*r*c+i*o*s+n*r*l-n*a*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=t.elements,n=this.elements,r=i[0],a=i[1],o=i[2],s=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],p=d*l-c*u,f=c*h-d*s,m=u*s-l*h,g=r*p+a*f+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(o*u-d*a)*y,n[2]=(c*a-o*l)*y,n[3]=f*y,n[4]=(d*r-o*h)*y,n[5]=(o*s-c*r)*y,n[6]=m*y,n[7]=(a*h-u*r)*y,n[8]=(l*r-a*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,i,n,r,a,o){var s=Math.cos(r),l=Math.sin(r);this.set(i*s,i*l,-i*(s*a+l*o)+a+t,-n*l,n*s,-n*(-l*a+s*o)+o+e,0,0,1)},scale:function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.elements,r=n[0],a=n[3],o=n[6],s=n[1],l=n[4],c=n[7];return n[0]=e*r+i*s,n[3]=e*a+i*l,n[6]=e*o+i*c,n[1]=-i*r+e*s,n[4]=-i*a+e*l,n[7]=-i*o+e*c,this},translate:function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<9;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<9;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}});var Oe={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Ae&&(Ae=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ae.width=t.width,Ae.height=t.height;var i=Ae.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=Ae}return 2048<e.width||2048<e.height?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},Ie=0;function De(t,e,i,n,r,a,o,s,l,c){Object.defineProperty(this,"id",{value:Ie++}),this.uuid=Te.generateUUID(),this.name="",this.image=void 0!==t?t:De.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:De.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:U,this.wrapT=void 0!==n?n:U,this.magFilter=void 0!==r?r:Yt,this.minFilter=void 0!==a?a:qt,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:ie,this.type=void 0!==s?s:Jt,this.offset=new Me(0,0),this.repeat=new Me(1,1),this.center=new Me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Re,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:oe,this.version=0,this.onUpdate=null}function je(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function ke(t,e,i){this.width=t,this.height=e,this.scissor=new je(0,0,t,e),this.scissorTest=!1,this.viewport=new je(0,0,t,e),i=i||{},this.texture=new De(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Yt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function Ne(t,e,i){ke.call(this,t,e,i),this.samples=4}De.DEFAULT_IMAGE=void 0,De.DEFAULT_MAPPING=300,De.prototype=Object.assign(Object.create(be.prototype),{constructor:De,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=Te.generateUUID()),!e&&void 0===t.images[n.uuid]){var r;if(Array.isArray(n)){r=[];for(var a=0,o=n.length;a<o;a++)r.push(Oe.getDataURL(n[a]))}else r=Oe.getDataURL(n);t.images[n.uuid]={uuid:n.uuid,url:r}}i.image=n.uuid}return e||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case H:t.x=t.x-Math.floor(t.x);break;case U:t.x=t.x<0?0:1;break;case z:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case H:t.y=t.y-Math.floor(t.y);break;case U:t.y=t.y<0?0:1;break;case z:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(De.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(je.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(je.prototype,{isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*e+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*e+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*e+a[7]*i+a[11]*n+a[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return this.z=e<1e-4?(this.x=1,this.y=0):(this.x=t.x/e,this.y=t.y/e,t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,r,a=t.elements,o=a[0],s=a[4],l=a[8],c=a[1],h=a[5],u=a[9],d=a[2],p=a[6],f=a[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+p)<.1&&Math.abs(o+h+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(o+1)/2,g=(h+1)/2,v=(f+1)/2,y=(s+c)/4,_=(l+d)/4,b=(u+p)/4;return g<m&&v<m?r=m<.01?(i=0,n=.707106781):(n=y/(i=Math.sqrt(m)),_/i):v<g?r=g<.01?(n=0,i=.707106781):(i=y/(n=Math.sqrt(g)),b/n):v<.01?(n=i=.707106781,r=0):(i=_/(r=Math.sqrt(v)),n=b/r),this.set(i,n,r,e),this}var x=Math.sqrt((p-u)*(p-u)+(l-d)*(l-d)+(c-s)*(c-s));return Math.abs(x)<.001&&(x=1),this.x=(p-u)/x,this.y=(l-d)/x,this.z=(c-s)/x,this.w=Math.acos((o+h+f-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),ke.prototype=Object.assign(Object.create(be.prototype),{constructor:ke,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ne.prototype=Object.assign(Object.create(ke.prototype),{constructor:Ne,isWebGLMultisampleRenderTarget:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.samples=t.samples,this}});var Fe=new Le,Be=new We,He=new Le(0,0,0),Ue=new Le(1,1,1),ze=new Le,Ve=new Le,Ge=new Le;function We(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(We.prototype,{isMatrix4:!0,set:function(t,e,i,n,r,a,o,s,l,c,h,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new We).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,i=t.elements,n=1/Fe.setFromMatrixColumn(t,0).length(),r=1/Fe.setFromMatrixColumn(t,1).length(),a=1/Fe.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*a,e[9]=i[9]*a,e[10]=i[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,r=t.z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){var u=a*c,d=a*h,p=o*c,f=o*h;e[0]=s*c,e[4]=-s*h,e[8]=l,e[1]=d+p*l,e[5]=u-f*l,e[9]=-o*s,e[2]=f-u*l,e[6]=p+d*l,e[10]=a*s}else if("YXZ"===t.order){var m=s*c,g=s*h,v=l*c,y=l*h;e[0]=m+y*o,e[4]=v*o-g,e[8]=a*l,e[1]=a*h,e[5]=a*c,e[9]=-o,e[2]=g*o-v,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order){m=s*c,g=s*h,v=l*c,y=l*h;e[0]=m-y*o,e[4]=-a*h,e[8]=v+g*o,e[1]=g+v*o,e[5]=a*c,e[9]=y-m*o,e[2]=-a*l,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){u=a*c,d=a*h,p=o*c,f=o*h;e[0]=s*c,e[4]=p*l-d,e[8]=u*l+f,e[1]=s*h,e[5]=f*l+u,e[9]=d*l-p,e[2]=-l,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var _=a*s,b=a*l,x=o*s,w=o*l;e[0]=s*c,e[4]=w-_*h,e[8]=x*h+b,e[1]=h,e[5]=a*c,e[9]=-o*c,e[2]=-l*c,e[6]=b*h+x,e[10]=_-w*h}else if("XZY"===t.order){_=a*s,b=a*l,x=o*s,w=o*l;e[0]=s*c,e[4]=-h,e[8]=l*c,e[1]=_*h+w,e[5]=a*c,e[9]=b*h-x,e[2]=x*h-b,e[6]=o*c,e[10]=w*h+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(He,t,Ue)},lookAt:function(t,e,i){var n=this.elements;return Ge.subVectors(t,e),0===Ge.lengthSq()&&(Ge.z=1),Ge.normalize(),ze.crossVectors(i,Ge),0===ze.lengthSq()&&(1===Math.abs(i.z)?Ge.x+=1e-4:Ge.z+=1e-4,Ge.normalize(),ze.crossVectors(i,Ge)),ze.normalize(),Ve.crossVectors(Ge,ze),n[0]=ze.x,n[4]=Ve.x,n[8]=Ge.x,n[1]=ze.y,n[5]=Ve.y,n[9]=Ge.y,n[2]=ze.z,n[6]=Ve.z,n[10]=Ge.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],_=i[11],b=i[15],x=n[0],w=n[4],T=n[8],M=n[12],S=n[1],E=n[5],C=n[9],L=n[13],A=n[2],P=n[6],R=n[10],O=n[14],I=n[3],D=n[7],j=n[11],k=n[15];return r[0]=a*x+o*S+s*A+l*I,r[4]=a*w+o*E+s*P+l*D,r[8]=a*T+o*C+s*R+l*j,r[12]=a*M+o*L+s*O+l*k,r[1]=c*x+h*S+u*A+d*I,r[5]=c*w+h*E+u*P+d*D,r[9]=c*T+h*C+u*R+d*j,r[13]=c*M+h*L+u*O+d*k,r[2]=p*x+f*S+m*A+g*I,r[6]=p*w+f*E+m*P+g*D,r[10]=p*T+f*C+m*R+g*j,r[14]=p*M+f*L+m*O+g*k,r[3]=v*x+y*S+_*A+b*I,r[7]=v*w+y*E+_*P+b*D,r[11]=v*T+y*C+_*R+b*j,r[15]=v*M+y*L+_*O+b*k,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(t){for(var e=0,i=t.count;e<i;e++)Fe.x=t.getX(e),Fe.y=t.getY(e),Fe.z=t.getZ(e),Fe.applyMatrix4(this),t.setXYZ(e,Fe.x,Fe.y,Fe.z);return t},determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],a=t[1],o=t[5],s=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+r*s*h-n*l*h-r*o*u+i*l*u+n*o*d-i*s*d)+t[7]*(+e*s*d-e*l*u+r*a*u-n*a*d+n*l*c-r*s*c)+t[11]*(+e*l*h-e*o*d-r*a*h+i*a*d+r*o*c-i*l*c)+t[15]*(-n*o*c-e*s*h+e*o*u+n*a*h-i*a*u+i*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,i){var n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],_=n[15],b=p*y*u-v*f*u+v*h*m-c*y*m-p*h*_+c*f*_,x=g*f*u-d*y*u-g*h*m+l*y*m+d*h*_-l*f*_,w=d*v*u-g*p*u+g*c*m-l*v*m-d*c*_+l*p*_,T=g*p*h-d*v*h-g*c*f+l*v*f+d*c*y-l*p*y,M=r*b+a*x+o*w+s*T;if(0===M){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(S);return console.warn(S),this.identity()}var E=1/M;return i[0]=b*E,i[1]=(v*f*s-p*y*s-v*o*m+a*y*m+p*o*_-a*f*_)*E,i[2]=(c*y*s-v*h*s+v*o*u-a*y*u-c*o*_+a*h*_)*E,i[3]=(p*h*s-c*f*s-p*o*u+a*f*u+c*o*m-a*h*m)*E,i[4]=x*E,i[5]=(d*y*s-g*f*s+g*o*m-r*y*m-d*o*_+r*f*_)*E,i[6]=(g*h*s-l*y*s-g*o*u+r*y*u+l*o*_-r*h*_)*E,i[7]=(l*f*s-d*h*s+d*o*u-r*f*u-l*o*m+r*h*m)*E,i[8]=w*E,i[9]=(g*p*s-d*v*s-g*a*m+r*v*m+d*a*_-r*p*_)*E,i[10]=(l*v*s-g*c*s+g*a*u-r*v*u-l*a*_+r*c*_)*E,i[11]=(d*c*s-l*p*s-d*a*u+r*p*u+l*a*m-r*c*m)*E,i[12]=T*E,i[13]=(d*v*o-g*p*o+g*a*f-r*v*f-d*a*y+r*p*y)*E,i[14]=(g*c*o-l*v*o-g*a*h+r*v*h+l*a*y-r*c*y)*E,i[15]=(l*p*o-d*c*o+d*a*h-r*p*h-l*a*f+r*c*f)*E,this},scale:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,a=t.x,o=t.y,s=t.z,l=r*a,c=r*o;return this.set(l*a+i,l*o-n*s,l*s+n*o,0,l*o+n*s,c*o+i,c*s-n*a,0,l*s-n*o,c*s+n*a,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){var n=this.elements,r=e._x,a=e._y,o=e._z,s=e._w,l=r+r,c=a+a,h=o+o,u=r*l,d=r*c,p=r*h,f=a*c,m=a*h,g=o*h,v=s*l,y=s*c,_=s*h,b=i.x,x=i.y,w=i.z;return n[0]=(1-(f+g))*b,n[1]=(d+_)*b,n[2]=(p-y)*b,n[3]=0,n[4]=(d-_)*x,n[5]=(1-(u+g))*x,n[6]=(m+v)*x,n[7]=0,n[8]=(p+y)*w,n[9]=(m-v)*w,n[10]=(1-(u+f))*w,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},decompose:function(t,e,i){var n=this.elements,r=Fe.set(n[0],n[1],n[2]).length(),a=Fe.set(n[4],n[5],n[6]).length(),o=Fe.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],Be.copy(this);var s=1/r,l=1/a,c=1/o;return Be.elements[0]*=s,Be.elements[1]*=s,Be.elements[2]*=s,Be.elements[4]*=l,Be.elements[5]*=l,Be.elements[6]*=l,Be.elements[8]*=c,Be.elements[9]*=c,Be.elements[10]*=c,e.setFromRotationMatrix(Be),i.x=r,i.y=a,i.z=o,this},makePerspective:function(t,e,i,n,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*r/(e-t),l=2*r/(i-n),c=(e+t)/(e-t),h=(i+n)/(i-n),u=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,i,n,r,a){var o=this.elements,s=1/(e-t),l=1/(i-n),c=1/(a-r),h=(e+t)*s,u=(i+n)*l,d=(a+r)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}});var Ye=new We,Xe=new Se;function qe(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||qe.DefaultOrder}function Je(){this.mask=1}qe.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],qe.DefaultOrder="XYZ",Object.defineProperties(qe.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(qe.prototype,{isEuler:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=Te.clamp,r=t.elements,a=r[0],o=r[4],s=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],p=r[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,a))):"ZYX"===e?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===e?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e?(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,i){return Ye.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Ye,e,i)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return Xe.setFromEuler(this),this.setFromQuaternion(Xe,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Le(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(Je.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var Ze=0,Qe=new Le,Ke=new Se,$e=new We,ti=new Le,ei=new Le,ii=new Le,ni=new Se,ri=new Le(1,0,0),ai=new Le(0,1,0),oi=new Le(0,0,1),si={type:"added"},li={type:"removed"};function ci(){Object.defineProperty(this,"id",{value:Ze++}),this.uuid=Te.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ci.DefaultUp.clone();var t=new Le,e=new qe,i=new Se,n=new Le(1,1,1);e._onChange(function(){i.setFromEuler(e,!1)}),i._onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new We},normalMatrix:{value:new Re}}),this.matrix=new We,this.matrixWorld=new We,this.matrixAutoUpdate=ci.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Je,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function hi(){ci.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ci.DefaultUp=new Le(0,1,0),ci.DefaultMatrixAutoUpdate=!0,ci.prototype=Object.assign(Object.create(be.prototype),{constructor:ci,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Ke.setFromAxisAngle(t,e),this.quaternion.multiply(Ke),this},rotateOnWorldAxis:function(t,e){return Ke.setFromAxisAngle(t,e),this.quaternion.premultiply(Ke),this},rotateX:function(t){return this.rotateOnAxis(ri,t)},rotateY:function(t){return this.rotateOnAxis(ai,t)},rotateZ:function(t){return this.rotateOnAxis(oi,t)},translateOnAxis:function(t,e){return Qe.copy(t).applyQuaternion(this.quaternion),this.position.add(Qe.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(ri,t)},translateY:function(t){return this.translateOnAxis(ai,t)},translateZ:function(t){return this.translateOnAxis(oi,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4($e.getInverse(this.matrixWorld))},lookAt:function(t,e,i){t.isVector3?ti.copy(t):ti.set(t,e,i);var n=this.parent;this.updateWorldMatrix(!0,!1),ei.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$e.lookAt(ei,ti,this.up):$e.lookAt(ti,ei,this.up),this.quaternion.setFromRotationMatrix($e),n&&($e.extractRotation(n.matrixWorld),Ke.setFromRotationMatrix($e),this.quaternion.premultiply(Ke.inverse()))},add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(si)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(li)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),$e.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),$e.multiply(t.parent.matrixWorld)),t.applyMatrix($e),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Le),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Se),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ei,t,ii),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Le),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ei,ni,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Le),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var n=this.children,r=0,a=n.length;r<a;r++)n[r].updateWorldMatrix(!1,!0)},toJSON:function(i){var t=void 0===i||"string"==typeof i,e={};t&&(i={geometries:{},materials:{},textures:{},images:{},shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function r(t,e){return void 0===t[e.uuid]&&(t[e.uuid]=e.toJSON(i)),e.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==ae&&(n.drawMode=this.drawMode),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){n.geometry=r(i.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var c=o[s];r(i.shapes,c)}else r(i.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var h=[];for(s=0,l=this.material.length;s<l;s++)h.push(r(i.materials,this.material[s]));n.material=h}else n.material=r(i.materials,this.material);if(0<this.children.length){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(i).object)}if(t){var u=m(i.geometries),d=m(i.materials),p=m(i.textures),f=m(i.images);o=m(i.shapes);0<u.length&&(e.geometries=u),0<d.length&&(e.materials=d),0<p.length&&(e.textures=p),0<f.length&&(e.images=f),0<o.length&&(e.shapes=o)}return e.object=n,e;function m(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this}}),hi.prototype=Object.assign(Object.create(ci.prototype),{constructor:hi,isScene:!0,copy:function(t,e){return ci.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=ci.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ui=[new Le,new Le,new Le,new Le,new Le,new Le,new Le,new Le],di=new Le,pi=new Mi,fi=new Le,mi=new Le,gi=new Le,vi=new Le,yi=new Le,_i=new Le,bi=new Le,xi=new Le,wi=new Le,Ti=new Le;function Mi(t,e){this.min=void 0!==t?t:new Le(1/0,1/0,1/0),this.max=void 0!==e?e:new Le(-1/0,-1/0,-1/0)}function Si(t,e,i,n,r){var a,o;for(a=0,o=t.length-3;a<=o;a+=3){Ti.fromArray(t,a);var s=r.x*Math.abs(Ti.x)+r.y*Math.abs(Ti.y)+r.z*Math.abs(Ti.z),l=e.dot(Ti),c=i.dot(Ti),h=n.dot(Ti);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>s)return!1}return!0}Object.assign(Mi.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=t.length;s<l;s+=3){var c=t[s],h=t[s+1],u=t[s+2];c<e&&(e=c),h<i&&(i=h),u<n&&(n=u),r<c&&(r=c),a<h&&(a=h),o<u&&(o=u)}return this.min.set(e,i,n),this.max.set(r,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=t.count;s<l;s++){var c=t.getX(s),h=t.getY(s),u=t.getZ(s);c<e&&(e=c),h<i&&(i=h),u<n&&(n=u),r<c&&(r=c),a<h&&(a=h),o<u&&(o=u)}return this.min.set(e,i,n),this.max.set(r,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var i=di.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Le),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Le),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),pi.copy(e.boundingBox),pi.applyMatrix4(t.matrixWorld),this.expandByPoint(pi.min),this.expandByPoint(pi.max));for(var i=t.children,n=0,r=i.length;n<r;n++)this.expandByObject(i[n]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Le),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,di),di.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,i;return i=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x),0<t.normal.y?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(bi),xi.subVectors(this.max,bi),fi.subVectors(t.a,bi),mi.subVectors(t.b,bi),gi.subVectors(t.c,bi),vi.subVectors(mi,fi),yi.subVectors(gi,mi),_i.subVectors(fi,gi);var e=[0,-vi.z,vi.y,0,-yi.z,yi.y,0,-_i.z,_i.y,vi.z,0,-vi.x,yi.z,0,-yi.x,_i.z,0,-_i.x,-vi.y,vi.x,0,-yi.y,yi.x,0,-_i.y,_i.x,0];return!!Si(e,fi,mi,gi,xi)&&(!!Si(e=[1,0,0,0,1,0,0,0,1],fi,mi,gi,xi)&&(wi.crossVectors(vi,yi),Si(e=[wi.x,wi.y,wi.z],fi,mi,gi,xi)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Le),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return di.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(di).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(ui[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ui[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ui[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ui[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ui[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ui[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ui[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ui[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ui)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Ei=new Mi;function Ci(t,e){this.center=void 0!==t?t:new Le,this.radius=void 0!==e?e:0}Object.assign(Ci.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var i=this.center;void 0!==e?i.copy(e):Ei.setFromPoints(t).getCenter(i);for(var n=0,r=0,a=t.length;r<a;r++)n=Math.max(n,i.distanceToSquared(t[r]));return this.radius=Math.sqrt(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Le),e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Mi),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var Li=new Le,Ai=new Le,Pi=new Le,Ri=new Le,Oi=new Le,Ii=new Le,Di=new Le;function ji(t,e){this.origin=void 0!==t?t:new Le,this.direction=void 0!==e?e:new Le(0,0,-1)}Object.assign(ji.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Le),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Li)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Le),e.subVectors(t,this.origin);var i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=Li.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Li.copy(this.direction).multiplyScalar(e).add(this.origin),Li.distanceToSquared(t))},distanceSqToSegment:function(t,e,i,n){Ai.copy(t).add(e).multiplyScalar(.5),Pi.copy(e).sub(t).normalize(),Ri.copy(this.origin).sub(Ai);var r,a,o,s,l=.5*t.distanceTo(e),c=-this.direction.dot(Pi),h=Ri.dot(this.direction),u=-Ri.dot(Pi),d=Ri.lengthSq(),p=Math.abs(1-c*c);if(0<p)if(a=c*h-u,s=l*p,0<=(r=c*u-h))if(-s<=a)if(a<=s){var f=1/p;o=(r*=f)*(r+c*(a*=f)+2*h)+a*(c*r+a+2*u)+d}else a=l,o=-(r=Math.max(0,-(c*a+h)))*r+a*(a+2*u)+d;else a=-l,o=-(r=Math.max(0,-(c*a+h)))*r+a*(a+2*u)+d;else o=a<=-s?-(r=Math.max(0,-(-c*l+h)))*r+(a=0<r?-l:Math.min(Math.max(-l,-u),l))*(a+2*u)+d:a<=s?(r=0,(a=Math.min(Math.max(-l,-u),l))*(a+2*u)+d):-(r=Math.max(0,-(c*l+h)))*r+(a=0<r?l:Math.min(Math.max(-l,-u),l))*(a+2*u)+d;else a=0<c?-l:l,o=-(r=Math.max(0,-(c*a+h)))*r+a*(a+2*u)+d;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(Pi).multiplyScalar(a).add(Ai),o},intersectSphere:function(t,e){Li.subVectors(t.center,this.origin);var i=Li.dot(this.direction),n=Li.dot(Li)-i*i,r=t.radius*t.radius;if(r<n)return null;var a=Math.sqrt(r-n),o=i-a,s=i+a;return o<0&&s<0?null:o<0?this.at(s,e):this.at(o,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return 0<=i?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var i,n,r,a,o,s,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return n=0<=l?(i=(t.min.x-u.x)*l,(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,(t.min.x-u.x)*l),(a=0<=c?(r=(t.min.y-u.y)*c,(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,(t.min.y-u.y)*c))<i||n<r?null:((i<r||i!=i)&&(i=r),(a<n||n!=n)&&(n=a),(s=0<=h?(o=(t.min.z-u.z)*h,(t.max.z-u.z)*h):(o=(t.max.z-u.z)*h,(t.min.z-u.z)*h))<i||n<o?null:((i<o||i!=i)&&(i=o),(s<n||n!=n)&&(n=s),n<0?null:this.at(0<=i?i:n,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,Li)},intersectTriangle:function(t,e,i,n,r){Oi.subVectors(e,t),Ii.subVectors(i,t),Di.crossVectors(Oi,Ii);var a,o=this.direction.dot(Di);if(0<o){if(n)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Ri.subVectors(this.origin,t);var s=a*this.direction.dot(Ii.crossVectors(Ri,Ii));if(s<0)return null;var l=a*this.direction.dot(Oi.cross(Ri));if(l<0)return null;if(o<s+l)return null;var c=-a*Ri.dot(Di);return c<0?null:this.at(c/o,r)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var ki=new Le,Ni=new Le,Fi=new Re;function Bi(t,e){this.normal=void 0!==t?t:new Le(1,0,0),this.constant=void 0!==e?e:0}Object.assign(Bi.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,i){var n=ki.subVectors(i,e).cross(Ni.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Le),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Le);var i=t.delta(ki),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var r=-(t.start.dot(this.normal)+this.constant)/n;return r<0||1<r?void 0:e.copy(i).multiplyScalar(r).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&0<i||i<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Le),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var i=e||Fi.getNormalMatrix(t),n=this.coplanarPoint(ki).applyMatrix4(t),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var Hi=new Le,Ui=new Le,zi=new Le,Vi=new Le,Gi=new Le,Wi=new Le,Yi=new Le,Xi=new Le,qi=new Le,Ji=new Le;function Zi(t,e,i){this.a=void 0!==t?t:new Le,this.b=void 0!==e?e:new Le,this.c=void 0!==i?i:new Le}Object.assign(Zi,{getNormal:function(t,e,i,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Le),n.subVectors(i,e),Hi.subVectors(t,e),n.cross(Hi);var r=n.lengthSq();return 0<r?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)},getBarycoord:function(t,e,i,n,r){Hi.subVectors(n,e),Ui.subVectors(i,e),zi.subVectors(t,e);var a=Hi.dot(Hi),o=Hi.dot(Ui),s=Hi.dot(zi),l=Ui.dot(Ui),c=Ui.dot(zi),h=a*l-o*o;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new Le),0===h)return r.set(-2,-1,-1);var u=1/h,d=(l*s-o*c)*u,p=(a*c-o*s)*u;return r.set(1-d-p,p,d)},containsPoint:function(t,e,i,n){return Zi.getBarycoord(t,e,i,n,Vi),0<=Vi.x&&0<=Vi.y&&Vi.x+Vi.y<=1},getUV:function(t,e,i,n,r,a,o,s){return this.getBarycoord(t,e,i,n,Vi),s.set(0,0),s.addScaledVector(r,Vi.x),s.addScaledVector(a,Vi.y),s.addScaledVector(o,Vi.z),s},isFrontFacing:function(t,e,i,n){return Hi.subVectors(i,e),Ui.subVectors(t,e),Hi.cross(Ui).dot(n)<0}}),Object.assign(Zi.prototype,{set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Hi.subVectors(this.c,this.b),Ui.subVectors(this.a,this.b),.5*Hi.cross(Ui).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Le),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Zi.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Bi),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Zi.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,i,n,r){return Zi.getUV(t,this.a,this.b,this.c,e,i,n,r)},containsPoint:function(t){return Zi.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Zi.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Le);var i,n,r=this.a,a=this.b,o=this.c;Gi.subVectors(a,r),Wi.subVectors(o,r),Xi.subVectors(t,r);var s=Gi.dot(Xi),l=Wi.dot(Xi);if(s<=0&&l<=0)return e.copy(r);qi.subVectors(t,a);var c=Gi.dot(qi),h=Wi.dot(qi);if(0<=c&&h<=c)return e.copy(a);var u=s*h-c*l;if(u<=0&&0<=s&&c<=0)return i=s/(s-c),e.copy(r).addScaledVector(Gi,i);Ji.subVectors(t,o);var d=Gi.dot(Ji),p=Wi.dot(Ji);if(0<=p&&d<=p)return e.copy(o);var f=d*l-s*p;if(f<=0&&0<=l&&p<=0)return n=l/(l-p),e.copy(r).addScaledVector(Wi,n);var m=c*p-d*h;if(m<=0&&0<=h-c&&0<=d-p)return Yi.subVectors(o,a),n=(h-c)/(h-c+(d-p)),e.copy(a).addScaledVector(Yi,n);var g=1/(m+f+u);return i=f*g,n=u*g,e.copy(r).addScaledVector(Gi,i).addScaledVector(Wi,n)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var Qi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ki={h:0,s:0,l:0},$i={h:0,s:0,l:0};function tn(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function en(t,e,i){return i<0&&(i+=1),1<i&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}function nn(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function rn(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function an(t,e,i,n,r,a){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new Le,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new tn,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}Object.assign(tn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(t,e,i){if(t=Te.euclideanModulo(t,1),e=Te.clamp(e,0,1),i=Te.clamp(i,0,1),0===e)this.r=this.g=this.b=i;else{var n=i<=.5?i*(1+e):i+e-i*e,r=2*i-n;this.r=en(r,n,t+1/3),this.g=en(r,n,t),this.b=en(r,n,t-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(o,s,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c=i[1],h=c.length;if(3===h)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(t){var e=Qi[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=0<e?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=nn(t.r),this.g=nn(t.g),this.b=nn(t.b),this},copyLinearToSRGB:function(t){return this.r=rn(t.r),this.g=rn(t.g),this.b=rn(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,i,n=this.r,r=this.g,a=this.b,o=Math.max(n,r,a),s=Math.min(n,r,a),l=(s+o)/2;if(s===o)i=e=0;else{var c=o-s;switch(i=l<=.5?c/(o+s):c/(2-o-s),o){case n:e=(r-a)/c+(r<a?6:0);break;case r:e=(a-n)/c+2;break;case a:e=(n-r)/c+4}e/=6}return t.h=e,t.s=i,t.l=l,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){return this.getHSL(Ki),Ki.h+=t,Ki.s+=e,Ki.l+=i,this.setHSL(Ki.h,Ki.s,Ki.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(Ki),t.getHSL($i);var i=Te.lerp(Ki.h,$i.h,e),n=Te.lerp(Ki.s,$i.s,e),r=Te.lerp(Ki.l,$i.l,e);return this.setHSL(i,n,r),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),tn.NAMES=Qi,Object.assign(an.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var on=0;function sn(){Object.defineProperty(this,"id",{value:on++}),this.uuid=Te.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=$,this.side=R,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=o,this.opacity=1,this.transparent=!1,this.blendSrc=pt,this.blendDst=ft,this.blendEquation=rt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Mt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ve,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ge,this.stencilZFail=ge,this.stencilZPass=ge,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function ln(t){sn.call(this),this.type="MeshBasicMaterial",this.color=new tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}function cn(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.usage=ye,this.updateRange={offset:0,count:-1},this.version=0}function hn(t,e,i){cn.call(this,new Int8Array(t),e,i)}function un(t,e,i){cn.call(this,new Uint8Array(t),e,i)}function dn(t,e,i){cn.call(this,new Uint8ClampedArray(t),e,i)}function pn(t,e,i){cn.call(this,new Int16Array(t),e,i)}function fn(t,e,i){cn.call(this,new Uint16Array(t),e,i)}function mn(t,e,i){cn.call(this,new Int32Array(t),e,i)}function gn(t,e,i){cn.call(this,new Uint32Array(t),e,i)}function vn(t,e,i){cn.call(this,new Float32Array(t),e,i)}function yn(t,e,i){cn.call(this,new Float64Array(t),e,i)}function _n(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function bn(t){if(0===t.length)return-1/0;for(var e=t[0],i=1,n=t.length;i<n;++i)t[i]>e&&(e=t[i]);return e}sn.prototype=Object.assign(Object.create(be.prototype),{constructor:sn,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i)if("shading"!==e){var n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,void 0!==this.combine&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==$&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),this.side!==R&&(i.side=this.side),this.vertexColors!==o&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.morphNormals&&(i.morphNormals=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e){var r=n(t.textures),a=n(t.images);0<r.length&&(i.textures=r),0<a.length&&(i.images=a)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,i=null;if(null!==e){var n=e.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(sn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((ln.prototype=Object.create(sn.prototype)).constructor=ln).prototype.isMeshBasicMaterial=!0,ln.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Object.defineProperty(cn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(cn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new tn),e[i++]=a.r,e[i++]=a.g,e[i++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new Me),e[i++]=a.x,e[i++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new Le),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new je),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z,e[i++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(hn.prototype=Object.create(cn.prototype)).constructor=hn,(un.prototype=Object.create(cn.prototype)).constructor=un,(dn.prototype=Object.create(cn.prototype)).constructor=dn,(pn.prototype=Object.create(cn.prototype)).constructor=pn,(fn.prototype=Object.create(cn.prototype)).constructor=fn,(mn.prototype=Object.create(cn.prototype)).constructor=mn,(gn.prototype=Object.create(cn.prototype)).constructor=gn,(vn.prototype=Object.create(cn.prototype)).constructor=vn,(yn.prototype=Object.create(cn.prototype)).constructor=yn,Object.assign(_n.prototype,{computeGroups:function(t){for(var e,i=[],n=void 0,r=t.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==n&&(n=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,i.push(e)),e={start:3*a,materialIndex:n})}void 0!==e&&(e.count=3*a-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,i=t.faces,n=t.vertices,r=t.faceVertexUvs,a=r[0]&&0<r[0].length,o=r[1]&&0<r[1].length,s=t.morphTargets,l=s.length;if(0<l){e=[];for(var c=0;c<l;c++)e[c]={name:s[c].name,data:[]};this.morphTargets.position=e}var h,u=t.morphNormals,d=u.length;if(0<d){h=[];for(c=0;c<d;c++)h[c]={name:u[c].name,data:[]};this.morphTargets.normal=h}var p=t.skinIndices,f=t.skinWeights,m=p.length===n.length,g=f.length===n.length;0<n.length&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(c=0;c<i.length;c++){var v=i[c];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var _=v.normal;this.normals.push(_,_,_)}var b,x=v.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===a)void 0!==(b=r[0][c])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new Me,new Me,new Me));if(!0===o)void 0!==(b=r[1][c])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new Me,new Me,new Me));for(var T=0;T<l;T++){var M=s[T].vertices;e[T].data.push(M[v.a],M[v.b],M[v.c])}for(T=0;T<d;T++){var S=u[T].vertexNormals[c];h[T].data.push(S.a,S.b,S.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var xn=1,wn=new We,Tn=new ci,Mn=new Le,Sn=new Mi,En=new Mi,Cn=new Le;function Ln(){Object.defineProperty(this,"id",{value:xn+=2}),this.uuid=Te.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Ln.prototype=Object.assign(Object.create(be.prototype),{constructor:Ln,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<bn(t)?gn:fn)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&((new Re).getNormalMatrix(t).applyToBufferAttribute(i),i.needsUpdate=!0);var n=this.attributes.tangent;void 0!==n&&((new Re).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return wn.makeRotationX(t),this.applyMatrix(wn),this},rotateY:function(t){return wn.makeRotationY(t),this.applyMatrix(wn),this},rotateZ:function(t){return wn.makeRotationZ(t),this.applyMatrix(wn),this},translate:function(t,e,i){return wn.makeTranslation(t,e,i),this.applyMatrix(wn),this},scale:function(t,e,i){return wn.makeScale(t,e,i),this.applyMatrix(wn),this},lookAt:function(t){return Tn.lookAt(t),Tn.updateMatrix(),this.applyMatrix(Tn.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mn).negate(),this.translate(Mn.x,Mn.y,Mn.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var i=new vn(3*e.vertices.length,3),n=new vn(3*e.colors.length,3);if(this.setAttribute("position",i.copyVector3sArray(e.vertices)),this.setAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new vn(e.lineDistances.length,1);this.setAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new vn(e,3)),this},updateFromObject:function(t){var e,i=t.geometry;if(t.isMesh){var n=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(n=void 0,i.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(i.vertices),e.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(i.normals),e.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(i.colors),e.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(i.uvs),e.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(i.lineDistances),e.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(t.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new _n).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new cn(e,3).copyVector3sArray(t.vertices)),0<t.normals.length){var i=new Float32Array(3*t.normals.length);this.setAttribute("normal",new cn(i,3).copyVector3sArray(t.normals))}if(0<t.colors.length){var n=new Float32Array(3*t.colors.length);this.setAttribute("color",new cn(n,3).copyColorsArray(t.colors))}if(0<t.uvs.length){var r=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new cn(r,2).copyVector2sArray(t.uvs))}if(0<t.uvs2.length){var a=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new cn(a,2).copyVector2sArray(t.uvs2))}for(var o in this.groups=t.groups,t.morphTargets){for(var s=[],l=t.morphTargets[o],c=0,h=l.length;c<h;c++){var u=l[c],d=new vn(3*u.data.length,3);d.name=u.name,s.push(d.copyVector3sArray(u.data))}this.morphAttributes[o]=s}if(0<t.skinIndices.length){var p=new vn(4*t.skinIndices.length,4);this.setAttribute("skinIndex",p.copyVector4sArray(t.skinIndices))}if(0<t.skinWeights.length){var f=new vn(4*t.skinWeights.length,4);this.setAttribute("skinWeight",f.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Mi);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var i=0,n=e.length;i<n;i++){var r=e[i];Sn.setFromBufferAttribute(r),this.morphTargetsRelative?(Cn.addVectors(this.boundingBox.min,Sn.min),this.boundingBox.expandByPoint(Cn),Cn.addVectors(this.boundingBox.max,Sn.max),this.boundingBox.expandByPoint(Cn)):(this.boundingBox.expandByPoint(Sn.min),this.boundingBox.expandByPoint(Sn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ci);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var i=this.boundingSphere.center;if(Sn.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var a=e[n];En.setFromBufferAttribute(a),this.morphTargetsRelative?(Cn.addVectors(Sn.min,En.min),Sn.expandByPoint(Cn),Cn.addVectors(Sn.max,En.max),Sn.expandByPoint(Cn)):(Sn.expandByPoint(En.min),Sn.expandByPoint(En.max))}Sn.getCenter(i);var o=0;for(n=0,r=t.count;n<r;n++)Cn.fromBufferAttribute(t,n),o=Math.max(o,i.distanceToSquared(Cn));if(e)for(n=0,r=e.length;n<r;n++){a=e[n];for(var s=this.morphTargetsRelative,l=0,c=a.count;l<c;l++)Cn.fromBufferAttribute(a,l),s&&(Mn.fromBufferAttribute(t,l),Cn.add(Mn)),o=Math.max(o,i.distanceToSquared(Cn))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var i=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new cn(new Float32Array(i.length),3));else for(var n=e.normal.array,r=0,a=n.length;r<a;r++)n[r]=0;var o,s,l,c=e.normal.array,h=new Le,u=new Le,d=new Le,p=new Le,f=new Le;if(t){var m=t.array;for(r=0,a=t.count;r<a;r+=3)o=3*m[r+0],s=3*m[r+1],l=3*m[r+2],h.fromArray(i,o),u.fromArray(i,s),d.fromArray(i,l),p.subVectors(d,u),f.subVectors(h,u),p.cross(f),c[o]+=p.x,c[o+1]+=p.y,c[o+2]+=p.z,c[s]+=p.x,c[s+1]+=p.y,c[s+2]+=p.z,c[l]+=p.x,c[l+1]+=p.y,c[l+2]+=p.z}else for(r=0,a=i.length;r<a;r+=9)h.fromArray(i,r),u.fromArray(i,r+3),d.fromArray(i,r+6),p.subVectors(d,u),f.subVectors(h,u),p.cross(f),c[r]=p.x,c[r+1]=p.y,c[r+2]=p.z,c[r+3]=p.x,c[r+4]=p.y,c[r+5]=p.z,c[r+6]=p.x,c[r+7]=p.y,c[r+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(var n in i)if(void 0!==t.attributes[n])for(var r=i[n].array,a=t.attributes[n],o=a.array,s=a.itemSize*e,l=Math.min(o.length,r.length-s),c=0,h=s;c<l;c++,h++)r[h]=o[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,i=t.count;e<i;e++)Cn.x=t.getX(e),Cn.y=t.getY(e),Cn.z=t.getZ(e),Cn.normalize(),t.setXYZ(e,Cn.x,Cn.y,Cn.z)},toNonIndexed:function(){function t(t,e){for(var i=t.array,n=t.itemSize,r=new i.constructor(e.length*n),a=0,o=0,s=0,l=e.length;s<l;s++){a=e[s]*n;for(var c=0;c<n;c++)r[o++]=i[a++]}return new cn(r,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Ln,i=this.index.array,n=this.attributes;for(var r in n){var a=t(n[r],i);e.setAttribute(r,a)}var o=this.morphAttributes;for(r in o){for(var s=[],l=o[r],c=0,h=l.length;c<h;c++){a=t(l[c],i);s.push(a)}e.morphAttributes[r]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var u=this.groups,d=(c=0,u.length);c<d;c++){var p=u[c];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Object.keys(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;null!==n&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var r=this.attributes;for(var i in r){var a=(d=r[i]).toJSON();""!==d.name&&(a.name=d.name),t.data.attributes[i]=a}var o={},s=!1;for(var i in this.morphAttributes){for(var l=this.morphAttributes[i],c=[],h=0,u=l.length;h<u;h++){var d;a=(d=l[h]).toJSON();""!==d.name&&(a.name=d.name),c.push(a)}0<c.length&&(o[i]=c,s=!0)}s&&(t.data.morphAttributes=o,t.data.morphTargetsRelative=this.morphTargetsRelative);var p=this.groups;0<p.length&&(t.data.groups=JSON.parse(JSON.stringify(p)));var f=this.boundingSphere;return null!==f&&(t.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),t},clone:function(){return(new Ln).copy(this)},copy:function(t){var e,i,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone());var a=t.attributes;for(e in a){var o=a[e];this.setAttribute(e,o.clone())}var s=t.morphAttributes;for(e in s){var l=[],c=s[e];for(i=0,n=c.length;i<n;i++)l.push(c[i].clone());this.morphAttributes[e]=l}this.morphTargetsRelative=t.morphTargetsRelative;var h=t.groups;for(i=0,n=h.length;i<n;i++){var u=h[i];this.addGroup(u.start,u.count,u.materialIndex)}var d=t.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var An=new We,Pn=new ji,Rn=new Ci,On=new Le,In=new Le,Dn=new Le,jn=new Le,kn=new Le,Nn=new Le,Fn=new Le,Bn=new Le,Hn=new Le,Un=new Me,zn=new Me,Vn=new Me,Gn=new Le,Wn=new Le;function Yn(t,e){ci.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Ln,this.material=void 0!==e?e:new ln({color:16777215*Math.random()}),this.drawMode=ae,this.updateMorphTargets()}function Xn(t,e,i,n,r,a,o,s){if(null===(e.side===xt?n.intersectTriangle(o,a,r,!0,s):n.intersectTriangle(r,a,o,e.side!==Q,s)))return null;Wn.copy(s),Wn.applyMatrix4(t.matrixWorld);var l=i.ray.origin.distanceTo(Wn);return l<i.near||l>i.far?null:{distance:l,point:Wn.clone(),object:t}}function qn(t,e,i,n,r,a,o,s,l,c,h,u){On.fromBufferAttribute(r,c),In.fromBufferAttribute(r,h),Dn.fromBufferAttribute(r,u);var d=t.morphTargetInfluences;if(e.morphTargets&&a&&d){Fn.set(0,0,0),Bn.set(0,0,0),Hn.set(0,0,0);for(var p=0,f=a.length;p<f;p++){var m=d[p],g=a[p];0!==m&&(jn.fromBufferAttribute(g,c),kn.fromBufferAttribute(g,h),Nn.fromBufferAttribute(g,u),o?(Fn.addScaledVector(jn,m),Bn.addScaledVector(kn,m),Hn.addScaledVector(Nn,m)):(Fn.addScaledVector(jn.sub(On),m),Bn.addScaledVector(kn.sub(In),m),Hn.addScaledVector(Nn.sub(Dn),m)))}On.add(Fn),In.add(Bn),Dn.add(Hn)}var v=Xn(t,e,i,n,On,In,Dn,Gn);if(v){s&&(Un.fromBufferAttribute(s,c),zn.fromBufferAttribute(s,h),Vn.fromBufferAttribute(s,u),v.uv=Zi.getUV(Gn,On,In,Dn,Un,zn,Vn,new Me)),l&&(Un.fromBufferAttribute(l,c),zn.fromBufferAttribute(l,h),Vn.fromBufferAttribute(l,u),v.uv2=Zi.getUV(Gn,On,In,Dn,Un,zn,Vn,new Me));var y=new an(c,h,u);Zi.getNormal(On,In,Dn,y.normal),v.face=y}return v}Yn.prototype=Object.assign(Object.create(ci.prototype),{constructor:Yn,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return ci.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,a=Object.keys(r);if(0<a.length){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)i=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{var s=n.morphTargets;void 0!==s&&0<s.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var i,n=this.geometry,r=this.material,a=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),Rn.copy(n.boundingSphere),Rn.applyMatrix4(a),!1!==t.ray.intersectsSphere(Rn)&&(An.getInverse(a),Pn.copy(t.ray).applyMatrix4(An),null===n.boundingBox||!1!==Pn.intersectsBox(n.boundingBox))))if(this.drawMode===ae){if(n.isBufferGeometry){var o,s,l,c,h,u,d,p,f,m=n.index,g=n.attributes.position,v=n.morphAttributes.position,y=n.morphTargetsRelative,_=n.attributes.uv,b=n.attributes.uv2,x=n.groups,w=n.drawRange;if(null!==m)if(Array.isArray(r))for(c=0,u=x.length;c<u;c++)for(f=r[(p=x[c]).materialIndex],h=Math.max(p.start,w.start),d=Math.min(p.start+p.count,w.start+w.count);h<d;h+=3)o=m.getX(h),s=m.getX(h+1),l=m.getX(h+2),(i=qn(this,f,t,Pn,g,v,y,_,b,o,s,l))&&(i.faceIndex=Math.floor(h/3),i.face.materialIndex=p.materialIndex,e.push(i));else for(c=Math.max(0,w.start),u=Math.min(m.count,w.start+w.count);c<u;c+=3)o=m.getX(c),s=m.getX(c+1),l=m.getX(c+2),(i=qn(this,r,t,Pn,g,v,y,_,b,o,s,l))&&(i.faceIndex=Math.floor(c/3),e.push(i));else if(void 0!==g)if(Array.isArray(r))for(c=0,u=x.length;c<u;c++)for(f=r[(p=x[c]).materialIndex],h=Math.max(p.start,w.start),d=Math.min(p.start+p.count,w.start+w.count);h<d;h+=3)(i=qn(this,f,t,Pn,g,v,y,_,b,o=h,s=h+1,l=h+2))&&(i.faceIndex=Math.floor(h/3),i.face.materialIndex=p.materialIndex,e.push(i));else for(c=Math.max(0,w.start),u=Math.min(g.count,w.start+w.count);c<u;c+=3)(i=qn(this,r,t,Pn,g,v,y,_,b,o=c,s=c+1,l=c+2))&&(i.faceIndex=Math.floor(c/3),e.push(i))}else if(n.isGeometry){var T,M,S,E,C=Array.isArray(r),L=n.vertices,A=n.faces,P=n.faceVertexUvs[0];0<P.length&&(E=P);for(var R=0,O=A.length;R<O;R++){var I=A[R],D=C?r[I.materialIndex]:r;if(void 0!==D&&(T=L[I.a],M=L[I.b],S=L[I.c],i=Xn(this,D,t,Pn,T,M,S,Gn))){if(E&&E[R]){var j=E[R];Un.copy(j[0]),zn.copy(j[1]),Vn.copy(j[2]),i.uv=Zi.getUV(Gn,T,M,S,Un,zn,Vn,new Me)}i.face=I,i.faceIndex=R,e.push(i)}}}}else console.warn("THREE.Mesh: TriangleStripDrawMode and TriangleFanDrawMode are not supported by .raycast().")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Jn=0,Zn=new We,Qn=new ci,Kn=new Le;function $n(){Object.defineProperty(this,"id",{value:Jn+=2}),this.uuid=Te.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}$n.prototype=Object.assign(Object.create(be.prototype),{constructor:$n,isGeometry:!0,applyMatrix:function(t){for(var e=(new Re).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++){this.vertices[i].applyMatrix4(t)}for(i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(e).normalize();for(var a=0,o=r.vertexNormals.length;a<o;a++)r.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return Zn.makeRotationX(t),this.applyMatrix(Zn),this},rotateY:function(t){return Zn.makeRotationY(t),this.applyMatrix(Zn),this},rotateZ:function(t){return Zn.makeRotationZ(t),this.applyMatrix(Zn),this},translate:function(t,e,i){return Zn.makeTranslation(t,e,i),this.applyMatrix(Zn),this},scale:function(t,e,i){return Zn.makeScale(t,e,i),this.applyMatrix(Zn),this},lookAt:function(t){return Qn.lookAt(t),Qn.updateMatrix(),this.applyMatrix(Qn.matrix),this},fromBufferGeometry:function(t){var o=this,e=null!==t.index?t.index.array:void 0,i=t.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var n=i.position.array,s=void 0!==i.normal?i.normal.array:void 0,l=void 0!==i.color?i.color.array:void 0,c=void 0!==i.uv?i.uv.array:void 0,h=void 0!==i.uv2?i.uv2.array:void 0;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var r=0;r<n.length;r+=3)o.vertices.push((new Le).fromArray(n,r)),void 0!==l&&o.colors.push((new tn).fromArray(l,r));function a(t,e,i,n){var r=void 0===l?[]:[o.colors[t].clone(),o.colors[e].clone(),o.colors[i].clone()],a=new an(t,e,i,void 0===s?[]:[(new Le).fromArray(s,3*t),(new Le).fromArray(s,3*e),(new Le).fromArray(s,3*i)],r,n);o.faces.push(a),void 0!==c&&o.faceVertexUvs[0].push([(new Me).fromArray(c,2*t),(new Me).fromArray(c,2*e),(new Me).fromArray(c,2*i)]),void 0!==h&&o.faceVertexUvs[1].push([(new Me).fromArray(h,2*t),(new Me).fromArray(h,2*e),(new Me).fromArray(h,2*i)])}var u=t.groups;if(0<u.length)for(r=0;r<u.length;r++)for(var d=u[r],p=d.start,f=p,m=p+d.count;f<m;f+=3)void 0!==e?a(e[f],e[f+1],e[f+2],d.materialIndex):a(f,f+1,f+2,d.materialIndex);else if(void 0!==e)for(r=0;r<e.length;r+=3)a(e[r],e[r+1],e[r+2]);else for(r=0;r<n.length/3;r+=3)a(r,r+1,r+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Kn).negate(),this.translate(Kn.x,Kn.y,Kn.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,n=new We;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new Le,e=new Le,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,i,n,r,a,o;for(void 0===t&&(t=!0),o=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)o[e]=new Le;if(t){var s,l,c,h=new Le,u=new Le;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],s=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c],h.subVectors(c,l),u.subVectors(s,l),h.cross(u),o[a.a].add(h),o[a.b].add(h),o[a.c].add(h)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)o[(a=this.faces[n]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,i=this.vertices.length;e<i;e++)o[e].normalize();for(n=0,r=this.faces.length;n<r;n++){var d=(a=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,i;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var n=(i=this.faces[t]).vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for((r=this.faces[i]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var a=new $n;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)l=new Le,c={a:new Le,b:new Le,c:new Le},o.push(l),s.push(c)}var l,c,h=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],l=h.faceNormals[i],c=h.vertexNormals[i],l.copy(r.normal),c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(r=this.faces[i]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Mi),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ci),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t&&t.isGeometry){var n,r=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,l=t.faces,c=this.colors,h=t.colors;void 0===i&&(i=0),void 0!==e&&(n=(new Re).getNormalMatrix(e));for(var u=0,d=o.length;u<d;u++){var p=o[u].clone();void 0!==e&&p.applyMatrix4(e),a.push(p)}for(u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(u=0,d=l.length;u<d;u++){var f,m,g,v=l[u],y=v.vertexNormals,_=v.vertexColors;(f=new an(v.a+r,v.b+r,v.c+r)).normal.copy(v.normal),void 0!==n&&f.normal.applyMatrix3(n).normalize();for(var b=0,x=y.length;b<x;b++)m=y[b].clone(),void 0!==n&&m.applyMatrix3(n).normalize(),f.vertexNormals.push(m);f.color.copy(v.color);for(b=0,x=_.length;b<x;b++)g=_[b],f.vertexColors.push(g.clone());f.materialIndex=v.materialIndex+i,s.push(f)}for(u=0,d=t.faceVertexUvs.length;u<d;u++){var w=t.faceVertexUvs[u];void 0===this.faceVertexUvs[u]&&(this.faceVertexUvs[u]=[]);for(b=0,x=w.length;b<x;b++){for(var T=w[b],M=[],S=0,E=T.length;S<E;S++)M.push(T[S].clone());this.faceVertexUvs[u].push(M)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,i,n,r,a,o,s,l={},c=[],h=[],u=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)t=this.vertices[i],void 0===l[e=Math.round(t.x*u)+"_"+Math.round(t.y*u)+"_"+Math.round(t.z*u)]?(l[e]=i,c.push(this.vertices[i]),h[i]=c.length-1):h[i]=h[l[e]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(r=this.faces[i]).a=h[r.a],r.b=h[r.b],r.c=h[r.c],a=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(a[p]===a[(p+1)%3]){d.push(i);break}}for(i=d.length-1;0<=i;i--){var f=d[i];for(this.faces.splice(f,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(f,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},setFromPoints:function(t){this.vertices=[];for(var e=0,i=t.length;e<i;e++){var n=t[e];this.vertices.push(new Le(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,i=0;i<e;i++)t[i]._id=i;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,r,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===e&&(n=[]),o&&o.length===e&&(r=[]);for(i=0;i<e;i++){var s=t[i]._id;n&&n.push(a[s]),r&&r.push(o[s])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}for(var n=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];n.push(a.x,a.y,a.z)}var o=[],s=[],l={},c=[],h={},u=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=0<p.normal.length(),g=0<p.vertexNormals.length,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=0<p.vertexColors.length,_=0;if(_=T(_=T(_=T(_=T(_=T(_=T(_=T(_=T(_,0,0),1,!0),2,!1),3,f),4,m),5,g),6,v),7,y),o.push(_),o.push(p.a,p.b,p.c),o.push(p.materialIndex),f){var b=this.faceVertexUvs[0][r];o.push(E(b[0]),E(b[1]),E(b[2]))}if(m&&o.push(M(p.normal)),g){var x=p.vertexNormals;o.push(M(x[0]),M(x[1]),M(x[2]))}if(v&&o.push(S(p.color)),y){var w=p.vertexColors;o.push(S(w[0]),S(w[1]),S(w[2]))}}function T(t,e,i){return i?t|1<<e:t&~(1<<e)}function M(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]||(l[e]=s.length/3,s.push(t.x,t.y,t.z)),l[e]}function S(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]||(h[e]=c.length,c.push(t.getHex())),h[e]}function E(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=u.length/2,u.push(t.x,t.y)),d[e]}return t.data={},t.data.vertices=n,t.data.normals=s,0<c.length&&(t.data.colors=c),0<u.length&&(t.data.uvs=[u]),t.data.faces=o,t},clone:function(){return(new $n).copy(this)},copy:function(t){var e,i,n,r,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,i=s.length;e<i;e++)this.vertices.push(s[e].clone());var l=t.colors;for(e=0,i=l.length;e<i;e++)this.colors.push(l[e].clone());var c=t.faces;for(e=0,i=c.length;e<i;e++)this.faces.push(c[e].clone());for(e=0,i=t.faceVertexUvs.length;e<i;e++){var h=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),n=0,r=h.length;n<r;n++){var u=h[n],d=[];for(a=0,o=u.length;a<o;a++){var p=u[a];d.push(p.clone())}this.faceVertexUvs[e].push(d)}}var f=t.morphTargets;for(e=0,i=f.length;e<i;e++){var m={};if(m.name=f[e].name,void 0!==f[e].vertices)for(m.vertices=[],n=0,r=f[e].vertices.length;n<r;n++)m.vertices.push(f[e].vertices[n].clone());if(void 0!==f[e].normals)for(m.normals=[],n=0,r=f[e].normals.length;n<r;n++)m.normals.push(f[e].normals[n].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,i=g.length;e<i;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],n=0,r=g[e].vertexNormals.length;n<r;n++){var y=g[e].vertexNormals[n],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],n=0,r=g[e].faceNormals.length;n<r;n++)v.faceNormals.push(g[e].faceNormals[n].clone());this.morphNormals.push(v)}var b=t.skinWeights;for(e=0,i=b.length;e<i;e++)this.skinWeights.push(b[e].clone());var x=t.skinIndices;for(e=0,i=x.length;e<i;e++)this.skinIndices.push(x[e].clone());var w=t.lineDistances;for(e=0,i=w.length;e<i;e++)this.lineDistances.push(w[e]);var T=t.boundingBox;null!==T&&(this.boundingBox=T.clone());var M=t.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var tr=function(o){function t(t,e,i,n,r,a){o.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new er(t,e,i,n,r,a)),this.mergeVertices()}return o&&(t.__proto__=o),(t.prototype=Object.create(o&&o.prototype)).constructor=t}($n),er=function(s){function t(t,e,i,n,r,a){s.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};var A=this;t=t||1,e=e||1,i=i||1,n=Math.floor(n)||1,r=Math.floor(r)||1,a=Math.floor(a)||1;var P=[],R=[],O=[],I=[],D=0,j=0;function o(t,e,i,n,r,a,o,s,l,c,h){var u,d,p=a/l,f=o/c,m=a/2,g=o/2,v=s/2,y=l+1,_=c+1,b=0,x=0,w=new Le;for(d=0;d<_;d++){var T=d*f-g;for(u=0;u<y;u++){var M=u*p-m;w[t]=M*n,w[e]=T*r,w[i]=v,R.push(w.x,w.y,w.z),w[t]=0,w[e]=0,w[i]=0<s?1:-1,O.push(w.x,w.y,w.z),I.push(u/l),I.push(1-d/c),b+=1}}for(d=0;d<c;d++)for(u=0;u<l;u++){var S=D+u+y*d,E=D+u+y*(d+1),C=D+(u+1)+y*(d+1),L=D+(u+1)+y*d;P.push(S,E,L),P.push(E,C,L),x+=6}A.addGroup(j,x,h),j+=x,D+=b}o("z","y","x",-1,-1,i,e,t,a,r,0),o("z","y","x",1,-1,i,e,-t,a,r,1),o("x","z","y",1,1,t,i,e,n,a,2),o("x","z","y",1,-1,t,i,-e,n,a,3),o("x","y","z",1,-1,t,e,i,n,r,4),o("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(P),this.setAttribute("position",new vn(R,3)),this.setAttribute("normal",new vn(O,3)),this.setAttribute("uv",new vn(I,2))}return s&&(t.__proto__=s),(t.prototype=Object.create(s&&s.prototype)).constructor=t}(Ln);function ir(t){var e={};for(var i in t)for(var n in e[i]={},t[i]){var r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}return e}function nr(t){for(var e={},i=0;i<t.length;i++){var n=ir(t[i]);for(var r in n)e[r]=n[r]}return e}var rr={clone:ir,merge:nr},ar="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",or="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function sr(t){sn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=ar,this.fragmentShader=or,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function lr(){ci.call(this),this.type="Camera",this.matrixWorldInverse=new We,this.projectionMatrix=new We,this.projectionMatrixInverse=new We}function cr(t,e,i,n){lr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}((sr.prototype=Object.create(sn.prototype)).constructor=sr).prototype.isShaderMaterial=!0,sr.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ir(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},sr.prototype.toJSON=function(t){var e=sn.prototype.toJSON.call(this,t);for(var i in e.uniforms={},this.uniforms){var n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}0<Object.keys(this.defines).length&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var r={};for(var a in this.extensions)!0===this.extensions[a]&&(r[a]=!0);return 0<Object.keys(r).length&&(e.extensions=r),e},lr.prototype=Object.assign(Object.create(ci.prototype),{constructor:lr,isCamera:!0,copy:function(t,e){return ci.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Le),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){ci.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),cr.prototype=Object.assign(Object.create(lr.prototype),{constructor:cr,isPerspectiveCamera:!0,copy:function(t,e){return lr.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Te.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Te.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Te.RAD2DEG*Math.atan(Math.tan(.5*Te.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Te.DEG2RAD*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*n/o,e-=a.offsetY*i/s,n*=a.width/o,i*=a.height/s}var l=this.filmOffset;0!==l&&(r+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=ci.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function hr(t,e,i,n){ci.call(this),this.type="CubeCamera";var a=new cr(90,1,t,e);a.up.set(0,-1,0),a.lookAt(new Le(1,0,0)),this.add(a);var o=new cr(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new Le(-1,0,0)),this.add(o);var s=new cr(90,1,t,e);s.up.set(0,0,1),s.lookAt(new Le(0,1,0)),this.add(s);var l=new cr(90,1,t,e);l.up.set(0,0,-1),l.lookAt(new Le(0,-1,0)),this.add(l);var c=new cr(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new Le(0,0,1)),this.add(c);var h=new cr(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new Le(0,0,-1)),this.add(h),n=n||{format:ee,magFilter:Yt,minFilter:Yt},this.renderTarget=new ur(i,i,n),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=t.getRenderTarget(),n=this.renderTarget,r=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,a),t.setRenderTarget(n,1),t.render(e,o),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,l),t.setRenderTarget(n,4),t.render(e,c),n.texture.generateMipmaps=r,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(i)},this.clear=function(t,e,i,n){for(var r=t.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)t.setRenderTarget(a,o),t.clear(e,i,n);t.setRenderTarget(r)}}function ur(t,e,i){ke.call(this,t,e,i)}function dr(t,e,i,n,r,a,o,s,l,c,h,u){De.call(this,null,a,o,s,l,c,n,r,h,u),this.image={data:t||null,width:e||1,height:i||1},this.magFilter=void 0!==l?l:Vt,this.minFilter=void 0!==c?c:Vt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}(hr.prototype=Object.create(ci.prototype)).constructor=hr,((ur.prototype=Object.create(ke.prototype)).constructor=ur).prototype.isWebGLRenderTargetCube=!0,ur.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var i=new hi,n={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},r=new sr({type:"CubemapFromEquirect",uniforms:ir(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:xt,blending:K});r.uniforms.tEquirect.value=e;var a=new Yn(new er(5,5,5),r);i.add(a);var o=new hr(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(t,i),a.geometry.dispose(),a.material.dispose(),this},((dr.prototype=Object.create(De.prototype)).constructor=dr).prototype.isDataTexture=!0;var pr=new Ci,fr=new Le;function mr(t,e,i,n,r,a){this.planes=[void 0!==t?t:new Bi,void 0!==e?e:new Bi,void 0!==i?i:new Bi,void 0!==n?n:new Bi,void 0!==r?r:new Bi,void 0!==a?a:new Bi]}Object.assign(mr.prototype,{set:function(t,e,i,n,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(o-n,h-s,f-u,y-m).normalize(),e[1].setComponents(o+n,h+s,f+u,y+m).normalize(),e[2].setComponents(o+r,h+l,f+d,y+g).normalize(),e[3].setComponents(o-r,h-l,f-d,y-g).normalize(),e[4].setComponents(o-a,h-c,f-p,y-v).normalize(),e[5].setComponents(o+a,h+c,f+p,y+v).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),pr.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(pr)},intersectsSprite:function(t){return pr.center.set(0,0,0),pr.radius=.7071067811865476,pr.applyMatrix4(t.matrixWorld),this.intersectsSphere(pr)},intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;r<6;r++){if(e[r].distanceToPoint(i)<n)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,i=0;i<6;i++){var n=e[i];if(fr.x=0<n.normal.x?t.max.x:t.min.x,fr.y=0<n.normal.y?t.max.y:t.min.y,fr.z=0<n.normal.z?t.max.z:t.min.z,n.distanceToPoint(fr)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}});var gr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToVariance(float roughness) {\n  float variance = 0.0;\n  if (roughness >= r1) {\n    variance = (r0 - roughness) * (v1 - v0) / (r0 - r1) + v0;\n  } else if (roughness >= r4) {\n    variance = (r1 - roughness) * (v4 - v1) / (r1 - r4) + v1;\n  } else if (roughness >= r5) {\n    variance = (r4 - roughness) * (v5 - v4) / (r4 - r5) + v4;\n  } else {\n    float roughness2 = roughness * roughness;\n    variance = 1.79 * roughness2 * roughness2;\n  }\n  return variance;\n}\nfloat varianceToRoughness(float variance) {\n  float roughness = 0.0;\n  if (variance >= v1) {\n    roughness = (v0 - variance) * (r1 - r0) / (v0 - v1) + r0;\n  } else if (variance >= v4) {\n    roughness = (v1 - variance) * (r4 - r1) / (v1 - v4) + r1;\n  } else if (variance >= v5) {\n    roughness = (v4 - variance) * (r5 - r4) / (v4 - v5) + r4;\n  } else {\n    roughness = pow(0.559 * variance, 0.25);  }\n  return roughness;\n}\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ), 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = clamp( clearcoatRoughness, 0.04, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_normalmap_pars_fragment:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpack2HalfToRGBA( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpack2HalfToRGBA( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = ( floor( uv * size - 0.5 ) + 0.5 ) * texelSize;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},vr={common:{diffuse:{value:new tn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Re},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Me(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new tn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new tn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Re}},sprite:{diffuse:{value:new tn(15658734)},opacity:{value:1},center:{value:new Me(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Re}}},yr={basic:{uniforms:nr([vr.common,vr.specularmap,vr.envmap,vr.aomap,vr.lightmap,vr.fog]),vertexShader:gr.meshbasic_vert,fragmentShader:gr.meshbasic_frag},lambert:{uniforms:nr([vr.common,vr.specularmap,vr.envmap,vr.aomap,vr.lightmap,vr.emissivemap,vr.fog,vr.lights,{emissive:{value:new tn(0)}}]),vertexShader:gr.meshlambert_vert,fragmentShader:gr.meshlambert_frag},phong:{uniforms:nr([vr.common,vr.specularmap,vr.envmap,vr.aomap,vr.lightmap,vr.emissivemap,vr.bumpmap,vr.normalmap,vr.displacementmap,vr.fog,vr.lights,{emissive:{value:new tn(0)},specular:{value:new tn(1118481)},shininess:{value:30}}]),vertexShader:gr.meshphong_vert,fragmentShader:gr.meshphong_frag},standard:{uniforms:nr([vr.common,vr.envmap,vr.aomap,vr.lightmap,vr.emissivemap,vr.bumpmap,vr.normalmap,vr.displacementmap,vr.roughnessmap,vr.metalnessmap,vr.fog,vr.lights,{emissive:{value:new tn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:gr.meshphysical_vert,fragmentShader:gr.meshphysical_frag},toon:{uniforms:nr([vr.common,vr.specularmap,vr.aomap,vr.lightmap,vr.emissivemap,vr.bumpmap,vr.normalmap,vr.displacementmap,vr.gradientmap,vr.fog,vr.lights,{emissive:{value:new tn(0)},specular:{value:new tn(1118481)},shininess:{value:30}}]),vertexShader:gr.meshtoon_vert,fragmentShader:gr.meshtoon_frag},matcap:{uniforms:nr([vr.common,vr.bumpmap,vr.normalmap,vr.displacementmap,vr.fog,{matcap:{value:null}}]),vertexShader:gr.meshmatcap_vert,fragmentShader:gr.meshmatcap_frag},points:{uniforms:nr([vr.points,vr.fog]),vertexShader:gr.points_vert,fragmentShader:gr.points_frag},dashed:{uniforms:nr([vr.common,vr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gr.linedashed_vert,fragmentShader:gr.linedashed_frag},depth:{uniforms:nr([vr.common,vr.displacementmap]),vertexShader:gr.depth_vert,fragmentShader:gr.depth_frag},normal:{uniforms:nr([vr.common,vr.bumpmap,vr.normalmap,vr.displacementmap,{opacity:{value:1}}]),vertexShader:gr.normal_vert,fragmentShader:gr.normal_frag},sprite:{uniforms:nr([vr.sprite,vr.fog]),vertexShader:gr.sprite_vert,fragmentShader:gr.sprite_frag},background:{uniforms:{uvTransform:{value:new Re},t2D:{value:null}},vertexShader:gr.background_vert,fragmentShader:gr.background_frag},cube:{uniforms:nr([vr.envmap,{opacity:{value:1}}]),vertexShader:gr.cube_vert,fragmentShader:gr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:gr.equirect_vert,fragmentShader:gr.equirect_frag},distanceRGBA:{uniforms:nr([vr.common,vr.displacementmap,{referencePosition:{value:new Le},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:gr.distanceRGBA_vert,fragmentShader:gr.distanceRGBA_frag},shadow:{uniforms:nr([vr.lights,vr.fog,{color:{value:new tn(0)},opacity:{value:1}}]),vertexShader:gr.shadow_vert,fragmentShader:gr.shadow_frag}};function _r(){var i=null,n=!1,r=null;function a(t,e){!1!==n&&(r(t,e),i.requestAnimationFrame(a))}return{start:function(){!0!==n&&null!==r&&(i.requestAnimationFrame(a),n=!0)},stop:function(){n=!1},setAnimationLoop:function(t){r=t},setContext:function(t){i=t}}}function br(l){var c=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),c.get(t)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var e=c.get(t);e&&(l.deleteBuffer(e.buffer),c.delete(t))},update:function(t,e){t.isInterleavedBufferAttribute&&(t=t.data);var i,n,r,a,o,s=c.get(t);void 0===s?c.set(t,function(t,e){var i=t.array,n=t.usage,r=l.createBuffer();l.bindBuffer(e,r),l.bufferData(e,i,n),t.onUploadCallback();var a=5126;return i instanceof Float32Array?a=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?a=5123:i instanceof Int16Array?a=5122:i instanceof Uint32Array?a=5125:i instanceof Int32Array?a=5124:i instanceof Int8Array?a=5120:i instanceof Uint8Array&&(a=5121),{buffer:r,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,e)):s.version<t.version&&(i=s.buffer,r=e,a=(n=t).array,o=n.updateRange,l.bindBuffer(r,i),-1===o.count?l.bufferSubData(r,0,a):(l.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1),s.version=t.version)}}}function xr(t,e,i,n){$n.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new wr(t,e,i,n)),this.mergeVertices()}function wr(t,e,i,n){Ln.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};var r,a,o=(t=t||1)/2,s=(e=e||1)/2,l=Math.floor(i)||1,c=Math.floor(n)||1,h=l+1,u=c+1,d=t/l,p=e/c,f=[],m=[],g=[],v=[];for(a=0;a<u;a++){var y=a*p-s;for(r=0;r<h;r++){var _=r*d-o;m.push(_,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-a/c)}}for(a=0;a<c;a++)for(r=0;r<l;r++){var b=r+h*a,x=r+h*(a+1),w=r+1+h*(a+1),T=r+1+h*a;f.push(b,x,T),f.push(x,w,T)}this.setIndex(f),this.setAttribute("position",new vn(m,3)),this.setAttribute("normal",new vn(g,3)),this.setAttribute("uv",new vn(v,2))}function Tr(l,i,c,n){var h,u,d=new tn(0),p=0,f=null,m=0;function g(t,e){i.buffers.color.setClear(t.r,t.g,t.b,e,n)}return{getClearColor:function(){return d},setClearColor:function(t,e){d.set(t),g(d,p=void 0!==e?e:1)},getClearAlpha:function(){return p},setClearAlpha:function(t){g(d,p=t)},render:function(t,e,i,n){var r=e.background,a=l.vr,o=a.getSession&&a.getSession();if(o&&"additive"===o.environmentBlendMode&&(r=null),null===r?(g(d,p),f=null,m=0):r&&r.isColor&&(g(r,1),n=!0,f=null,m=0),(l.autoClear||n)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil),r&&(r.isCubeTexture||r.isWebGLRenderTargetCube||r.mapping===Ut)){void 0===u&&((u=new Yn(new er(1,1,1),new sr({type:"BackgroundCubeMaterial",uniforms:ir(yr.cube.uniforms),vertexShader:yr.cube.vertexShader,fragmentShader:yr.cube.fragmentShader,side:xt,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(u.material,"map",{get:function(){return this.envMap.value}}),c.update(u));var s=r.isWebGLRenderTargetCube?r.texture:r;u.material.envMap=s,f===r&&m===s.version||(u.material.needsUpdate=!0,f=r,m=s.version),t.unshift(u,u.geometry,u.material,0,0,null)}else r&&r.isTexture&&(void 0===h&&((h=new Yn(new wr(2,2),new sr({type:"BackgroundMaterial",uniforms:ir(yr.background.uniforms),vertexShader:yr.background.vertexShader,fragmentShader:yr.background.fragmentShader,side:R,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),c.update(h)),!0===(h.material.uniforms.t2D.value=r).matrixAutoUpdate&&r.updateMatrix(),h.material.uniforms.uvTransform.value.copy(r.matrix),f===r&&m===r.version||(h.material.needsUpdate=!0,m=(f=r).version),t.unshift(h,h.geometry,h.material,0,0,null))}}}function Mr(o,s,l,t){var c,h=t.isWebGL2;this.setMode=function(t){c=t},this.render=function(t,e){o.drawArrays(c,t,e),l.update(e,c)},this.renderInstances=function(t,e,i,n){if(0!==n){var r,a;if(h)r=o,a="drawArraysInstanced";else if(a="drawArraysInstancedANGLE",null===(r=s.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");r[a](c,e,i,n),l.update(i,c,n)}}}function Sr(e,i,t){var n;function r(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==t.precision?t.precision:"highp",s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=!0===t.logarithmicDepthBuffer,c=e.getParameter(34930),h=e.getParameter(35660),u=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=0<h,y=a||!!i.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==n)return n;var t=i.get("EXT_texture_filter_anisotropic");return n=null!==t?e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:u,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function Er(){var h=this,u=null,d=0,p=!1,f=!1,m=new Bi,g=new Re,v={value:null,needsUpdate:!1};function y(){v.value!==u&&(v.value=u,v.needsUpdate=0<d),h.numPlanes=d,h.numIntersection=0}function _(t,e,i,n){var r=null!==t?t.length:0,a=null;if(0!==r){if(a=v.value,!0!==n||null===a){var o=i+4*r,s=e.matrixWorldInverse;g.getNormalMatrix(s),(null===a||a.length<o)&&(a=new Float32Array(o));for(var l=0,c=i;l!==r;++l,c+=4)m.copy(t[l]).applyMatrix4(s,g),m.normal.toArray(a,c),a[c+3]=m.constant}v.value=a,v.needsUpdate=!0}return h.numPlanes=r,a}this.uniform=v,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,i){var n=0!==t.length||e||0!==d||p;return p=e,u=_(t,i,0),d=t.length,n},this.beginShadows=function(){f=!0,_(null)},this.endShadows=function(){f=!1,y()},this.setState=function(t,e,i,n,r,a){if(!p||null===t||0===t.length||f&&!i)f?_(null):y();else{var o=f?0:d,s=4*o,l=r.clippingState||null;v.value=l,l=_(t,n,s,a);for(var c=0;c!==s;++c)l[c]=u[c];r.clippingState=l,this.numIntersection=e?this.numPlanes:0,this.numPlanes+=o}}}function Cr(i){var n={};return{get:function(t){if(void 0!==n[t])return n[t];var e;switch(t){case"WEBGL_depth_texture":e=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=i.getExtension(t)}return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),n[t]=e}}}function Lr(t,p,a){var o=new WeakMap,f=new WeakMap;function s(t){var e=t.target,i=o.get(e);for(var n in null!==i.index&&p.remove(i.index),i.attributes)p.remove(i.attributes[n]);e.removeEventListener("dispose",s),o.delete(e);var r=f.get(i);r&&(p.remove(r),f.delete(i)),a.memory.geometries--}function n(t){var e=[],i=t.index,n=t.attributes.position,r=0;if(null!==i){var a=i.array;r=i.version;for(var o=0,s=a.length;o<s;o+=3){var l=a[o+0],c=a[o+1],h=a[o+2];e.push(l,c,c,h,h,l)}}else{a=n.array;r=n.version;for(o=0,s=a.length/3-1;o<s;o+=3){l=o+0,c=o+1,h=o+2;e.push(l,c,c,h,h,l)}}var u=new(65535<bn(e)?gn:fn)(e,1);u.version=r,p.update(u,34963);var d=f.get(t);d&&p.remove(d),f.set(t,u)}return{get:function(t,e){var i=o.get(e);return i||(e.addEventListener("dispose",s),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Ln).setFromObject(t)),i=e._bufferGeometry),o.set(e,i),a.memory.geometries++,i)},update:function(t){var e=t.index,i=t.attributes;for(var n in null!==e&&p.update(e,34963),i)p.update(i[n],34962);var r=t.morphAttributes;for(var n in r)for(var a=r[n],o=0,s=a.length;o<s;o++)p.update(a[o],34962)},getWireframeAttribute:function(t){var e=f.get(t);if(e){var i=t.index;null!==i&&e.version<i.version&&n(t)}else n(t);return f.get(t)}}}function Ar(o,s,l,t){var c,h,u,d=t.isWebGL2;this.setMode=function(t){c=t},this.setIndex=function(t){h=t.type,u=t.bytesPerElement},this.render=function(t,e){o.drawElements(c,e,h,t*u),l.update(e,c)},this.renderInstances=function(t,e,i,n){if(0!==n){var r,a;if(d)r=o,a="drawElementsInstanced";else if(a="drawElementsInstancedANGLE",null===(r=s.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");r[a](c,i,h,e*u,n),l.update(i,c,n)}}}function Pr(t){var n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function(t,e,i){switch(i=i||1,n.calls++,e){case 4:n.triangles+=i*(t/3);break;case 5:case 6:n.triangles+=i*(t-2);break;case 1:n.lines+=i*(t/2);break;case 3:n.lines+=i*(t-1);break;case 2:n.lines+=i*t;break;case 0:n.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e)}}}}function Rr(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Or(m){var g={},v=new Float32Array(8);return{update:function(t,e,i,n){var r=t.morphTargetInfluences,a=r.length,o=g[e.id];if(void 0===o){o=[];for(var s=0;s<a;s++)o[s]=[s,0];g[e.id]=o}var l=i.morphTargets&&e.morphAttributes.position,c=i.morphNormals&&e.morphAttributes.normal;for(s=0;s<a;s++)0!==(u=o[s])[1]&&(l&&e.deleteAttribute("morphTarget"+s),c&&e.deleteAttribute("morphNormal"+s));for(s=0;s<a;s++)(u=o[s])[0]=s,u[1]=r[s];o.sort(Rr);var h=0;for(s=0;s<8;s++){var u;if(u=o[s]){var d=u[0],p=u[1];if(p){l&&e.setAttribute("morphTarget"+s,l[d]),c&&e.setAttribute("morphNormal"+s,c[d]),h+=v[s]=p;continue}}v[s]=0}var f=e.morphTargetsRelative?1:1-h;n.getUniforms().setValue(m,"morphTargetBaseInfluence",f),n.getUniforms().setValue(m,"morphTargetInfluences",v)}}}function Ir(t,r,a,o){var s={};return{update:function(t){var e=o.render.frame,i=t.geometry,n=r.get(t,i);return s[n.id]!==e&&(i.isGeometry&&n.updateFromObject(t),r.update(n),s[n.id]=e),t.isInstancedMesh&&a.update(t.instanceMatrix,34962),n},dispose:function(){s={}}}}function Dr(t,e,i,n,r,a,o,s,l,c){De.call(this,t=void 0!==t?t:[],e=void 0!==e?e:kt,i,n,r,a,o=void 0!==o?o:ee,s,l,c),this.flipY=!1}function jr(t,e,i,n){De.call(this,null),this.image={data:t||null,width:e||1,height:i||1,depth:n||1},this.magFilter=Vt,this.minFilter=Vt,this.wrapR=U,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function kr(t,e,i,n){De.call(this,null),this.image={data:t||null,width:e||1,height:i||1,depth:n||1},this.magFilter=Vt,this.minFilter=Vt,this.wrapR=U,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}yr.physical={uniforms:nr([yr.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new tn(0)},clearcoatNormalScale:{value:new Me(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:gr.meshphysical_vert,fragmentShader:gr.meshphysical_frag},(xr.prototype=Object.create($n.prototype)).constructor=xr,(wr.prototype=Object.create(Ln.prototype)).constructor=wr,((Dr.prototype=Object.create(De.prototype)).constructor=Dr).prototype.isCubeTexture=!0,Object.defineProperty(Dr.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),((jr.prototype=Object.create(De.prototype)).constructor=jr).prototype.isDataTexture2DArray=!0,((kr.prototype=Object.create(De.prototype)).constructor=kr).prototype.isDataTexture3D=!0;var Nr=new De,Fr=new jr,Br=new kr,Hr=new Dr,Ur=[],zr=[],Vr=new Float32Array(16),Gr=new Float32Array(9),Wr=new Float32Array(4);function Yr(t,e,i){var n=t[0];if(n<=0||0<n)return t;var r=e*i,a=Ur[r];if(void 0===a&&(a=new Float32Array(r),Ur[r]=a),0!==e){n.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=i,t[o].toArray(a,s)}return a}function Xr(t,e){if(t.length!==e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function qr(t,e){for(var i=0,n=e.length;i<n;i++)t[i]=e[i]}function Jr(t,e){var i=zr[e];void 0===i&&(i=new Int32Array(e),zr[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function Zr(t,e){var i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Qr(t,e){var i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Xr(i,e))return;t.uniform2fv(this.addr,e),qr(i,e)}}function Kr(t,e){var i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(void 0!==e.r)i[0]===e.r&&i[1]===e.g&&i[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(Xr(i,e))return;t.uniform3fv(this.addr,e),qr(i,e)}}function $r(t,e){var i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Xr(i,e))return;t.uniform4fv(this.addr,e),qr(i,e)}}function ta(t,e){var i=this.cache,n=e.elements;if(void 0===n){if(Xr(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),qr(i,e)}else{if(Xr(i,n))return;Wr.set(n),t.uniformMatrix2fv(this.addr,!1,Wr),qr(i,n)}}function ea(t,e){var i=this.cache,n=e.elements;if(void 0===n){if(Xr(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),qr(i,e)}else{if(Xr(i,n))return;Gr.set(n),t.uniformMatrix3fv(this.addr,!1,Gr),qr(i,n)}}function ia(t,e){var i=this.cache,n=e.elements;if(void 0===n){if(Xr(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),qr(i,e)}else{if(Xr(i,n))return;Vr.set(n),t.uniformMatrix4fv(this.addr,!1,Vr),qr(i,n)}}function na(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTexture2D(e||Nr,r)}function ra(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||Fr,r)}function aa(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||Br,r)}function oa(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTextureCube(e||Hr,r)}function sa(t,e){var i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function la(t,e){var i=this.cache;Xr(i,e)||(t.uniform2iv(this.addr,e),qr(i,e))}function ca(t,e){var i=this.cache;Xr(i,e)||(t.uniform3iv(this.addr,e),qr(i,e))}function ha(t,e){var i=this.cache;Xr(i,e)||(t.uniform4iv(this.addr,e),qr(i,e))}function ua(t,e){t.uniform1fv(this.addr,e)}function da(t,e){t.uniform1iv(this.addr,e)}function pa(t,e){t.uniform2iv(this.addr,e)}function fa(t,e){t.uniform3iv(this.addr,e)}function ma(t,e){t.uniform4iv(this.addr,e)}function ga(t,e){var i=Yr(e,this.size,2);t.uniform2fv(this.addr,i)}function va(t,e){var i=Yr(e,this.size,3);t.uniform3fv(this.addr,i)}function ya(t,e){var i=Yr(e,this.size,4);t.uniform4fv(this.addr,i)}function _a(t,e){var i=Yr(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function ba(t,e){var i=Yr(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function xa(t,e){var i=Yr(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function wa(t,e,i){var n=e.length,r=Jr(i,n);t.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.safeSetTexture2D(e[a]||Nr,r[a])}function Ta(t,e,i){var n=e.length,r=Jr(i,n);t.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.safeSetTextureCube(e[a]||Hr,r[a])}function Ma(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Zr;case 35664:return Qr;case 35665:return Kr;case 35666:return $r;case 35674:return ta;case 35675:return ea;case 35676:return ia;case 35678:case 36198:return na;case 35679:return aa;case 35680:return oa;case 36289:return ra;case 5124:case 35670:return sa;case 35667:case 35671:return la;case 35668:case 35672:return ca;case 35669:case 35673:return ha}}(e.type)}function Sa(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return ua;case 35664:return ga;case 35665:return va;case 35666:return ya;case 35674:return _a;case 35675:return ba;case 35676:return xa;case 35678:return wa;case 35680:return Ta;case 5124:case 35670:return da;case 35667:case 35671:return pa;case 35668:case 35672:return fa;case 35669:case 35673:return ma}}(e.type)}function Ea(t){this.id=t,this.seq=[],this.map={}}Sa.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),qr(e,t)},Ea.prototype.setValue=function(t,e,i){for(var n=this.seq,r=0,a=n.length;r!==a;++r){var o=n[r];o.setValue(t,e[o.id],i)}};var Ca=/([\w\d_]+)(\])?(\[|\.)?/g;function La(t,e){t.seq.push(e),t.map[e.id]=e}function Aa(t,e,i){var n=t.name,r=n.length;for(Ca.lastIndex=0;;){var a=Ca.exec(n),o=Ca.lastIndex,s=a[1],l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===r){La(i,void 0===c?new Ma(s,t,e):new Sa(s,t,e));break}var h=i.map[s];void 0===h&&La(i,h=new Ea(s)),i=h}}function Pa(t,e){this.seq=[],this.map={};for(var i=t.getProgramParameter(e,35718),n=0;n<i;++n){var r=t.getActiveUniform(e,n);Aa(r,t.getUniformLocation(e,r.name),this)}}function Ra(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}Pa.prototype.setValue=function(t,e,i,n){var r=this.map[e];void 0!==r&&r.setValue(t,i,n)},Pa.prototype.setOptional=function(t,e,i){var n=e[i];void 0!==n&&this.setValue(t,i,n)},Pa.upload=function(t,e,i,n){for(var r=0,a=e.length;r!==a;++r){var o=e[r],s=i[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,n)}},Pa.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!==r;++n){var a=t[n];a.id in e&&i.push(a)}return i};var Oa=0;function Ia(t){switch(t){case oe:return["Linear","( value )"];case i:return["sRGB","( value )"];case se:return["RGBE","( value )"];case ce:return["RGBM","( value, 7.0 )"];case he:return["RGBM","( value, 16.0 )"];case ue:return["RGBD","( value, 256.0 )"];case n:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case le:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function Da(t,e,i){var n=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return n&&""===r?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+i+"\n"+r+function(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")}(t.getShaderSource(e))}function ja(t,e){var i=Ia(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function ka(t){return""!==t}function Na(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Fa(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Ba=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ha(t){return t.replace(Ba,Ua)}function Ua(t,e){var i=gr[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return Ha(i)}var za=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function Va(t){return t.replace(za,Ga)}function Ga(t,e,i,n){for(var r="",a=parseInt(e);a<parseInt(i);a++)r+=n.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function Wa(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Ya(t,e,i,n,r,a){var o,s,l,c,h,u,d,p,f,m,g=t.getContext(),v=n.defines,y=r.vertexShader,_=r.fragmentShader,b=(s="SHADOWMAP_TYPE_BASIC",(o=a).shadowMapType===V?s="SHADOWMAP_TYPE_PCF":o.shadowMapType===G?s="SHADOWMAP_TYPE_PCF_SOFT":o.shadowMapType===W&&(s="SHADOWMAP_TYPE_VSM"),s),x=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case kt:case Nt:e="ENVMAP_TYPE_CUBE";break;case Ut:case zt:e="ENVMAP_TYPE_CUBE_UV";break;case Ft:case Bt:e="ENVMAP_TYPE_EQUIREC";break;case Ht:e="ENVMAP_TYPE_SPHERE"}return e}(a),w=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Nt:case Bt:e="ENVMAP_MODE_REFRACTION"}return e}(a),T=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Y:e="ENVMAP_BLENDING_MULTIPLY";break;case X:e="ENVMAP_BLENDING_MIX";break;case At:e="ENVMAP_BLENDING_ADD"}return e}(a),M=0<t.gammaFactor?t.gammaFactor:1,S=a.isWebGL2?"":(l=n.extensions,c=a,h=e,[(l=l||{}).derivatives||c.envMapCubeUV||c.bumpMap||c.tangentSpaceNormalMap||c.clearcoatNormalMap||c.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(l.fragDepth||c.logarithmicDepthBuffer)&&h.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",l.drawBuffers&&h.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(l.shaderTextureLOD||c.envMap)&&h.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ka).join("\n")),E=function(t){var e=[];for(var i in t){var n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}(v),C=g.createProgram(),L=a.numMultiviewViews;if(n.isRawShaderMaterial?(0<(u=[E].filter(ka).join("\n")).length&&(u+="\n"),0<(d=[S,E].filter(ka).join("\n")).length&&(d+="\n")):(u=[Wa(a),"#define SHADER_NAME "+r.name,E,a.instancing?"#define USE_INSTANCING":"",a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+M,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+w:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+b:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(a.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ka).join("\n"),d=[S,Wa(a),"#define SHADER_NAME "+r.name,E,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+M,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+x:"",a.envMap?"#define "+w:"",a.envMap?"#define "+T:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.sheen?"#define USE_SHEEN":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+b:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(a.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensions&&n.extensions.shaderTextureLOD||a.envMap)&&(a.isWebGL2||e.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",a.toneMapping!==Pt?"#define TONE_MAPPING":"",a.toneMapping!==Pt?gr.tonemapping_pars_fragment:"",a.toneMapping!==Pt?function(t,e){var i;switch(e){case Rt:i="Linear";break;case Ot:i="Reinhard";break;case It:i="Uncharted2";break;case Dt:i="OptimizedCineon";break;case jt:i="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding?gr.encodings_pars_fragment:"",a.mapEncoding?ja("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?ja("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?ja("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?ja("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?(p="linearToOutputTexel",f=a.outputEncoding,m=Ia(f),"vec4 "+p+"( vec4 value ) { return LinearTo"+m[0]+m[1]+"; }"):"",a.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ka).join("\n")),y=Fa(y=Na(y=Ha(y),a),a),_=Fa(_=Na(_=Ha(_),a),a),y=Va(y),_=Va(_),a.isWebGL2&&!n.isRawShaderMaterial){var A=!1,P=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==y.match(P)&&null!==_.match(P)&&(A=!0,y=y.replace(P,""),_=_.replace(P,"")),u=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+u,d=["#version 300 es\n","#define varying in",A?"":"out highp vec4 pc_fragColor;",A?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+d,0<L&&(u=(u=u.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","layout(num_views = "+L+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+L+"];","uniform mat4 projectionMatrices["+L+"];","uniform mat4 viewMatrices["+L+"];","uniform mat3 normalMatrices["+L+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n")),d=(d=d.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+L+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n")))}var R,O,I=d+_,D=Ra(g,35633,u+y),j=Ra(g,35632,I);if(g.attachShader(C,D),g.attachShader(C,j),void 0!==n.index0AttributeName?g.bindAttribLocation(C,0,n.index0AttributeName):!0===a.morphTargets&&g.bindAttribLocation(C,0,"position"),g.linkProgram(C),t.debug.checkShaderErrors){var k=g.getProgramInfoLog(C).trim(),N=g.getShaderInfoLog(D).trim(),F=g.getShaderInfoLog(j).trim(),B=!0,H=!0;if(!1===g.getProgramParameter(C,35714)){B=!1;var U=Da(g,D,"vertex"),z=Da(g,j,"fragment");console.error("THREE.WebGLProgram: shader error: ",g.getError(),"35715",g.getProgramParameter(C,35715),"gl.getProgramInfoLog",k,U,z)}else""!==k?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k):""!==N&&""!==F||(H=!1);H&&(this.diagnostics={runnable:B,material:n,programLog:k,vertexShader:{log:N,prefix:u},fragmentShader:{log:F,prefix:d}})}return g.deleteShader(D),g.deleteShader(j),this.getUniforms=function(){return void 0===R&&(R=new Pa(g,C)),R},this.getAttributes=function(){return void 0===O&&(O=function(t,e){for(var i={},n=t.getProgramParameter(e,35721),r=0;r<n;r++){var a=t.getActiveAttrib(e,r).name;i[a]=t.getAttribLocation(e,a)}return i}(g,C)),O},this.destroy=function(){g.deleteProgram(C),this.program=void 0},this.name=r.name,this.id=Oa++,this.cacheKey=i,this.usedTimes=1,this.program=C,this.vertexShader=D,this.fragmentShader=j,this.numMultiviewViews=L,this}function Xa(u,l,d){var c=[],p=d.isWebGL2,f=d.logarithmicDepthBuffer,m=d.floatVertexTextures,g=d.precision,v=d.maxVertexUniforms,y=d.vertexTextures,_={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},a=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function b(t,e){var i;return t?t.isTexture?i=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=oe,i===oe&&e&&(i=n),i}this.getParameters=function(t,e,i,n,r,a,o){var s=_[t.type],l=o.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(m)return 1024;var i=v,n=Math.floor((i-20)/4),r=Math.min(n,e.length);return r<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+r+"."),0):r}(o):0;null!==t.precision&&(g=d.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",g,"instead.");var c=u.getRenderTarget(),h=c&&c.isWebGLMultiviewRenderTarget?c.numViews:0;return{isWebGL2:p,shaderID:s,precision:g,instancing:!0===o.isInstancedMesh,supportsVertexTextures:y,numMultiviewViews:h,outputEncoding:b(c?c.texture:null,u.gammaOutput),map:!!t.map,mapEncoding:b(t.map,u.gammaInput),matcap:!!t.matcap,matcapEncoding:b(t.matcap,u.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:b(t.envMap,u.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===Ut||t.envMap.mapping===zt),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:b(t.emissiveMap,u.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===me,tangentSpaceNormalMap:t.normalMapType===fe,clearcoatNormalMap:!!t.clearcoatNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,sheen:!!t.sheen,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,vertexUvs:!!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatNormalMap||t.displacementMap),uvsVertexOnly:!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatNormalMap||!t.displacementMap),fog:!!n,useFog:t.fog,fogExp2:n&&n.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:f,skinning:t.skinning&&0<l,maxBones:l,useVertexTexture:m,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:u.maxMorphTargets,maxMorphNormals:u.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numDirLightShadows:e.directionalShadowMap.length,numPointLightShadows:e.pointShadowMap.length,numSpotLightShadows:e.spotShadowMap.length,numClippingPlanes:r,numClipIntersection:a,dithering:t.dithering,shadowMapEnabled:u.shadowMap.enabled&&0<i.length,shadowMapType:u.shadowMap.type,toneMapping:t.toneMapped?u.toneMapping:Pt,physicallyCorrectLights:u.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===Q,flipSided:t.side===xt,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCacheKey=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(var r=0;r<a.length;r++)i.push(e[a[r]]);return i.push(t.onBeforeCompile.toString()),i.push(u.gammaOutput),i.push(u.gammaFactor),i.join()},this.acquireProgram=function(t,e,i,n){for(var r,a=0,o=c.length;a<o;a++){var s=c[a];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new Ya(u,l,n,t,e,i),c.push(r)),r},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=c.indexOf(t);c[e]=c[c.length-1],c.pop(),t.destroy()}},this.programs=c}function qa(){var n=new WeakMap;return{get:function(t){var e=n.get(t);return void 0===e&&(e={},n.set(t,e)),e},remove:function(t){n.delete(t)},update:function(t,e,i){n.get(t)[e]=i},dispose:function(){n=new WeakMap}}}function Ja(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Za(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Qa(){var s=[],l=0,c=[],h=[],u={id:-1};function d(t,e,i,n,r,a){var o=s[l];return void 0===o?(o={id:t.id,object:t,geometry:e,material:i,program:i.program||u,groupOrder:n,renderOrder:t.renderOrder,z:r,group:a},s[l]=o):(o.id=t.id,o.object=t,o.geometry=e,o.material=i,o.program=i.program||u,o.groupOrder=n,o.renderOrder=t.renderOrder,o.z=r,o.group=a),l++,o}return{opaque:c,transparent:h,init:function(){l=0,c.length=0,h.length=0},push:function(t,e,i,n,r,a){var o=d(t,e,i,n,r,a);(!0===i.transparent?h:c).push(o)},unshift:function(t,e,i,n,r,a){var o=d(t,e,i,n,r,a);(!0===i.transparent?h:c).unshift(o)},sort:function(){1<c.length&&c.sort(Ja),1<h.length&&h.sort(Za)}}}function Ka(){var r=new WeakMap;function a(t){var e=t.target;e.removeEventListener("dispose",a),r.delete(e)}return{get:function(t,e){var i,n=r.get(t);return void 0===n?(i=new Qa,r.set(t,new WeakMap),r.get(t).set(e,i),t.addEventListener("dispose",a)):void 0===(i=n.get(e))&&(i=new Qa,n.set(e,i)),i},dispose:function(){r=new WeakMap}}}function $a(){var i={};return{get:function(t){if(void 0!==i[t.id])return i[t.id];var e;switch(t.type){case"DirectionalLight":e={direction:new Le,color:new tn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"SpotLight":e={position:new Le,direction:new Le,color:new tn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"PointLight":e={position:new Le,color:new tn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Me,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":e={direction:new Le,skyColor:new tn,groundColor:new tn};break;case"RectAreaLight":e={color:new tn,position:new Le,halfWidth:new Le,halfHeight:new Le}}return i[t.id]=e}}}var to=0;function eo(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function io(){for(var E=new $a,C={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},t=0;t<9;t++)C.probe.push(new Le);var L=new Le,A=new We,P=new We;return{setup:function(t,e,i){for(var n=0,r=0,a=0,o=0;o<9;o++)C.probe[o].set(0,0,0);var s=0,l=0,c=0,h=0,u=0,d=0,p=0,f=0,m=i.matrixWorldInverse;t.sort(eo),o=0;for(var g=t.length;o<g;o++){var v=t[o],y=v.color,_=v.intensity,b=v.distance,x=v.shadow&&v.shadow.map?v.shadow.map.texture:null;if(v.isAmbientLight)n+=y.r*_,r+=y.g*_,a+=y.b*_;else if(v.isLightProbe)for(var w=0;w<9;w++)C.probe[w].addScaledVector(v.sh.coefficients[w],_);else if(v.isDirectionalLight){if((M=E.get(v)).color.copy(v.color).multiplyScalar(v.intensity),M.direction.setFromMatrixPosition(v.matrixWorld),L.setFromMatrixPosition(v.target.matrixWorld),M.direction.sub(L),M.direction.transformDirection(m),M.shadow=v.castShadow,v.castShadow){var T=v.shadow;M.shadowBias=T.bias,M.shadowRadius=T.radius,M.shadowMapSize=T.mapSize,C.directionalShadowMap[s]=x,C.directionalShadowMatrix[s]=v.shadow.matrix,d++}C.directional[s]=M,s++}else if(v.isSpotLight)(M=E.get(v)).position.setFromMatrixPosition(v.matrixWorld),M.position.applyMatrix4(m),M.color.copy(y).multiplyScalar(_),M.distance=b,M.direction.setFromMatrixPosition(v.matrixWorld),L.setFromMatrixPosition(v.target.matrixWorld),M.direction.sub(L),M.direction.transformDirection(m),M.coneCos=Math.cos(v.angle),M.penumbraCos=Math.cos(v.angle*(1-v.penumbra)),M.decay=v.decay,M.shadow=v.castShadow,v.castShadow&&(T=v.shadow,M.shadowBias=T.bias,M.shadowRadius=T.radius,M.shadowMapSize=T.mapSize,C.spotShadowMap[c]=x,C.spotShadowMatrix[c]=v.shadow.matrix,f++),C.spot[c]=M,c++;else if(v.isRectAreaLight)(M=E.get(v)).color.copy(y).multiplyScalar(_),M.position.setFromMatrixPosition(v.matrixWorld),M.position.applyMatrix4(m),P.identity(),A.copy(v.matrixWorld),A.premultiply(m),P.extractRotation(A),M.halfWidth.set(.5*v.width,0,0),M.halfHeight.set(0,.5*v.height,0),M.halfWidth.applyMatrix4(P),M.halfHeight.applyMatrix4(P),C.rectArea[h]=M,h++;else if(v.isPointLight)(M=E.get(v)).position.setFromMatrixPosition(v.matrixWorld),M.position.applyMatrix4(m),M.color.copy(v.color).multiplyScalar(v.intensity),M.distance=v.distance,M.decay=v.decay,M.shadow=v.castShadow,v.castShadow&&(T=v.shadow,M.shadowBias=T.bias,M.shadowRadius=T.radius,M.shadowMapSize=T.mapSize,M.shadowCameraNear=T.camera.near,M.shadowCameraFar=T.camera.far,C.pointShadowMap[l]=x,C.pointShadowMatrix[l]=v.shadow.matrix,p++),C.point[l]=M,l++;else if(v.isHemisphereLight){var M;(M=E.get(v)).direction.setFromMatrixPosition(v.matrixWorld),M.direction.transformDirection(m),M.direction.normalize(),M.skyColor.copy(v.color).multiplyScalar(_),M.groundColor.copy(v.groundColor).multiplyScalar(_),C.hemi[u]=M,u++}}C.ambient[0]=n,C.ambient[1]=r,C.ambient[2]=a;var S=C.hash;S.directionalLength===s&&S.pointLength===l&&S.spotLength===c&&S.rectAreaLength===h&&S.hemiLength===u&&S.numDirectionalShadows===d&&S.numPointShadows===p&&S.numSpotShadows===f||(C.directional.length=s,C.spot.length=c,C.rectArea.length=h,C.point.length=l,C.hemi.length=u,C.directionalShadowMap.length=d,C.pointShadowMap.length=p,C.spotShadowMap.length=f,C.directionalShadowMatrix.length=d,C.pointShadowMatrix.length=p,C.spotShadowMatrix.length=f,S.directionalLength=s,S.pointLength=l,S.spotLength=c,S.rectAreaLength=h,S.hemiLength=u,S.numDirectionalShadows=d,S.numPointShadows=p,S.numSpotShadows=f,C.version=to++)},state:C}}function no(){var e=new io,i=[],n=[];return{init:function(){i.length=0,n.length=0},state:{lightsArray:i,shadowsArray:n,lights:e},setupLights:function(t){e.setup(i,n,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){n.push(t)}}}function ro(){var n=new WeakMap;function r(t){var e=t.target;e.removeEventListener("dispose",r),n.delete(e)}return{get:function(t,e){var i;return!1===n.has(t)?(i=new no,n.set(t,new WeakMap),n.get(t).set(e,i),t.addEventListener("dispose",r)):!1===n.get(t).has(e)?(i=new no,n.get(t).set(e,i)):i=n.get(t).get(e),i},dispose:function(){n=new WeakMap}}}function ao(t){sn.call(this),this.type="MeshDepthMaterial",this.depthPacking=de,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function oo(t){sn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Le,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}((ao.prototype=Object.create(sn.prototype)).constructor=ao).prototype.isMeshDepthMaterial=!0,ao.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((oo.prototype=Object.create(sn.prototype)).constructor=oo).prototype.isMeshDistanceMaterial=!0,oo.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};var so="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpack2HalfToRGBA ( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",lo="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function co(g,v,y){var _=new mr,b=new Me,x=new Me,w=new je,a=[],o=[],T={},M={0:xt,1:R,2:Q},n=new sr({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Me},radius:{value:4}},vertexShader:lo,fragmentShader:so}),r=n.clone();r.defines.HORIZONAL_PASS=1;var t=new Ln;t.setAttribute("position",new cn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var s=new Yn(t,n),S=this;function E(t,e){var i=v.update(s);n.uniforms.shadow_pass.value=t.map.texture,n.uniforms.resolution.value=t.mapSize,n.uniforms.radius.value=t.radius,g.setRenderTarget(t.mapPass),g.clear(),g.renderBufferDirect(e,null,i,n,s,null),r.uniforms.shadow_pass.value=t.mapPass.texture,r.uniforms.resolution.value=t.mapSize,r.uniforms.radius.value=t.radius,g.setRenderTarget(t.map),g.clear(),g.renderBufferDirect(e,null,i,r,s,null)}function C(t,e,i){var n=t<<0|e<<1|i<<2,r=a[n];return void 0===r&&(r=new ao({depthPacking:pe,morphTargets:t,skinning:e}),a[n]=r),r}function L(t,e,i){var n=t<<0|e<<1|i<<2,r=o[n];return void 0===r&&(r=new oo({morphTargets:t,skinning:e}),o[n]=r),r}function A(t,e,i,n,r,a){var o=t.geometry,s=null,l=C,c=t.customDepthMaterial;if(!0===i.isPointLight&&(l=L,c=t.customDistanceMaterial),void 0===c){var h=!1;!0===e.morphTargets&&(!0===o.isBufferGeometry?h=o.morphAttributes&&o.morphAttributes.position&&0<o.morphAttributes.position.length:!0===o.isGeometry&&(h=o.morphTargets&&0<o.morphTargets.length));var u=!1;!0===t.isSkinnedMesh&&(!0===e.skinning?u=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),s=l(h,u,!0===t.isInstancedMesh)}else s=c;if(g.localClippingEnabled&&!0===e.clipShadows&&0!==e.clippingPlanes.length){var d=s.uuid,p=e.uuid,f=T[d];void 0===f&&(f={},T[d]=f);var m=f[p];void 0===m&&(m=s.clone(),f[p]=m),s=m}return s.visible=e.visible,s.wireframe=e.wireframe,s.side=a===W?null!==e.shadowSide?e.shadowSide:e.side:null!==e.shadowSide?e.shadowSide:M[e.side],s.clipShadows=e.clipShadows,s.clippingPlanes=e.clippingPlanes,s.clipIntersection=e.clipIntersection,s.wireframeLinewidth=e.wireframeLinewidth,s.linewidth=e.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial&&(s.referencePosition.setFromMatrixPosition(i.matrixWorld),s.nearDistance=n,s.farDistance=r),s}function P(t,e,i,n,r){if(!1!==t.visible){if(t.layers.test(e.layers)&&(t.isMesh||t.isLine||t.isPoints)&&(t.castShadow||t.receiveShadow&&r===W)&&(!t.frustumCulled||_.intersectsObject(t))){t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld);var a=v.update(t),o=t.material;if(Array.isArray(o))for(var s=a.groups,l=0,c=s.length;l<c;l++){var h=s[l],u=o[h.materialIndex];if(u&&u.visible){var d=A(t,u,n,i.near,i.far,r);g.renderBufferDirect(i,null,a,d,t,h)}}else if(o.visible){d=A(t,o,n,i.near,i.far,r);g.renderBufferDirect(i,null,a,d,t,null)}}for(var p=t.children,f=0,m=p.length;f<m;f++)P(p[f],e,i,n,r)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=V,this.render=function(t,e,i){if(!1!==S.enabled&&(!1!==S.autoUpdate||!1!==S.needsUpdate)&&0!==t.length){var n=g.getRenderTarget(),r=g.getActiveCubeFace(),a=g.getActiveMipmapLevel(),o=g.state;o.setBlending(K),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var s=0,l=t.length;s<l;s++){var c=t[s],h=c.shadow;if(void 0!==h){b.copy(h.mapSize);var u=h.getFrameExtents();if(b.multiply(u),x.copy(h.mapSize),(b.x>y||b.y>y)&&(console.warn("THREE.WebGLShadowMap:",c,"has shadow exceeding max texture size, reducing"),b.x>y&&(x.x=Math.floor(y/u.x),b.x=x.x*u.x,h.mapSize.x=x.x),b.y>y&&(x.y=Math.floor(y/u.y),b.y=x.y*u.y,h.mapSize.y=x.y)),null===h.map&&!h.isPointLightShadow&&this.type===W){var d={minFilter:Yt,magFilter:Yt,format:ie};h.map=new ke(b.x,b.y,d),h.map.texture.name=c.name+".shadowMap",h.mapPass=new ke(b.x,b.y,d),h.camera.updateProjectionMatrix()}if(null===h.map){d={minFilter:Vt,magFilter:Vt,format:ie};h.map=new ke(b.x,b.y,d),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}g.setRenderTarget(h.map),g.clear();for(var p=h.getViewportCount(),f=0;f<p;f++){var m=h.getViewport(f);w.set(x.x*m.x,x.y*m.y,x.x*m.z,x.y*m.w),o.viewport(w),h.updateMatrices(c,f),_=h.getFrustum(),P(e,i,h.camera,c,this.type)}h.isPointLightShadow||this.type!==W||E(h,i)}else console.warn("THREE.WebGLShadowMap:",c,"has no shadow.")}S.needsUpdate=!1,g.setRenderTarget(n,r,a)}}}function ho(h,i,t){var n=t.isWebGL2;var r=new function(){var e=!1,a=new je,i=null,o=new je(0,0,0,0);return{setMask:function(t){i===t||e||(h.colorMask(t,t,t,t),i=t)},setLocked:function(t){e=t},setClear:function(t,e,i,n,r){!0===r&&(t*=n,e*=n,i*=n),a.set(t,e,i,n),!1===o.equals(a)&&(h.clearColor(t,e,i,n),o.copy(a))},reset:function(){e=!1,i=null,o.set(-1,0,0,0)}}},a=new function(){var e=!1,i=null,n=null,r=null;return{setTest:function(t){t?F(2929):B(2929)},setMask:function(t){i===t||e||(h.depthMask(t),i=t)},setFunc:function(t){if(n!==t){if(t)switch(t){case bt:h.depthFunc(512);break;case wt:h.depthFunc(519);break;case Tt:h.depthFunc(513);break;case Mt:h.depthFunc(515);break;case St:h.depthFunc(514);break;case Et:h.depthFunc(518);break;case Ct:h.depthFunc(516);break;case Lt:h.depthFunc(517);break;default:h.depthFunc(515)}else h.depthFunc(515);n=t}},setLocked:function(t){e=t},setClear:function(t){r!==t&&(h.clearDepth(t),r=t)},reset:function(){e=!1,r=n=i=null}}},o=new function(){var e=!1,i=null,n=null,r=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(t){e||(t?F(2960):B(2960))},setMask:function(t){i===t||e||(h.stencilMask(t),i=t)},setFunc:function(t,e,i){n===t&&r===e&&a===i||(h.stencilFunc(t,e,i),n=t,r=e,a=i)},setOp:function(t,e,i){o===t&&s===e&&l===i||(h.stencilOp(t,e,i),o=t,s=e,l=i)},setLocked:function(t){e=t},setClear:function(t){c!==t&&(h.clearStencil(t),c=t)},reset:function(){e=!1,c=l=s=o=a=r=n=i=null}}},e=h.getParameter(34921),s=new Uint8Array(e),l=new Uint8Array(e),c=new Uint8Array(e),u={},d=null,p=null,f=null,m=null,g=null,v=null,y=null,_=null,b=null,x=!1,w=null,T=null,M=null,S=null,E=null,C=h.getParameter(35661),L=!1,A=0,P=h.getParameter(7938);-1!==P.indexOf("WebGL")?(A=parseFloat(/^WebGL\ ([0-9])/.exec(P)[1]),L=1<=A):-1!==P.indexOf("OpenGL ES")&&(A=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(P)[1]),L=2<=A);var R=null,O={},I=new je,D=new je;function j(t,e,i){var n=new Uint8Array(4),r=h.createTexture();h.bindTexture(t,r),h.texParameteri(t,10241,9728),h.texParameteri(t,10240,9728);for(var a=0;a<i;a++)h.texImage2D(e+a,0,6408,1,1,0,6408,5121,n);return r}var k={};function N(t,e){(s[t]=1,0===l[t]&&(h.enableVertexAttribArray(t),l[t]=1),c[t]!==e)&&((n?h:i.get("ANGLE_instanced_arrays"))[n?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](t,e),c[t]=e)}function F(t){!0!==u[t]&&(h.enable(t),u[t]=!0)}function B(t){!1!==u[t]&&(h.disable(t),u[t]=!1)}k[3553]=j(3553,3553,1),k[34067]=j(34067,34069,6),r.setClear(0,0,0,1),a.setClear(1),o.setClear(0),F(2929),a.setFunc(Mt),G(!1),W(J),F(2884),V(K);var H={};if(H[rt]=32774,H[at]=32778,H[ot]=32779,n)H[st]=32775,H[lt]=32776;else{var U=i.get("EXT_blend_minmax");null!==U&&(H[st]=U.MIN_EXT,H[lt]=U.MAX_EXT)}var z={};function V(t,e,i,n,r,a,o,s){if(t!==K){if(p||(F(3042),p=!0),t===nt)r=r||e,a=a||i,o=o||n,e===m&&r===y||(h.blendEquationSeparate(H[e],H[r]),m=e,y=r),i===g&&n===v&&a===_&&o===b||(h.blendFuncSeparate(z[i],z[n],z[a],z[o]),g=i,v=n,_=a,b=o),f=t,x=null;else if(t!==f||s!==x){if(m===rt&&y===rt||(h.blendEquation(32774),y=m=rt),s)switch(t){case $:h.blendFuncSeparate(1,771,1,771);break;case tt:h.blendFunc(1,1);break;case et:h.blendFuncSeparate(0,0,769,771);break;case it:h.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case $:h.blendFuncSeparate(770,771,1,771);break;case tt:h.blendFunc(770,1);break;case et:h.blendFunc(0,769);break;case it:h.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}b=_=v=g=null,f=t,x=s}}else p&&(B(3042),p=!1)}function G(t){w!==t&&(t?h.frontFace(2304):h.frontFace(2305),w=t)}function W(t){t!==q?(F(2884),t!==T&&(t===J?h.cullFace(1029):t===Z?h.cullFace(1028):h.cullFace(1032))):B(2884),T=t}function Y(t,e,i){t?(F(32823),S===e&&E===i||(h.polygonOffset(e,i),S=e,E=i)):B(32823)}function X(t){void 0===t&&(t=33984+C-1),R!==t&&(h.activeTexture(t),R=t)}return z[ct]=0,z[ht]=1,z[ut]=768,z[pt]=770,z[_t]=776,z[vt]=774,z[mt]=772,z[dt]=769,z[ft]=771,z[yt]=775,z[gt]=773,{buffers:{color:r,depth:a,stencil:o},initAttributes:function(){for(var t=0,e=s.length;t<e;t++)s[t]=0},enableAttribute:function(t){N(t,0)},enableAttributeAndDivisor:N,disableUnusedAttributes:function(){for(var t=0,e=l.length;t!==e;++t)l[t]!==s[t]&&(h.disableVertexAttribArray(t),l[t]=0)},enable:F,disable:B,useProgram:function(t){return d!==t&&(h.useProgram(t),d=t,!0)},setBlending:V,setMaterial:function(t,e){t.side===Q?B(2884):F(2884);var i=t.side===xt;e&&(i=!i),G(i),t.blending===$&&!1===t.transparent?V(K):V(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),r.setMask(t.colorWrite);var n=t.stencilWrite;o.setTest(n),n&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Y(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:G,setCullFace:W,setLineWidth:function(t){t!==M&&(L&&h.lineWidth(t),M=t)},setPolygonOffset:Y,setScissorTest:function(t){t?F(3089):B(3089)},activeTexture:X,bindTexture:function(t,e){null===R&&X();var i=O[R];void 0===i&&(i={type:void 0,texture:void 0},O[R]=i),i.type===t&&i.texture===e||(h.bindTexture(t,e||k[t]),i.type=t,i.texture=e)},unbindTexture:function(){var t=O[R];void 0!==t&&void 0!==t.type&&(h.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{h.compressedTexImage2D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{h.texImage2D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{h.texImage3D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===I.equals(t)&&(h.scissor(t.x,t.y,t.z,t.w),I.copy(t))},viewport:function(t){!1===D.equals(t)&&(h.viewport(t.x,t.y,t.z,t.w),D.copy(t))},reset:function(){for(var t=0;t<l.length;t++)1===l[t]&&(h.disableVertexAttribArray(t),l[t]=0);u={},O={},T=w=f=d=R=null,r.reset(),a.reset(),o.reset()}}}function uo(v,y,_,b,r,x,w){var c,T=r.isWebGL2,e=r.maxTextures,g=r.maxCubemapSize,m=r.maxTextureSize,i=r.maxSamples,o=new WeakMap,n="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d");function h(t,e){return n?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function M(t,e,i,n){var r=1;if((t.width>n||t.height>n)&&(r=n/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var a=e?Te.floorPowerOfTwo:Math.floor,o=a(r*t.width),s=a(r*t.height);void 0===c&&(c=h(o,s));var l=i?h(o,s):c;return l.width=o,l.height=s,l.getContext("2d").drawImage(t,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+s+")."),l}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function S(t){return Te.isPowerOfTwo(t.width)&&Te.isPowerOfTwo(t.height)}function E(t,e){return t.generateMipmaps&&e&&t.minFilter!==Vt&&t.minFilter!==Yt}function C(t,e,i,n){v.generateMipmap(t),b.get(e).__maxMipLevel=Math.log(Math.max(i,n))*Math.LOG2E}function L(t,e){if(!1===T)return t;var i=t;return 6403===t&&(5126===e&&(i=33326),5131===e&&(i=33325),5121===e&&(i=33321)),6407===t&&(5126===e&&(i=34837),5131===e&&(i=34843),5121===e&&(i=32849)),6408===t&&(5126===e&&(i=34836),5131===e&&(i=34842),5121===e&&(i=32856)),33325===i||33326===i||34842===i||34836===i?y.get("EXT_color_buffer_float"):34843!==i&&34837!==i||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),i}function a(t){return t===Vt||t===Gt||t===Wt?9728:9729}function s(t){var e=t.target;e.removeEventListener("dispose",s),function(t){var e=b.get(t);if(void 0===e.__webglInit)return;v.deleteTexture(e.__webglTexture),b.remove(t)}(e),e.isVideoTexture&&o.delete(e),w.memory.textures--}function A(t){var e=t.target;e.removeEventListener("dispose",A),function(t){var e=b.get(t),i=b.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&v.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var n=0;n<6;n++)v.deleteFramebuffer(e.__webglFramebuffer[n]),e.__webglDepthbuffer&&v.deleteRenderbuffer(e.__webglDepthbuffer[n]);else v.deleteFramebuffer(e.__webglFramebuffer),e.__webglDepthbuffer&&v.deleteRenderbuffer(e.__webglDepthbuffer);if(t.isWebGLMultiviewRenderTarget){v.deleteTexture(e.__webglColorTexture),v.deleteTexture(e.__webglDepthStencilTexture),w.memory.textures-=2;for(var n=0,r=e.__webglViewFramebuffers.length;n<r;n++)v.deleteFramebuffer(e.__webglViewFramebuffers[n])}b.remove(t.texture),b.remove(t)}(e),w.memory.textures--}var l=0;function u(t,e){var i,n,r=b.get(t);if(t.isVideoTexture&&(i=t,n=w.render.frame,o.get(i)!==n&&(o.set(i,n),i.update())),0<t.version&&r.__version!==t.version){var a=t.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void I(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}_.activeTexture(33984+e),_.bindTexture(3553,r.__webglTexture)}function d(t,e){if(6===t.image.length){var i=b.get(t);if(0<t.version&&i.__version!==t.version){O(i,t),_.activeTexture(33984+e),_.bindTexture(34067,i.__webglTexture),v.pixelStorei(37440,t.flipY);for(var n=t&&t.isCompressedTexture,r=t.image[0]&&t.image[0].isDataTexture,a=[],o=0;o<6;o++)a[o]=n||r?r?t.image[o].image:t.image[o]:M(t.image[o],!1,!0,g);var s,l=a[0],c=S(l)||T,h=x.convert(t.format),u=x.convert(t.type),d=L(h,u);if(R(34067,t,c),n){for(o=0;o<6;o++){s=a[o].mipmaps;for(var p=0;p<s.length;p++){var f=s[p];t.format!==ie&&t.format!==ee?null!==h?_.compressedTexImage2D(34069+o,p,d,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_.texImage2D(34069+o,p,d,f.width,f.height,0,h,u,f.data)}}i.__maxMipLevel=s.length-1}else{s=t.mipmaps;for(o=0;o<6;o++)if(r){_.texImage2D(34069+o,0,d,a[o].width,a[o].height,0,h,u,a[o].data);for(p=0;p<s.length;p++){var m=(f=s[p]).image[o].image;_.texImage2D(34069+o,p+1,d,m.width,m.height,0,h,u,m.data)}}else{_.texImage2D(34069+o,0,d,h,u,a[o]);for(p=0;p<s.length;p++){f=s[p];_.texImage2D(34069+o,p+1,d,h,u,f.image[o])}}i.__maxMipLevel=s.length}E(t,c)&&C(34067,t,l.width,l.height),i.__version=t.version,t.onUpdate&&t.onUpdate(t)}else _.activeTexture(33984+e),_.bindTexture(34067,i.__webglTexture)}}function p(t,e){_.activeTexture(33984+e),_.bindTexture(34067,b.get(t).__webglTexture)}var f={};f[H]=10497,f[U]=33071,f[z]=33648;var P={};function R(t,e,i){i?(v.texParameteri(t,10242,f[e.wrapS]),v.texParameteri(t,10243,f[e.wrapT]),32879!==t&&35866!==t||v.texParameteri(t,32882,f[e.wrapR]),v.texParameteri(t,10240,P[e.magFilter]),v.texParameteri(t,10241,P[e.minFilter])):(v.texParameteri(t,10242,33071),v.texParameteri(t,10243,33071),32879!==t&&35866!==t||v.texParameteri(t,32882,33071),e.wrapS===U&&e.wrapT===U||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),v.texParameteri(t,10240,a(e.magFilter)),v.texParameteri(t,10241,a(e.minFilter)),e.minFilter!==Vt&&e.minFilter!==Yt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var n=y.get("EXT_texture_filter_anisotropic");if(n){if(e.type===Kt&&null===y.get("OES_texture_float_linear"))return;if(e.type===$t&&null===(T||y.get("OES_texture_half_float_linear")))return;(1<e.anisotropy||b.get(e).__currentAnisotropy)&&(v.texParameterf(t,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,r.getMaxAnisotropy())),b.get(e).__currentAnisotropy=e.anisotropy)}}function O(t,e){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",s),t.__webglTexture=v.createTexture(),w.memory.textures++)}function I(t,e,i){var n=3553;e.isDataTexture2DArray&&(n=35866),e.isDataTexture3D&&(n=32879),O(t,e),_.activeTexture(33984+i),_.bindTexture(n,t.__webglTexture),v.pixelStorei(37440,e.flipY),v.pixelStorei(37441,e.premultiplyAlpha),v.pixelStorei(3317,e.unpackAlignment);var r,a=(r=e,!T&&(r.wrapS!==U||r.wrapT!==U||r.minFilter!==Vt&&r.minFilter!==Yt)&&!1===S(e.image)),o=M(e.image,a,!1,m),s=S(o)||T,l=x.convert(e.format),c=x.convert(e.type),h=L(l,c);R(n,e,s);var u,d=e.mipmaps;if(e.isDepthTexture){if(h=6402,e.type===Kt){if(!1===T)throw new Error("Float Depth Texture only supported in WebGL2.0");h=36012}else T&&(h=33189);e.format===ne&&6402===h&&e.type!==Zt&&e.type!==Qt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=Zt,c=x.convert(e.type)),e.format===re&&(h=34041,e.type!==te&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=te,c=x.convert(e.type))),_.texImage2D(3553,0,h,o.width,o.height,0,l,c,null)}else if(e.isDataTexture)if(0<d.length&&s){for(var p=0,f=d.length;p<f;p++)u=d[p],_.texImage2D(3553,p,h,u.width,u.height,0,l,c,u.data);e.generateMipmaps=!1,t.__maxMipLevel=d.length-1}else _.texImage2D(3553,0,h,o.width,o.height,0,l,c,o.data),t.__maxMipLevel=0;else if(e.isCompressedTexture){for(p=0,f=d.length;p<f;p++)u=d[p],e.format!==ie&&e.format!==ee?null!==l?_.compressedTexImage2D(3553,p,h,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_.texImage2D(3553,p,h,u.width,u.height,0,l,c,u.data);t.__maxMipLevel=d.length-1}else if(e.isDataTexture2DArray)_.texImage3D(35866,0,h,o.width,o.height,o.depth,0,l,c,o.data),t.__maxMipLevel=0;else if(e.isDataTexture3D)_.texImage3D(32879,0,h,o.width,o.height,o.depth,0,l,c,o.data),t.__maxMipLevel=0;else if(0<d.length&&s){for(p=0,f=d.length;p<f;p++)u=d[p],_.texImage2D(3553,p,h,l,c,u);e.generateMipmaps=!1,t.__maxMipLevel=d.length-1}else _.texImage2D(3553,0,h,l,c,o),t.__maxMipLevel=0;E(e,s)&&C(3553,e,o.width,o.height),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}function D(t,e,i,n){var r=x.convert(e.texture.format),a=x.convert(e.texture.type),o=L(r,a);_.texImage2D(n,0,o,e.width,e.height,0,r,a,null),v.bindFramebuffer(36160,t),v.framebufferTexture2D(36160,i,n,b.get(e.texture).__webglTexture,0),v.bindFramebuffer(36160,null)}function j(t,e,i){if(v.bindRenderbuffer(36161,t),e.depthBuffer&&!e.stencilBuffer){if(i){var n=N(e);v.renderbufferStorageMultisample(36161,n,33189,e.width,e.height)}else v.renderbufferStorage(36161,33189,e.width,e.height);v.framebufferRenderbuffer(36160,36096,36161,t)}else if(e.depthBuffer&&e.stencilBuffer){if(i){n=N(e);v.renderbufferStorageMultisample(36161,n,35056,e.width,e.height)}else v.renderbufferStorage(36161,34041,e.width,e.height);v.framebufferRenderbuffer(36160,33306,36161,t)}else{var r=L(x.convert(e.texture.format),x.convert(e.texture.type));if(i){n=N(e);v.renderbufferStorageMultisample(36161,n,r,e.width,e.height)}else v.renderbufferStorage(36161,r,e.width,e.height)}v.bindRenderbuffer(36161,null)}function k(t){var e=b.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,e){if(e&&e.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(v.bindFramebuffer(36160,t),!e.depthTexture||!e.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");b.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),u(e.depthTexture,0);var i=b.get(e.depthTexture).__webglTexture;if(e.depthTexture.format===ne)v.framebufferTexture2D(36160,36096,3553,i,0);else{if(e.depthTexture.format!==re)throw new Error("Unknown depthTexture format");v.framebufferTexture2D(36160,33306,3553,i,0)}}(e.__webglFramebuffer,t)}else if(i){e.__webglDepthbuffer=[];for(var n=0;n<6;n++)v.bindFramebuffer(36160,e.__webglFramebuffer[n]),e.__webglDepthbuffer[n]=v.createRenderbuffer(),j(e.__webglDepthbuffer[n],t)}else v.bindFramebuffer(36160,e.__webglFramebuffer),e.__webglDepthbuffer=v.createRenderbuffer(),j(e.__webglDepthbuffer,t);v.bindFramebuffer(36160,null)}function N(t){return T&&t.isWebGLMultisampleRenderTarget?Math.min(i,t.samples):0}P[Vt]=9728,P[Gt]=9984,P[Wt]=9986,P[Yt]=9729,P[Xt]=9985;var F=!(P[qt]=9987),B=!1;this.allocateTextureUnit=function(){var t=l;return e<=t&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+e),l+=1,t},this.resetTextureUnits=function(){l=0},this.setTexture2D=u,this.setTexture2DArray=function(t,e){var i=b.get(t);0<t.version&&i.__version!==t.version?I(i,t,e):(_.activeTexture(33984+e),_.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=b.get(t);0<t.version&&i.__version!==t.version?I(i,t,e):(_.activeTexture(33984+e),_.bindTexture(32879,i.__webglTexture))},this.setTextureCube=d,this.setTextureCubeDynamic=p,this.setupRenderTarget=function(t){var e=b.get(t),i=b.get(t.texture);t.addEventListener("dispose",A),i.__webglTexture=v.createTexture(),w.memory.textures++;var n=!0===t.isWebGLRenderTargetCube,r=!0===t.isWebGLMultisampleRenderTarget,a=!0===t.isWebGLMultiviewRenderTarget,o=S(t)||T;if(n){e.__webglFramebuffer=[];for(var s=0;s<6;s++)e.__webglFramebuffer[s]=v.createFramebuffer()}else if(e.__webglFramebuffer=v.createFramebuffer(),r)if(T){e.__webglMultisampledFramebuffer=v.createFramebuffer(),e.__webglColorRenderbuffer=v.createRenderbuffer(),v.bindRenderbuffer(36161,e.__webglColorRenderbuffer);var l=L(x.convert(t.texture.format),x.convert(t.texture.type)),c=N(t);v.renderbufferStorageMultisample(36161,c,l,t.width,t.height),v.bindFramebuffer(36160,e.__webglMultisampledFramebuffer),v.framebufferRenderbuffer(36160,36064,36161,e.__webglColorRenderbuffer),v.bindRenderbuffer(36161,null),t.depthBuffer&&(e.__webglDepthRenderbuffer=v.createRenderbuffer(),j(e.__webglDepthRenderbuffer,t,!0)),v.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(a){var h=t.width,u=t.height,d=t.numViews;v.bindFramebuffer(36160,e.__webglFramebuffer);var p=y.get("OVR_multiview2");w.memory.textures+=2;var f=v.createTexture();v.bindTexture(35866,f),v.texParameteri(35866,10240,9728),v.texParameteri(35866,10241,9728),v.texImage3D(35866,0,32856,h,u,d,0,6408,5121,null),p.framebufferTextureMultiviewOVR(36160,36064,f,0,0,d);var m=v.createTexture();v.bindTexture(35866,m),v.texParameteri(35866,10240,9728),v.texParameteri(35866,10241,9728),v.texImage3D(35866,0,35056,h,u,d,0,34041,34042,null),p.framebufferTextureMultiviewOVR(36160,33306,m,0,0,d);var g=new Array(d);for(s=0;s<d;++s)g[s]=v.createFramebuffer(),v.bindFramebuffer(36160,g[s]),v.framebufferTextureLayer(36160,36064,f,0,s);e.__webglColorTexture=f,e.__webglDepthStencilTexture=m,e.__webglViewFramebuffers=g,v.bindFramebuffer(36160,null),v.bindTexture(35866,null)}if(n){for(_.bindTexture(34067,i.__webglTexture),R(34067,t.texture,o),s=0;s<6;s++)D(e.__webglFramebuffer[s],t,36064,34069+s);E(t.texture,o)&&C(34067,t.texture,t.width,t.height),_.bindTexture(34067,null)}else a||(_.bindTexture(3553,i.__webglTexture),R(3553,t.texture,o),D(e.__webglFramebuffer,t,36064,3553),E(t.texture,o)&&C(3553,t.texture,t.width,t.height),_.bindTexture(3553,null));t.depthBuffer&&k(t)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(E(e,S(t)||T)){var i=t.isWebGLRenderTargetCube?34067:3553,n=b.get(e).__webglTexture;_.bindTexture(i,n),C(i,e,t.width,t.height),_.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(T){var e=b.get(t);v.bindFramebuffer(36008,e.__webglMultisampledFramebuffer),v.bindFramebuffer(36009,e.__webglFramebuffer);var i=t.width,n=t.height,r=16384;t.depthBuffer&&(r|=256),t.stencilBuffer&&(r|=1024),v.blitFramebuffer(0,0,i,n,0,0,i,n,r,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),t=t.texture),u(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLRenderTargetCube&&(!1===B&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),B=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?d(t,e):p(t,e)}}function po(t,i,e){var n=e.isWebGL2;return{convert:function(t){var e;if(t===Jt)return 5121;if(t===l)return 32819;if(t===c)return 32820;if(t===h)return 33635;if(t===r)return 5120;if(t===a)return 5122;if(t===Zt)return 5123;if(t===s)return 5124;if(t===Qt)return 5125;if(t===Kt)return 5126;if(t===$t)return n?5131:null!==(e=i.get("OES_texture_half_float"))?e.HALF_FLOAT_OES:null;if(t===u)return 6406;if(t===ee)return 6407;if(t===ie)return 6408;if(t===d)return 6409;if(t===p)return 6410;if(t===ne)return 6402;if(t===re)return 34041;if(t===f)return 6403;if(t===m||t===g||t===y||t===_){if(null===(e=i.get("WEBGL_compressed_texture_s3tc")))return null;if(t===m)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===g)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===y)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===_)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===b||t===x||t===w||t===T){if(null===(e=i.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===b)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===x)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===w)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===T)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}return t===M?null!==(e=i.get("WEBGL_compressed_texture_etc1"))?e.COMPRESSED_RGB_ETC1_WEBGL:null:t===S||t===E||t===C||t===L||t===A||t===P||t===O||t===I||t===D||t===j||t===k||t===N||t===F||t===B?null!==(e=i.get("WEBGL_compressed_texture_astc"))?t:null:t===te?n?34042:null!==(e=i.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function fo(t,e,i,n){ke.call(this,t,e,n),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=i}function mo(i,d){var p,n,a,o,r,f,s,l=2,c=i.extensions,m=i.properties,h=0;function u(t){return t.isArrayCamera?t.cameras:(r[0]=t,r)}this.isAvailable=function(){if(void 0===s){var t=c.get("OVR_multiview2");if(s=null!==t&&!1===d.getContextAttributes().antialias){h=d.getParameter(t.MAX_VIEWS_OVR),p=new fo(0,0,l),f=new Me,o=[],a=[],r=[];for(var e=0;e<h;e++)o[e]=new We,a[e]=new Re}}return s},this.attachCamera=function(t){!1!==function(t){if(void 0===t.isArrayCamera)return!0;var e=t.cameras;if(e.length>h)return!1;for(var i=1,n=e.length;i<n;i++)if(e[0].viewport.z!==e[i].viewport.z||e[0].viewport.w!==e[i].viewport.w)return!1;return!0}(t)&&(n=i.getRenderTarget(),function(t){if(n?f.set(n.width,n.height):i.getDrawingBufferSize(f),t.isArrayCamera){var e=t.cameras[0].viewport;p.setSize(e.z,e.w),p.setNumViews(t.cameras.length)}else p.setSize(f.x,f.y),p.setNumViews(l)}(t),i.setRenderTarget(p))},this.detachCamera=function(t){p===i.getRenderTarget()&&(i.setRenderTarget(n),function(t){var e=p,i=e.numViews,n=m.get(e).__webglViewFramebuffers,r=e.width,a=e.height;if(t.isArrayCamera)for(var o=0;o<i;o++){var s=t.cameras[o].viewport,l=s.x,c=s.y,h=l+s.z,u=c+s.w;d.bindFramebuffer(36008,n[o]),d.blitFramebuffer(0,0,r,a,l,c,h,u,16384,9728)}else d.bindFramebuffer(36008,n[0]),d.blitFramebuffer(0,0,r,a,0,0,f.x,f.y,16384,9728)}(t))},this.updateCameraProjectionMatricesUniform=function(t,e){for(var i=u(t),n=0;n<i.length;n++)o[n].copy(i[n].projectionMatrix);e.setValue(d,"projectionMatrices",o)},this.updateCameraViewMatricesUniform=function(t,e){for(var i=u(t),n=0;n<i.length;n++)o[n].copy(i[n].matrixWorldInverse);e.setValue(d,"viewMatrices",o)},this.updateObjectMatricesUniforms=function(t,e,i){for(var n=u(e),r=0;r<n.length;r++)o[r].multiplyMatrices(n[r].matrixWorldInverse,t.matrixWorld),a[r].getNormalMatrix(o[r]);i.setValue(d,"modelViewMatrices",o),i.setValue(d,"normalMatrices",a)}}function go(){ci.call(this),this.type="Group"}function vo(t){cr.call(this),this.cameras=t||[]}fo.prototype=Object.assign(Object.create(ke.prototype),{constructor:fo,isWebGLMultiviewRenderTarget:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.numViews=t.numViews,this},setNumViews:function(t){return this.numViews!==t&&(this.numViews=t,this.dispose()),this}}),go.prototype=Object.assign(Object.create(ci.prototype),{constructor:go,isGroup:!0}),vo.prototype=Object.assign(Object.create(cr.prototype),{constructor:vo,isArrayCamera:!0});var yo,_o=new Le,bo=new Le;function xo(t,e,i){_o.setFromMatrixPosition(e.matrixWorld),bo.setFromMatrixPosition(i.matrixWorld);var n=_o.distanceTo(bo),r=e.projectionMatrix.elements,a=i.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],h=(r[8]-1)/r[0],u=(a[8]+1)/a[0],d=o*h,p=o*u,f=n/(-h+u),m=f*-h;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var g=o+f,v=s+f,y=d-m,_=p+(n-m),b=l*s/v*g,x=c*s/v*g;t.projectionMatrix.makePerspective(y,_,b,x,g,v)}function wo(e){var i,n,r=this,h=null,u=null,d=[],p=new We,f=new We,a=1,m="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(u=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",t,!1));var g=new We,v=new Se,y=new Le,_=new cr,b=new cr;b.viewport=new je,b.layers.enable(1);var x=new cr;x.viewport=new je,x.layers.enable(2);var w=new vo([b,x]);function o(){return null!==h&&!0===h.isPresenting}w.layers.enable(1),w.layers.enable(2);var s,l=new Me;function t(){if(o()){var t=h.getEyeParameters("left");i=2*t.renderWidth*a,n=t.renderHeight*a,s=e.getPixelRatio(),e.getSize(l),e.setDrawingBufferSize(i,n,1),b.viewport.set(0,0,i/2,n),x.viewport.set(i/2,0,i/2,n),c.start(),r.dispatchEvent({type:"sessionstart"})}else r.enabled&&e.setDrawingBufferSize(l.width,l.height,s),c.stop(),r.dispatchEvent({type:"sessionend"})}var T=[],M=[];function S(t){for(var e=navigator.getGamepads&&navigator.getGamepads(),i=0,n=e.length;i<n;i++){var r=e[i];if(r&&("Daydream Controller"===r.id||"Gear VR Controller"===r.id||"Oculus Go Controller"===r.id||"OpenVR Gamepad"===r.id||r.id.startsWith("Oculus Touch")||r.id.startsWith("HTC Vive Focus")||r.id.startsWith("Spatial Controller"))){var a=r.hand;if(0===t&&(""===a||"right"===a))return r;if(1===t&&"left"===a)return r}}}function E(t,e){null!==e&&4===e.length&&t.set(e[0]*i,e[1]*n,e[2]*i,e[3]*n)}this.enabled=!1,this.getController=function(t){var e=d[t];return void 0===e&&((e=new go).matrixAutoUpdate=!1,e.visible=!1,d[t]=e),e},this.getDevice=function(){return h},this.setDevice=function(t){void 0!==t&&(h=t),c.setContext(t)},this.setFramebufferScaleFactor=function(t){a=t},this.setReferenceSpaceType=function(t){m=t},this.getCamera=function(t){var e="local-floor"===m?1.6:0;if(h.depthNear=t.near,h.depthFar=t.far,h.getFrameData(u),"local-floor"===m){var i=h.stageParameters;i?p.fromArray(i.sittingToStandingTransform):p.makeTranslation(0,e,0)}var n=u.pose;_.matrix.copy(p),_.matrix.decompose(_.position,_.quaternion,_.scale),null!==n.orientation&&(v.fromArray(n.orientation),_.quaternion.multiply(v)),null!==n.position&&(v.setFromRotationMatrix(p),y.fromArray(n.position),y.applyQuaternion(v),_.position.add(y)),_.updateMatrixWorld(),t.matrixWorld.copy(_.matrixWorld);for(var r=t.children,a=0,o=r.length;a<o;a++)r[a].updateMatrixWorld(!0);b.near=t.near,x.near=t.near,b.far=t.far,x.far=t.far,b.matrixWorldInverse.fromArray(u.leftViewMatrix),x.matrixWorldInverse.fromArray(u.rightViewMatrix),f.getInverse(p),"local-floor"===m&&(b.matrixWorldInverse.multiply(f),x.matrixWorldInverse.multiply(f));var s=t.parent;null!==s&&(g.getInverse(s.matrixWorld),b.matrixWorldInverse.multiply(g),x.matrixWorldInverse.multiply(g)),b.matrixWorld.getInverse(b.matrixWorldInverse),x.matrixWorld.getInverse(x.matrixWorldInverse),b.projectionMatrix.fromArray(u.leftProjectionMatrix),x.projectionMatrix.fromArray(u.rightProjectionMatrix),xo(w,b,x);var l=h.getLayers();if(l.length){var c=l[0];E(b.viewport,c.leftBounds),E(x.viewport,c.rightBounds)}return function(){for(var t=0;t<d.length;t++){var e=d[t],i=S(t);if(void 0!==i&&void 0!==i.pose){if(null===i.pose)return;var n=i.pose;!1===n.hasPosition&&e.position.set(.2,-.6,-.05),null!==n.position&&e.position.fromArray(n.position),null!==n.orientation&&e.quaternion.fromArray(n.orientation),e.matrix.compose(e.position,e.quaternion,e.scale),e.matrix.premultiply(p),e.matrix.decompose(e.position,e.quaternion,e.scale),e.matrixWorldNeedsUpdate=!0,e.visible=!0;var r="Daydream Controller"===i.id?0:1;void 0===T[t]&&(T[t]=!1),T[t]!==i.buttons[r].pressed&&(T[t]=i.buttons[r].pressed,!0===T[t]?e.dispatchEvent({type:"selectstart"}):(e.dispatchEvent({type:"selectend"}),e.dispatchEvent({type:"select"}))),r=2,void 0===M[t]&&(M[t]=!1),void 0!==i.buttons[r]&&M[t]!==i.buttons[r].pressed&&(M[t]=i.buttons[r].pressed,!0===M[t]?e.dispatchEvent({type:"squeezestart"}):(e.dispatchEvent({type:"squeezeend"}),e.dispatchEvent({type:"squeeze"})))}else e.visible=!1}}(),w},this.getStandingMatrix=function(){return p},this.isPresenting=o;var c=new _r;this.setAnimationLoop=function(t){c.setAnimationLoop(t),o()&&c.start()},this.submitFrame=function(){o()&&h.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",t)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function To(d,e){var i=this,p=null,f=null,n="local-floor",m=null,g=[],v=[];var o=new cr;o.layers.enable(1),o.viewport=new je;var s=new cr;s.layers.enable(2),s.viewport=new je;var y=new vo([o,s]);function r(t){for(var e=0;e<g.length;e++)v[e]===t.inputSource&&g[e].dispatchEvent({type:t.type})}function a(){d.setFramebuffer(null),d.setRenderTarget(d.getRenderTarget()),b.stop(),i.dispatchEvent({type:"sessionend"})}function l(t){f=t,b.setContext(p),b.start(),i.dispatchEvent({type:"sessionstart"})}function c(){for(var t=0;t<g.length;t++)v[t]=h(t)}function h(t){for(var e=p.inputSources,i=0;i<e.length;i++){var n=e[i],r=n.handedness;if(0===t&&("none"===r||"right"===r))return n;if(1===t&&"left"===r)return n}}function u(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}y.layers.enable(1),y.layers.enable(2),this.enabled=!1,this.getController=function(t){var e=g[t];return void 0===e&&((e=new go).matrixAutoUpdate=!1,e.visible=!1,g[t]=e),e},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(t){n=t},this.getSession=function(){return p},this.setSession=function(t){null!==(p=t)&&(p.addEventListener("select",r),p.addEventListener("selectstart",r),p.addEventListener("selectend",r),p.addEventListener("squeeze",r),p.addEventListener("squeezestart",r),p.addEventListener("squeezeend",r),p.addEventListener("end",a),p.updateRenderState({baseLayer:new XRWebGLLayer(p,e)}),p.requestReferenceSpace(n).then(l),p.addEventListener("inputsourceschange",c),c())},this.getCamera=function(t){var e=t.parent,i=y.cameras;u(y,e);for(var n=0;n<i.length;n++)u(i[n],e);t.matrixWorld.copy(y.matrixWorld);for(var r=t.children,a=(n=0,r.length);n<a;n++)r[n].updateMatrixWorld(!0);return xo(y,o,s),y},this.isPresenting=function(){return null!==p&&null!==f};var _=null;var b=new _r;b.setAnimationLoop(function(t,e){if(null!==(m=e.getViewerPose(f))){var i=m.views,n=p.renderState.baseLayer;d.setFramebuffer(n.framebuffer);for(var r=0;r<i.length;r++){var a=i[r],o=n.getViewport(a),s=a.transform.inverse.matrix,l=y.cameras[r];l.matrix.fromArray(s).getInverse(l.matrix),l.projectionMatrix.fromArray(a.projectionMatrix),l.viewport.set(o.x,o.y,o.width,o.height),0===r&&y.matrix.copy(l.matrix)}}for(r=0;r<g.length;r++){var c=g[r],h=v[r];if(h){var u=e.getPose(h.targetRaySpace,f);if(null!==u){c.matrix.fromArray(u.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.visible=!0;continue}}c.visible=!1}_&&_(t)}),this.setAnimationLoop=function(t){_=t},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new We},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function Mo(t){var n=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",h=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,f=null,R=null;this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Rt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var O,T,I,D,m,j,k,M,S,g,y,u,d,p,E,C,L,v,N=this,_=!1,b=null,x=0,w=0,A=null,P=null,F=-1,B={geometry:null,program:null,wireframe:!1},H=null,U=null,z=new je,V=new je,G=null,W=n.width,Y=n.height,X=1,q=new je(0,0,W,Y),J=new je(0,0,W,Y),Z=!1,Q=new mr,K=new Er,$=!1,tt=!1,et=new We,it=new Le;function nt(){return null===A?X:1}try{var rt={alpha:i,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:h,xrCompatible:!0};if(n.addEventListener("webglcontextlost",ct,!1),n.addEventListener("webglcontextrestored",ht,!1),null===(O=e||n.getContext("webgl",rt)||n.getContext("experimental-webgl",rt)))throw null!==n.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===O.getShaderPrecisionFormat&&(O.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function at(){T=new Cr(O),!1===(I=new Sr(O,T,t)).isWebGL2&&(T.get("WEBGL_depth_texture"),T.get("OES_texture_float"),T.get("OES_texture_half_float"),T.get("OES_texture_half_float_linear"),T.get("OES_standard_derivatives"),T.get("OES_element_index_uint"),T.get("ANGLE_instanced_arrays")),T.get("OES_texture_float_linear"),v=new po(O,T,I),(D=new ho(O,T,I)).scissor(V.copy(J).multiplyScalar(X).floor()),D.viewport(z.copy(q).multiplyScalar(X).floor()),m=new Pr(O),j=new qa,k=new uo(O,T,D,j,I,v,m),M=new br(O),S=new Lr(O,M,m),g=new Ir(O,S,M,m),E=new Or(O),y=new Xa(N,T,I),u=new Ka,d=new ro,p=new Tr(N,D,g,s),C=new Mr(O,T,m,I),L=new Ar(O,T,m,I),m.programs=y.programs,N.capabilities=I,N.extensions=T,N.properties=j,N.renderLists=u,N.state=D,N.info=m}at();var ot="undefined"!=typeof navigator&&"xr"in navigator?new To(N,O):new wo(N);this.vr=ot;var st=new mo(N,O),lt=new co(N,g,I.maxTextureSize);function ct(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function ht(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1,at()}function ut(t){var e,i=t.target;i.removeEventListener("dispose",ut),dt(e=i),j.remove(e)}function dt(t){var e=j.get(t).program;(t.program=void 0)!==e&&y.releaseProgram(e)}this.shadowMap=lt,this.getContext=function(){return O},this.getContextAttributes=function(){return O.getContextAttributes()},this.forceContextLoss=function(){var t=T.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=T.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(t){void 0!==t&&(X=t,this.setSize(W,Y,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new Me),t.set(W,Y)},this.setSize=function(t,e,i){ot.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=t,Y=e,n.width=Math.floor(t*X),n.height=Math.floor(e*X),!1!==i&&(n.style.width=t+"px",n.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new Me),t.set(W*X,Y*X).floor()},this.setDrawingBufferSize=function(t,e,i){W=t,Y=e,X=i,n.width=Math.floor(t*i),n.height=Math.floor(e*i),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new je),t.copy(z)},this.getViewport=function(t){return t.copy(q)},this.setViewport=function(t,e,i,n){t.isVector4?q.set(t.x,t.y,t.z,t.w):q.set(t,e,i,n),D.viewport(z.copy(q).multiplyScalar(X).floor())},this.getScissor=function(t){return t.copy(J)},this.setScissor=function(t,e,i,n){t.isVector4?J.set(t.x,t.y,t.z,t.w):J.set(t,e,i,n),D.scissor(V.copy(J).multiplyScalar(X).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(t){D.setScissorTest(Z=t)},this.getClearColor=function(){return p.getClearColor()},this.setClearColor=function(){p.setClearColor.apply(p,arguments)},this.getClearAlpha=function(){return p.getClearAlpha()},this.setClearAlpha=function(){p.setClearAlpha.apply(p,arguments)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=16384),(void 0===e||e)&&(n|=256),(void 0===i||i)&&(n|=1024),O.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",ct,!1),n.removeEventListener("webglcontextrestored",ht,!1),u.dispose(),d.dispose(),j.dispose(),g.dispose(),ot.dispose(),ft.stop()},this.renderBufferImmediate=function(t,e){D.initAttributes();var i=j.get(t);t.hasPositions&&!i.position&&(i.position=O.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=O.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=O.createBuffer()),t.hasColors&&!i.color&&(i.color=O.createBuffer());var n=e.getAttributes();t.hasPositions&&(O.bindBuffer(34962,i.position),O.bufferData(34962,t.positionArray,35048),D.enableAttribute(n.position),O.vertexAttribPointer(n.position,3,5126,!1,0,0)),t.hasNormals&&(O.bindBuffer(34962,i.normal),O.bufferData(34962,t.normalArray,35048),D.enableAttribute(n.normal),O.vertexAttribPointer(n.normal,3,5126,!1,0,0)),t.hasUvs&&(O.bindBuffer(34962,i.uv),O.bufferData(34962,t.uvArray,35048),D.enableAttribute(n.uv),O.vertexAttribPointer(n.uv,2,5126,!1,0,0)),t.hasColors&&(O.bindBuffer(34962,i.color),O.bufferData(34962,t.colorArray,35048),D.enableAttribute(n.color),O.vertexAttribPointer(n.color,3,5126,!1,0,0)),D.disableUnusedAttributes(),O.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,a){var o=r.isMesh&&r.matrixWorld.determinant()<0;D.setMaterial(n,o);var s=yt(t,e,n,r),l=!1;B.geometry===i.id&&B.program===s.id&&B.wireframe===(!0===n.wireframe)||(B.geometry=i.id,B.program=s.id,B.wireframe=!0===n.wireframe,l=!0),r.morphTargetInfluences&&(E.update(r,i,n,s),l=!0);var c=i.index,h=i.attributes.position;if((null===c||0!==c.count)&&void 0!==h&&0!==h.count){var u,d=1;!0===n.wireframe&&(c=S.getWireframeAttribute(i),d=2);var p=C;null!==c&&(u=M.get(c),(p=L).setIndex(u)),l&&(!function(t,e,i,n){if(!1===I.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===T.get("ANGLE_instanced_arrays"))return;D.initAttributes();var r=e.attributes,a=n.getAttributes(),o=i.defaultAttributeValues;for(var s in a){var l=a[s];if(0<=l){var c=r[s];if(void 0!==c){var h=c.normalized,u=c.itemSize,d=M.get(c);if(void 0===d)continue;var p=d.buffer,f=d.type,m=d.bytesPerElement;if(c.isInterleavedBufferAttribute){var g=c.data,v=g.stride,y=c.offset;g&&g.isInstancedInterleavedBuffer?(D.enableAttributeAndDivisor(l,g.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=g.meshPerAttribute*g.count)):D.enableAttribute(l),O.bindBuffer(34962,p),O.vertexAttribPointer(l,u,f,h,v*m,y*m)}else c.isInstancedBufferAttribute?(D.enableAttributeAndDivisor(l,c.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=c.meshPerAttribute*c.count)):D.enableAttribute(l),O.bindBuffer(34962,p),O.vertexAttribPointer(l,u,f,h,0,0)}else if("instanceMatrix"===s){var d=M.get(t.instanceMatrix);if(void 0===d)continue;var p=d.buffer,f=d.type;D.enableAttributeAndDivisor(l+0,1),D.enableAttributeAndDivisor(l+1,1),D.enableAttributeAndDivisor(l+2,1),D.enableAttributeAndDivisor(l+3,1),O.bindBuffer(34962,p),O.vertexAttribPointer(l+0,4,f,!1,64,0),O.vertexAttribPointer(l+1,4,f,!1,64,16),O.vertexAttribPointer(l+2,4,f,!1,64,32),O.vertexAttribPointer(l+3,4,f,!1,64,48)}else if(void 0!==o){var _=o[s];if(void 0!==_)switch(_.length){case 2:O.vertexAttrib2fv(l,_);break;case 3:O.vertexAttrib3fv(l,_);break;case 4:O.vertexAttrib4fv(l,_);break;default:O.vertexAttrib1fv(l,_)}}}}D.disableUnusedAttributes()}(r,i,n,s),null!==c&&O.bindBuffer(34963,u.buffer));var f=1/0;null!==c?f=c.count:void 0!==h&&(f=h.count);var m=i.drawRange.start*d,g=i.drawRange.count*d,v=null!==a?a.start*d:0,y=null!==a?a.count*d:1/0,_=Math.max(m,v),b=Math.min(f,m+g,v+y)-1,x=Math.max(0,b-_+1);if(0!==x){if(r.isMesh)if(!0===n.wireframe)D.setLineWidth(n.wireframeLinewidth*nt()),p.setMode(1);else switch(r.drawMode){case ae:p.setMode(4);break;case 1:p.setMode(5);break;case 2:p.setMode(6)}else if(r.isLine){var w=n.linewidth;void 0===w&&(w=1),D.setLineWidth(w*nt()),r.isLineSegments?p.setMode(1):r.isLineLoop?p.setMode(2):p.setMode(3)}else r.isPoints?p.setMode(0):r.isSprite&&p.setMode(4);r.isInstancedMesh?p.renderInstances(i,_,x,r.count):i.isInstancedBufferGeometry?p.renderInstances(i,_,x,i.maxInstancedCount):p.render(_,x)}}},this.compile=function(i,t){(R=d.get(i,t)).init(),i.traverse(function(t){t.isLight&&(R.pushLight(t),t.castShadow&&R.pushShadow(t))}),R.setupLights(t),i.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var e=0;e<t.material.length;e++)vt(t.material[e],i.fog,t);else vt(t.material,i.fog,t)})};var pt=null;var ft=new _r;function mt(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,l=o.geometry,c=void 0===n?o.material:n,h=o.group;if(i.isArrayCamera)if(U=i,ot.enabled&&st.isAvailable())gt(s,e,i,l,c,h);else for(var u=i.cameras,d=0,p=u.length;d<p;d++){var f=u[d];s.layers.test(f.layers)&&(D.viewport(z.copy(f.viewport)),R.setupLights(f),gt(s,e,f,l,c,h))}else U=null,gt(s,e,i,l,c,h)}}function gt(t,e,i,n,r,a){if(t.onBeforeRender(N,e,i,n,r,a),R=d.get(e,U||i),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){D.setMaterial(r);var o=yt(i,e.fog,r,t);B.geometry=null,B.program=null,B.wireframe=!1,s=o,t.render(function(t){N.renderBufferImmediate(t,s)})}else N.renderBufferDirect(i,e.fog,n,r,t,a);var s;t.onAfterRender(N,e,i,n,r,a),R=d.get(e,U||i)}function vt(t,e,i){var n=j.get(t),r=R.state.lights,a=R.state.shadowsArray,o=r.state.version,s=y.getParameters(t,r.state,a,e,K.numPlanes,K.numIntersection,i),l=y.getProgramCacheKey(t,s),c=n.program,h=!0;if(void 0===c)t.addEventListener("dispose",ut);else if(c.cacheKey!==l)dt(t);else if(n.lightsStateVersion!==o)n.lightsStateVersion=o,h=!1;else{if(void 0!==s.shaderID)return;h=!1}if(h){if(s.shaderID){var u=yr[s.shaderID];n.shader={name:t.type,uniforms:ir(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(n.shader,N),l=y.getProgramCacheKey(t,s),c=y.acquireProgram(t,n.shader,s,l),n.program=c,t.program=c}var d=c.getAttributes();if(t.morphTargets)for(var p=t.numSupportedMorphTargets=0;p<N.maxMorphTargets;p++)0<=d["morphTarget"+p]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(p=t.numSupportedMorphNormals=0;p<N.maxMorphNormals;p++)0<=d["morphNormal"+p]&&t.numSupportedMorphNormals++;var f,m=n.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=K.numPlanes,n.numIntersection=K.numIntersection,m.clippingPlanes=K.uniform),n.fog=e,n.needsLights=(f=t).isMeshLambertMaterial||f.isMeshToonMaterial||f.isMeshPhongMaterial||f.isMeshStandardMaterial||f.isShadowMaterial||f.isShaderMaterial&&!0===f.lights,n.lightsStateVersion=o,n.needsLights&&(m.ambientLightColor.value=r.state.ambient,m.lightProbe.value=r.state.probe,m.directionalLights.value=r.state.directional,m.spotLights.value=r.state.spot,m.rectAreaLights.value=r.state.rectArea,m.pointLights.value=r.state.point,m.hemisphereLights.value=r.state.hemi,m.directionalShadowMap.value=r.state.directionalShadowMap,m.directionalShadowMatrix.value=r.state.directionalShadowMatrix,m.spotShadowMap.value=r.state.spotShadowMap,m.spotShadowMatrix.value=r.state.spotShadowMatrix,m.pointShadowMap.value=r.state.pointShadowMap,m.pointShadowMatrix.value=r.state.pointShadowMatrix);var g=n.program.getUniforms(),v=Pa.seqWithValue(g.seq,m);n.uniformsList=v}function yt(t,e,i,n){k.resetTextureUnits();var r=j.get(i),a=R.state.lights;if($&&(tt||t!==H)){var o=t===H&&i.id===F;K.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,o)}i.version===r.__version&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==e?i.needsUpdate=!0:r.needsLights&&r.lightsStateVersion!==a.state.version?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===K.numPlanes&&r.numIntersection===K.numIntersection||(i.needsUpdate=!0)),i.version!==r.__version&&(vt(i,e,n),r.__version=i.version);var s,l,c,h,u,d,p,f,m,g,v,y,_=!1,b=!1,x=!1,w=r.program,T=w.getUniforms(),M=r.shader.uniforms;if(D.useProgram(w.program)&&(x=b=_=!0),i.id!==F&&(F=i.id,b=!0),_||H!==t){if(0<w.numMultiviewViews?st.updateCameraProjectionMatricesUniform(t,T):T.setValue(O,"projectionMatrix",t.projectionMatrix),I.logarithmicDepthBuffer&&T.setValue(O,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),H!==t&&(H=t,x=b=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){var S=T.map.cameraPosition;void 0!==S&&S.setValue(O,it.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&T.setValue(O,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&(0<w.numMultiviewViews?st.updateCameraViewMatricesUniform(t,T):T.setValue(O,"viewMatrix",t.matrixWorldInverse))}if(i.skinning){T.setOptional(O,n,"bindMatrix"),T.setOptional(O,n,"bindMatrixInverse");var E=n.skeleton;if(E){var C=E.bones;if(I.floatVertexTextures){if(void 0===E.boneTexture){var L=Math.sqrt(4*C.length);L=Te.ceilPowerOfTwo(L),L=Math.max(L,4);var A=new Float32Array(L*L*4);A.set(E.boneMatrices);var P=new dr(A,L,L,ie,Kt);E.boneMatrices=A,E.boneTexture=P,E.boneTextureSize=L}T.setValue(O,"boneTexture",E.boneTexture,k),T.setValue(O,"boneTextureSize",E.boneTextureSize)}else T.setOptional(O,E,"boneMatrices")}}return(b||r.receiveShadow!==n.receiveShadow)&&(r.receiveShadow=n.receiveShadow,T.setValue(O,"receiveShadow",n.receiveShadow)),b&&(T.setValue(O,"toneMappingExposure",N.toneMappingExposure),T.setValue(O,"toneMappingWhitePoint",N.toneMappingWhitePoint),r.needsLights&&(y=x,(v=M).ambientLightColor.needsUpdate=y,v.lightProbe.needsUpdate=y,v.directionalLights.needsUpdate=y,v.pointLights.needsUpdate=y,v.spotLights.needsUpdate=y,v.rectAreaLights.needsUpdate=y,v.hemisphereLights.needsUpdate=y),e&&i.fog&&(g=e,(m=M).fogColor.value.copy(g.color),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)),i.isMeshBasicMaterial?_t(M,i):i.isMeshLambertMaterial?(_t(M,i),p=M,(f=i).emissiveMap&&(p.emissiveMap.value=f.emissiveMap)):i.isMeshToonMaterial?(_t(M,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===xt&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===xt&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(M,i)):i.isMeshPhongMaterial?(_t(M,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===xt&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===xt&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(M,i)):i.isMeshStandardMaterial?(_t(M,i),i.isMeshPhysicalMaterial?function(t,e){bt(t,e),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===xt&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(M,i):bt(M,i)):i.isMeshMatcapMaterial?(_t(M,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===xt&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===xt&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(M,i)):i.isMeshDepthMaterial?(_t(M,i),u=M,(d=i).displacementMap&&(u.displacementMap.value=d.displacementMap,u.displacementScale.value=d.displacementScale,u.displacementBias.value=d.displacementBias)):i.isMeshDistanceMaterial?(_t(M,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(M,i)):i.isMeshNormalMaterial?(_t(M,i),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===xt&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===xt&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(M,i)):i.isLineBasicMaterial?(h=i,(c=M).diffuse.value.copy(h.color),c.opacity.value=h.opacity,i.isLineDashedMaterial&&(l=i,(s=M).dashSize.value=l.dashSize,s.totalSize.value=l.dashSize+l.gapSize,s.scale.value=l.scale)):i.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*X,t.scale.value=.5*Y,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var i;e.map?i=e.map:e.alphaMap&&(i=e.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(M,i):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var i;e.map?i=e.map:e.alphaMap&&(i=e.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(M,i):i.isShadowMaterial?(M.color.value.copy(i.color),M.opacity.value=i.opacity):i.envMap&&_t(M,i),void 0!==M.ltc_1&&(M.ltc_1.value=vr.LTC_1),void 0!==M.ltc_2&&(M.ltc_2.value=vr.LTC_2),Pa.upload(O,r.uniformsList,M,k),i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Pa.upload(O,r.uniformsList,M,k),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&T.setValue(O,"center",n.center),0<w.numMultiviewViews?st.updateObjectMatricesUniforms(n,t,T):(T.setValue(O,"modelViewMatrix",n.modelViewMatrix),T.setValue(O,"normalMatrix",n.normalMatrix)),T.setValue(O,"modelMatrix",n.matrixWorld),w}function _t(t,e){var i;t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=j.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}function bt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===xt&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===xt&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}ft.setAnimationLoop(function(t){ot.isPresenting()||pt&&pt(t)}),"undefined"!=typeof window&&ft.setContext(window),this.setAnimationLoop=function(t){pt=t,ot.setAnimationLoop(t),ft.start()},this.render=function(t,e){var i,n;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),e&&e.isCamera){if(!_){B.geometry=null,B.program=null,B.wireframe=!1,F=-1,!(H=null)===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ot.enabled&&ot.isPresenting()&&(e=ot.getCamera(e)),(R=d.get(t,e)).init(),t.onBeforeRender(N,t,e,i||A),et.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Q.setFromMatrix(et),tt=this.localClippingEnabled,$=K.init(this.clippingPlanes,tt,e),(f=u.get(t,e)).init(),function t(e,i,n,r){if(!1===e.visible)return;var a=e.layers.test(i.layers);if(a)if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(i);else if(e.isLight)R.pushLight(e),e.castShadow&&R.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||Q.intersectsSprite(e)){r&&it.setFromMatrixPosition(e.matrixWorld).applyMatrix4(et);var o=g.update(e),s=e.material;s.visible&&f.push(e,o,s,n,it.z,null)}}else if(e.isImmediateRenderObject)r&&it.setFromMatrixPosition(e.matrixWorld).applyMatrix4(et),f.push(e,null,e.material,n,it.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==m.render.frame&&(e.skeleton.update(),e.skeleton.frame=m.render.frame),!e.frustumCulled||Q.intersectsObject(e))){r&&it.setFromMatrixPosition(e.matrixWorld).applyMatrix4(et);var o=g.update(e),s=e.material;if(Array.isArray(s))for(var l=o.groups,c=0,h=l.length;c<h;c++){var u=l[c],d=s[u.materialIndex];d&&d.visible&&f.push(e,o,d,n,it.z,u)}else s.visible&&f.push(e,o,s,n,it.z,null)}var p=e.children;for(var c=0,h=p.length;c<h;c++)t(p[c],i,n,r)}(t,e,0,N.sortObjects),!0===N.sortObjects&&f.sort(),$&&K.beginShadows();var r=R.state.shadowsArray;lt.render(r,t,e),R.setupLights(e),$&&K.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),ot.enabled&&st.isAvailable()&&st.attachCamera(e),p.render(f,t,e,n);var a=f.opaque,o=f.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&mt(a,t,e,s),o.length&&mt(o,t,e,s)}else a.length&&mt(a,t,e),o.length&&mt(o,t,e);t.onAfterRender(N,t,e),null!==A&&(k.updateRenderTargetMipmap(A),k.updateMultisampleRenderTarget(A)),D.buffers.depth.setTest(!0),D.buffers.depth.setMask(!0),D.buffers.color.setMask(!0),D.setPolygonOffset(!1),ot.enabled&&(st.isAvailable()&&st.detachCamera(e),ot.submitFrame()),R=f=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){b!==t&&null===A&&O.bindFramebuffer(36160,t),b=t},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return A},this.setRenderTarget=function(t,e,i){x=e,w=i,(A=t)&&void 0===j.get(t).__webglFramebuffer&&k.setupRenderTarget(t);var n=b,r=!1;if(t){var a=j.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(n=a[e||0],r=!0):n=t.isWebGLMultisampleRenderTarget?j.get(t).__webglMultisampledFramebuffer:a,z.copy(t.viewport),V.copy(t.scissor),G=t.scissorTest}else z.copy(q).multiplyScalar(X).floor(),V.copy(J).multiplyScalar(X).floor(),G=Z;if(P!==n&&(O.bindFramebuffer(36160,n),P=n),D.viewport(z),D.scissor(V),D.setScissorTest(G),r){var o=j.get(t.texture);O.framebufferTexture2D(36160,36064,34069+(e||0),o.__webglTexture,i||0)}},this.readRenderTargetPixels=function(t,e,i,n,r,a,o){if(t&&t.isWebGLRenderTarget){var s=j.get(t).__webglFramebuffer;if(t.isWebGLRenderTargetCube&&void 0!==o&&(s=s[o]),s){var l=!1;s!==P&&(O.bindFramebuffer(36160,s),l=!0);try{var c=t.texture,h=c.format,u=c.type;if(h!==ie&&v.convert(h)!==O.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===Jt||v.convert(u)===O.getParameter(35738)||u===Kt&&(I.isWebGL2||T.get("OES_texture_float")||T.get("WEBGL_color_buffer_float"))||u===$t&&(I.isWebGL2?T.get("EXT_color_buffer_float"):T.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===O.checkFramebufferStatus(36160)?0<=e&&e<=t.width-n&&0<=i&&i<=t.height-r&&O.readPixels(e,i,n,r,v.convert(h),v.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&O.bindFramebuffer(36160,P)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,i){void 0===i&&(i=0);var n=Math.pow(2,-i),r=Math.floor(e.image.width*n),a=Math.floor(e.image.height*n),o=v.convert(e.format);k.setTexture2D(e,0),O.copyTexImage2D(3553,i,o,t.x,t.y,r,a,0),D.unbindTexture()},this.copyTextureToTexture=function(t,e,i,n){var r=e.image.width,a=e.image.height,o=v.convert(i.format),s=v.convert(i.type);k.setTexture2D(i,0),e.isDataTexture?O.texSubImage2D(3553,n||0,t.x,t.y,r,a,o,s,e.image.data):O.texSubImage2D(3553,n||0,t.x,t.y,o,s,e.image),D.unbindTexture()},this.initTexture=function(t){k.setTexture2D(t,0),D.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function So(t,e){this.name="",this.color=new tn(t),this.density=void 0!==e?e:25e-5}function Eo(t,e,i){this.name="",this.color=new tn(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function Co(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=ye,this.updateRange={offset:0,count:-1},this.version=0}function Lo(t,e,i,n){this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===n}function Ao(t){sn.call(this),this.type="SpriteMaterial",this.color=new tn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.assign(wo.prototype,be.prototype),Object.assign(To.prototype,be.prototype),Object.assign(So.prototype,{isFogExp2:!0,clone:function(){return new So(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Eo.prototype,{isFog:!0,clone:function(){return new Eo(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Co.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Co.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),Object.defineProperties(Lo.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Lo.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}}),((Ao.prototype=Object.create(sn.prototype)).constructor=Ao).prototype.isSpriteMaterial=!0,Ao.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Po=new Le,Ro=new Le,Oo=new Le,Io=new Me,Do=new Me,jo=new We,ko=new Le,No=new Le,Fo=new Le,Bo=new Me,Ho=new Me,Uo=new Me;function zo(t){if(ci.call(this),this.type="Sprite",void 0===yo){yo=new Ln;var e=new Co(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);yo.setIndex([0,1,2,0,2,3]),yo.setAttribute("position",new Lo(e,3,0,!1)),yo.setAttribute("uv",new Lo(e,2,3,!1))}this.geometry=yo,this.material=void 0!==t?t:new Ao,this.center=new Me(.5,.5)}function Vo(t,e,i,n,r,a){Io.subVectors(t,i).addScalar(.5).multiply(n),void 0!==r?(Do.x=a*Io.x-r*Io.y,Do.y=r*Io.x+a*Io.y):Do.copy(Io),t.copy(e),t.x+=Do.x,t.y+=Do.y,t.applyMatrix4(jo)}zo.prototype=Object.assign(Object.create(ci.prototype),{constructor:zo,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ro.setFromMatrixScale(this.matrixWorld),jo.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Oo.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ro.multiplyScalar(-Oo.z);var i,n,r=this.material.rotation;0!==r&&(n=Math.cos(r),i=Math.sin(r));var a=this.center;Vo(ko.set(-.5,-.5,0),Oo,a,Ro,i,n),Vo(No.set(.5,-.5,0),Oo,a,Ro,i,n),Vo(Fo.set(.5,.5,0),Oo,a,Ro,i,n),Bo.set(0,0),Ho.set(1,0),Uo.set(1,1);var o=t.ray.intersectTriangle(ko,No,Fo,!1,Po);if(null!==o||(Vo(No.set(-.5,.5,0),Oo,a,Ro,i,n),Ho.set(0,1),null!==(o=t.ray.intersectTriangle(ko,Fo,No,!1,Po)))){var s=t.ray.origin.distanceTo(Po);s<t.near||s>t.far||e.push({distance:s,point:Po.clone(),uv:Zi.getUV(Po,ko,No,Fo,Bo,Ho,Uo,new Me),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return ci.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var Go=new Le,Wo=new Le;function Yo(){ci.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Xo(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Yn.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new We,this.bindMatrixInverse=new We}Yo.prototype=Object.assign(Object.create(ci.prototype),{constructor:Yo,isLOD:!0,copy:function(t){ci.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,n=e.length;i<n;i++){var r=e[i];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);return i.splice(n,0,{distance:e,object:t}),this.add(t),this},getObjectForDistance:function(t){var e=this.levels;if(0<e.length){for(var i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object}return null},raycast:function(t,e){if(0<this.levels.length){Go.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(Go);this.getObjectForDistance(i).raycast(t,e)}},update:function(t){var e=this.levels;if(1<e.length){Go.setFromMatrixPosition(t.matrixWorld),Wo.setFromMatrixPosition(this.matrixWorld);var i=Go.distanceTo(Wo);e[0].object.visible=!0;for(var n=1,r=e.length;n<r&&i>=e[n].distance;n++)e[n-1].object.visible=!1,e[n].object.visible=!0;for(;n<r;n++)e[n].object.visible=!1}},toJSON:function(t){var e=ci.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var a=i[n];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),Xo.prototype=Object.assign(Object.create(Yn.prototype),{constructor:Xo,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new je,e=this.geometry.attributes.skinWeight,i=0,n=e.count;i<n;i++){t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.w=e.getW(i);var r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(i,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Yn.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var qo=new We,Jo=new We;function Zo(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new We)}}function Qo(){ci.call(this),this.type="Bone"}Object.assign(Zo.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new We;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){var t,e,i;for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,i=this.boneMatrices,n=this.boneTexture,r=0,a=t.length;r<a;r++){var o=t[r]?t[r].matrixWorld:Jo;qo.multiplyMatrices(o,e[r]),qo.toArray(i,16*r)}void 0!==n&&(n.needsUpdate=!0)},clone:function(){return new Zo(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,i=this.bones.length;e<i;e++){var n=this.bones[e];if(n.name===t)return n}}}),Qo.prototype=Object.assign(Object.create(ci.prototype),{constructor:Qo,isBone:!0});var Ko=new We,$o=new We,ts=[],es=new Yn;function is(t,e,i){Yn.call(this,t,e),this.instanceMatrix=new cn(new Float32Array(16*i),16),this.count=i}function ns(t){sn.call(this),this.type="LineBasicMaterial",this.color=new tn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}is.prototype=Object.assign(Object.create(Yn.prototype),{constructor:is,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var i=this.matrixWorld,n=this.count;if(es.geometry=this.geometry,es.material=this.material,void 0!==es.material)for(var r=0;r<n;r++)this.getMatrixAt(r,Ko),$o.multiplyMatrices(i,Ko),es.matrixWorld=$o,es.raycast(t,ts),0<ts.length&&(ts[0].instanceId=r,ts[0].object=this,e.push(ts[0]),ts.length=0)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),((ns.prototype=Object.create(sn.prototype)).constructor=ns).prototype.isLineBasicMaterial=!0,ns.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var rs=new Le,as=new Le,os=new We,ss=new ji,ls=new Ci;function cs(t,e,i){1===i&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),ci.call(this),this.type="Line",this.geometry=void 0!==t?t:new Ln,this.material=void 0!==e?e:new ns({color:16777215*Math.random()})}cs.prototype=Object.assign(Object.create(ci.prototype),{constructor:cs,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[0],n=1,r=e.count;n<r;n++)rs.fromBufferAttribute(e,n-1),as.fromBufferAttribute(e,n),i[n]=i[n-1],i[n]+=rs.distanceTo(as);t.setAttribute("lineDistance",new vn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;(i=t.lineDistances)[0]=0;for(n=1,r=a.length;n<r;n++)i[n]=i[n-1],i[n]+=a[n-1].distanceTo(a[n])}return this},raycast:function(t,e){var i=t.linePrecision,n=this.geometry,r=this.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),ls.copy(n.boundingSphere),ls.applyMatrix4(r),ls.radius+=i,!1!==t.ray.intersectsSphere(ls)){os.getInverse(r),ss.copy(t.ray).applyMatrix4(os);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new Le,l=new Le,c=new Le,h=new Le,u=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,p=n.attributes.position.array;if(null!==d)for(var f=d.array,m=0,g=f.length-1;m<g;m+=u){var v=f[m],y=f[m+1];if(s.fromArray(p,3*v),l.fromArray(p,3*y),!(o<ss.distanceSqToSegment(s,l,h,c)))h.applyMatrix4(this.matrixWorld),(x=t.ray.origin.distanceTo(h))<t.near||x>t.far||e.push({distance:x,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,g=p.length/3-1;m<g;m+=u){if(s.fromArray(p,3*m),l.fromArray(p,3*m+3),!(o<ss.distanceSqToSegment(s,l,h,c)))h.applyMatrix4(this.matrixWorld),(x=t.ray.origin.distanceTo(h))<t.near||x>t.far||e.push({distance:x,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var _=n.vertices,b=_.length;for(m=0;m<b-1;m+=u){var x;if(!(o<ss.distanceSqToSegment(_[m],_[m+1],h,c)))h.applyMatrix4(this.matrixWorld),(x=t.ray.origin.distanceTo(h))<t.near||x>t.far||e.push({distance:x,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var hs=new Le,us=new Le;function ds(t,e){cs.call(this,t,e),this.type="LineSegments"}function ps(t,e){cs.call(this,t,e),this.type="LineLoop"}function fs(t){sn.call(this),this.type="PointsMaterial",this.color=new tn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}ds.prototype=Object.assign(Object.create(cs.prototype),{constructor:ds,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[],n=0,r=e.count;n<r;n+=2)hs.fromBufferAttribute(e,n),us.fromBufferAttribute(e,n+1),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+hs.distanceTo(us);t.setAttribute("lineDistance",new vn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;for(i=t.lineDistances,n=0,r=a.length;n<r;n+=2)hs.copy(a[n]),us.copy(a[n+1]),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+hs.distanceTo(us)}return this}}),ps.prototype=Object.assign(Object.create(cs.prototype),{constructor:ps,isLineLoop:!0}),((fs.prototype=Object.create(sn.prototype)).constructor=fs).prototype.isPointsMaterial=!0,fs.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var ms=new We,gs=new ji,vs=new Ci,ys=new Le;function _s(t,e){ci.call(this),this.type="Points",this.geometry=void 0!==t?t:new Ln,this.material=void 0!==e?e:new fs({color:16777215*Math.random()}),this.updateMorphTargets()}function bs(t,e,i,n,r,a,o){var s=gs.distanceSqToPoint(t);if(s<i){var l=new Le;gs.closestPointToPoint(t,l),l.applyMatrix4(n);var c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;a.push({distance:c,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:o})}}function xs(t,e,i,n,r,a,o,s,l){De.call(this,t,e,i,n,r,a,o,s,l),this.format=void 0!==o?o:ee,this.minFilter=void 0!==a?a:Yt,this.magFilter=void 0!==r?r:Yt,this.generateMipmaps=!1}function ws(t,e,i,n,r,a,o,s,l,c,h,u){De.call(this,null,a,o,s,l,c,n,r,h,u),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Ts(t,e,i,n,r,a,o,s,l){De.call(this,t,e,i,n,r,a,o,s,l),this.needsUpdate=!0}function Ms(t,e,i,n,r,a,o,s,l,c){if((c=void 0!==c?c:ne)!==ne&&c!==re)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===ne&&(i=Zt),void 0===i&&c===re&&(i=te),De.call(this,null,n,r,a,o,s,c,i,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:Vt,this.minFilter=void 0!==s?s:Vt,this.flipY=!1,this.generateMipmaps=!1}function Ss(t){Ln.call(this),this.type="WireframeGeometry";var e,i,n,r,a,o,s,l,c,h,u=[],d=[0,0],p={},f=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,n=m.length;e<n;e++){var g=m[e];for(i=0;i<3;i++)s=g[f[i]],l=g[f[(i+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]})}for(c in p)o=p[c],h=t.vertices[o.index1],u.push(h.x,h.y,h.z),h=t.vertices[o.index2],u.push(h.x,h.y,h.z)}else if(t&&t.isBufferGeometry){var v,y,_,b,x,w;if(h=new Le,null!==t.index){for(v=t.attributes.position,y=t.index,0===(_=t.groups).length&&(_=[{start:0,count:y.count,materialIndex:0}]),r=0,a=_.length;r<a;++r)for(n=(e=(b=_[r]).start)+b.count;e<n;e+=3)for(i=0;i<3;i++)s=y.getX(e+i),l=y.getX(e+(i+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]});for(c in p)o=p[c],h.fromBufferAttribute(v,o.index1),u.push(h.x,h.y,h.z),h.fromBufferAttribute(v,o.index2),u.push(h.x,h.y,h.z)}else for(e=0,n=(v=t.attributes.position).count/3;e<n;e++)for(i=0;i<3;i++)x=3*e+i,h.fromBufferAttribute(v,x),u.push(h.x,h.y,h.z),w=3*e+(i+1)%3,h.fromBufferAttribute(v,w),u.push(h.x,h.y,h.z)}this.setAttribute("position",new vn(u,3))}function Es(t,e,i){$n.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new Cs(t,e,i)),this.mergeVertices()}function Cs(t,e,i){Ln.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};var n,r,a=[],o=[],s=[],l=[],c=new Le,h=new Le,u=new Le,d=new Le,p=new Le;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var f=e+1;for(n=0;n<=i;n++){var m=n/i;for(r=0;r<=e;r++){var g=r/e;t(g,m,h),o.push(h.x,h.y,h.z),0<=g-1e-5?(t(g-1e-5,m,u),d.subVectors(h,u)):(t(g+1e-5,m,u),d.subVectors(u,h)),0<=m-1e-5?(t(g,m-1e-5,u),p.subVectors(h,u)):(t(g,m+1e-5,u),p.subVectors(u,h)),c.crossVectors(d,p).normalize(),s.push(c.x,c.y,c.z),l.push(g,m)}}for(n=0;n<i;n++)for(r=0;r<e;r++){var v=n*f+r,y=n*f+r+1,_=(n+1)*f+r+1,b=(n+1)*f+r;a.push(v,y,b),a.push(y,_,b)}this.setIndex(a),this.setAttribute("position",new vn(o,3)),this.setAttribute("normal",new vn(s,3)),this.setAttribute("uv",new vn(l,2))}function Ls(t,e,i,n){$n.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},this.fromBufferGeometry(new As(t,e,i,n)),this.mergeVertices()}function As(n,a,t,e){Ln.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:n,indices:a,radius:t,detail:e},t=t||1;var h=[],u=[];function o(t,e,i,n){var r,a,o=Math.pow(2,n),s=[];for(r=0;r<=o;r++){s[r]=[];var l=t.clone().lerp(i,r/o),c=e.clone().lerp(i,r/o),h=o-r;for(a=0;a<=h;a++)s[r][a]=0===a&&r===o?l:l.clone().lerp(c,a/h)}for(r=0;r<o;r++)for(a=0;a<2*(o-r)-1;a++){var u=Math.floor(a/2);a%2==0?(d(s[r][u+1]),d(s[r+1][u]),d(s[r][u])):(d(s[r][u+1]),d(s[r+1][u+1]),d(s[r+1][u]))}}function d(t){h.push(t.x,t.y,t.z)}function s(t,e){var i=3*t;e.x=n[i+0],e.y=n[i+1],e.z=n[i+2]}function p(t,e,i,n){n<0&&1===t.x&&(u[e]=t.x-1),0===i.x&&0===i.z&&(u[e]=n/2/Math.PI+.5)}function f(t){return Math.atan2(t.z,-t.x)}!function(t){for(var e=new Le,i=new Le,n=new Le,r=0;r<a.length;r+=3)s(a[r+0],e),s(a[r+1],i),s(a[r+2],n),o(e,i,n,t)}(e=e||0),function(t){for(var e=new Le,i=0;i<h.length;i+=3)e.x=h[i+0],e.y=h[i+1],e.z=h[i+2],e.normalize().multiplyScalar(t),h[i+0]=e.x,h[i+1]=e.y,h[i+2]=e.z}(t),function(){for(var t=new Le,e=0;e<h.length;e+=3){t.x=h[e+0],t.y=h[e+1],t.z=h[e+2];var i=f(t)/2/Math.PI+.5,n=(r=t,Math.atan2(-r.y,Math.sqrt(r.x*r.x+r.z*r.z))/Math.PI+.5);u.push(i,1-n)}var r;(function(){for(var t=new Le,e=new Le,i=new Le,n=new Le,r=new Me,a=new Me,o=new Me,s=0,l=0;s<h.length;s+=9,l+=6){t.set(h[s+0],h[s+1],h[s+2]),e.set(h[s+3],h[s+4],h[s+5]),i.set(h[s+6],h[s+7],h[s+8]),r.set(u[l+0],u[l+1]),a.set(u[l+2],u[l+3]),o.set(u[l+4],u[l+5]),n.copy(t).add(e).add(i).divideScalar(3);var c=f(n);p(r,l+0,t,c),p(a,l+2,e,c),p(o,l+4,i,c)}})(),function(){for(var t=0;t<u.length;t+=6){var e=u[t+0],i=u[t+2],n=u[t+4],r=Math.max(e,i,n),a=Math.min(e,i,n);.9<r&&a<.1&&(e<.2&&(u[t+0]+=1),i<.2&&(u[t+2]+=1),n<.2&&(u[t+4]+=1))}}()}(),this.setAttribute("position",new vn(h,3)),this.setAttribute("normal",new vn(h.slice(),3)),this.setAttribute("uv",new vn(u,2)),0===e?this.computeVertexNormals():this.normalizeNormals()}function Ps(t,e){$n.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Rs(t,e)),this.mergeVertices()}function Rs(t,e){As.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Os(t,e){$n.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Is(t,e)),this.mergeVertices()}function Is(t,e){As.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ds(t,e){$n.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new js(t,e)),this.mergeVertices()}function js(t,e){var i=(1+Math.sqrt(5))/2;As.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ks(t,e){$n.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ns(t,e)),this.mergeVertices()}function Ns(t,e){var i=(1+Math.sqrt(5))/2,n=1/i;As.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Fs(t,e,i,n,r,a){$n.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new Bs(t,e,i,n,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function Bs(o,s,l,c,t){Ln.call(this),this.type="TubeBufferGeometry",this.parameters={path:o,tubularSegments:s,radius:l,radialSegments:c,closed:t},s=s||64,l=l||1,c=c||8,t=t||!1;var h=o.computeFrenetFrames(s,t);this.tangents=h.tangents,this.normals=h.normals,this.binormals=h.binormals;var r,u,d=new Le,p=new Le,e=new Me,f=new Le,m=[],g=[],i=[],a=[];function n(t){f=o.getPointAt(t/s,f);var e=h.normals[t],i=h.binormals[t];for(u=0;u<=c;u++){var n=u/c*Math.PI*2,r=Math.sin(n),a=-Math.cos(n);p.x=a*e.x+r*i.x,p.y=a*e.y+r*i.y,p.z=a*e.z+r*i.z,p.normalize(),g.push(p.x,p.y,p.z),d.x=f.x+l*p.x,d.y=f.y+l*p.y,d.z=f.z+l*p.z,m.push(d.x,d.y,d.z)}}!function(){for(r=0;r<s;r++)n(r);n(!1===t?s:0),function(){for(r=0;r<=s;r++)for(u=0;u<=c;u++)e.x=r/s,e.y=u/c,i.push(e.x,e.y)}(),function(){for(u=1;u<=s;u++)for(r=1;r<=c;r++){var t=(c+1)*(u-1)+(r-1),e=(c+1)*u+(r-1),i=(c+1)*u+r,n=(c+1)*(u-1)+r;a.push(t,e,n),a.push(e,i,n)}}()}(),this.setIndex(a),this.setAttribute("position",new vn(m,3)),this.setAttribute("normal",new vn(g,3)),this.setAttribute("uv",new vn(i,2))}function Hs(t,e,i,n,r,a,o){$n.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Us(t,e,i,n,r,a)),this.mergeVertices()}function Us(t,e,i,n,r,a){Ln.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:a},t=t||1,e=e||.4,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,a=a||3;var o,s,l=[],c=[],h=[],u=[],d=new Le,p=new Le,f=new Le,m=new Le,g=new Le,v=new Le,y=new Le;for(o=0;o<=i;++o){var _=o/i*r*Math.PI*2;for(C(_,r,a,t,f),C(_+.01,r,a,t,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=n;++s){var b=s/n*Math.PI*2,x=-e*Math.cos(b),w=e*Math.sin(b);d.x=f.x+(x*y.x+w*g.x),d.y=f.y+(x*y.y+w*g.y),d.z=f.z+(x*y.z+w*g.z),c.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),h.push(p.x,p.y,p.z),u.push(o/i),u.push(s/n)}}for(s=1;s<=i;s++)for(o=1;o<=n;o++){var T=(n+1)*(s-1)+(o-1),M=(n+1)*s+(o-1),S=(n+1)*s+o,E=(n+1)*(s-1)+o;l.push(T,M,E),l.push(M,S,E)}function C(t,e,i,n,r){var a=Math.cos(t),o=Math.sin(t),s=i/e*t,l=Math.cos(s);r.x=n*(2+l)*.5*a,r.y=n*(2+l)*o*.5,r.z=n*Math.sin(s)*.5}this.setIndex(l),this.setAttribute("position",new vn(c,3)),this.setAttribute("normal",new vn(h,3)),this.setAttribute("uv",new vn(u,2))}function zs(t,e,i,n,r){$n.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Vs(t,e,i,n,r)),this.mergeVertices()}function Vs(t,e,i,n,r){Ln.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||1,e=e||.4,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var a,o,s=[],l=[],c=[],h=[],u=new Le,d=new Le,p=new Le;for(a=0;a<=i;a++)for(o=0;o<=n;o++){var f=o/n*r,m=a/i*Math.PI*2;d.x=(t+e*Math.cos(m))*Math.cos(f),d.y=(t+e*Math.cos(m))*Math.sin(f),d.z=e*Math.sin(m),l.push(d.x,d.y,d.z),u.x=t*Math.cos(f),u.y=t*Math.sin(f),p.subVectors(d,u).normalize(),c.push(p.x,p.y,p.z),h.push(o/n),h.push(a/i)}for(a=1;a<=i;a++)for(o=1;o<=n;o++){var g=(n+1)*a+o-1,v=(n+1)*(a-1)+o-1,y=(n+1)*(a-1)+o,_=(n+1)*a+o;s.push(g,v,_),s.push(v,y,_)}this.setIndex(s),this.setAttribute("position",new vn(l,3)),this.setAttribute("normal",new vn(c,3)),this.setAttribute("uv",new vn(h,2))}_s.prototype=Object.assign(Object.create(ci.prototype),{constructor:_s,isPoints:!0,raycast:function(t,e){var i=this.geometry,n=this.matrixWorld,r=t.params.Points.threshold;if(null===i.boundingSphere&&i.computeBoundingSphere(),vs.copy(i.boundingSphere),vs.applyMatrix4(n),vs.radius+=r,!1!==t.ray.intersectsSphere(vs)){ms.getInverse(n),gs.copy(t.ray).applyMatrix4(ms);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(i.isBufferGeometry){var s=i.index,l=i.attributes.position.array;if(null!==s)for(var c=s.array,h=0,u=c.length;h<u;h++){var d=c[h];ys.fromArray(l,3*d),bs(ys,d,o,n,t,e,this)}else{h=0;for(var p=l.length/3;h<p;h++)ys.fromArray(l,3*h),bs(ys,h,o,n,t,e,this)}}else{var f=i.vertices;for(h=0,p=f.length;h<p;h++)bs(f[h],h,o,n,t,e,this)}}},updateMorphTargets:function(){var t,e,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,a=Object.keys(r);if(0<a.length){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)i=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{var s=n.morphTargets;void 0!==s&&0<s.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),xs.prototype=Object.assign(Object.create(De.prototype),{constructor:xs,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((ws.prototype=Object.create(De.prototype)).constructor=ws).prototype.isCompressedTexture=!0,((Ts.prototype=Object.create(De.prototype)).constructor=Ts).prototype.isCanvasTexture=!0,((Ms.prototype=Object.create(De.prototype)).constructor=Ms).prototype.isDepthTexture=!0,(Ss.prototype=Object.create(Ln.prototype)).constructor=Ss,(Es.prototype=Object.create($n.prototype)).constructor=Es,(Cs.prototype=Object.create(Ln.prototype)).constructor=Cs,(Ls.prototype=Object.create($n.prototype)).constructor=Ls,(As.prototype=Object.create(Ln.prototype)).constructor=As,(Ps.prototype=Object.create($n.prototype)).constructor=Ps,(Rs.prototype=Object.create(As.prototype)).constructor=Rs,(Os.prototype=Object.create($n.prototype)).constructor=Os,(Is.prototype=Object.create(As.prototype)).constructor=Is,(Ds.prototype=Object.create($n.prototype)).constructor=Ds,(js.prototype=Object.create(As.prototype)).constructor=js,(ks.prototype=Object.create($n.prototype)).constructor=ks,(Ns.prototype=Object.create(As.prototype)).constructor=Ns,(Fs.prototype=Object.create($n.prototype)).constructor=Fs,((Bs.prototype=Object.create(Ln.prototype)).constructor=Bs).prototype.toJSON=function(){var t=Ln.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(Hs.prototype=Object.create($n.prototype)).constructor=Hs,(Us.prototype=Object.create(Ln.prototype)).constructor=Us,(zs.prototype=Object.create($n.prototype)).constructor=zs,(Vs.prototype=Object.create(Ln.prototype)).constructor=Vs;var Gs=function(t,e,i){i=i||2;var n,r,a,o,s,l,c,h=e&&e.length,u=h?e[0]*i:t.length,d=Ws(t,0,u,i,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=function(t,e,i,n){var r,a,o,s,l,c=[];for(r=0,a=e.length;r<a;r++)o=e[r]*n,s=r<a-1?e[r+1]*n:t.length,(l=Ws(t,o,s,n,!1))===l.next&&(l.steiner=!0),c.push(el(l));for(c.sort(Ks),r=0;r<c.length;r++)$s(c[r],i),i=Ys(i,i.next);return i}(t,e,d,i)),t.length>80*i){n=a=t[0],r=o=t[1];for(var f=i;f<u;f+=i)(s=t[f])<n&&(n=s),(l=t[f+1])<r&&(r=l),a<s&&(a=s),o<l&&(o=l);c=0!==(c=Math.max(a-n,o-r))?1/c:0}return Xs(d,p,i,n,r,c),p};function Ws(t,e,i,n,r){var a,o;if(r===0<function(t,e,i,n){for(var r=0,a=e,o=i-n;a<i;a+=n)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}(t,e,i,n))for(a=e;a<i;a+=n)o=ll(a,t[a],t[a+1],o);else for(a=i-n;e<=a;a-=n)o=ll(a,t[a],t[a+1],o);return o&&rl(o,o.next)&&(cl(o),o=o.next),o}function Ys(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!rl(n,n.next)&&0!==nl(n.prev,n,n.next))n=n.next;else{if(cl(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function Xs(t,e,i,n,r,a,o){if(t){!o&&a&&function(t,e,i,n){var r=t;for(;null===r.z&&(r.z=tl(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next,r!==t;);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,a,o,s,l,c=1;do{for(i=t,a=t=null,o=0;i;){for(o++,n=i,e=s=0;e<c&&(s++,n=n.nextZ);e++);for(l=c;0<s||0<l&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(i=(r=i).nextZ,s--):(n=(r=n).nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;i=n}a.nextZ=null,c*=2}while(1<o)}(r)}(t,n,r,a);for(var s,l,c=t;t.prev!==t.next;)if(s=t.prev,l=t.next,a?Js(t,n,r,a):qs(t))e.push(s.i/i),e.push(t.i/i),e.push(l.i/i),cl(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?Xs(t=Zs(t,e,i),e,i,n,r,a,2):2===o&&Qs(t,e,i,n,r,a):Xs(Ys(t),e,i,n,r,a,1);break}}}function qs(t){var e=t.prev,i=t,n=t.next;if(0<=nl(e,i,n))return!1;for(var r=t.next.next;r!==t.prev;){if(il(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&0<=nl(r.prev,r,r.next))return!1;r=r.next}return!0}function Js(t,e,i,n){var r=t.prev,a=t,o=t.next;if(0<=nl(r,a,o))return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,c=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,h=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,u=tl(s,l,e,i,n),d=tl(c,h,e,i,n),p=t.prevZ,f=t.nextZ;p&&p.z>=u&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&il(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=nl(p.prev,p,p.next))return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&il(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=nl(f.prev,f,f.next))return!1;f=f.nextZ}for(;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&il(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=nl(p.prev,p,p.next))return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&il(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=nl(f.prev,f,f.next))return!1;f=f.nextZ}return!0}function Zs(t,e,i){var n=t;do{var r=n.prev,a=n.next.next;!rl(r,a)&&al(r,n,n.next,a)&&ol(r,a)&&ol(a,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(a.i/i),cl(n),cl(n.next),n=t=a),n=n.next}while(n!==t);return n}function Qs(t,e,i,n,r,a){var o,s,l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&(s=c,(o=l).next.i!==s.i&&o.prev.i!==s.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&al(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(o,s)&&ol(o,s)&&ol(s,o)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;for(;i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next,i!==t;);return n}(o,s))){var h=sl(l,c);return l=Ys(l,l.next),h=Ys(h,h.next),Xs(l,e,i,n,r,a),void Xs(h,e,i,n,r,a)}c=c.next}l=l.next}while(l!==t)}function Ks(t,e){return t.x-e.x}function $s(t,e){if(e=function(t,e){var i,n=e,r=t.x,a=t.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&o<s){if((o=s)===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===o)return i.prev;var l,c=i,h=i.x,u=i.y,d=1/0;n=i.next;for(;n!==c;)r>=n.x&&n.x>=h&&r!==n.x&&il(a<u?r:o,a,h,u,a<u?o:r,a,n.x,n.y)&&((l=Math.abs(a-n.y)/(r-n.x))<d||l===d&&n.x>i.x)&&ol(n,t)&&(i=n,d=l),n=n.next;return i}(t,e)){var i=sl(e,t);Ys(i,i.next)}}function tl(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function el(t){for(var e=t,i=t;(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),(e=e.next)!==t;);return i}function il(t,e,i,n,r,a,o,s){return 0<=(r-o)*(e-s)-(t-o)*(a-s)&&0<=(t-o)*(n-s)-(i-o)*(e-s)&&0<=(i-o)*(a-s)-(r-o)*(n-s)}function nl(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function rl(t,e){return t.x===e.x&&t.y===e.y}function al(t,e,i,n){return!!(rl(t,i)&&rl(e,n)||rl(t,n)&&rl(i,e))||0<nl(t,e,i)!=0<nl(t,e,n)&&0<nl(i,n,t)!=0<nl(i,n,e)}function ol(t,e){return nl(t.prev,t,t.next)<0?0<=nl(t,e,t.next)&&0<=nl(t,t.prev,e):nl(t,e,t.prev)<0||nl(t,t.next,e)<0}function sl(t,e){var i=new hl(t.i,t.x,t.y),n=new hl(e.i,e.x,e.y),r=t.next,a=e.prev;return(t.next=e).prev=t,(i.next=r).prev=i,(n.next=i).prev=n,(a.next=n).prev=a,n}function ll(t,e,i,n){var r=new hl(t,e,i);return n?(r.next=n.next,(r.prev=n).next.prev=r,n.next=r):(r.prev=r).next=r,r}function cl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function hl(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var ul={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},isClockWise:function(t){return ul.area(t)<0},triangulateShape:function(t,e){var i=[],n=[],r=[];dl(t),pl(i,t);var a=t.length;e.forEach(dl);for(var o=0;o<e.length;o++)n.push(a),a+=e[o].length,pl(i,e[o]);var s=Gs(i,n);for(o=0;o<s.length;o+=3)r.push(s.slice(o,o+3));return r}};function dl(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function pl(t,e){for(var i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}function fl(t,e){$n.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new ml(t,e)),this.mergeVertices()}function ml(t,Q){Ln.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:Q},t=Array.isArray(t)?t:[t];for(var K=this,$=[],tt=[],e=0,i=t.length;e<i;e++){n(t[e])}function n(t){var n=[],e=void 0!==Q.curveSegments?Q.curveSegments:12,l=void 0!==Q.steps?Q.steps:1,i=void 0!==Q.depth?Q.depth:100,r=void 0===Q.bevelEnabled||Q.bevelEnabled,a=void 0!==Q.bevelThickness?Q.bevelThickness:6,o=void 0!==Q.bevelSize?Q.bevelSize:a-2,s=void 0!==Q.bevelOffset?Q.bevelOffset:0,c=void 0!==Q.bevelSegments?Q.bevelSegments:3,h=Q.extrudePath,u=void 0!==Q.UVGenerator?Q.UVGenerator:gl;void 0!==Q.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),i=Q.amount);var d,p,f,m,g,v,y,_,b=!1;h&&(d=h.getSpacedPoints(l),r=!(b=!0),p=h.computeFrenetFrames(l,!1),f=new Le,m=new Le,g=new Le),r||(s=o=a=c=0);var x=t.extractPoints(e),w=x.shape,T=x.holes;if(!ul.isClockWise(w))for(w=w.reverse(),y=0,_=T.length;y<_;y++)v=T[y],ul.isClockWise(v)&&(T[y]=v.reverse());var M=ul.triangulateShape(w,T),S=w;for(y=0,_=T.length;y<_;y++)v=T[y],w=w.concat(v);function E(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}var C,L,A,P,R,O,I=w.length,D=M.length;function j(t,e,i){var n,r,a,o=t.x-e.x,s=t.y-e.y,l=i.x-t.x,c=i.y-t.y,h=o*o+s*s,u=o*c-s*l;if(Math.abs(u)>Number.EPSILON){var d=Math.sqrt(h),p=Math.sqrt(l*l+c*c),f=e.x-s/d,m=e.y+o/d,g=((i.x-c/p-f)*c-(i.y+l/p-m)*l)/(o*c-s*l),v=(n=f+o*g-t.x)*n+(r=m+s*g-t.y)*r;if(v<=2)return new Me(n,r);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),a=y?(n=-s,r=o,Math.sqrt(h)):(n=o,r=s,Math.sqrt(h/2))}return new Me(n/a,r/a)}for(var k=[],N=0,F=S.length,B=F-1,H=N+1;N<F;N++,B++,H++)B===F&&(B=0),H===F&&(H=0),k[N]=j(S[N],S[B],S[H]);var U,z,V=[],G=k.concat();for(y=0,_=T.length;y<_;y++){for(v=T[y],U=[],N=0,B=(F=v.length)-1,H=N+1;N<F;N++,B++,H++)B===F&&(B=0),H===F&&(H=0),U[N]=j(v[N],v[B],v[H]);V.push(U),G=G.concat(U)}for(C=0;C<c;C++){for(A=C/c,P=a*Math.cos(A*Math.PI/2),L=o*Math.sin(A*Math.PI/2)+s,N=0,F=S.length;N<F;N++)Y((R=E(S[N],k[N],L)).x,R.y,-P);for(y=0,_=T.length;y<_;y++)for(v=T[y],U=V[y],N=0,F=v.length;N<F;N++)Y((R=E(v[N],U[N],L)).x,R.y,-P)}for(L=o+s,N=0;N<I;N++)R=r?E(w[N],G[N],L):w[N],b?(m.copy(p.normals[0]).multiplyScalar(R.x),f.copy(p.binormals[0]).multiplyScalar(R.y),g.copy(d[0]).add(m).add(f),Y(g.x,g.y,g.z)):Y(R.x,R.y,0);for(z=1;z<=l;z++)for(N=0;N<I;N++)R=r?E(w[N],G[N],L):w[N],b?(m.copy(p.normals[z]).multiplyScalar(R.x),f.copy(p.binormals[z]).multiplyScalar(R.y),g.copy(d[z]).add(m).add(f),Y(g.x,g.y,g.z)):Y(R.x,R.y,i/l*z);for(C=c-1;0<=C;C--){for(A=C/c,P=a*Math.cos(A*Math.PI/2),L=o*Math.sin(A*Math.PI/2)+s,N=0,F=S.length;N<F;N++)Y((R=E(S[N],k[N],L)).x,R.y,i+P);for(y=0,_=T.length;y<_;y++)for(v=T[y],U=V[y],N=0,F=v.length;N<F;N++)R=E(v[N],U[N],L),b?Y(R.x,R.y+d[l-1].y,d[l-1].x+P):Y(R.x,R.y,i+P)}function W(t,e){var i,n;for(N=t.length;0<=--N;){(n=(i=N)-1)<0&&(n=t.length-1);var r=0,a=l+2*c;for(r=0;r<a;r++){var o=I*r,s=I*(r+1);q(e+i+o,e+n+o,e+n+s,e+i+s)}}}function Y(t,e,i){n.push(t),n.push(e),n.push(i)}function X(t,e,i){J(t),J(e),J(i);var n=$.length/3,r=u.generateTopUV(K,$,n-3,n-2,n-1);Z(r[0]),Z(r[1]),Z(r[2])}function q(t,e,i,n){J(t),J(e),J(n),J(e),J(i),J(n);var r=$.length/3,a=u.generateSideWallUV(K,$,r-6,r-3,r-2,r-1);Z(a[0]),Z(a[1]),Z(a[3]),Z(a[1]),Z(a[2]),Z(a[3])}function J(t){$.push(n[3*t+0]),$.push(n[3*t+1]),$.push(n[3*t+2])}function Z(t){tt.push(t.x),tt.push(t.y)}!function(){var t=$.length/3;if(r){var e=0,i=I*e;for(N=0;N<D;N++)X((O=M[N])[2]+i,O[1]+i,O[0]+i);for(i=I*(e=l+2*c),N=0;N<D;N++)X((O=M[N])[0]+i,O[1]+i,O[2]+i)}else{for(N=0;N<D;N++)X((O=M[N])[2],O[1],O[0]);for(N=0;N<D;N++)X((O=M[N])[0]+I*l,O[1]+I*l,O[2]+I*l)}K.addGroup(t,$.length/3-t,0)}(),function(){var t=$.length/3,e=0;for(W(S,e),e+=S.length,y=0,_=T.length;y<_;y++)W(v=T[y],e),e+=v.length;K.addGroup(t,$.length/3-t,1)}()}this.setAttribute("position",new vn($,3)),this.setAttribute("uv",new vn(tt,2)),this.computeVertexNormals()}((fl.prototype=Object.create($n.prototype)).constructor=fl).prototype.toJSON=function(){var t=$n.prototype.toJSON.call(this);return vl(this.parameters.shapes,this.parameters.options,t)},((ml.prototype=Object.create(Ln.prototype)).constructor=ml).prototype.toJSON=function(){var t=Ln.prototype.toJSON.call(this);return vl(this.parameters.shapes,this.parameters.options,t)};var gl={generateTopUV:function(t,e,i,n,r){var a=e[3*i],o=e[3*i+1],s=e[3*n],l=e[3*n+1],c=e[3*r],h=e[3*r+1];return[new Me(a,o),new Me(s,l),new Me(c,h)]},generateSideWallUV:function(t,e,i,n,r,a){var o=e[3*i],s=e[3*i+1],l=e[3*i+2],c=e[3*n],h=e[3*n+1],u=e[3*n+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*a],g=e[3*a+1],v=e[3*a+2];return Math.abs(s-h)<.01?[new Me(o,1-l),new Me(c,1-u),new Me(d,1-f),new Me(m,1-v)]:[new Me(s,1-l),new Me(h,1-u),new Me(p,1-f),new Me(g,1-v)]}};function vl(t,e,i){if(i.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var a=t[n];i.shapes.push(a.uuid)}else i.shapes.push(t.uuid);return void 0!==e.extrudePath&&(i.options.extrudePath=e.extrudePath.toJSON()),i}function yl(t,e){$n.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new _l(t,e)),this.mergeVertices()}function _l(t,e){var i=(e=e||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new $n;var n=i.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),ml.call(this,n,e),this.type="TextBufferGeometry"}function bl(t,e,i,n,r,a,o){$n.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new xl(t,e,i,n,r,a,o)),this.mergeVertices()}function xl(t,e,i,n,r,a,o){Ln.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,l,c=Math.min(a+o,Math.PI),h=0,u=[],d=new Le,p=new Le,f=[],m=[],g=[],v=[];for(l=0;l<=i;l++){var y=[],_=l/i,b=0;for(0==l&&0==a?b=.5/e:l==i&&c==Math.PI&&(b=-.5/e),s=0;s<=e;s++){var x=s/e;d.x=-t*Math.cos(n+x*r)*Math.sin(a+_*o),d.y=t*Math.cos(a+_*o),d.z=t*Math.sin(n+x*r)*Math.sin(a+_*o),m.push(d.x,d.y,d.z),p.copy(d).normalize(),g.push(p.x,p.y,p.z),v.push(x+b,1-_),y.push(h++)}u.push(y)}for(l=0;l<i;l++)for(s=0;s<e;s++){var w=u[l][s+1],T=u[l][s],M=u[l+1][s],S=u[l+1][s+1];(0!==l||0<a)&&f.push(w,T,S),(l!==i-1||c<Math.PI)&&f.push(T,M,S)}this.setIndex(f),this.setAttribute("position",new vn(m,3)),this.setAttribute("normal",new vn(g,3)),this.setAttribute("uv",new vn(v,2))}function wl(t,e,i,n,r,a){$n.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new Tl(t,e,i,n,r,a)),this.mergeVertices()}function Tl(t,e,i,n,r,a){Ln.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},t=t||.5,e=e||1,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var o,s,l,c=[],h=[],u=[],d=[],p=t,f=(e-t)/(n=void 0!==n?Math.max(1,n):1),m=new Le,g=new Me;for(s=0;s<=n;s++){for(l=0;l<=i;l++)o=r+l/i*a,m.x=p*Math.cos(o),m.y=p*Math.sin(o),h.push(m.x,m.y,m.z),u.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,d.push(g.x,g.y);p+=f}for(s=0;s<n;s++){var v=s*(i+1);for(l=0;l<i;l++){var y=o=l+v,_=o+i+1,b=o+i+2,x=o+1;c.push(y,_,x),c.push(_,b,x)}}this.setIndex(c),this.setAttribute("position",new vn(h,3)),this.setAttribute("normal",new vn(u,3)),this.setAttribute("uv",new vn(d,2))}function Ml(t,e,i,n){$n.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new Sl(t,e,i,n)),this.mergeVertices()}function Sl(t,e,i,n){Ln.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e)||12,i=i||0,n=n||2*Math.PI,n=Te.clamp(n,0,2*Math.PI);var r,a,o,s=[],l=[],c=[],h=1/e,u=new Le,d=new Me;for(a=0;a<=e;a++){var p=i+a*h*n,f=Math.sin(p),m=Math.cos(p);for(o=0;o<=t.length-1;o++)u.x=t[o].x*f,u.y=t[o].y,u.z=t[o].x*m,l.push(u.x,u.y,u.z),d.x=a/e,d.y=o/(t.length-1),c.push(d.x,d.y)}for(a=0;a<e;a++)for(o=0;o<t.length-1;o++){var g=r=o+a*t.length,v=r+t.length,y=r+t.length+1,_=r+1;s.push(g,v,_),s.push(v,y,_)}if(this.setIndex(s),this.setAttribute("position",new vn(l,3)),this.setAttribute("uv",new vn(c,2)),this.computeVertexNormals(),n===2*Math.PI){var b=this.attributes.normal.array,x=new Le,w=new Le,T=new Le;for(r=e*t.length*3,o=a=0;a<t.length;a++,o+=3)x.x=b[o+0],x.y=b[o+1],x.z=b[o+2],w.x=b[r+o+0],w.y=b[r+o+1],w.z=b[r+o+2],T.addVectors(x,w).normalize(),b[o+0]=b[r+o+0]=T.x,b[o+1]=b[r+o+1]=T.y,b[o+2]=b[r+o+2]=T.z}}function El(t,e){$n.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Cl(t,e)),this.mergeVertices()}function Cl(t,f){Ln.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:f},f=f||12;var m=[],g=[],v=[],y=[],e=0,_=0;if(!1===Array.isArray(t))n(t);else for(var i=0;i<t.length;i++)n(t[i]),this.addGroup(e,_,i),e+=_,_=0;function n(t){var e,i,n,r=g.length/3,a=t.extractPoints(f),o=a.shape,s=a.holes;for(!1===ul.isClockWise(o)&&(o=o.reverse()),e=0,i=s.length;e<i;e++)n=s[e],!0===ul.isClockWise(n)&&(s[e]=n.reverse());var l=ul.triangulateShape(o,s);for(e=0,i=s.length;e<i;e++)n=s[e],o=o.concat(n);for(e=0,i=o.length;e<i;e++){var c=o[e];g.push(c.x,c.y,0),v.push(0,0,1),y.push(c.x,c.y)}for(e=0,i=l.length;e<i;e++){var h=l[e],u=h[0]+r,d=h[1]+r,p=h[2]+r;m.push(u,d,p),_+=3}}this.setIndex(m),this.setAttribute("position",new vn(g,3)),this.setAttribute("normal",new vn(v,3)),this.setAttribute("uv",new vn(y,2))}function Ll(t,e){if(e.shapes=[],Array.isArray(t))for(var i=0,n=t.length;i<n;i++){var r=t[i];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}function Al(t,e){Ln.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var i,n,r,a,o=[],s=Math.cos(Te.DEG2RAD*e),l=[0,0],c={},h=["a","b","c"];t.isBufferGeometry?(a=new $n).fromBufferGeometry(t):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var u=a.vertices,d=a.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)i=m[h[g]],n=m[h[(g+1)%3]],l[0]=Math.min(i,n),l[1]=Math.max(i,n),void 0===c[r=l[0]+","+l[1]]?c[r]={index1:l[0],index2:l[1],face1:p,face2:void 0}:c[r].face2=p;for(r in c){var v=c[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=u[v.index1];o.push(y.x,y.y,y.z),y=u[v.index2],o.push(y.x,y.y,y.z)}}this.setAttribute("position",new vn(o,3))}function Pl(t,e,i,n,r,a,o,s){$n.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Rl(t,e,i,n,r,a,o,s)),this.mergeVertices()}function Rl(v,y,_,b,x,t,w,T){Ln.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:v,radiusBottom:y,height:_,radialSegments:b,heightSegments:x,openEnded:t,thetaStart:w,thetaLength:T};var M=this;v=void 0!==v?v:1,y=void 0!==y?y:1,_=_||1,b=Math.floor(b)||8,x=Math.floor(x)||1,t=void 0!==t&&t,w=void 0!==w?w:0,T=void 0!==T?T:2*Math.PI;var S=[],E=[],C=[],L=[],A=0,P=[],R=_/2,O=0;function e(t){var e,i,n,r=new Me,a=new Le,o=0,s=!0===t?v:y,l=!0===t?1:-1;for(i=A,e=1;e<=b;e++)E.push(0,R*l,0),C.push(0,l,0),L.push(.5,.5),A++;for(n=A,e=0;e<=b;e++){var c=e/b*T+w,h=Math.cos(c),u=Math.sin(c);a.x=s*u,a.y=R*l,a.z=s*h,E.push(a.x,a.y,a.z),C.push(0,l,0),r.x=.5*h+.5,r.y=.5*u*l+.5,L.push(r.x,r.y),A++}for(e=0;e<b;e++){var d=i+e,p=n+e;!0===t?S.push(p,p+1,d):S.push(p+1,p,d),o+=3}M.addGroup(O,o,!0===t?1:2),O+=o}!function(){var t,e,i=new Le,n=new Le,r=0,a=(y-v)/_;for(e=0;e<=x;e++){var o=[],s=e/x,l=s*(y-v)+v;for(t=0;t<=b;t++){var c=t/b,h=c*T+w,u=Math.sin(h),d=Math.cos(h);n.x=l*u,n.y=-s*_+R,n.z=l*d,E.push(n.x,n.y,n.z),i.set(u,a,d).normalize(),C.push(i.x,i.y,i.z),L.push(c,1-s),o.push(A++)}P.push(o)}for(t=0;t<b;t++)for(e=0;e<x;e++){var p=P[e][t],f=P[e+1][t],m=P[e+1][t+1],g=P[e][t+1];S.push(p,f,g),S.push(f,m,g),r+=6}M.addGroup(O,r,0),O+=r}(),!1===t&&(0<v&&e(!0),0<y&&e(!1)),this.setIndex(S),this.setAttribute("position",new vn(E,3)),this.setAttribute("normal",new vn(C,3)),this.setAttribute("uv",new vn(L,2))}function Ol(t,e,i,n,r,a,o){Pl.call(this,0,t,e,i,n,r,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function Il(t,e,i,n,r,a,o){Rl.call(this,0,t,e,i,n,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function Dl(t,e,i,n){$n.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new jl(t,e,i,n)),this.mergeVertices()}function jl(t,e,i,n){Ln.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,a,o=[],s=[],l=[],c=[],h=new Le,u=new Me;for(s.push(0,0,0),l.push(0,0,1),c.push(.5,.5),a=0,r=3;a<=e;a++,r+=3){var d=i+a/e*n;h.x=t*Math.cos(d),h.y=t*Math.sin(d),s.push(h.x,h.y,h.z),l.push(0,0,1),u.x=(s[r]/t+1)/2,u.y=(s[r+1]/t+1)/2,c.push(u.x,u.y)}for(r=1;r<=e;r++)o.push(r,r+1,0);this.setIndex(o),this.setAttribute("position",new vn(s,3)),this.setAttribute("normal",new vn(l,3)),this.setAttribute("uv",new vn(c,2))}(yl.prototype=Object.create($n.prototype)).constructor=yl,(_l.prototype=Object.create(ml.prototype)).constructor=_l,(bl.prototype=Object.create($n.prototype)).constructor=bl,(xl.prototype=Object.create(Ln.prototype)).constructor=xl,(wl.prototype=Object.create($n.prototype)).constructor=wl,(Tl.prototype=Object.create(Ln.prototype)).constructor=Tl,(Ml.prototype=Object.create($n.prototype)).constructor=Ml,(Sl.prototype=Object.create(Ln.prototype)).constructor=Sl,((El.prototype=Object.create($n.prototype)).constructor=El).prototype.toJSON=function(){var t=$n.prototype.toJSON.call(this);return Ll(this.parameters.shapes,t)},((Cl.prototype=Object.create(Ln.prototype)).constructor=Cl).prototype.toJSON=function(){var t=Ln.prototype.toJSON.call(this);return Ll(this.parameters.shapes,t)},(Al.prototype=Object.create(Ln.prototype)).constructor=Al,(Pl.prototype=Object.create($n.prototype)).constructor=Pl,(Rl.prototype=Object.create(Ln.prototype)).constructor=Rl,(Ol.prototype=Object.create(Pl.prototype)).constructor=Ol,(Il.prototype=Object.create(Rl.prototype)).constructor=Il,(Dl.prototype=Object.create($n.prototype)).constructor=Dl,(jl.prototype=Object.create(Ln.prototype)).constructor=jl;var kl=Object.freeze({__proto__:null,WireframeGeometry:Ss,ParametricGeometry:Es,ParametricBufferGeometry:Cs,TetrahedronGeometry:Ps,TetrahedronBufferGeometry:Rs,OctahedronGeometry:Os,OctahedronBufferGeometry:Is,IcosahedronGeometry:Ds,IcosahedronBufferGeometry:js,DodecahedronGeometry:ks,DodecahedronBufferGeometry:Ns,PolyhedronGeometry:Ls,PolyhedronBufferGeometry:As,TubeGeometry:Fs,TubeBufferGeometry:Bs,TorusKnotGeometry:Hs,TorusKnotBufferGeometry:Us,TorusGeometry:zs,TorusBufferGeometry:Vs,TextGeometry:yl,TextBufferGeometry:_l,SphereGeometry:bl,SphereBufferGeometry:xl,RingGeometry:wl,RingBufferGeometry:Tl,PlaneGeometry:xr,PlaneBufferGeometry:wr,LatheGeometry:Ml,LatheBufferGeometry:Sl,ShapeGeometry:El,ShapeBufferGeometry:Cl,ExtrudeGeometry:fl,ExtrudeBufferGeometry:ml,EdgesGeometry:Al,ConeGeometry:Ol,ConeBufferGeometry:Il,CylinderGeometry:Pl,CylinderBufferGeometry:Rl,CircleGeometry:Dl,CircleBufferGeometry:jl,BoxGeometry:tr,BoxBufferGeometry:er});function Nl(t){sn.call(this),this.type="ShadowMaterial",this.color=new tn(0),this.transparent=!0,this.setValues(t)}function Fl(t){sr.call(this,t),this.type="RawShaderMaterial"}function Bl(t){sn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new tn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fe,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Hl(t){Bl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new Me(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(t)}function Ul(t){sn.call(this),this.type="MeshPhongMaterial",this.color=new tn(16777215),this.specular=new tn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fe,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function zl(t){sn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new tn(16777215),this.specular=new tn(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fe,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Vl(t){sn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fe,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Gl(t){sn.call(this),this.type="MeshLambertMaterial",this.color=new tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Wl(t){sn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new tn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fe,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Yl(t){ns.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}((Nl.prototype=Object.create(sn.prototype)).constructor=Nl).prototype.isShadowMaterial=!0,Nl.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this},((Fl.prototype=Object.create(sr.prototype)).constructor=Fl).prototype.isRawShaderMaterial=!0,((Bl.prototype=Object.create(sn.prototype)).constructor=Bl).prototype.isMeshStandardMaterial=!0,Bl.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Hl.prototype=Object.create(Bl.prototype)).constructor=Hl).prototype.isMeshPhysicalMaterial=!0,Hl.prototype.copy=function(t){return Bl.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearcoat=t.clearcoat,this.clearcoatRoughness=t.clearcoatRoughness,t.sheen?this.sheen=(this.sheen||new tn).copy(t.sheen):this.sheen=null,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.transparency=t.transparency,this},((Ul.prototype=Object.create(sn.prototype)).constructor=Ul).prototype.isMeshPhongMaterial=!0,Ul.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((zl.prototype=Object.create(sn.prototype)).constructor=zl).prototype.isMeshToonMaterial=!0,zl.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Vl.prototype=Object.create(sn.prototype)).constructor=Vl).prototype.isMeshNormalMaterial=!0,Vl.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Gl.prototype=Object.create(sn.prototype)).constructor=Gl).prototype.isMeshLambertMaterial=!0,Gl.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Wl.prototype=Object.create(sn.prototype)).constructor=Wl).prototype.isMeshMatcapMaterial=!0,Wl.prototype.copy=function(t){return sn.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Yl.prototype=Object.create(ns.prototype)).constructor=Yl).prototype.isLineDashedMaterial=!0,Yl.prototype.copy=function(t){return ns.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Xl=Object.freeze({__proto__:null,ShadowMaterial:Nl,SpriteMaterial:Ao,RawShaderMaterial:Fl,ShaderMaterial:sr,PointsMaterial:fs,MeshPhysicalMaterial:Hl,MeshStandardMaterial:Bl,MeshPhongMaterial:Ul,MeshToonMaterial:zl,MeshNormalMaterial:Vl,MeshLambertMaterial:Gl,MeshDepthMaterial:ao,MeshDistanceMaterial:oo,MeshBasicMaterial:ln,MeshMatcapMaterial:Wl,LineDashedMaterial:Yl,LineBasicMaterial:ns,Material:sn}),ql={arraySlice:function(t,e,i){return ql.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(i){for(var t=i.length,e=new Array(t),n=0;n!==t;++n)e[n]=n;return e.sort(function(t,e){return i[t]-i[e]}),e},sortedArray:function(t,e,i){for(var n=t.length,r=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=i[a]*e,l=0;l!==e;++l)r[o++]=t[s+l];return r},flattenJSON:function(t,e,i,n){for(var r=1,a=t[0];void 0!==a&&void 0===a[n];)a=t[r++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))for(;void 0!==(o=a[n])&&(e.push(a.time),i.push.apply(i,o)),void 0!==(a=t[r++]););else if(void 0!==o.toArray)for(;void 0!==(o=a[n])&&(e.push(a.time),o.toArray(i,i.length)),void 0!==(a=t[r++]););else for(;void 0!==(o=a[n])&&(e.push(a.time),i.push(o)),void 0!==(a=t[r++]););}},subclip:function(t,e,i,n,r){r=r||30;var a=t.clone();a.name=e;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],c=l.getValueSize(),h=[],u=[],d=0;d<l.times.length;++d){var p=l.times[d]*r;if(!(p<i||n<=p)){h.push(l.times[d]);for(var f=0;f<c;++f)u.push(l.values[d*c+f])}}0!==h.length&&(l.times=ql.convertArray(h,l.times.constructor),l.values=ql.convertArray(u,l.values.constructor),o.push(l))}a.tracks=o;var m=1/0;for(s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a}};function Jl(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function Zl(t,e,i,n){Jl.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ql(t,e,i,n){Jl.call(this,t,e,i,n)}function Kl(t,e,i,n){Jl.call(this,t,e,i,n)}function $l(t,e,i,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ql.convertArray(e,this.TimeBufferType),this.values=ql.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function tc(t,e,i){$l.call(this,t,e,i)}function ec(t,e,i,n){$l.call(this,t,e,i,n)}function ic(t,e,i,n){$l.call(this,t,e,i,n)}function nc(t,e,i,n){Jl.call(this,t,e,i,n)}function rc(t,e,i,n){$l.call(this,t,e,i,n)}function ac(t,e,i,n){$l.call(this,t,e,i,n)}function oc(t,e,i,n){$l.call(this,t,e,i,n)}function sc(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=Te.generateUUID(),this.duration<0&&this.resetDuration()}function lc(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ic;case"vector":case"vector2":case"vector3":case"vector4":return oc;case"color":return ec;case"quaternion":return rc;case"bool":case"boolean":return tc;case"string":return ac}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var i=[],n=[];ql.flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(Jl.prototype,{evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{var a;i:{n:if(!(t<n)){for(var o=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,r)}if(i===o)break;if(r=n,t<(n=e[++i]))break e}a=e.length;break i}if(r<=t)break t;var s=e[1];t<s&&(i=2,r=s);for(o=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===o)break;if(n=r,(r=e[--i-1])<=t)break e}a=i,i=0}for(;i<a;){var l=i+a>>>1;t<e[l]?a=l:i=l+1}if(n=e[i],void 0===(r=e[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n,a=0;a!==n;++a)e[a]=i[r+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Jl.prototype,{beforeStart_:Jl.prototype.copySampleValue_,afterEnd_:Jl.prototype.copySampleValue_}),Zl.prototype=Object.assign(Object.create(Jl.prototype),{constructor:Zl,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,i){var n=this.parameterPositions,r=t-2,a=t+1,o=n[r],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:r=t,o=2*e-i;break;case 2402:o=e+n[r=n.length-2]-n[r+1];break;default:r=t,o=i}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=t,s=2*i-e;break;case 2402:s=i+n[a=1]-n[0];break;default:a=t-1,s=e}var l=.5*(i-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-i),this._offsetPrev=r*c,this._offsetNext=a*c},interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f,b=0;b!==o;++b)r[b]=g*a[c+b]+v*a[l+b]+y*a[s+b]+_*a[h+b];return r}}),Ql.prototype=Object.assign(Object.create(Jl.prototype),{constructor:Ql,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,c=(i-e)/(n-e),h=1-c,u=0;u!==o;++u)r[u]=a[l+u]*h+a[s+u]*c;return r}}),Kl.prototype=Object.assign(Object.create(Jl.prototype),{constructor:Kl,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign($l,{toJSON:function(t){var e,i=t.constructor;if(void 0!==i.toJSON)e=i.toJSON(t);else{e={name:t.name,times:ql.convertArray(t.times,Array),values:ql.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e}}),Object.assign($l.prototype,{constructor:$l,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Kl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Ql(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Zl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)return this.createInterpolant=e,this;var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,n=i.length,r=0,a=n-1;r!==n&&i[r]<t;)++r;for(;-1!==a&&i[a]>e;)--a;if(++a,0!==r||a!==n){a<=r&&(r=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=ql.arraySlice(i,r,a),this.values=ql.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==r;o++){var s=i[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&s<a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==n&&ql.isTypedArray(n)){o=0;for(var l=n.length;o!==l;++o){var c=n[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=2302===this.getInterpolation(),r=1,a=t.length-1,o=1;o<a;++o){var s=!1,l=t[o];if(l!==t[o+1]&&(1!==o||l!==l[0]))if(n)s=!0;else for(var c=o*i,h=c-i,u=c+i,d=0;d!==i;++d){var p=e[c+d];if(p!==e[h+d]||p!==e[u+d]){s=!0;break}}if(s){if(o!==r){t[r]=t[o];var f=o*i,m=r*i;for(d=0;d!==i;++d)e[m+d]=e[f+d]}++r}}if(0<a){t[r]=t[a];for(f=a*i,m=r*i,d=0;d!==i;++d)e[m+d]=e[f+d];++r}return r!==t.length&&(this.times=ql.arraySlice(t,0,r),this.values=ql.arraySlice(e,0,r*i)),this},clone:function(){var t=ql.arraySlice(this.times,0),e=ql.arraySlice(this.values,0),i=new this.constructor(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}),tc.prototype=Object.assign(Object.create($l.prototype),{constructor:tc,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ec.prototype=Object.assign(Object.create($l.prototype),{constructor:ec,ValueTypeName:"color"}),ic.prototype=Object.assign(Object.create($l.prototype),{constructor:ic,ValueTypeName:"number"}),nc.prototype=Object.assign(Object.create(Jl.prototype),{constructor:nc,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=(i-e)/(n-e),c=s+o;s!==c;s+=4)Se.slerpFlat(r,0,a,s-o,a,s,l);return r}}),rc.prototype=Object.assign(Object.create($l.prototype),{constructor:rc,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new nc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ac.prototype=Object.assign(Object.create($l.prototype),{constructor:ac,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),oc.prototype=Object.assign(Object.create($l.prototype),{constructor:oc,ValueTypeName:"vector"}),Object.assign(sc,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),r=0,a=i.length;r!==a;++r)e.push(lc(i[r]).scale(n));return new sc(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},r=0,a=i.length;r!==a;++r)e.push($l.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(t,e,i,n){for(var r=e.length,a=[],o=0;o<r;o++){var s=[],l=[];s.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);var c=ql.getKeyframeOrder(s);s=ql.sortedArray(s,1,c),l=ql.sortedArray(l,1,c),n||0!==s[0]||(s.push(r),l.push(l[0])),a.push(new ic(".morphTargetInfluences["+e[o].name+"]",s,l).scale(1/i))}return new sc(t,-1,a)},findByName:function(t,e){var i=t;if(!Array.isArray(t)){var n=t;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],l=s.name.match(r);if(l&&1<l.length){var c=n[u=l[1]];c||(n[u]=c=[]),c.push(s)}}var h=[];for(var u in n)h.push(sc.CreateFromMorphTargetSequence(u,n[u],e,i));return h},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(t,e,i,n,r){if(0!==i.length){var a=[],o=[];ql.flattenJSON(i,a,o,n),0!==a.length&&r.push(new t(e,a,o))}},n=[],r=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.hierarchy||[],l=0;l<s.length;l++){var c=s[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h={},u=0;u<c.length;u++)if(c[u].morphTargets)for(var d=0;d<c[u].morphTargets.length;d++)h[c[u].morphTargets[d]]=-1;for(var p in h){var f=[],m=[];for(d=0;d!==c[u].morphTargets.length;++d){var g=c[u];f.push(g.time),m.push(g.morphTarget===p?1:0)}n.push(new ic(".morphTargetInfluence["+p+"]",f,m))}a=h.length*(o||1)}else{var v=".bones["+e[l].name+"]";i(oc,v+".position",c,"pos",n),i(rc,v+".quaternion",c,"rot",n),i(oc,v+".scale",c,"scl",n)}}return 0===n.length?null:new sc(r,a,n)}}),Object.assign(sc.prototype,{resetDuration:function(){for(var t=0,e=0,i=this.tracks.length;e!==i;++e){var n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new sc(this.name,this.duration,t)}});var cc={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function hc(t,e,i){var n=this,r=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){o++,!1===r&&void 0!==n.onStart&&n.onStart(t,a,o),r=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){var e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(var e=0,i=l.length;e<i;e+=2){var n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}var uc=new hc;function dc(t){this.manager=void 0!==t?t:uc,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(dc.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var pc={};function fc(t){dc.call(this,t)}function mc(t){dc.call(this,t)}function gc(t){dc.call(this,t)}function vc(t){dc.call(this,t)}function yc(t){dc.call(this,t)}function _c(t){dc.call(this,t)}function bc(t){dc.call(this,t)}function xc(){this.type="Curve",this.arcLengthDivisions=200}function wc(t,e,i,n,r,a,o,s){xc.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Tc(t,e,i,n,r,a){wc.call(this,t,e,i,i,n,r,a),this.type="ArcCurve"}function Mc(){var r=0,a=0,o=0,s=0;function c(t,e,i,n){o=-3*(r=t)+3*e-2*(a=i)-n,s=2*t-2*e+i+n}return{initCatmullRom:function(t,e,i,n,r){c(e,i,r*(i-t),r*(n-e))},initNonuniformCatmullRom:function(t,e,i,n,r,a,o){var s=(e-t)/r-(i-t)/(r+a)+(i-e)/a,l=(i-e)/a-(n-e)/(a+o)+(n-i)/o;c(e,i,s*=a,l*=a)},calc:function(t){var e=t*t;return r+a*t+o*e+s*(e*t)}}}fc.prototype=Object.assign(Object.create(dc.prototype),{constructor:fc,load:function(o,t,e,i){void 0===o&&(o=""),void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);var s=this,n=cc.get(o);if(void 0!==n)return s.manager.itemStart(o),setTimeout(function(){t&&t(n),s.manager.itemEnd(o)},0),n;if(void 0===pc[o]){var r=o.match(/^data:(.*?)(;base64)?,(.*)$/);if(r){var a=r[1],l=!!r[2],c=r[3];c=decodeURIComponent(c),l&&(c=atob(c));try{var h,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var d=new Uint8Array(c.length),p=0;p<c.length;p++)d[p]=c.charCodeAt(p);h="blob"===u?new Blob([d.buffer],{type:a}):d.buffer;break;case"document":var f=new DOMParser;h=f.parseFromString(c,a);break;case"json":h=JSON.parse(c);break;default:h=c}setTimeout(function(){t&&t(h),s.manager.itemEnd(o)},0)}catch(t){setTimeout(function(){i&&i(t),s.manager.itemError(o),s.manager.itemEnd(o)},0)}}else{pc[o]=[],pc[o].push({onLoad:t,onProgress:e,onError:i});var m=new XMLHttpRequest;for(var g in m.open("GET",o,!0),m.addEventListener("load",function(t){var e=this.response,i=pc[o];if(delete pc[o],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),cc.add(o,e);for(var n=0,r=i.length;n<r;n++){(a=i[n]).onLoad&&a.onLoad(e)}s.manager.itemEnd(o)}else{for(n=0,r=i.length;n<r;n++){var a;(a=i[n]).onError&&a.onError(t)}s.manager.itemError(o),s.manager.itemEnd(o)}},!1),m.addEventListener("progress",function(t){for(var e=pc[o],i=0,n=e.length;i<n;i++){var r=e[i];r.onProgress&&r.onProgress(t)}},!1),m.addEventListener("error",function(t){var e=pc[o];delete pc[o];for(var i=0,n=e.length;i<n;i++){var r=e[i];r.onError&&r.onError(t)}s.manager.itemError(o),s.manager.itemEnd(o)},!1),m.addEventListener("abort",function(t){var e=pc[o];delete pc[o];for(var i=0,n=e.length;i<n;i++){var r=e[i];r.onError&&r.onError(t)}s.manager.itemError(o),s.manager.itemEnd(o)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return s.manager.itemStart(o),m}pc[o].push({onLoad:t,onProgress:e,onError:i})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),mc.prototype=Object.assign(Object.create(dc.prototype),{constructor:mc,load:function(t,e,i,n){var r=this,a=new fc(r.manager);a.setPath(r.path),a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){for(var e=[],i=0;i<t.length;i++){var n=sc.parse(t[i]);e.push(n)}return e}}),gc.prototype=Object.assign(Object.create(dc.prototype),{constructor:gc,load:function(t,a,e,n){var o=this,s=[],l=new ws;l.image=s;var r=new fc(this.manager);function i(i){r.load(t[i],function(t){var e=o.parse(t,!0);s[i]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},6===(c+=1)&&(1===e.mipmapCount&&(l.minFilter=Yt),l.format=e.format,l.needsUpdate=!0,a&&a(l))},e,n)}if(r.setPath(this.path),r.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,h=0,u=t.length;h<u;++h)i(h);else r.load(t,function(t){var e=o.parse(t,!0);if(e.isCubemap)for(var i=e.mipmaps.length/e.mipmapCount,n=0;n<i;n++){s[n]={mipmaps:[]};for(var r=0;r<e.mipmapCount;r++)s[n].mipmaps.push(e.mipmaps[n*e.mipmapCount+r]),s[n].format=e.format,s[n].width=e.width,s[n].height=e.height}else l.image.width=e.width,l.image.height=e.height,l.mipmaps=e.mipmaps;1===e.mipmapCount&&(l.minFilter=Yt),l.format=e.format,l.needsUpdate=!0,a&&a(l)},e,n);return l}}),vc.prototype=Object.assign(Object.create(dc.prototype),{constructor:vc,load:function(t,i,e,n){var r=this,a=new dr,o=new fc(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(t,function(t){var e=r.parse(t);e&&(void 0!==e.image?a.image=e.image:void 0!==e.data&&(a.image.width=e.width,a.image.height=e.height,a.image.data=e.data),a.wrapS=void 0!==e.wrapS?e.wrapS:U,a.wrapT=void 0!==e.wrapT?e.wrapT:U,a.magFilter=void 0!==e.magFilter?e.magFilter:Yt,a.minFilter=void 0!==e.minFilter?e.minFilter:Yt,a.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.format&&(a.format=e.format),void 0!==e.type&&(a.type=e.type),void 0!==e.mipmaps&&(a.mipmaps=e.mipmaps,a.minFilter=qt),1===e.mipmapCount&&(a.minFilter=Yt),a.needsUpdate=!0,i&&i(a,e))},e,n),a}}),yc.prototype=Object.assign(Object.create(dc.prototype),{constructor:yc,load:function(e,t,i,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=cc.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),cc.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}),_c.prototype=Object.assign(Object.create(dc.prototype),{constructor:_c,load:function(t,i,e,n){var r=new Dr,a=new yc(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(e){a.load(t[e],function(t){r.images[e]=t,6===++o&&(r.needsUpdate=!0,i&&i(r))},void 0,n)}for(var l=0;l<t.length;++l)s(l);return r}}),bc.prototype=Object.assign(Object.create(dc.prototype),{constructor:bc,load:function(i,n,t,e){var r=new De,a=new yc(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(i,function(t){r.image=t;var e=0<i.search(/\.jpe?g($|\?)/i)||0===i.search(/^data\:image\/jpeg/);r.format=e?ee:ie,r.needsUpdate=!0,void 0!==n&&n(r)},t,e),r}}),Object.assign(xc.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),a=0;for(n.push(0),i=1;i<=t;i++)a+=(e=this.getPoint(i/t)).distanceTo(r),n.push(a),r=e;return this.cacheArcLengths=n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,n=this.getLengths(),r=0,a=n.length;i=e||t*n[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=n[r=Math.floor(s+(l-s)/2)]-i)<0)s=r+1;else{if(!(0<o)){l=r;break}l=r-1}if(n[r=l]===i)return r/(a-1);var c=n[r];return(r+(i-c)/(n[r+1]-c))/(a-1)},getTangent:function(t){var e=t-1e-4,i=t+1e-4;e<0&&(e=0),1<i&&(i=1);var n=this.getPoint(e);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var i,n,r,a=new Le,o=[],s=[],l=[],c=new Le,h=new We;for(i=0;i<=t;i++)n=i/t,o[i]=this.getTangentAt(n),o[i].normalize();s[0]=new Le,l[0]=new Le;var u=Number.MAX_VALUE,d=Math.abs(o[0].x),p=Math.abs(o[0].y),f=Math.abs(o[0].z);for(d<=u&&(u=d,a.set(1,0,0)),p<=u&&(u=p,a.set(0,1,0)),f<=u&&a.set(0,0,1),c.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],c),l[0].crossVectors(o[0],s[0]),i=1;i<=t;i++)s[i]=s[i-1].clone(),l[i]=l[i-1].clone(),c.crossVectors(o[i-1],o[i]),c.length()>Number.EPSILON&&(c.normalize(),r=Math.acos(Te.clamp(o[i-1].dot(o[i]),-1,1)),s[i].applyMatrix4(h.makeRotationAxis(c,r))),l[i].crossVectors(o[i],s[i]);if(!0===e)for(r=Math.acos(Te.clamp(s[0].dot(s[t]),-1,1)),r/=t,0<o[0].dot(c.crossVectors(s[0],s[t]))&&(r=-r),i=1;i<=t;i++)s[i].applyMatrix4(h.makeRotationAxis(o[i],r*i)),l[i].crossVectors(o[i],s[i]);return{tangents:o,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),((wc.prototype=Object.create(xc.prototype)).constructor=wc).prototype.isEllipseCurve=!0,wc.prototype.getPoint=function(t,e){for(var i=e||new Me,n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;r<0;)r+=n;for(;n<r;)r-=n;r<Number.EPSILON&&(r=a?0:n),!0!==this.aClockwise||a||(r===n?r=-n:r-=n);var o=this.aStartAngle+t*r,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=s-this.aX,d=l-this.aY;s=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return i.set(s,l)},wc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},wc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},wc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},((Tc.prototype=Object.create(wc.prototype)).constructor=Tc).prototype.isArcCurve=!0;var Sc=new Le,Ec=new Mc,Cc=new Mc,Lc=new Mc;function Ac(t,e,i,n){xc.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=i||"centripetal",this.tension=n||.5}function Pc(t,e,i,n,r){var a=.5*(n-e),o=.5*(r-i),s=t*t;return(2*i-2*n+a+o)*(t*s)+(-3*i+3*n-2*a-o)*s+a*t+i}function Rc(t,e,i,n){return(o=1-t)*o*e+2*(1-(a=t))*a*i+(r=t)*r*n;var r,a,o}function Oc(t,e,i,n,r){return(c=1-t)*c*c*e+3*(l=1-(s=t))*l*s*i+3*(1-(o=t))*o*o*n+(a=t)*a*a*r;var a,o,s,l,c}function Ic(t,e,i,n){xc.call(this),this.type="CubicBezierCurve",this.v0=t||new Me,this.v1=e||new Me,this.v2=i||new Me,this.v3=n||new Me}function Dc(t,e,i,n){xc.call(this),this.type="CubicBezierCurve3",this.v0=t||new Le,this.v1=e||new Le,this.v2=i||new Le,this.v3=n||new Le}function jc(t,e){xc.call(this),this.type="LineCurve",this.v1=t||new Me,this.v2=e||new Me}function kc(t,e){xc.call(this),this.type="LineCurve3",this.v1=t||new Le,this.v2=e||new Le}function Nc(t,e,i){xc.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Me,this.v1=e||new Me,this.v2=i||new Me}function Fc(t,e,i){xc.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Le,this.v1=e||new Le,this.v2=i||new Le}function Bc(t){xc.call(this),this.type="SplineCurve",this.points=t||[]}((Ac.prototype=Object.create(xc.prototype)).constructor=Ac).prototype.isCatmullRomCurve3=!0,Ac.prototype.getPoint=function(t,e){var i,n,r,a,o=e||new Le,s=this.points,l=s.length,c=(l-(this.closed?0:1))*t,h=Math.floor(c),u=c-h;if(this.closed?h+=0<h?0:(Math.floor(Math.abs(h)/l)+1)*l:0===u&&h===l-1&&(h=l-2,u=1),i=this.closed||0<h?s[(h-1)%l]:(Sc.subVectors(s[0],s[1]).add(s[0]),Sc),n=s[h%l],r=s[(h+1)%l],a=this.closed||h+2<l?s[(h+2)%l]:(Sc.subVectors(s[l-1],s[l-2]).add(s[l-1]),Sc),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(i.distanceToSquared(n),d),f=Math.pow(n.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(a),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Ec.initNonuniformCatmullRom(i.x,n.x,r.x,a.x,p,f,m),Cc.initNonuniformCatmullRom(i.y,n.y,r.y,a.y,p,f,m),Lc.initNonuniformCatmullRom(i.z,n.z,r.z,a.z,p,f,m)}else"catmullrom"===this.curveType&&(Ec.initCatmullRom(i.x,n.x,r.x,a.x,this.tension),Cc.initCatmullRom(i.y,n.y,r.y,a.y,this.tension),Lc.initCatmullRom(i.z,n.z,r.z,a.z,this.tension));return o.set(Ec.calc(u),Cc.calc(u),Lc.calc(u)),o},Ac.prototype.copy=function(t){xc.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Ac.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Ac.prototype.fromJSON=function(t){xc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new Le).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},((Ic.prototype=Object.create(xc.prototype)).constructor=Ic).prototype.isCubicBezierCurve=!0,Ic.prototype.getPoint=function(t,e){var i=e||new Me,n=this.v0,r=this.v1,a=this.v2,o=this.v3;return i.set(Oc(t,n.x,r.x,a.x,o.x),Oc(t,n.y,r.y,a.y,o.y)),i},Ic.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Ic.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Ic.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((Dc.prototype=Object.create(xc.prototype)).constructor=Dc).prototype.isCubicBezierCurve3=!0,Dc.prototype.getPoint=function(t,e){var i=e||new Le,n=this.v0,r=this.v1,a=this.v2,o=this.v3;return i.set(Oc(t,n.x,r.x,a.x,o.x),Oc(t,n.y,r.y,a.y,o.y),Oc(t,n.z,r.z,a.z,o.z)),i},Dc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Dc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Dc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((jc.prototype=Object.create(xc.prototype)).constructor=jc).prototype.isLineCurve=!0,jc.prototype.getPoint=function(t,e){var i=e||new Me;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},jc.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},jc.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},jc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},jc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},jc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((kc.prototype=Object.create(xc.prototype)).constructor=kc).prototype.isLineCurve3=!0,kc.prototype.getPoint=function(t,e){var i=e||new Le;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},kc.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},kc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},kc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},kc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((Nc.prototype=Object.create(xc.prototype)).constructor=Nc).prototype.isQuadraticBezierCurve=!0,Nc.prototype.getPoint=function(t,e){var i=e||new Me,n=this.v0,r=this.v1,a=this.v2;return i.set(Rc(t,n.x,r.x,a.x),Rc(t,n.y,r.y,a.y)),i},Nc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Nc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Nc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((Fc.prototype=Object.create(xc.prototype)).constructor=Fc).prototype.isQuadraticBezierCurve3=!0,Fc.prototype.getPoint=function(t,e){var i=e||new Le,n=this.v0,r=this.v1,a=this.v2;return i.set(Rc(t,n.x,r.x,a.x),Rc(t,n.y,r.y,a.y),Rc(t,n.z,r.z,a.z)),i},Fc.prototype.copy=function(t){return xc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Fc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Fc.prototype.fromJSON=function(t){return xc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((Bc.prototype=Object.create(xc.prototype)).constructor=Bc).prototype.isSplineCurve=!0,Bc.prototype.getPoint=function(t,e){var i=e||new Me,n=this.points,r=(n.length-1)*t,a=Math.floor(r),o=r-a,s=n[0===a?a:a-1],l=n[a],c=n[a>n.length-2?n.length-1:a+1],h=n[a>n.length-3?n.length-1:a+2];return i.set(Pc(o,s.x,l.x,c.x,h.x),Pc(o,s.y,l.y,c.y,h.y)),i},Bc.prototype.copy=function(t){xc.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push(n.clone())}return this},Bc.prototype.toJSON=function(){var t=xc.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var n=this.points[e];t.points.push(n.toArray())}return t},Bc.prototype.fromJSON=function(t){xc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new Me).fromArray(n))}return this};var Hc=Object.freeze({__proto__:null,ArcCurve:Tc,CatmullRomCurve3:Ac,CubicBezierCurve:Ic,CubicBezierCurve3:Dc,EllipseCurve:wc,LineCurve:jc,LineCurve3:kc,QuadraticBezierCurve:Nc,QuadraticBezierCurve3:Fc,SplineCurve:Bc});function Uc(){xc.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function zc(t){Uc.call(this),this.type="Path",this.currentPoint=new Me,t&&this.setFromPoints(t)}function Vc(t){zc.call(this,t),this.uuid=Te.generateUUID(),this.type="Shape",this.holes=[]}function Gc(t,e){ci.call(this),this.type="Light",this.color=new tn(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Wc(t,e,i){Gc.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ci.DefaultUp),this.updateMatrix(),this.groundColor=new tn(e)}function Yc(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Me(512,512),this.map=null,this.mapPass=null,this.matrix=new We,this._frustum=new mr,this._frameExtents=new Me(1,1),this._viewportCount=1,this._viewports=[new je(0,0,1,1)]}function Xc(){Yc.call(this,new cr(50,1,.5,500))}function qc(t,e,i,n,r,a){Gc.call(this,t,e),this.type="SpotLight",this.position.copy(ci.DefaultUp),this.updateMatrix(),this.target=new ci,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new Xc}function Jc(){Yc.call(this,new cr(90,1,.5,500)),this._frameExtents=new Me(4,2),this._viewportCount=6,this._viewports=[new je(2,1,1,1),new je(0,1,1,1),new je(3,1,1,1),new je(1,1,1,1),new je(3,0,1,1),new je(1,0,1,1)],this._cubeDirections=[new Le(1,0,0),new Le(-1,0,0),new Le(0,0,1),new Le(0,0,-1),new Le(0,1,0),new Le(0,-1,0)],this._cubeUps=[new Le(0,1,0),new Le(0,1,0),new Le(0,1,0),new Le(0,1,0),new Le(0,0,1),new Le(0,0,-1)]}function Zc(t,e,i,n){Gc.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new Jc}function Qc(t,e,i,n,r,a){lr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==i?i:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function Kc(){Yc.call(this,new Qc(-5,5,5,-5,.5,500))}function $c(t,e){Gc.call(this,t,e),this.type="DirectionalLight",this.position.copy(ci.DefaultUp),this.updateMatrix(),this.target=new ci,this.shadow=new Kc}function th(t,e){Gc.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function eh(t,e,i,n){Gc.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function ih(t){dc.call(this,t),this.textures={}}Uc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Uc,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new jc(e,t))},getPoint:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e){var r=i[n]-e,a=this.curves[n],o=a.getLength(),s=0===o?0:1-r/o;return a.getPointAt(s)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,r=this.curves;n<r.length;n++)for(var a=r[n],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),l=0;l<s.length;l++){var c=s[l];e&&e.equals(c)||(i.push(c),e=c)}return this.autoClose&&1<i.length&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){xc.prototype.copy.call(this,t),this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=xc.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,i=this.curves.length;e<i;e++){var n=this.curves[e];t.curves.push(n.toJSON())}return t},fromJSON:function(t){xc.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push((new Hc[n.type]).fromJSON(n))}return this}}),zc.prototype=Object.assign(Object.create(Uc.prototype),{constructor:zc,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var i=new jc(this.currentPoint.clone(),new Me(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,i,n){var r=new Nc(this.currentPoint.clone(),new Me(t,e),new Me(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this},bezierCurveTo:function(t,e,i,n,r,a){var o=new Ic(this.currentPoint.clone(),new Me(t,e),new Me(i,n),new Me(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this},splineThru:function(t){var e=new Bc([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,i,n,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,i,n,r,a),this},absarc:function(t,e,i,n,r,a){return this.absellipse(t,e,i,i,n,r,a),this},ellipse:function(t,e,i,n,r,a,o,s){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,i,n,r,a,o,s),this},absellipse:function(t,e,i,n,r,a,o,s){var l=new wc(t,e,i,n,r,a,o,s);if(0<this.curves.length){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var h=l.getPoint(1);return this.currentPoint.copy(h),this},copy:function(t){return Uc.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Uc.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Uc.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Vc.prototype=Object.assign(Object.create(zc.prototype),{constructor:Vc,getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){zc.prototype.copy.call(this,t),this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push(n.clone())}return this},toJSON:function(){var t=zc.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,i=this.holes.length;e<i;e++){var n=this.holes[e];t.holes.push(n.toJSON())}return t},fromJSON:function(t){zc.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push((new zc).fromJSON(n))}return this}}),Gc.prototype=Object.assign(Object.create(ci.prototype),{constructor:Gc,isLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=ci.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Wc.prototype=Object.assign(Object.create(Gc.prototype),{constructor:Wc,isHemisphereLight:!0,copy:function(t){return Gc.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Yc.prototype,{_projScreenMatrix:new We,_lightPositionWorld:new Le,_lookTarget:new Le,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,i=this.matrix,n=this._projScreenMatrix,r=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),e.position.copy(a),r.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(r),e.updateMatrixWorld(),n.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromMatrix(n),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(e.projectionMatrix),i.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Xc.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Xc,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,i=2*Te.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;i===e.fov&&n===e.aspect&&r===e.far||(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix()),Yc.prototype.updateMatrices.call(this,t)}}),qc.prototype=Object.assign(Object.create(Gc.prototype),{constructor:qc,isSpotLight:!0,copy:function(t){return Gc.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Jc.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Jc,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var i=this.camera,n=this.matrix,r=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;r.setFromMatrixPosition(t.matrixWorld),i.position.copy(r),a.copy(i.position),a.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(a),i.updateMatrixWorld(),n.makeTranslation(-r.x,-r.y,-r.z),o.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromMatrix(o)}}),Zc.prototype=Object.assign(Object.create(Gc.prototype),{constructor:Zc,isPointLight:!0,copy:function(t){return Gc.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Qc.prototype=Object.assign(Object.create(lr.prototype),{constructor:Qc,isOrthographicCamera:!0,copy:function(t,e){return lr.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,a=i+t,o=n+e,s=n-e;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;a=(r+=h*(this.view.offsetX/l))+h*(this.view.width/l),s=(o-=u*(this.view.offsetY/c))-u*(this.view.height/c)}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=ci.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Kc.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Kc,isDirectionalLightShadow:!0,updateMatrices:function(t){Yc.prototype.updateMatrices.call(this,t)}}),$c.prototype=Object.assign(Object.create(Gc.prototype),{constructor:$c,isDirectionalLight:!0,copy:function(t){return Gc.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),th.prototype=Object.assign(Object.create(Gc.prototype),{constructor:th,isAmbientLight:!0}),eh.prototype=Object.assign(Object.create(Gc.prototype),{constructor:eh,isRectAreaLight:!0,copy:function(t){return Gc.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=Gc.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),ih.prototype=Object.assign(Object.create(dc.prototype),{constructor:ih,load:function(t,e,i,n){var r=this,a=new fc(r.manager);a.setPath(r.path),a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=this.textures;function i(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var n=new Xl[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.sheen&&(n.sheen=(new tn).setHex(t.sheen)),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearcoat&&(n.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(n.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(n.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(n.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(n.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(n.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(n.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(n.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(n.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(n.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(n.morphNormals=t.morphNormals),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.toneMapped&&(n.toneMapped=t.toneMapped),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.uniforms)for(var r in t.uniforms){var a=t.uniforms[r];switch(n.uniforms[r]={},a.type){case"t":n.uniforms[r].value=i(a.value);break;case"c":n.uniforms[r].value=(new tn).setHex(a.value);break;case"v2":n.uniforms[r].value=(new Me).fromArray(a.value);break;case"v3":n.uniforms[r].value=(new Le).fromArray(a.value);break;case"v4":n.uniforms[r].value=(new je).fromArray(a.value);break;case"m3":n.uniforms[r].value=(new Re).fromArray(a.value);case"m4":n.uniforms[r].value=(new We).fromArray(a.value);break;default:n.uniforms[r].value=a.value}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var o in t.extensions)n.extensions[o]=t.extensions[o];if(void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=i(t.map)),void 0!==t.matcap&&(n.matcap=i(t.matcap)),void 0!==t.alphaMap&&(n.alphaMap=i(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=i(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=i(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),n.normalScale=(new Me).fromArray(s)}return void 0!==t.displacementMap&&(n.displacementMap=i(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=i(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=i(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=i(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=i(t.specularMap)),void 0!==t.envMap&&(n.envMap=i(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(n.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(n.lightMap=i(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=i(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=i(t.gradientMap)),void 0!==t.clearcoatNormalMap&&(n.clearcoatNormalMap=i(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(n.clearcoatNormalScale=(new Me).fromArray(t.clearcoatNormalScale)),n},setTextures:function(t){return this.textures=t,this}});var nh={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",i=0,n=t.length;i<n;i++)e+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function rh(){Ln.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ah(t,e,i,n){"number"==typeof i&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),cn.call(this,t,e,i),this.meshPerAttribute=n||1}function oh(t){dc.call(this,t)}rh.prototype=Object.assign(Object.create(Ln.prototype),{constructor:rh,isInstancedBufferGeometry:!0,copy:function(t){return Ln.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=Ln.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),ah.prototype=Object.assign(Object.create(cn.prototype),{constructor:ah,isInstancedBufferAttribute:!0,copy:function(t){return cn.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=cn.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),oh.prototype=Object.assign(Object.create(dc.prototype),{constructor:oh,load:function(t,e,i,n){var r=this,a=new fc(r.manager);a.setPath(r.path),a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=t.isInstancedBufferGeometry?new rh:new Ln,i=t.data.index;if(void 0!==i){var n=new sh[i.type](i.array);e.setIndex(new cn(n,1))}var r=t.data.attributes;for(var a in r){var o=r[a],s=(n=new sh[o.type](o.array),new(o.isInstancedBufferAttribute?ah:cn)(n,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),e.setAttribute(a,s)}var l=t.data.morphAttributes;if(l)for(var a in l){for(var c=l[a],h=[],u=0,d=c.length;u<d;u++){o=c[u],s=new cn(n=new sh[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),h.push(s)}e.morphAttributes[a]=h}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var p=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==p){u=0;for(var f=p.length;u!==f;++u){var m=p[u];e.addGroup(m.start,m.count,m.materialIndex)}}var g=t.data.boundingSphere;if(void 0!==g){var v=new Le;void 0!==g.center&&v.fromArray(g.center),e.boundingSphere=new Ci(v,g.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var sh={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function lh(t){dc.call(this,t)}lh.prototype=Object.assign(Object.create(dc.prototype),{constructor:lh,load:function(n,r,t,a){var o=this,e=""===this.path?nh.extractUrlBase(n):this.path;this.resourcePath=this.resourcePath||e;var i=new fc(o.manager);i.setPath(this.path),i.load(n,function(t){var e=null;try{e=JSON.parse(t)}catch(t){return void 0!==a&&a(t),void console.error("THREE:ObjectLoader: Can't parse "+n+".",t.message)}var i=e.metadata;void 0!==i&&void 0!==i.type&&"geometry"!==i.type.toLowerCase()?o.parse(e,r):console.error("THREE.ObjectLoader: Can't load "+n)},t,a)},parse:function(t,e){var i=this.parseShape(t.shapes),n=this.parseGeometries(t.geometries,i),r=this.parseImages(t.images,function(){void 0!==e&&e(s)}),a=this.parseTextures(t.textures,r),o=this.parseMaterials(t.materials,a),s=this.parseObject(t.object,n,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var i=0,n=t.length;i<n;i++){var r=(new Vc).fromJSON(t[i]);e[r.uuid]=r}return e},parseGeometries:function(t,e){var i={};if(void 0!==t)for(var n=new oh,r=0,a=t.length;r<a;r++){var o,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new kl[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new kl[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new kl[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new kl[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new kl[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new kl[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new kl[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new kl[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new kl[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new kl[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new kl[s.type]((new Hc[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new kl[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new kl[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],c=0,h=s.shapes.length;c<h;c++){var u=e[s.shapes[c]];l.push(u)}o=new kl[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],c=0,h=s.shapes.length;c<h;c++){u=e[s.shapes[c]];l.push(u)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new Hc[d.type]).fromJSON(d)),o=new kl[s.type](l,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=n.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)o=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),i[s.uuid]=o}return i},parseMaterials:function(t,e){var i={},n={};if(void 0!==t){var r=new ih;r.setTextures(e);for(var a=0,o=t.length;a<o;a++){var s=t[a];if("MultiMaterial"===s.type){for(var l=[],c=0;c<s.materials.length;c++){var h=s.materials[c];void 0===i[h.uuid]&&(i[h.uuid]=r.parse(h)),l.push(i[h.uuid])}n[s.uuid]=l}else void 0===i[s.uuid]&&(i[s.uuid]=r.parse(s)),n[s.uuid]=i[s.uuid]}}return n},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],r=sc.parse(n);void 0!==n.uuid&&(r.uuid=n.uuid),e.push(r)}return e},parseImages:function(t,e){var i=this,n={};function r(t){return i.manager.itemStart(t),a.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemError(t),i.manager.itemEnd(t)})}if(void 0!==t&&0<t.length){var a=new yc(new hc(e));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var l=t[o],c=l.url;if(Array.isArray(c)){n[l.uuid]=[];for(var h=0,u=c.length;h<u;h++){var d=c[h],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:i.resourcePath+d;n[l.uuid].push(r(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:i.resourcePath+l.url;n[l.uuid]=r(p)}}}return n},parseTextures:function(t,e){function i(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var r=0,a=t.length;r<a;r++){var o,s=t[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(e[s.image])?new Dr(e[s.image]):new De(e[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=i(s.mapping,hh)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=i(s.wrap[0],uh),o.wrapT=i(s.wrap[1],uh)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=i(s.minFilter,dh)),void 0!==s.magFilter&&(o.magFilter=i(s.magFilter,dh)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),n[s.uuid]=o}return n},parseObject:function(t,e,a){var i;function n(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function r(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];void 0===a[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),e.push(a[r])}return e}return void 0===a[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),a[t]}}switch(t.type){case"Scene":i=new hi,void 0!==t.background&&Number.isInteger(t.background)&&(i.background=new tn(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?i.fog=new Eo(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(i.fog=new So(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new cr(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(i.focus=t.focus),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.filmGauge&&(i.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(i.filmOffset=t.filmOffset),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"OrthographicCamera":i=new Qc(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"AmbientLight":i=new th(t.color,t.intensity);break;case"DirectionalLight":i=new $c(t.color,t.intensity);break;case"PointLight":i=new Zc(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new eh(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new qc(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new Wc(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=n(t.geometry),s=r(t.material);i=o.bones&&0<o.bones.length?new Xo(o,s):new Yn(o,s);break;case"InstancedMesh":o=n(t.geometry),s=r(t.material);var l=t.count,c=t.instanceMatrix;(i=new is(o,s,l)).instanceMatrix=new cn(new Float32Array(c.array),16);break;case"LOD":i=new Yo;break;case"Line":i=new cs(n(t.geometry),r(t.material),t.mode);break;case"LineLoop":i=new ps(n(t.geometry),r(t.material));break;case"LineSegments":i=new ds(n(t.geometry),r(t.material));break;case"PointCloud":case"Points":i=new _s(n(t.geometry),r(t.material));break;case"Sprite":i=new zo(r(t.material));break;case"Group":i=new go;break;default:i=new ci}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(i.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(i.matrixAutoUpdate=t.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.quaternion&&i.quaternion.fromArray(t.quaternion),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.castShadow&&(i.castShadow=t.castShadow),void 0!==t.receiveShadow&&(i.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(i.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(i.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&i.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(i.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.frustumCulled&&(i.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(i.renderOrder=t.renderOrder),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.layers&&(i.layers.mask=t.layers),void 0!==t.drawMode&&i.setDrawMode(t.drawMode),void 0!==t.children)for(var h=t.children,u=0;u<h.length;u++)i.add(this.parseObject(h[u],e,a));if("LOD"===t.type){void 0!==t.autoUpdate&&(i.autoUpdate=t.autoUpdate);for(var d=t.levels,p=0;p<d.length;p++){var f=d[p],m=i.getObjectByProperty("uuid",f.object);void 0!==m&&i.addLevel(m,f.distance)}}return i}});var ch,hh={UVMapping:300,CubeReflectionMapping:kt,CubeRefractionMapping:Nt,EquirectangularReflectionMapping:Ft,EquirectangularRefractionMapping:Bt,SphericalReflectionMapping:Ht,CubeUVReflectionMapping:Ut,CubeUVRefractionMapping:zt},uh={RepeatWrapping:H,ClampToEdgeWrapping:U,MirroredRepeatWrapping:z},dh={NearestFilter:Vt,NearestMipmapNearestFilter:Gt,NearestMipmapLinearFilter:Wt,LinearFilter:Yt,LinearMipmapNearestFilter:Xt,LinearMipmapLinearFilter:qt};function ph(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),dc.call(this,t),this.options=void 0}function fh(){this.type="ShapePath",this.color=new tn,this.subPaths=[],this.currentPath=null}function mh(t){this.type="Font",this.data=t}function gh(t,e,i,n,r){var a=r.glyphs[t]||r.glyphs["?"];if(a){var o,s,l,c,h,u,d,p,f=new fh;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":o=m[g++]*e+i,s=m[g++]*e+n,f.moveTo(o,s);break;case"l":o=m[g++]*e+i,s=m[g++]*e+n,f.lineTo(o,s);break;case"q":l=m[g++]*e+i,c=m[g++]*e+n,h=m[g++]*e+i,u=m[g++]*e+n,f.quadraticCurveTo(h,u,l,c);break;case"b":l=m[g++]*e+i,c=m[g++]*e+n,h=m[g++]*e+i,u=m[g++]*e+n,d=m[g++]*e+i,p=m[g++]*e+n,f.bezierCurveTo(h,u,d,p,l,c)}}return{offsetX:a.ha*e,path:f}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+r.familyName+".")}function vh(t){dc.call(this,t)}ph.prototype=Object.assign(Object.create(dc.prototype),{constructor:ph,setOptions:function(t){return this.options=t,this},load:function(e,i,t,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=cc.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout(function(){i&&i(a),r.manager.itemEnd(e)},0),a;fetch(e).then(function(t){return t.blob()}).then(function(t){return void 0===r.options?createImageBitmap(t):createImageBitmap(t,r.options)}).then(function(t){cc.add(e,t),i&&i(t),r.manager.itemEnd(e)}).catch(function(t){n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}),r.manager.itemStart(e)}}),Object.assign(fh.prototype,{moveTo:function(t,e){return this.currentPath=new zc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,i,n){return this.currentPath.quadraticCurveTo(t,e,i,n),this},bezierCurveTo:function(t,e,i,n,r,a){return this.currentPath.bezierCurveTo(t,e,i,n,r,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i],a=new Vc;a.curves=r.curves,e.push(a)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,a=0;a<i;r=a++){var o=e[r],s=e[a],l=s.x-o.x,c=s.y-o.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(o=e[a],l=-l,s=e[r],c=-c),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var h=c*(t.x-o.x)-l*(t.y-o.y);if(0===h)return!0;if(h<0)continue;n=!n}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return n}var r=ul.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return i(a);var o,s,l,c=[];if(1===a.length)return s=a[0],(l=new Vc).curves=s.curves,c.push(l),c;var h=!r(a[0].getPoints());h=t?!h:h;var u,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=r(u=(s=a[v]).getPoints()),(o=t?!o:o)?(!h&&f[g]&&g++,f[g]={s:new Vc,p:u},f[g].s.curves=s.curves,h&&g++,m[g]=[]):m[g].push({h:s,p:u[0]});if(!f[0])return i(a);if(1<f.length){for(var _=!1,b=[],x=0,w=f.length;x<w;x++)p[x]=[];for(x=0,w=f.length;x<w;x++)for(var T=m[x],M=0;M<T.length;M++){for(var S=T[M],E=!0,C=0;C<f.length;C++)n(S.p,f[C].p)&&(x!==C&&b.push({froms:x,tos:C,hole:M}),E?(E=!1,p[C].push(S)):_=!0);E&&p[x].push(S)}0<b.length&&(_||(m=p))}v=0;for(var L=f.length;v<L;v++){l=f[v].s,c.push(l);for(var A=0,P=(d=m[v]).length;A<P;A++)l.holes.push(d[A].h)}return c}}),Object.assign(mh.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var i=[],n=function(t,e,i){for(var n=Array.from?Array.from(t):String(t).split(""),r=e/i.resolution,a=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*r,o=[],s=0,l=0,c=0;c<n.length;c++){var h=n[c];if("\n"===h)s=0,l-=a;else{var u=gh(h,r,s,l,i);s+=u.offsetX,o.push(u.path)}}return o}(t,e,this.data),r=0,a=n.length;r<a;r++)Array.prototype.push.apply(i,n[r].toShapes());return i}}),vh.prototype=Object.assign(Object.create(dc.prototype),{constructor:vh,load:function(t,n,e,i){var r=this,a=new fc(this.manager);a.setPath(this.path),a.load(t,function(e){var i;try{i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}var t=r.parse(i);n&&n(t)},e,i)},parse:function(t){return new mh(t)}});var yh={getContext:function(){return void 0===ch&&(ch=new(window.AudioContext||window.webkitAudioContext)),ch},setContext:function(t){ch=t}};function _h(t){dc.call(this,t)}function bh(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Le)}function xh(t,e){Gc.call(this,void 0,e),this.sh=void 0!==t?t:new bh}function wh(t,e,i){xh.call(this,void 0,i);var n=(new tn).set(t),r=(new tn).set(e),a=new Le(n.r,n.g,n.b),o=new Le(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}function Th(t,e){xh.call(this,void 0,e);var i=(new tn).set(t);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}_h.prototype=Object.assign(Object.create(dc.prototype),{constructor:_h,load:function(t,i,e,n){var r=new fc(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(t,function(t){var e=t.slice(0);yh.getContext().decodeAudioData(e,function(t){i(t)})},e,n)}}),Object.assign(bh.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var i=t.x,n=t.y,r=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.282095),e.addScale(a[1],.488603*n),e.addScale(a[2],.488603*r),e.addScale(a[3],.488603*i),e.addScale(a[4],i*n*1.092548),e.addScale(a[5],n*r*1.092548),e.addScale(a[6],.315392*(3*r*r-1)),e.addScale(a[7],i*r*1.092548),e.addScale(a[8],.546274*(i*i-n*n)),e},getIrradianceAt:function(t,e){var i=t.x,n=t.y,r=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.886227),e.addScale(a[1],1.023328*n),e.addScale(a[2],1.023328*r),e.addScale(a[3],1.023328*i),e.addScale(a[4],.858086*i*n),e.addScale(a[5],.858086*n*r),e.addScale(a[6],.743125*r*r-.247708),e.addScale(a[7],.858086*i*r),e.addScale(a[8],.429043*(i*i-n*n)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var i=0;i<9;i++)this.coefficients[i].lerp(t.coefficients[i],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var i=this.coefficients,n=0;n<9;n++)i[n].fromArray(t,e+3*n);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var i=this.coefficients,n=0;n<9;n++)i[n].toArray(t,e+3*n);return t}}),Object.assign(bh,{getBasisAt:function(t,e){var i=t.x,n=t.y,r=t.z;e[0]=.282095,e[1]=.488603*n,e[2]=.488603*r,e[3]=.488603*i,e[4]=1.092548*i*n,e[5]=1.092548*n*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*i*r,e[8]=.546274*(i*i-n*n)}}),xh.prototype=Object.assign(Object.create(Gc.prototype),{constructor:xh,isLightProbe:!0,copy:function(t){return Gc.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return Gc.prototype.toJSON.call(this,t)}}),wh.prototype=Object.assign(Object.create(xh.prototype),{constructor:wh,isHemisphereLightProbe:!0,copy:function(t){return xh.prototype.copy.call(this,t),this},toJSON:function(t){return xh.prototype.toJSON.call(this,t)}}),Th.prototype=Object.assign(Object.create(xh.prototype),{constructor:Th,isAmbientLightProbe:!0,copy:function(t){return xh.prototype.copy.call(this,t),this},toJSON:function(t){return xh.prototype.toJSON.call(this,t)}});var Mh=new We,Sh=new We;function Eh(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new cr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new cr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Ch(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(Eh.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var i,n,r=t.projectionMatrix.clone(),a=e.eyeSep/2,o=a*e.near/e.focus,s=e.near*Math.tan(Te.DEG2RAD*e.fov*.5)/e.zoom;Sh.elements[12]=-a,Mh.elements[12]=a,i=-s*e.aspect+o,n=s*e.aspect+o,r.elements[0]=2*e.near/(n-i),r.elements[8]=(n+i)/(n-i),this.cameraL.projectionMatrix.copy(r),i=-s*e.aspect-o,n=s*e.aspect-o,r.elements[0]=2*e.near/(n-i),r.elements[8]=(n+i)/(n-i),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Sh),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Mh)}}),Object.assign(Ch.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var Lh=new Le,Ah=new Se,Ph=new Le,Rh=new Le;function Oh(){ci.call(this),this.type="AudioListener",this.context=yh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Ch}function Ih(t){ci.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}Oh.prototype=Object.assign(Object.create(ci.prototype),{constructor:Oh,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){ci.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Lh,Ah,Ph),Rh.set(0,0,-1).applyQuaternion(Ah),e.positionX){var n=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Lh.x,n),e.positionY.linearRampToValueAtTime(Lh.y,n),e.positionZ.linearRampToValueAtTime(Lh.z,n),e.forwardX.linearRampToValueAtTime(Rh.x,n),e.forwardY.linearRampToValueAtTime(Rh.y,n),e.forwardZ.linearRampToValueAtTime(Rh.z,n),e.upX.linearRampToValueAtTime(i.x,n),e.upY.linearRampToValueAtTime(i.y,n),e.upZ.linearRampToValueAtTime(i.z,n)}else e.setPosition(Lh.x,Lh.y,Lh.z),e.setOrientation(Rh.x,Rh.y,Rh.z,i.x,i.y,i.z)}}),Ih.prototype=Object.assign(Object.create(ci.prototype),{constructor:Ih,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var Dh=new Le,jh=new Se,kh=new Le,Nh=new Le;function Fh(t){Ih.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Bh(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Hh(t,e,i){this.binding=t,this.valueSize=i;var n,r=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Fh.prototype=Object.assign(Object.create(Ih.prototype),{constructor:Fh,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,i){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(t){if(ci.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Dh,jh,kh),Nh.set(0,0,1).applyQuaternion(jh);var e=this.panner;if(e.positionX){var i=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(Dh.x,i),e.positionY.linearRampToValueAtTime(Dh.y,i),e.positionZ.linearRampToValueAtTime(Dh.z,i),e.orientationX.linearRampToValueAtTime(Nh.x,i),e.orientationY.linearRampToValueAtTime(Nh.y,i),e.orientationZ.linearRampToValueAtTime(Nh.z,i)}else e.setPosition(Dh.x,Dh.y,Dh.z),e.setOrientation(Nh.x,Nh.y,Nh.z)}}}),Object.assign(Bh.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Object.assign(Hh.prototype,{accumulate:function(t,e){var i=this.buffer,n=this.valueSize,r=t*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)i[r+o]=i[o];a=e}else{var s=e/(a+=e);this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=3*e;this._mixBufferRegion(i,n,o,1-r,e)}for(var s=e,l=e+e;s!==l;++s)if(i[s]!==i[s+e]){a.setValue(i,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var r=i,a=n;r!==a;++r)e[r]=e[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,n,r){if(.5<=n)for(var a=0;a!==r;++a)t[e+a]=t[i+a]},_slerp:function(t,e,i,n){Se.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,r){for(var a=1-n,o=0;o!==r;++o){var s=e+o;t[s]=t[s]*a+t[i+o]*n}}});var Uh="\\[\\]\\.:\\/",zh=new RegExp("["+Uh+"]","g"),Vh="[^"+Uh+"]",Gh="[^"+Uh.replace("\\.","")+"]",Wh=/((?:WC+[\/:])*)/.source.replace("WC",Vh),Yh=/(WCOD+)?/.source.replace("WCOD",Gh),Xh=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Vh),qh=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Vh),Jh=new RegExp("^"+Wh+Yh+Xh+qh+"$"),Zh=["material","materials","bones"];function Qh(t,e,i){var n=i||Kh.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function Kh(t,e,i){this.path=e,this.parsedPath=i||Kh.parseTrackName(e),this.node=Kh.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function $h(){this.uuid=Te.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function tu(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var n=e.tracks,r=n.length,a=new Array(r),o={endingStart:2400,endingEnd:2400},s=0;s!==r;++s){var l=n[s].createInterpolant(null);(a[s]=l).settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function eu(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function iu(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function nu(t,e,i){Co.call(this,t,e),this.meshPerAttribute=i||1}function ru(t,e,i,n){this.ray=new ji(t,e),this.near=i||0,this.far=n||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function au(t,e){return t.distance-e.distance}function ou(t,e,i,n){if(!1!==t.visible&&(t.raycast(e,i),!0===n))for(var r=t.children,a=0,o=r.length;a<o;a++)ou(r[a],e,i,!0)}function su(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function lu(t,e,i){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==i?i:0,this}Object.assign(Qh.prototype,{getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(Kh,{Composite:Qh,create:function(t,e,i){return t&&t.isAnimationObjectGroup?new Kh.Composite(t,e,i):new Kh(t,e,i)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(zh,"")},parseTrackName:function(t){var e=Jh.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var r=i.nodeName.substring(n+1);-1!==Zh.indexOf(r)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i},findNode:function(t,r){if(!r||""===r||"root"===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){var e=t.skeleton.getBoneByName(r);if(void 0!==e)return e}if(t.children){var a=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.name===r||i.uuid===r)return i;var n=a(i.children);if(n)return n}return null},i=a(t.children);if(i)return i}return null}}),Object.assign(Kh.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(t=Kh.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var a=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[n];if(void 0!==s){var l=this.Versioning.None;void 0!==(this.targetObject=t).needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===r){r=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===r){r=o;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var h=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+n+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Kh.prototype,{_getValue_unbound:Kh.prototype.getValue,_setValue_unbound:Kh.prototype.setValue}),Object.assign($h.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,c=0,h=arguments.length;c!==h;++c){var u=arguments[c],d=u.uuid,p=n[d];if(void 0===p){p=e++,n[d]=p,t.push(u);for(var f=0,m=s;f!==m;++f)o[f].push(new Kh(u,r[f],a[f]))}else if(p<i){l=t[p];var g=--i,v=t[g];t[n[v.uuid]=p]=v,t[n[d]=g]=u;for(f=0,m=s;f!==m;++f){var y=o[f],_=y[g],b=y[p];y[p]=_,void 0===b&&(b=new Kh(u,r[f],a[f])),y[g]=b}}else t[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,c=i[l];if(void 0!==c&&e<=c){var h=e++,u=t[h];t[i[u.uuid]=c]=u,t[i[l]=h]=s;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[h],g=f[c];f[c]=m,f[h]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o].uuid,c=n[l];if(void 0!==c)if(delete n[l],c<i){var h=--i,u=t[h],d=t[v=--e];t[n[u.uuid]=c]=u,t[n[d.uuid]=h]=d,t.pop();for(var p=0,f=a;p!==f;++p){var m=(y=r[p])[h],g=y[v];y[c]=m,y[h]=g,y.pop()}}else{var v;t[n[(d=t[v=--e]).uuid]=c]=d,t.pop();for(p=0,f=a;p!==f;++p){var y;(y=r[p])[c]=y[v],y.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],r=this._bindings;if(void 0!==n)return r[n];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,h=new Array(l);n=r.length,i[t]=n,a.push(t),o.push(e),r.push(h);for(var u=c,d=s.length;u!==d;++u){var p=s[u];h[u]=new Kh(p,t,e)}return h},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];a[e[t[o]]=i]=s,a.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}}),Object.assign(tu.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){var n=this._clip.duration,r=t._clip.duration,a=r/n,o=n/r;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,r=n.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+i,l[0]=t/o,l[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){if(this.enabled){var r=this._startTime;if(null!==r){var a=(t-r)*i;if(a<0||0===i)return;this._startTime=null,e=i*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(0<s)for(var l=this._interpolants,c=this._propertyBindings,h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulate(n,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i)e*=i.evaluate(t)[0],t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e},_updateTime:function(t){var e=this.time+t,i=this._clip.duration,n=this.loop,r=this._loopCount,a=2202===n;if(0===t)return-1===r?e:a&&1==(1&r)?i-e:e;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i<=e)e=i;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(0<=t?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),i<=e||e<0){var o=Math.floor(e/i);e-=i*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?i:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1});else{if(1===s){var l=t<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=e;if(a&&1==(1&r))return i-e}return e},_setEndings:function(t,e,i){var n=this._interpolantSettings;n.endingEnd=i?n.endingStart=2401:(n.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,i){var n=this._mixer,r=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=e,o[1]=r+t,s[1]=i,this}}),eu.prototype=Object.assign(Object.create(be.prototype),{constructor:eu,_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,a=t._propertyBindings,o=t._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var h=0;h!==r;++h){var u=n[h],d=u.name,p=c[d];if(void 0!==p)a[h]=p;else{if(void 0!==(p=a[h])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=e&&e._propertyBindings[h].binding.parsedPath;++(p=new Hh(Kh.create(i,d,f),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),a[h]=p}o[h].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(var r=t._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,r=this._actionsByClip,a=r[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=n.length,n.push(t),a.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;e[i._cacheIndex=n]=i,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;s[l._byClipCacheIndex=c]=l,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,r=n[e],a=this._bindings;void 0===r&&(r={},n[e]=r),(r[i]=t)._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,a=this._bindingsByRootAndName,o=a[n],s=e[e.length-1],l=t._cacheIndex;e[s._cacheIndex=l]=s,e.pop(),delete o[r],0===Object.keys(o).length&&delete a[n]},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(t[(i=new Ql(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];e[t.__cacheIndex=n]=t,e[r.__cacheIndex=i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?sc.findByName(i,t):t,a=null!==r?r.uuid:t,o=this._actionsByClip[a],s=null;if(void 0!==o){var l=o.actionByRoot[n];if(void 0!==l)return l;s=o.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var c=new tu(this,r,e);return this._bindAction(c,s),this._addInactiveAction(c,a,n),c},existingAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?sc.findByName(i,t):t,a=r?r.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0;for(var r=this._nActiveBindings=0;r!==e;++r)t[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),a=this._accuIndex^=1,o=0;o!==i;++o){e[o]._update(n,t,r,a)}var s=this._bindings,l=this._nActiveBindings;for(o=0;o!==l;++o)s[o].apply(a);return this},setTime:function(t){for(var e=this.time=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var c=l._cacheIndex,h=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,e[h._cacheIndex=c]=h,e.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),iu.prototype.clone=function(){return new iu(void 0===this.value.clone?this.value:this.value.clone())},nu.prototype=Object.assign(Object.create(Co.prototype),{constructor:nu,isInstancedInterleavedBuffer:!0,copy:function(t){return Co.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(ru.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,i){var n=i||[];return ou(t,this,n,e),n.sort(au),n},intersectObjects:function(t,e,i){var n=i||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,a=t.length;r<a;r++)ou(t[r],this,n,e);return n.sort(au),n}}),Object.assign(su.prototype,{set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(Te.clamp(e/this.radius,-1,1))),this}}),Object.assign(lu.prototype,{set:function(t,e,i){return this.radius=t,this.theta=e,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,i){return this.radius=Math.sqrt(t*t+i*i),this.theta=Math.atan2(t,i),this.y=e,this}});var cu=new Me;function hu(t,e){this.min=void 0!==t?t:new Me(1/0,1/0),this.max=void 0!==e?e:new Me(-1/0,-1/0)}Object.assign(hu.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var i=cu.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Me),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Me),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Me),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Me),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return cu.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var uu=new Le,du=new Le;function pu(t,e){this.start=void 0!==t?t:new Le,this.end=void 0!==e?e:new Le}function fu(t){ci.call(this),this.material=t,this.render=function(){}}Object.assign(pu.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Le),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Le),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Le),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){uu.subVectors(t,this.start),du.subVectors(this.end,this.start);var i=du.dot(du),n=du.dot(uu)/i;return e&&(n=Te.clamp(n,0,1)),n},closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e);return void 0===i&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new Le),this.delta(i).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),((fu.prototype=Object.create(ci.prototype)).constructor=fu).prototype.isImmediateRenderObject=!0;var mu=new Le,gu=new Le,vu=new Re,yu=["a","b","c"];function _u(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16711680,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var l=new Ln,c=new vn(2*o*3,3);l.setAttribute("position",c),ds.call(this,l,new ns({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}((_u.prototype=Object.create(ds.prototype)).constructor=_u).prototype.update=function(){this.object.updateMatrixWorld(!0),vu.getNormalMatrix(this.object.matrixWorld);var t=this.object.matrixWorld,e=this.geometry.attributes.position,i=this.object.geometry;if(i&&i.isGeometry)for(var n=i.vertices,r=i.faces,a=0,o=0,s=r.length;o<s;o++)for(var l=r[o],c=0,h=l.vertexNormals.length;c<h;c++){var u=n[l[yu[c]]],d=l.vertexNormals[c];mu.copy(u).applyMatrix4(t),gu.copy(d).applyMatrix3(vu).normalize().multiplyScalar(this.size).add(mu),e.setXYZ(a,mu.x,mu.y,mu.z),a+=1,e.setXYZ(a,gu.x,gu.y,gu.z),a+=1}else if(i&&i.isBufferGeometry){var p=i.attributes.position,f=i.attributes.normal;for(a=0,c=0,h=p.count;c<h;c++)mu.set(p.getX(c),p.getY(c),p.getZ(c)).applyMatrix4(t),gu.set(f.getX(c),f.getY(c),f.getZ(c)),gu.applyMatrix3(vu).normalize().multiplyScalar(this.size).add(mu),e.setXYZ(a,mu.x,mu.y,mu.z),a+=1,e.setXYZ(a,gu.x,gu.y,gu.z),a+=1}e.needsUpdate=!0};var bu=new Le;function xu(t,e){ci.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var i=new Ln,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,a=1;r<32;r++,a++){var o=r/32*Math.PI*2,s=a/32*Math.PI*2;n.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}i.setAttribute("position",new vn(n,3));var l=new ns({fog:!1});this.cone=new ds(i,l),this.add(this.cone),this.update()}((xu.prototype=Object.create(ci.prototype)).constructor=xu).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},xu.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),bu.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(bu),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var wu=new Le,Tu=new We,Mu=new We;function Su(t){for(var e=function t(e){var i=[];e&&e.isBone&&i.push(e);for(var n=0;n<e.children.length;n++)i.push.apply(i,t(e.children[n]));return i}(t),i=new Ln,n=[],r=[],a=new tn(0,0,1),o=new tn(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}i.setAttribute("position",new vn(n,3)),i.setAttribute("color",new vn(r,3));var c=new ns({vertexColors:v,depthTest:!1,depthWrite:!1,transparent:!0});ds.call(this,i,c),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Eu(t,e,i){this.light=t,this.light.updateMatrixWorld(),this.color=i;var n=new xl(e,4,2),r=new ln({wireframe:!0,fog:!1});Yn.call(this,n,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Cu(t,e){this.type="RectAreaLightHelper",this.light=t,this.color=e;var i=new Ln;i.setAttribute("position",new vn([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere();var n=new ns({fog:!1});cs.call(this,i,n);var r=new Ln;r.setAttribute("position",new vn([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new Yn(r,new ln({side:xt,fog:!1}))),this.update()}((Su.prototype=Object.create(ds.prototype)).constructor=Su).prototype.updateMatrixWorld=function(t){var e=this.bones,i=this.geometry,n=i.getAttribute("position");Mu.getInverse(this.root.matrixWorld);for(var r=0,a=0;r<e.length;r++){var o=e[r];o.parent&&o.parent.isBone&&(Tu.multiplyMatrices(Mu,o.matrixWorld),wu.setFromMatrixPosition(Tu),n.setXYZ(a,wu.x,wu.y,wu.z),Tu.multiplyMatrices(Mu,o.parent.matrixWorld),wu.setFromMatrixPosition(Tu),n.setXYZ(a+1,wu.x,wu.y,wu.z),a+=2)}i.getAttribute("position").needsUpdate=!0,ci.prototype.updateMatrixWorld.call(this,t)},((Eu.prototype=Object.create(Yn.prototype)).constructor=Eu).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Eu.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},((Cu.prototype=Object.create(cs.prototype)).constructor=Cu).prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var t=this.material.color,e=Math.max(t.r,t.g,t.b);1<e&&t.multiplyScalar(1/e),this.children[0].material.color.copy(this.material.color)}},Cu.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()};var Lu=new Le,Au=new tn,Pu=new tn;function Ru(t,e,i){ci.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;var n=new Is(e);n.rotateY(.5*Math.PI),this.material=new ln({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=v);var r=n.getAttribute("position"),a=new Float32Array(3*r.count);n.setAttribute("color",new cn(a,3)),this.add(new Yn(n,this.material)),this.update()}function Ou(t,e){this.lightProbe=t,this.size=e;var i={GAMMA_OUTPUT:""},n=new sr({defines:i,uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","vec3 linearToOutput( in vec3 a ) {","\t#ifdef GAMMA_OUTPUT","\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );","\t#else","\t\treturn a;","\t#endif","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\toutgoingLight = linearToOutput( outgoingLight );","\tgl_FragColor = vec4( outgoingLight, 1.0 );","}"].join("\n")}),r=new xl(1,32,16);Yn.call(this,r,n),this.onBeforeRender()}function Iu(t,e,i,n){t=t||10,e=e||10,i=new tn(void 0!==i?i:4473924),n=new tn(void 0!==n?n:8947848);for(var r=e/2,a=t/e,o=t/2,s=[],l=[],c=0,h=0,u=-o;c<=e;c++,u+=a){s.push(-o,0,u,o,0,u),s.push(u,0,-o,u,0,o);var d=c===r?i:n;d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3}var p=new Ln;p.setAttribute("position",new vn(s,3)),p.setAttribute("color",new vn(l,3));var f=new ns({vertexColors:v});ds.call(this,p,f)}function Du(t,e,i,n,r,a){t=t||10,e=e||16,i=i||8,n=n||64,r=new tn(void 0!==r?r:4473924),a=new tn(void 0!==a?a:8947848);var o,s,l,c,h,u,d,p=[],f=[];for(c=0;c<=e;c++)l=c/e*(2*Math.PI),o=Math.sin(l)*t,s=Math.cos(l)*t,p.push(0,0,0),p.push(o,0,s),d=1&c?r:a,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(c=0;c<=i;c++)for(d=1&c?r:a,u=t-t/i*c,h=0;h<n;h++)l=h/n*(2*Math.PI),o=Math.sin(l)*u,s=Math.cos(l)*u,p.push(o,0,s),f.push(d.r,d.g,d.b),l=(h+1)/n*(2*Math.PI),o=Math.sin(l)*u,s=Math.cos(l)*u,p.push(o,0,s),f.push(d.r,d.g,d.b);var m=new Ln;m.setAttribute("position",new vn(p,3)),m.setAttribute("color",new vn(f,3));var g=new ns({vertexColors:v});ds.call(this,m,g)}function ju(t,e,i,n){this.audio=t,this.range=e||1,this.divisionsInnerAngle=i||16,this.divisionsOuterAngle=n||2;var r=new Ln,a=this.divisionsInnerAngle+2*this.divisionsOuterAngle,o=new Float32Array(3*(3*a+3));r.setAttribute("position",new cn(o,3));var s=new ns({color:65280}),l=new ns({color:16776960});cs.call(this,r,[l,s]),this.update()}((Ru.prototype=Object.create(ci.prototype)).constructor=Ru).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ru.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Au.copy(this.light.color),Pu.copy(this.light.groundColor);for(var i=0,n=e.count;i<n;i++){var r=i<n/2?Au:Pu;e.setXYZ(i,r.r,r.g,r.b)}e.needsUpdate=!0}t.lookAt(Lu.setFromMatrixPosition(this.light.matrixWorld).negate())},((Ou.prototype=Object.create(Yn.prototype)).constructor=Ou).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ou.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},Iu.prototype=Object.assign(Object.create(ds.prototype),{constructor:Iu,copy:function(t){return ds.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),(Du.prototype=Object.create(ds.prototype)).constructor=Du,((ju.prototype=Object.create(cs.prototype)).constructor=ju).prototype.update=function(){var a,o,t=this.audio,s=this.range,e=this.divisionsInnerAngle,i=this.divisionsOuterAngle,n=Te.degToRad(t.panner.coneInnerAngle),r=Te.degToRad(t.panner.coneOuterAngle),l=n/2,c=r/2,h=0,u=0,d=this.geometry,p=d.attributes.position;function f(t,e,i,n){var r=(e-t)/i;for(p.setXYZ(h,0,0,0),u++,a=t;a<e;a+=r)o=h+u,p.setXYZ(o,Math.sin(a)*s,0,Math.cos(a)*s),p.setXYZ(o+1,Math.sin(Math.min(a+r,e))*s,0,Math.cos(Math.min(a+r,e))*s),p.setXYZ(o+2,0,0,0),u+=3;d.addGroup(h,u,n),h+=u,u=0}d.clearGroups(),f(-c,-l,i,0),f(-l,l,e,1),f(l,c,i,0),p.needsUpdate=!0,n===r&&(this.material[0].visible=!1)},ju.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()};var ku=new Le,Nu=new Le,Fu=new Re;function Bu(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16776960,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Ln,c=new vn(2*o*3,3);l.setAttribute("position",c),ds.call(this,l,new ns({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}((Bu.prototype=Object.create(ds.prototype)).constructor=Bu).prototype.update=function(){this.object.updateMatrixWorld(!0),Fu.getNormalMatrix(this.object.matrixWorld);for(var t=this.object.matrixWorld,e=this.geometry.attributes.position,i=this.object.geometry,n=i.vertices,r=i.faces,a=0,o=0,s=r.length;o<s;o++){var l=r[o],c=l.normal;ku.copy(n[l.a]).add(n[l.b]).add(n[l.c]).divideScalar(3).applyMatrix4(t),Nu.copy(c).applyMatrix3(Fu).normalize().multiplyScalar(this.size).add(ku),e.setXYZ(a,ku.x,ku.y,ku.z),a+=1,e.setXYZ(a,Nu.x,Nu.y,Nu.z),a+=1}e.needsUpdate=!0};var Hu=new Le,Uu=new Le,zu=new Le;function Vu(t,e,i){ci.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===e&&(e=1);var n=new Ln;n.setAttribute("position",new vn([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var r=new ns({fog:!1});this.lightPlane=new cs(n,r),this.add(this.lightPlane),(n=new Ln).setAttribute("position",new vn([0,0,0,0,0,1],3)),this.targetLine=new cs(n,r),this.add(this.targetLine),this.update()}((Vu.prototype=Object.create(ci.prototype)).constructor=Vu).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Vu.prototype.update=function(){Hu.setFromMatrixPosition(this.light.matrixWorld),Uu.setFromMatrixPosition(this.light.target.matrixWorld),zu.subVectors(Uu,Hu),this.lightPlane.lookAt(Uu),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Uu),this.targetLine.scale.z=zu.length()};var Gu=new Le,Wu=new lr;function Yu(t){var e=new Ln,i=new ns({color:16777215,vertexColors:1}),n=[],r=[],a={},o=new tn(16755200),s=new tn(16711680),l=new tn(43775),c=new tn(16777215),h=new tn(3355443);function u(t,e,i){d(t,i),d(e,i)}function d(t,e){n.push(0,0,0),r.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(n.length/3-1)}u("n1","n2",o),u("n2","n4",o),u("n4","n3",o),u("n3","n1",o),u("f1","f2",o),u("f2","f4",o),u("f4","f3",o),u("f3","f1",o),u("n1","f1",o),u("n2","f2",o),u("n3","f3",o),u("n4","f4",o),u("p","n1",s),u("p","n2",s),u("p","n3",s),u("p","n4",s),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l),u("c","t",c),u("p","c",h),u("cn1","cn2",h),u("cn3","cn4",h),u("cf1","cf2",h),u("cf3","cf4",h),e.setAttribute("position",new vn(n,3)),e.setAttribute("color",new vn(r,3)),ds.call(this,e,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function Xu(t,e,i,n,r,a,o){Gu.set(r,a,o).unproject(n);var s=e[t];if(void 0!==s)for(var l=i.getAttribute("position"),c=0,h=s.length;c<h;c++)l.setXYZ(s[c],Gu.x,Gu.y,Gu.z)}((Yu.prototype=Object.create(ds.prototype)).constructor=Yu).prototype.update=function(){var t=this.geometry,e=this.pointMap;Wu.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Xu("c",e,t,Wu,0,0,-1),Xu("t",e,t,Wu,0,0,1),Xu("n1",e,t,Wu,-1,-1,-1),Xu("n2",e,t,Wu,1,-1,-1),Xu("n3",e,t,Wu,-1,1,-1),Xu("n4",e,t,Wu,1,1,-1),Xu("f1",e,t,Wu,-1,-1,1),Xu("f2",e,t,Wu,1,-1,1),Xu("f3",e,t,Wu,-1,1,1),Xu("f4",e,t,Wu,1,1,1),Xu("u1",e,t,Wu,.7,1.1,-1),Xu("u2",e,t,Wu,-.7,1.1,-1),Xu("u3",e,t,Wu,0,2,-1),Xu("cf1",e,t,Wu,-1,0,1),Xu("cf2",e,t,Wu,1,0,1),Xu("cf3",e,t,Wu,0,-1,1),Xu("cf4",e,t,Wu,0,1,1),Xu("cn1",e,t,Wu,-1,0,-1),Xu("cn2",e,t,Wu,1,0,-1),Xu("cn3",e,t,Wu,0,-1,-1),Xu("cn4",e,t,Wu,0,1,-1),t.getAttribute("position").needsUpdate=!0};var qu=new Mi;function Ju(t,e){this.object=t,void 0===e&&(e=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new Ln;r.setIndex(new cn(i,1)),r.setAttribute("position",new cn(n,3)),ds.call(this,r,new ns({color:e})),this.matrixAutoUpdate=!1,this.update()}function Zu(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Ln;n.setIndex(new cn(i,1)),n.setAttribute("position",new vn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ds.call(this,n,new ns({color:e})),this.geometry.computeBoundingSphere()}function Qu(t,e,i){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var n=void 0!==i?i:16776960,r=new Ln;r.setAttribute("position",new vn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),cs.call(this,r,new ns({color:n}));var a=new Ln;a.setAttribute("position",new vn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Yn(a,new ln({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}((Ju.prototype=Object.create(ds.prototype)).constructor=Ju).prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&qu.setFromObject(this.object),!qu.isEmpty()){var e=qu.min,i=qu.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=e.x,r[4]=i.y,r[5]=i.z,r[6]=e.x,r[7]=e.y,r[8]=i.z,r[9]=i.x,r[10]=e.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=e.z,r[15]=e.x,r[16]=i.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=i.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Ju.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Ju.prototype.copy=function(t){return ds.prototype.copy.call(this,t),this.object=t.object,this},Ju.prototype.clone=function(){return(new this.constructor).copy(this)},((Zu.prototype=Object.create(ds.prototype)).constructor=Zu).prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),ci.prototype.updateMatrixWorld.call(this,t))},((Qu.prototype=Object.create(cs.prototype)).constructor=Qu).prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?xt:R,this.lookAt(this.plane.normal),ci.prototype.updateMatrixWorld.call(this,t)};var Ku,$u,td=new Le;function ed(t,e,i,n,r,a){ci.call(this),void 0===t&&(t=new Le(0,0,1)),void 0===e&&(e=new Le(0,0,0)),void 0===i&&(i=1),void 0===n&&(n=16776960),void 0===r&&(r=.2*i),void 0===a&&(a=.2*r),void 0===Ku&&((Ku=new Ln).setAttribute("position",new vn([0,0,0,0,1,0],3)),($u=new Rl(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new cs(Ku,new ns({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Yn($u,new ln({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,r,a)}function id(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=new Ln;i.setAttribute("position",new vn(e,3)),i.setAttribute("color",new vn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new ns({vertexColors:v});ds.call(this,i,n)}((ed.prototype=Object.create(ci.prototype)).constructor=ed).prototype.setDirection=function(t){if(.99999<t.y)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{td.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(td,e)}},ed.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},ed.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},ed.prototype.copy=function(t){return ci.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},ed.prototype.clone=function(){return(new this.constructor).copy(this)},(id.prototype=Object.create(ds.prototype)).constructor=id;function nd(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ac.call(this,t),this.type="catmullrom",this.closed=!0}function rd(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ac.call(this,t),this.type="catmullrom"}function ad(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ac.call(this,t),this.type="catmullrom"}xc.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(xc.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},Object.assign(Uc.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new $n,i=0,n=t.length;i<n;i++){var r=t[i];e.vertices.push(new Le(r.x,r.y,r.z||0))}return e}}),Object.assign(zc.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),nd.prototype=Object.create(Ac.prototype),rd.prototype=Object.create(Ac.prototype),ad.prototype=Object.create(Ac.prototype),Object.assign(ad.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Iu.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Su.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(dc.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),nh.extractUrlBase(t)}}),dc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(lh.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(hu.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Mi.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),pu.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Te,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Te.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Te.ceilPowerOfTwo(t)}}),Object.assign(Re.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(We.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Le).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,i,n,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,i,r,a)}}),Bi.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Se.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(ji.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Zi.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Zi,{barycoordFromPoint:function(t,e,i,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Zi.getBarycoord(t,e,i,n,r)},normal:function(t,e,i,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Zi.getNormal(t,e,i,n)}}),Object.assign(Vc.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new fl(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new El(this,t)}}),Object.assign(Me.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Le.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(je.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign($n.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(ci.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(ci.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Yo.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Zo.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Xo.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(xc.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),cr.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Gc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(cn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===_e},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(_e)}}}),Object.assign(cn.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?_e:ye),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ln.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new cn(e,arguments[2])))},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)}}),Object.defineProperties(Ln.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Co.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===_e},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(Co.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?_e:ye),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ml.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(iu.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(sn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new tn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Ul.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(sr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Mo.prototype,{clearTarget:function(t,e,i,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,i,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Mo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}}}),Object.defineProperties(co.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ur.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(ke.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(wo.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Object.defineProperties(Ih.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new _h).load(t,function(t){e.setBuffer(t)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Bh.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},hr.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var od={merge:function(t,e,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};Oe.crossOrigin=void 0,Oe.loadTexture=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new bc;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},Oe.loadTextureCube=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new _c;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},Oe.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Oe.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var sd={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"111dev"}})),t.ACESFilmicToneMapping=jt,t.AddEquation=rt,t.AddOperation=At,t.AdditiveBlending=tt,t.AlphaFormat=u,t.AlwaysDepth=wt,t.AlwaysStencilFunc=ve,t.AmbientLight=th,t.AmbientLightProbe=Th,t.AnimationClip=sc,t.AnimationLoader=mc,t.AnimationMixer=eu,t.AnimationObjectGroup=$h,t.AnimationUtils=ql,t.ArcCurve=Tc,t.ArrayCamera=vo,t.ArrowHelper=ed,t.Audio=Ih,t.AudioAnalyser=Bh,t.AudioContext=yh,t.AudioListener=Oh,t.AudioLoader=_h,t.AxesHelper=id,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new id(t)},t.BackSide=xt,t.BasicDepthPacking=de,t.BasicShadowMap=0,t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new vc(t)},t.Bone=Qo,t.BooleanKeyframeTrack=tc,t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Ju(t,e)},t.Box2=hu,t.Box3=Mi,t.Box3Helper=Zu,t.BoxBufferGeometry=er,t.BoxGeometry=tr,t.BoxHelper=Ju,t.BufferAttribute=cn,t.BufferGeometry=Ln,t.BufferGeometryLoader=oh,t.ByteType=r,t.Cache=cc,t.Camera=lr,t.CameraHelper=Yu,t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},t.CanvasTexture=Ts,t.CatmullRomCurve3=Ac,t.CineonToneMapping=Dt,t.CircleBufferGeometry=jl,t.CircleGeometry=Dl,t.ClampToEdgeWrapping=U,t.Clock=Ch,t.ClosedSplineCurve3=nd,t.Color=tn,t.ColorKeyframeTrack=ec,t.CompressedTexture=ws,t.CompressedTextureLoader=gc,t.ConeBufferGeometry=Il,t.ConeGeometry=Ol,t.CubeCamera=hr,t.CubeGeometry=tr,t.CubeReflectionMapping=kt,t.CubeRefractionMapping=Nt,t.CubeTexture=Dr,t.CubeTextureLoader=_c,t.CubeUVReflectionMapping=Ut,t.CubeUVRefractionMapping=zt,t.CubicBezierCurve=Ic,t.CubicBezierCurve3=Dc,t.CubicInterpolant=Zl,t.CullFaceBack=J,t.CullFaceFront=Z,t.CullFaceFrontBack=3,t.CullFaceNone=q,t.Curve=xc,t.CurvePath=Uc,t.CustomBlending=nt,t.CylinderBufferGeometry=Rl,t.CylinderGeometry=Pl,t.Cylindrical=lu,t.DataTexture=dr,t.DataTexture2DArray=jr,t.DataTexture3D=kr,t.DataTextureLoader=vc,t.DecrementStencilOp=7683,t.DecrementWrapStencilOp=34056,t.DefaultLoadingManager=uc,t.DepthFormat=ne,t.DepthStencilFormat=re,t.DepthTexture=Ms,t.DirectionalLight=$c,t.DirectionalLightHelper=Vu,t.DirectionalLightShadow=Kc,t.DiscreteInterpolant=Kl,t.DodecahedronBufferGeometry=Ns,t.DodecahedronGeometry=ks,t.DoubleSide=Q,t.DstAlphaFactor=mt,t.DstColorFactor=vt,t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new cn(t,e).setDynamic(!0)},t.DynamicCopyUsage=35050,t.DynamicDrawUsage=_e,t.DynamicReadUsage=35049,t.EdgesGeometry=Al,t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ds(new Al(t.geometry),new ns({color:void 0!==e?e:16777215}))},t.EllipseCurve=wc,t.EqualDepth=St,t.EqualStencilFunc=514,t.EquirectangularReflectionMapping=Ft,t.EquirectangularRefractionMapping=Bt,t.Euler=qe,t.EventDispatcher=be,t.ExtrudeBufferGeometry=ml,t.ExtrudeGeometry=fl,t.Face3=an,t.Face4=function(t,e,i,n,r,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new an(t,e,i,r,a,o)},t.FaceColors=1,t.FaceNormalsHelper=Bu,t.FileLoader=fc,t.FlatShading=1,t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new vn(t,e)},t.Float32BufferAttribute=vn,t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new yn(t,e)},t.Float64BufferAttribute=yn,t.FloatType=Kt,t.Fog=Eo,t.FogExp2=So,t.Font=mh,t.FontLoader=vh,t.FrontFaceDirectionCCW=1,t.FrontFaceDirectionCW=0,t.FrontSide=R,t.Frustum=mr,t.GammaEncoding=n,t.Geometry=$n,t.GeometryUtils=od,t.GreaterDepth=Ct,t.GreaterEqualDepth=Et,t.GreaterEqualStencilFunc=518,t.GreaterStencilFunc=516,t.GridHelper=Iu,t.Group=go,t.HalfFloatType=$t,t.HemisphereLight=Wc,t.HemisphereLightHelper=Ru,t.HemisphereLightProbe=wh,t.IcosahedronBufferGeometry=js,t.IcosahedronGeometry=Ds,t.ImageBitmapLoader=ph,t.ImageLoader=yc,t.ImageUtils=Oe,t.ImmediateRenderObject=fu,t.IncrementStencilOp=7682,t.IncrementWrapStencilOp=34055,t.InstancedBufferAttribute=ah,t.InstancedBufferGeometry=rh,t.InstancedInterleavedBuffer=nu,t.InstancedMesh=is,t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new pn(t,e)},t.Int16BufferAttribute=pn,t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new mn(t,e)},t.Int32BufferAttribute=mn,t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new hn(t,e)},t.Int8BufferAttribute=hn,t.IntType=s,t.InterleavedBuffer=Co,t.InterleavedBufferAttribute=Lo,t.Interpolant=Jl,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.InvertStencilOp=5386,t.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},t.KeepStencilOp=ge,t.KeyframeTrack=$l,t.LOD=Yo,t.LatheBufferGeometry=Sl,t.LatheGeometry=Ml,t.Layers=Je,t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},t.LessDepth=Tt,t.LessEqualDepth=Mt,t.LessEqualStencilFunc=515,t.LessStencilFunc=513,t.Light=Gc,t.LightProbe=xh,t.LightProbeHelper=Ou,t.LightShadow=Yc,t.Line=cs,t.Line3=pu,t.LineBasicMaterial=ns,t.LineCurve=jc,t.LineCurve3=kc,t.LineDashedMaterial=Yl,t.LineLoop=ps,t.LinePieces=1,t.LineSegments=ds,t.LineStrip=0,t.LinearEncoding=oe,t.LinearFilter=Yt,t.LinearInterpolant=Ql,t.LinearMipMapLinearFilter=1008,t.LinearMipMapNearestFilter=1007,t.LinearMipmapLinearFilter=qt,t.LinearMipmapNearestFilter=Xt,t.LinearToneMapping=Rt,t.Loader=dc,t.LoaderUtils=nh,t.LoadingManager=hc,t.LogLuvEncoding=le,t.LoopOnce=2200,t.LoopPingPong=2202,t.LoopRepeat=2201,t.LuminanceAlphaFormat=p,t.LuminanceFormat=d,t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},t.Material=sn,t.MaterialLoader=ih,t.Math=Te,t.Matrix3=Re,t.Matrix4=We,t.MaxEquation=lt,t.Mesh=Yn,t.MeshBasicMaterial=ln,t.MeshDepthMaterial=ao,t.MeshDistanceMaterial=oo,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MeshLambertMaterial=Gl,t.MeshMatcapMaterial=Wl,t.MeshNormalMaterial=Vl,t.MeshPhongMaterial=Ul,t.MeshPhysicalMaterial=Hl,t.MeshStandardMaterial=Bl,t.MeshToonMaterial=zl,t.MinEquation=st,t.MirroredRepeatWrapping=z,t.MixOperation=X,t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,(t.materials=t).clone=function(){return t.slice()},t},t.MultiplyBlending=it,t.MultiplyOperation=Y,t.NearestFilter=Vt,t.NearestMipMapLinearFilter=1005,t.NearestMipMapNearestFilter=1004,t.NearestMipmapLinearFilter=Wt,t.NearestMipmapNearestFilter=Gt,t.NeverDepth=bt,t.NeverStencilFunc=512,t.NoBlending=K,t.NoColors=o,t.NoToneMapping=Pt,t.NormalBlending=$,t.NotEqualDepth=Lt,t.NotEqualStencilFunc=517,t.NumberKeyframeTrack=ic,t.Object3D=ci,t.ObjectLoader=lh,t.ObjectSpaceNormalMap=me,t.OctahedronBufferGeometry=Is,t.OctahedronGeometry=Os,t.OneFactor=ht,t.OneMinusDstAlphaFactor=gt,t.OneMinusDstColorFactor=yt,t.OneMinusSrcAlphaFactor=ft,t.OneMinusSrcColorFactor=dt,t.OrthographicCamera=Qc,t.PCFShadowMap=V,t.PCFSoftShadowMap=G,t.ParametricBufferGeometry=Cs,t.ParametricGeometry=Es,t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new zo(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new fs(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new _s(t,e)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new fs(t)},t.Path=zc,t.PerspectiveCamera=cr,t.Plane=Bi,t.PlaneBufferGeometry=wr,t.PlaneGeometry=xr,t.PlaneHelper=Qu,t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new _s(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new fs(t)},t.PointLight=Zc,t.PointLightHelper=Eu,t.Points=_s,t.PointsMaterial=fs,t.PolarGridHelper=Du,t.PolyhedronBufferGeometry=As,t.PolyhedronGeometry=Ls,t.PositionalAudio=Fh,t.PositionalAudioHelper=ju,t.PropertyBinding=Kh,t.PropertyMixer=Hh,t.QuadraticBezierCurve=Nc,t.QuadraticBezierCurve3=Fc,t.Quaternion=Se,t.QuaternionKeyframeTrack=rc,t.QuaternionLinearInterpolant=nc,t.REVISION="111dev",t.RGBADepthPacking=pe,t.RGBAFormat=ie,t.RGBA_ASTC_10x10_Format=N,t.RGBA_ASTC_10x5_Format=D,t.RGBA_ASTC_10x6_Format=j,t.RGBA_ASTC_10x8_Format=k,t.RGBA_ASTC_12x10_Format=F,t.RGBA_ASTC_12x12_Format=B,t.RGBA_ASTC_4x4_Format=S,t.RGBA_ASTC_5x4_Format=E,t.RGBA_ASTC_5x5_Format=C,t.RGBA_ASTC_6x5_Format=L,t.RGBA_ASTC_6x6_Format=A,t.RGBA_ASTC_8x5_Format=P,t.RGBA_ASTC_8x6_Format=O,t.RGBA_ASTC_8x8_Format=I,t.RGBA_PVRTC_2BPPV1_Format=T,t.RGBA_PVRTC_4BPPV1_Format=w,t.RGBA_S3TC_DXT1_Format=g,t.RGBA_S3TC_DXT3_Format=y,t.RGBA_S3TC_DXT5_Format=_,t.RGBDEncoding=ue,t.RGBEEncoding=se,t.RGBEFormat=e,t.RGBFormat=ee,t.RGBM16Encoding=he,t.RGBM7Encoding=ce,t.RGB_ETC1_Format=M,t.RGB_PVRTC_2BPPV1_Format=x,t.RGB_PVRTC_4BPPV1_Format=b,t.RGB_S3TC_DXT1_Format=m,t.RawShaderMaterial=Fl,t.Ray=ji,t.Raycaster=ru,t.RectAreaLight=eh,t.RectAreaLightHelper=Cu,t.RedFormat=f,t.ReinhardToneMapping=Ot,t.RepeatWrapping=H,t.ReplaceStencilOp=7681,t.ReverseSubtractEquation=ot,t.RingBufferGeometry=Tl,t.RingGeometry=wl,t.Scene=hi,t.SceneUtils=sd,t.ShaderChunk=gr,t.ShaderLib=yr,t.ShaderMaterial=sr,t.ShadowMaterial=Nl,t.Shape=Vc,t.ShapeBufferGeometry=Cl,t.ShapeGeometry=El,t.ShapePath=fh,t.ShapeUtils=ul,t.ShortType=a,t.Skeleton=Zo,t.SkeletonHelper=Su,t.SkinnedMesh=Xo,t.SmoothShading=2,t.Sphere=Ci,t.SphereBufferGeometry=xl,t.SphereGeometry=bl,t.Spherical=su,t.SphericalHarmonics3=bh,t.SphericalReflectionMapping=Ht,t.Spline=ad,t.SplineCurve=Bc,t.SplineCurve3=rd,t.SpotLight=qc,t.SpotLightHelper=xu,t.SpotLightShadow=Xc,t.Sprite=zo,t.SpriteMaterial=Ao,t.SrcAlphaFactor=pt,t.SrcAlphaSaturateFactor=_t,t.SrcColorFactor=ut,t.StaticCopyUsage=35046,t.StaticDrawUsage=ye,t.StaticReadUsage=35045,t.StereoCamera=Eh,t.StreamCopyUsage=35042,t.StreamDrawUsage=35040,t.StreamReadUsage=35041,t.StringKeyframeTrack=ac,t.SubtractEquation=at,t.SubtractiveBlending=et,t.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},t.TangentSpaceNormalMap=fe,t.TetrahedronBufferGeometry=Rs,t.TetrahedronGeometry=Ps,t.TextBufferGeometry=_l,t.TextGeometry=yl,t.Texture=De,t.TextureLoader=bc,t.TorusBufferGeometry=Vs,t.TorusGeometry=zs,t.TorusKnotBufferGeometry=Us,t.TorusKnotGeometry=Hs,t.Triangle=Zi,t.TriangleFanDrawMode=2,t.TriangleStripDrawMode=1,t.TrianglesDrawMode=ae,t.TubeBufferGeometry=Bs,t.TubeGeometry=Fs,t.UVMapping=300,t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new fn(t,e)},t.Uint16BufferAttribute=fn,t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new gn(t,e)},t.Uint32BufferAttribute=gn,t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new un(t,e)},t.Uint8BufferAttribute=un,t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new dn(t,e)},t.Uint8ClampedBufferAttribute=dn,t.Uncharted2ToneMapping=It,t.Uniform=iu,t.UniformsLib=vr,t.UniformsUtils=rr,t.UnsignedByteType=Jt,t.UnsignedInt248Type=te,t.UnsignedIntType=Qt,t.UnsignedShort4444Type=l,t.UnsignedShort5551Type=c,t.UnsignedShort565Type=h,t.UnsignedShortType=Zt,t.VSMShadowMap=W,t.Vector2=Me,t.Vector3=Le,t.Vector4=je,t.VectorKeyframeTrack=oc,t.Vertex=function(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Le(t,e,i)},t.VertexColors=v,t.VertexNormalsHelper=_u,t.VideoTexture=xs,t.WebGLMultisampleRenderTarget=Ne,t.WebGLRenderTarget=ke,t.WebGLRenderTargetCube=ur,t.WebGLRenderer=Mo,t.WebGLUtils=po,t.WireframeGeometry=Ss,t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ds(new Ss(t.geometry),new ns({color:void 0!==e?e:16777215}))},t.WrapAroundEnding=2402,t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new fc(t)},t.ZeroCurvatureEnding=2400,t.ZeroFactor=ct,t.ZeroSlopeEnding=2401,t.ZeroStencilOp=0,t.sRGBEncoding=i,Object.defineProperty(t,"__esModule",{value:!0})}),THREE.MTLLoader=function(t){THREE.Loader.call(this,t)},THREE.MTLLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.MTLLoader,load:function(t,e,i,n){var r=this,a=""===this.path?THREE.LoaderUtils.extractUrlBase(t):this.path,o=new THREE.FileLoader(this.manager);o.setPath(this.path),o.load(t,function(t){e(r.parse(t,a))},i,n)},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,e){for(var i=t.split("\n"),n={},r=/\s+/,a={},o=0;o<i.length;o++){var s=i[o];if(0!==(s=s.trim()).length&&"#"!==s.charAt(0)){var l=s.indexOf(" "),c=0<=l?s.substring(0,l):s;c=c.toLowerCase();var h=0<=l?s.substring(l+1):"";if(h=h.trim(),"newmtl"===c)n={name:h},a[h]=n;else if("ka"===c||"kd"===c||"ks"===c||"ke"===c){var u=h.split(r,3);n[c]=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])]}else n[c]=h}}var d=new THREE.MTLLoader.MaterialCreator(this.resourcePath||e,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(a),d}}),THREE.MTLLoader.MaterialCreator=function(t,e){this.baseUrl=t||"",this.options=e,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var e={};for(var i in t){var n=t[i],r={};for(var a in e[i]=r,n){var o=!0,s=n[a],l=a.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(r[l]=s)}}return e},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0;for(var e in this.materialsInfo)this.materialsArray[t]=this.create(e),this.nameLookup[e]=t,t++;return this.materialsArray},create:function(t){return void 0===this.materials[t]&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){var o=this,e=this.materialsInfo[t],s={name:t,side:this.side};function i(t,e){if(!s[t]){var i,n,r=o.getTextureParams(e,s),a=o.loadTexture((i=o.baseUrl,"string"!=typeof(n=r.url)||""===n?"":/^https?:\/\//i.test(n)?n:i+n));a.repeat.copy(r.scale),a.offset.copy(r.offset),a.wrapS=o.wrap,a.wrapT=o.wrap,s[t]=a}}for(var n in e){var r,a=e[n];if(""!==a)switch(n.toLowerCase()){case"kd":s.color=(new THREE.Color).fromArray(a);break;case"ks":s.specular=(new THREE.Color).fromArray(a);break;case"ke":s.emissive=(new THREE.Color).fromArray(a);break;case"map_kd":i("map",a);break;case"map_ks":i("specularMap",a);break;case"map_ke":i("emissiveMap",a);break;case"norm":i("normalMap",a);break;case"map_bump":case"bump":i("bumpMap",a);break;case"map_d":i("alphaMap",a),s.transparent=!0;break;case"ns":s.shininess=parseFloat(a);break;case"d":(r=parseFloat(a))<1&&(s.opacity=r,s.transparent=!0);break;case"tr":r=parseFloat(a),this.options&&this.options.invertTrProperty&&(r=1-r),0<r&&(s.opacity=1-r,s.transparent=!0)}}return this.materials[t]=new THREE.MeshPhongMaterial(s),this.materials[t]},getTextureParams:function(t,e){var i,n={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},r=t.split(/\s+/);return 0<=(i=r.indexOf("-bm"))&&(e.bumpScale=parseFloat(r[i+1]),r.splice(i,2)),0<=(i=r.indexOf("-s"))&&(n.scale.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),0<=(i=r.indexOf("-o"))&&(n.offset.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),n.url=r.join(" ").trim(),n},loadTexture:function(t,e,i,n,r){var a,o=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager,s=o.getHandler(t);return null===s&&(s=new THREE.TextureLoader(o)),s.setCrossOrigin&&s.setCrossOrigin(this.crossOrigin),a=s.load(t,i,n,r),void 0!==e&&(a.mapping=e),a}},THREE.OBJLoader=function(){var G=/^[og]\s*(.+)?/,W=/^mtllib /,Y=/^usemtl /,X=/^usemap /;function q(){var t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);var i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(t,e){var i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);var n={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&0<e.length?e[e.length-1]:"",smooth:void 0!==i?i.smooth:this.smooth,groupStart:void 0!==i?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(n),n},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&1<this.materials.length)for(var i=this.materials.length-1;0<=i;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},i&&i.name&&"function"==typeof i.clone){var n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){var i=parseInt(t,10);return 3*(0<=i?i-1:i+e/3)},parseNormalIndex:function(t,e){var i=parseInt(t,10);return 3*(0<=i?i-1:i+e/3)},parseUVIndex:function(t,e){var i=parseInt(t,10);return 2*(0<=i?i-1:i+e/2)},addVertex:function(t,e,i){var n=this.vertices,r=this.object.geometry.vertices;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,i){var n=this.normals,r=this.object.geometry.normals;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},addColor:function(t,e,i){var n=this.colors,r=this.object.geometry.colors;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},addUV:function(t,e,i){var n=this.uvs,r=this.object.geometry.uvs;r.push(n[t+0],n[t+1]),r.push(n[e+0],n[e+1]),r.push(n[i+0],n[i+1])},addUVLine:function(t){var e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,i,n,r,a,o,s,l){var c=this.vertices.length,h=this.parseVertexIndex(t,c),u=this.parseVertexIndex(e,c),d=this.parseVertexIndex(i,c);if(this.addVertex(h,u,d),0<this.colors.length&&this.addColor(h,u,d),void 0!==n&&""!==n){var p=this.uvs.length;h=this.parseUVIndex(n,p),u=this.parseUVIndex(r,p),d=this.parseUVIndex(a,p),this.addUV(h,u,d)}if(void 0!==o&&""!==o){var f=this.normals.length;h=this.parseNormalIndex(o,f),u=o===s?h:this.parseNormalIndex(s,f),d=o===l?h:this.parseNormalIndex(l,f),this.addNormal(h,u,d)}},addPointGeometry:function(t){this.object.geometry.type="Points";for(var e=this.vertices.length,i=0,n=t.length;i<n;i++)this.addVertexPoint(this.parseVertexIndex(t[i],e))},addLineGeometry:function(t,e){this.object.geometry.type="Line";for(var i=this.vertices.length,n=this.uvs.length,r=0,a=t.length;r<a;r++)this.addVertexLine(this.parseVertexIndex(t[r],i));var o=0;for(a=e.length;o<a;o++)this.addUVLine(this.parseUVIndex(e[o],n))}};return t.startObject("",!1),t}function t(t){THREE.Loader.call(this,t),this.materials=null}return t.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:t,load:function(t,e,i,n){var r=this,a=new THREE.FileLoader(r.manager);a.setPath(this.path),a.load(t,function(t){e(r.parse(t))},i,n)},setMaterials:function(t){return this.materials=t,this},parse:function(t){console.time("OBJLoader");var e=new q;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var i=t.split("\n"),n="",r="",a=[],o="function"==typeof"".trimLeft,s=0,l=i.length;s<l;s++)if(n=i[s],0!==(n=o?n.trimLeft():n.trim()).length&&"#"!==(r=n.charAt(0)))if("v"===r){var c=n.split(/\s+/);switch(c[0]){case"v":e.vertices.push(parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3])),7<=c.length&&e.colors.push(parseFloat(c[4]),parseFloat(c[5]),parseFloat(c[6]));break;case"vn":e.normals.push(parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]));break;case"vt":e.uvs.push(parseFloat(c[1]),parseFloat(c[2]))}}else if("f"===r){for(var h=n.substr(1).trim().split(/\s+/),u=[],d=0,p=h.length;d<p;d++){var f=h[d];if(0<f.length){var m=f.split("/");u.push(m)}}var g=u[0];for(d=1,p=u.length-1;d<p;d++){var v=u[d],y=u[d+1];e.addFace(g[0],v[0],y[0],g[1],v[1],y[1],g[2],v[2],y[2])}}else if("l"===r){var _=n.substring(1).trim().split(" "),b=[],x=[];if(-1===n.indexOf("/"))b=_;else for(var w=0,T=_.length;w<T;w++){var M=_[w].split("/");""!==M[0]&&b.push(M[0]),""!==M[1]&&x.push(M[1])}e.addLineGeometry(b,x)}else if("p"===r){var S=n.substr(1).trim().split(" ");e.addPointGeometry(S)}else if(null!==(a=G.exec(n))){var E=(" "+a[0].substr(1).trim()).substr(1);e.startObject(E)}else if(Y.test(n))e.object.startMaterial(n.substring(7).trim(),e.materialLibraries);else if(W.test(n))e.materialLibraries.push(n.substring(7).trim());else if(X.test(n))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===r){if(1<(a=n.split(" ")).length){var C=a[1].trim().toLowerCase();e.object.smooth="0"!==C&&"off"!==C}else e.object.smooth=!0;(U=e.object.currentMaterial())&&(U.smooth=e.object.smooth)}else{if("\0"===n)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+n+'"')}e.finalize();var L=new THREE.Group;L.materialLibraries=[].concat(e.materialLibraries);for(s=0,l=e.objects.length;s<l;s++){var A=e.objects[s],P=A.geometry,R=A.materials,O="Line"===P.type,I="Points"===P.type,D=!1;if(0!==P.vertices.length){var j=new THREE.BufferGeometry;j.setAttribute("position",new THREE.Float32BufferAttribute(P.vertices,3)),0<P.normals.length?j.setAttribute("normal",new THREE.Float32BufferAttribute(P.normals,3)):j.computeVertexNormals(),0<P.colors.length&&(D=!0,j.setAttribute("color",new THREE.Float32BufferAttribute(P.colors,3))),0<P.uvs.length&&j.setAttribute("uv",new THREE.Float32BufferAttribute(P.uvs,2));for(var k,N=[],F=0,B=R.length;F<B;F++){var H=R[F],U=void 0;if(null!==this.materials)if(U=this.materials.create(H.name),!O||!U||U instanceof THREE.LineBasicMaterial){if(I&&U&&!(U instanceof THREE.PointsMaterial)){var z=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(z,U),z.color.copy(U.color),z.map=U.map,U=z}}else{var V=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(V,U),V.color.copy(U.color),U=V}U||((U=O?new THREE.LineBasicMaterial:I?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=H.name),U.flatShading=!H.smooth,U.vertexColors=D?THREE.VertexColors:THREE.NoColors,N.push(U)}if(1<N.length){for(F=0,B=R.length;F<B;F++){H=R[F];j.addGroup(H.groupStart,H.groupCount,F)}k=O?new THREE.LineSegments(j,N):I?new THREE.Points(j,N):new THREE.Mesh(j,N)}else k=O?new THREE.LineSegments(j,N[0]):I?new THREE.Points(j,N[0]):new THREE.Mesh(j,N[0]);k.name=A.name,L.add(k)}}return console.timeEnd("OBJLoader"),L}}),t}(),THREE.OrbitControls=function(t,e){var i,n,r,a,o;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.touches={ONE:THREE.TOUCH.ROTATE,TWO:THREE.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(l),s.update(),d=u.NONE},this.update=(i=new THREE.Vector3,n=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),r=n.clone().inverse(),a=new THREE.Vector3,o=new THREE.Quaternion,function(){var t=s.object.position;return i.copy(t).sub(s.target),i.applyQuaternion(n),f.setFromVector3(i),s.autoRotate&&d===u.NONE&&A(2*Math.PI/60/60*s.autoRotateSpeed),s.enableDamping?(f.theta+=m.theta*s.dampingFactor,f.phi+=m.phi*s.dampingFactor):(f.theta+=m.theta,f.phi+=m.phi),f.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,f.theta)),f.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=g,f.radius=Math.max(s.minDistance,Math.min(s.maxDistance,f.radius)),!0===s.enableDamping?s.target.addScaledVector(v,s.dampingFactor):s.target.add(v),i.setFromSpherical(f),i.applyQuaternion(r),t.copy(s.target).add(i),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor,v.multiplyScalar(1-s.dampingFactor)):(m.set(0,0,0),v.set(0,0,0)),g=1,!(!(y||a.distanceToSquared(s.object.position)>p||8*(1-o.dot(s.object.quaternion))>p)||(s.dispatchEvent(l),a.copy(s.object.position),o.copy(s.object.quaternion),y=!1))}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",et,!1),s.domElement.removeEventListener("mousedown",X,!1),s.domElement.removeEventListener("wheel",Z,!1),s.domElement.removeEventListener("touchstart",K,!1),s.domElement.removeEventListener("touchend",tt,!1),s.domElement.removeEventListener("touchmove",$,!1),document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",J,!1),s.domElement.removeEventListener("keydown",Q,!1)};var s=this,l={type:"change"},c={type:"start"},h={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},d=u.NONE,p=1e-6,f=new THREE.Spherical,m=new THREE.Spherical,g=1,v=new THREE.Vector3,y=!1,_=new THREE.Vector2,b=new THREE.Vector2,x=new THREE.Vector2,w=new THREE.Vector2,T=new THREE.Vector2,M=new THREE.Vector2,S=new THREE.Vector2,E=new THREE.Vector2,C=new THREE.Vector2;function L(){return Math.pow(.95,s.zoomSpeed)}function A(t){m.theta-=t}function P(t){m.phi-=t}var R,O,I,D=(R=new THREE.Vector3,function(t,e){R.setFromMatrixColumn(e,0),R.multiplyScalar(-t),v.add(R)}),j=(O=new THREE.Vector3,function(t,e){!0===s.screenSpacePanning?O.setFromMatrixColumn(e,1):(O.setFromMatrixColumn(e,0),O.crossVectors(s.object.up,O)),O.multiplyScalar(t),v.add(O)}),k=(I=new THREE.Vector3,function(t,e){var i=s.domElement;if(s.object.isPerspectiveCamera){var n=s.object.position;I.copy(n).sub(s.target);var r=I.length();r*=Math.tan(s.object.fov/2*Math.PI/180),D(2*t*r/i.clientHeight,s.object.matrix),j(2*e*r/i.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(D(t*(s.object.right-s.object.left)/s.object.zoom/i.clientWidth,s.object.matrix),j(e*(s.object.top-s.object.bottom)/s.object.zoom/i.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)});function N(t){s.object.isPerspectiveCamera?g/=t:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*t)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function F(t){s.object.isPerspectiveCamera?g*=t:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/t)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function B(t){_.set(t.clientX,t.clientY)}function H(t){w.set(t.clientX,t.clientY)}function U(t){if(1==t.touches.length)_.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);_.set(e,i)}}function z(t){if(1==t.touches.length)w.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);w.set(e,i)}}function V(t){var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);S.set(0,n)}function G(t){if(1==t.touches.length)b.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);b.set(e,i)}x.subVectors(b,_).multiplyScalar(s.rotateSpeed);var n=s.domElement;A(2*Math.PI*x.x/n.clientHeight),P(2*Math.PI*x.y/n.clientHeight),_.copy(b)}function W(t){if(1==t.touches.length)T.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);T.set(e,i)}M.subVectors(T,w).multiplyScalar(s.panSpeed),k(M.x,M.y),w.copy(T)}function Y(t){var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);E.set(0,n),C.set(0,Math.pow(E.y/S.y,s.zoomSpeed)),N(C.y),S.copy(E)}function X(t){if(!1!==s.enabled){switch(t.preventDefault(),s.domElement.focus?s.domElement.focus():window.focus(),t.button){case 0:switch(s.mouseButtons.LEFT){case THREE.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===s.enablePan)return;H(t),d=u.PAN}else{if(!1===s.enableRotate)return;B(t),d=u.ROTATE}break;case THREE.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===s.enableRotate)return;B(t),d=u.ROTATE}else{if(!1===s.enablePan)return;H(t),d=u.PAN}break;default:d=u.NONE}break;case 1:switch(s.mouseButtons.MIDDLE){case THREE.MOUSE.DOLLY:if(!1===s.enableZoom)return;e=t,S.set(e.clientX,e.clientY),d=u.DOLLY;break;default:d=u.NONE}break;case 2:switch(s.mouseButtons.RIGHT){case THREE.MOUSE.ROTATE:if(!1===s.enableRotate)return;B(t),d=u.ROTATE;break;case THREE.MOUSE.PAN:if(!1===s.enablePan)return;H(t),d=u.PAN;break;default:d=u.NONE}}var e;d!==u.NONE&&(document.addEventListener("mousemove",q,!1),document.addEventListener("mouseup",J,!1),s.dispatchEvent(c))}}function q(t){var e,i;if(!1!==s.enabled)switch(t.preventDefault(),d){case u.ROTATE:if(!1===s.enableRotate)return;!function(t){b.set(t.clientX,t.clientY),x.subVectors(b,_).multiplyScalar(s.rotateSpeed);var e=s.domElement;A(2*Math.PI*x.x/e.clientHeight),P(2*Math.PI*x.y/e.clientHeight),_.copy(b),s.update()}(t);break;case u.DOLLY:if(!1===s.enableZoom)return;i=t,E.set(i.clientX,i.clientY),C.subVectors(E,S),0<C.y?N(L()):C.y<0&&F(L()),S.copy(E),s.update();break;case u.PAN:if(!1===s.enablePan)return;e=t,T.set(e.clientX,e.clientY),M.subVectors(T,w).multiplyScalar(s.panSpeed),k(M.x,M.y),w.copy(T),s.update()}}function J(t){!1!==s.enabled&&(document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",J,!1),s.dispatchEvent(h),d=u.NONE)}function Z(t){var e;!1===s.enabled||!1===s.enableZoom||d!==u.NONE&&d!==u.ROTATE||(t.preventDefault(),t.stopPropagation(),s.dispatchEvent(c),(e=t).deltaY<0?F(L()):0<e.deltaY&&N(L()),s.update(),s.dispatchEvent(h))}function Q(t){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(t){var e=!1;switch(t.keyCode){case s.keys.UP:k(0,s.keyPanSpeed),e=!0;break;case s.keys.BOTTOM:k(0,-s.keyPanSpeed),e=!0;break;case s.keys.LEFT:k(s.keyPanSpeed,0),e=!0;break;case s.keys.RIGHT:k(-s.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),s.update())}(t)}function K(t){if(!1!==s.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(s.touches.ONE){case THREE.TOUCH.ROTATE:if(!1===s.enableRotate)return;U(t),d=u.TOUCH_ROTATE;break;case THREE.TOUCH.PAN:if(!1===s.enablePan)return;z(t),d=u.TOUCH_PAN;break;default:d=u.NONE}break;case 2:switch(s.touches.TWO){case THREE.TOUCH.DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;i=t,s.enableZoom&&V(i),s.enablePan&&z(i),d=u.TOUCH_DOLLY_PAN;break;case THREE.TOUCH.DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;e=t,s.enableZoom&&V(e),s.enableRotate&&U(e),d=u.TOUCH_DOLLY_ROTATE;break;default:d=u.NONE}break;default:d=u.NONE}var e,i;d!==u.NONE&&s.dispatchEvent(c)}}function $(t){var e,i;if(!1!==s.enabled)switch(t.preventDefault(),t.stopPropagation(),d){case u.TOUCH_ROTATE:if(!1===s.enableRotate)return;G(t),s.update();break;case u.TOUCH_PAN:if(!1===s.enablePan)return;W(t),s.update();break;case u.TOUCH_DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;i=t,s.enableZoom&&Y(i),s.enablePan&&W(i),s.update();break;case u.TOUCH_DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;e=t,s.enableZoom&&Y(e),s.enableRotate&&G(e),s.update();break;default:d=u.NONE}}function tt(t){!1!==s.enabled&&(s.dispatchEvent(h),d=u.NONE)}function et(t){!1!==s.enabled&&t.preventDefault()}s.domElement.addEventListener("contextmenu",et,!1),s.domElement.addEventListener("mousedown",X,!1),s.domElement.addEventListener("wheel",Z,!1),s.domElement.addEventListener("touchstart",K,!1),s.domElement.addEventListener("touchend",tt,!1),s.domElement.addEventListener("touchmove",$,!1),s.domElement.addEventListener("keydown",Q,!1),-1===s.domElement.tabIndex&&(s.domElement.tabIndex=0),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.MapControls=function(t,e){THREE.OrbitControls.call(this,t,e),this.mouseButtons.LEFT=THREE.MOUSE.PAN,this.mouseButtons.RIGHT=THREE.MOUSE.ROTATE,this.touches.ONE=THREE.TOUCH.PAN,this.touches.TWO=THREE.TOUCH.DOLLY_ROTATE},THREE.MapControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.MapControls.prototype.constructor=THREE.MapControls;